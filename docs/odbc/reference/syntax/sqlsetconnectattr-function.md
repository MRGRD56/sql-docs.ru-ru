---
description: Функция SQLSetConnectAttr
title: Функция SQLSetConnectAttr | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLSetConnectAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetConnectAttr
helpviewer_keywords:
- SQLSetConnectAttr function [ODBC]
ms.assetid: 97fc7445-5a66-4eb9-8e77-10990b5fd685
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 0e6e3e9722510b7a1a563de8546b2e4190696e10
ms.sourcegitcommit: 3bde506b2fa3bc82813dbe658d567b1b9eb4278b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/11/2020
ms.locfileid: "94498457"
---
# <a name="sqlsetconnectattr-function"></a>Функция SQLSetConnectAttr
**Соответствия**  
 Представленная версия: соответствие стандартам ODBC 3,0: ISO 92  
  
 **Сводка**  
 **SQLSetConnectAttr** задает атрибуты, управляющие аспектами соединений.  
  
> [!NOTE]
>  Дополнительные сведения о том, как диспетчер драйверов сопоставляет эту функцию, когда приложение ODBC 3 *. x* работает с драйвером ODBC 2 *. x* , см. в разделе [Сопоставление функций замены для обратной совместимости приложений](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLSetConnectAttr(  
     SQLHDBC       ConnectionHandle,  
     SQLINTEGER    Attribute,  
     SQLPOINTER    ValuePtr,  
     SQLINTEGER    StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *коннектионхандле*  
 [Input] Дескриптор подключения  
  
 *Attribute*  
 Входной Заданный атрибут, указанный в комментариях.  
  
 *ValuePtr*  
 Входной Указатель на значение, которое должно быть связано с *атрибутом*. В зависимости от значения *атрибута* *ValuePtr* будет целочисленным значением без знака или будет указывать на строку символов, завершающуюся нулем. Обратите внимание, что целочисленный тип аргумента *атрибута* может иметь нефиксированную длину. подробные сведения см. в разделе комментариев.  
  
 *StringLength*  
 Входной Если *атрибут Attribute* является атрибутом, ОПРЕДЕЛЯЕМым ODBC, а *ValuePtr* указывает на символьную строку или двоичный буфер, этот аргумент должен иметь длину * *ValuePtr*. Для символьных строковых данных этот аргумент должен содержать число байтов в строке.  
  
 Если *атрибут Attribute* является атрибутом, ОПРЕДЕЛЯЕМым ODBC, а *ValuePtr* — целым числом, *StringLength* игнорируется.  
  
 Если *атрибут* является атрибутом, определяемым драйвером, приложение указывает природу атрибута для диспетчера драйверов, задавая аргумент *StringLength* . *StringLength* могут иметь следующие значения:  
  
-   Если *ValuePtr* является указателем на символьную строку, *StringLength* — это длина строки или SQL_NTS.  
  
-   Если *ValuePtr* является указателем на двоичный буфер, приложение помещает результат макроса SQL_LEN_BINARY_ATTR ( *length* ) в *StringLength*. Это помещает отрицательное значение в *StringLength*.  
  
-   Если *ValuePtr* является указателем на значение, отличное от символьной строки или двоичной строки, *StringLength* должно иметь значение SQL_IS_POINTER.  
  
-   Если *ValuePtr* содержит значение фиксированной длины, то *StringLength* либо SQL_IS_INTEGER, либо SQL_IS_UINTEGER, соответственно.  
  
## <a name="returns"></a>Возвращаемое значение  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_INVALID_HANDLE или SQL_STILL_EXECUTING.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetConnectAttr** возвращает SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное значение SQLSTATE может быть получено путем вызова **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_DBC и *маркером* *коннектионхандле*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые функцией **SQLSetConnectAttr** , и объясняется каждый из них в контексте этой функции. Нотация "(DM)" предшествует описаниям SQLSTATE, возвращаемым диспетчером драйверов. Код возврата, связанный с каждым значением SQLSTATE, имеет SQL_ERROR, если не указано иное.  
  
 Драйвер может возвращать SQL_SUCCESS_WITH_INFO, чтобы предоставить сведения о результате установки параметра.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение для конкретного драйвера. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01S02|Значение параметра изменено|Драйвер не поддерживал значение, указанное в *ValuePtr* , и заменяло аналогичное значение. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|08002|Имя подключения используется|Аргумент *атрибута* был SQL_ATTR_ODBC_CURSORS, а драйвер уже подключен к источнику данных.|  
|08003|Соединение не открыто|(DM) было указано значение *атрибута* , которое требовало открытого соединения, но *коннектионхандле* не находится в подключенном состоянии.|  
|08S01|Сбой канала связи|Канал связи между драйвером и источником данных, к которому был подключен драйвер, был неудачен до завершения обработки функции.|  
|24 000|Недопустимое состояние курсора|Аргумент *атрибута* был SQL_ATTR_CURRENT_CATALOG, а результирующий набор — Pending.|  
|25000|Недопустимая операция в локальной транзакции|Соединение находилось в локальной транзакции при попытке прикрепления к соединению распределенных транзакций (DTC) путем установки атрибута Connection SQL_ATTR_ENLIST_IN_DTC.<br /><br /> Подключение уже прикреплено к DTC.<br /><br /> Соединение было прикреплено к распределенной транзакции, а локальная транзакция была запущена путем установки SQL_ATTR_AUTOCOMMIT в значение SQL_AUTOCOMMIT_OFF.|  
|3D000|Недопустимое имя каталога|Аргумент *атрибута* был SQL_CURRENT_CATALOG, а указанное имя каталога недопустимо.|  
|HY000|Общая ошибка|Произошла ошибка, для которой нет определенного SQLSTATE и для которого не определен SQLSTATE для конкретной реализации. Сообщение об ошибке, возвращаемое функцией **SQLGetDiagRec** в буфере *\* MessageText* , описывает ошибку и ее причину.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Operation canceled|Асинхронная обработка включена для *коннектионхандле*. Была вызвана функция **SQLSetConnectAttr** , до ее завершения была вызвана [функция склканцелхандле](../../../odbc/reference/syntax/sqlcancelhandle-function.md) в *Коннектионхандле* , а затем в *коннектионхандле* был вызвана функция **SQLSetConnectAttr** .<br /><br /> Или была вызвана функция  **SQLSetConnectAttr** , и до ее завершения была вызвана **склканцелхандле** в *коннектионхандле* из другого потока многопоточного приложения.|  
|HY009|Недопустимое использование пустого указателя|Аргумент *атрибута* определил атрибут Connection, который требовал строкового значения, а аргумент *ValuePtr* был пустым указателем.|  
|HY010|Ошибка последовательности функций|(DM) вызывается асинхронно исполняемая функция для *статеменсандле* , связанной с *коннектионхандле* , и все еще выполнялась при вызове **SQLSetConnectAttr** .<br /><br /> (DM) вызывается асинхронно исполняемая функция (не эта одна) для *коннектионхандле* и все еще выполнялась при вызове этой функции.<br /><br /> (DM) **SQLExecute** , **SQLExecDirect** или **SQLMoreResults** были вызваны для одного из дескрипторов инструкций, связанных с *коннектионхандле* и возвращаемых SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до получения данных для всех потоковых параметров.<br /><br /> (DM) **SQLExecute** , **SQLExecDirect** , **SQLBulkOperations** или **SQLSetPos** были вызваны для *статеменсандле* , связанного с *коннектионхандле* , и возвращены SQL_NEED_DATA. Эта функция была вызвана перед отправкой данных для всех параметров или столбцов данных, выполняемых во время выполнения.<br /><br /> (DM) **SQLBrowseConnect** был вызван для *коннектионхандле* и вернул SQL_NEED_DATA. Эта функция была вызвана до того, как **SQLBrowseConnect** вернул SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|HY011|Задать атрибут сейчас невозможно|Аргумент *атрибута* был SQL_ATTR_TXN_ISOLATION, а транзакция была открыта.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как не удалось получить доступ к базовым объектам памяти, возможно, из-за нехватки памяти.|  
|HY024|Недопустимое значение атрибута|При наличии указанного значения *атрибута* в *ValuePtr* было указано недопустимое значение. (Диспетчер драйверов возвращает значение SQLSTATE только для атрибутов соединения и инструкций, принимающих дискретный набор значений, таких как SQL_ATTR_ACCESS_MODE или SQL_ATTR_ASYNC_ENABLE. Для всех других атрибутов соединения и инструкции драйвер должен проверить значение, указанное в *ValuePtr*.)<br /><br /> Аргумент *атрибута* был SQL_ATTR_TRACEFILE или SQL_ATTR_TRANSLATE_LIB, а *ValuePtr* — пустая строка.|  
|HY090|Недопустимая длина строки или буфера|*(DM) \* ValuePtr* является символьной строкой, а аргумент *StringLength* был меньше 0, но не SQL_NTS.|  
|HY092|Недопустимый идентификатор атрибута или параметра|(DM) значение, указанное для *атрибута* Argument, недопустимо для версии ODBC, поддерживаемой драйвером.<br /><br /> (DM) значение, указанное для *атрибута* Argument, было атрибутом только для чтения.|  
|HY114|Драйвер не поддерживает асинхронное выполнение функции на уровне соединения|(DM) приложение попыталось включить асинхронное выполнение функции с SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE для драйвера, который не поддерживает асинхронные операции подключения.|  
|HY117|Подключение приостановлено из-за неизвестного состояния транзакции. Допускаются только функции отключения и только для чтения.|(DM) Дополнительные сведения о состоянии SUSPENDED см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HY121|Невозможно одновременно включить библиотеку курсоров и пулы Driver-Aware|Дополнительные сведения см. в статье [Организация пулов соединений с учетом драйверов](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md).|  
|HYC00|Необязательная функция не реализована|Значение, заданное для *атрибута* Argument, было допустимым соединением ODBC или атрибутом инструкции для версии ODBC, поддерживаемой драйвером, но не поддерживаемой драйвером.|  
|HYT01|Время ожидания подключения истекло|Время ожидания соединения истекло до ответа источника данных на запрос. Время ожидания соединения задается через **SQLSetConnectAttr** , SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) драйвер, связанный с *коннектионхандле* , не поддерживает функцию.|  
|IM009|Не удалось загрузить библиотеку DLL для перевода|Драйверу не удалось загрузить библиотеку DLL преобразования, указанную для соединения. Эта ошибка может быть возвращена, только если *атрибут* имеет SQL_ATTR_TRANSLATE_LIB.|  
|IM017|Опрос отключен в режиме асинхронного уведомления|При использовании модели уведомления опрос отключен.|  
|IM018|**Склкомплетеасинк** не был вызван для завершения предыдущей асинхронной операции с этим обработчиком.|Если предыдущий вызов функции в обработчике возвращает SQL_STILL_EXECUTING и если включен режим уведомления, то для обработки после обработки и завершения операции необходимо вызвать **склкомплетеасинк** .|  
|S1118|Драйвер не поддерживает асинхронное уведомление|Был установлен SQL_ATTR_ASYNC_DBC_EVENT (после установления соединения), но Асинхронное уведомление не поддерживается драйвером.|  
  
 Если *атрибут* является атрибутом инструкции, **SQLSetConnectAttr** может возвращать любой SQLSTATE, возвращенный **SQLSetStmtAttr**.  
  
## <a name="comments"></a>Комментарии  
 Общие сведения об атрибутах соединения см. в разделе [атрибуты соединения](../../../odbc/reference/develop-app/connection-attributes.md).  
  
 Определенные в настоящее время атрибуты и версия ODBC, в которой они были представлены, показаны в таблице далее в этом разделе. Ожидается, что для использования преимуществ различных источников данных будут определены дополнительные атрибуты. Диапазон атрибутов зарезервирован ODBC; Разработчики драйверов должны зарезервировать значения для собственного использования драйвера из Open Group.  
  
> [!NOTE]
>  Возможность установки атрибутов инструкций на уровне соединения путем вызова **SQLSetConnectAttr** является устаревшей в ODBC 3 *. x*. Приложения ODBC 3 *. x* никогда не должны задавать атрибуты инструкций на уровне соединения. Атрибуты инструкций ODBC 3 *. x* не могут быть установлены на уровне соединения, за исключением атрибутов SQL_ATTR_METADATA_ID и SQL_ATTR_ASYNC_ENABLE, которые являются атрибутами соединения и атрибутами инструкции и могут быть установлены на уровне соединения или инструкции.  
> 
>  Драйверы ODBC 3 *. x* должны поддерживать эту функцию только в том случае, если они должны работать с приложениями ODBC 2 *. x* , которые задают параметры инструкции ODBC 2 *. x* на уровне соединения. Дополнительные сведения см. в разделе [сопоставление SQLSetConnectOption](../../../odbc/reference/appendixes/sqlsetconnectoption-mapping.md) в приложении G: рекомендации по драйверу для обеспечения обратной совместимости.  
  
 Приложение может вызывать **SQLSetConnectAttr** в любое время между выделением и освобождением подключения. Все атрибуты соединения и инструкции, установленные приложением для соединения, сохраняются до тех пор, пока для соединения не будет вызван **SQLFreeHandle** . Например, если приложение вызывает **SQLSetConnectAttr** перед подключением к источнику данных, атрибут сохраняется даже в случае сбоя **SQLSetConnectAttr** в драйвере при подключении приложения к источнику данных. Если приложение устанавливает атрибут для конкретного драйвера, атрибут сохраняется даже в том случае, если приложение подключается к другому драйверу в соединении.  
  
 Некоторые атрибуты соединения можно задать только до установки соединения. другие можно задать только после установки соединения. В следующей таблице указаны атрибуты соединения, которые должны быть установлены до или после установки соединения. *Либо* указывает, что атрибут можно задать до или после соединения.  
  
|Атрибут|Задать до или после подключения?|  
|---------------|-------------------------------------|  
|SQL_ATTR_ACCESS_MODE|Либо [1]|  
|SQL_ATTR_ASYNC_DBC_EVENT|Можно использовать|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE|Либо [4]|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK|Можно использовать|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT|Можно использовать|  
|SQL_ATTR_ASYNC_ENABLE|Либо [2]|  
|SQL_ATTR_AUTO_IPD|Можно использовать|  
|SQL_ATTR_AUTOCOMMIT|Либо [5]|  
|SQL_ATTR_CONNECTION_DEAD|После|  
|SQL_ATTR_CONNECTION_TIMEOUT|Можно использовать|  
|SQL_ATTR_CURRENT_CATALOG|Либо [1]|  
|SQL_ATTR_DBC_INFO_TOKEN|После|  
|SQL_ATTR_ENLIST_IN_DTC|После|  
|SQL_ATTR_LOGIN_TIMEOUT|До|  
|SQL_ATTR_METADATA_ID|Можно использовать|  
|SQL_ATTR_ODBC_CURSORS|До|  
|SQL_ATTR_PACKET_SIZE|До|  
|SQL_ATTR_QUIET_MODE|Можно использовать|  
|SQL_ATTR_TRACE|Можно использовать|  
|SQL_ATTR_TRACEFILE|Можно использовать|  
|SQL_ATTR_TRANSLATE_LIB|После|  
|SQL_ATTR_TRANSLATE_OPTION|После|  
|SQL_ATTR_TXN_ISOLATION|Либо [3]|  
  
 [1] SQL_ATTR_ACCESS_MODE и SQL_ATTR_CURRENT_CATALOG можно задать до или после подключения, в зависимости от драйвера. Однако взаимодействующие приложения устанавливают их перед подключением, так как некоторые драйверы не поддерживают их изменение после подключения.  
  
 [2] SQL_ATTR_ASYNC_ENABLE необходимо задать перед выполнением активного оператора.  
  
 [3] SQL_ATTR_TXN_ISOLATION можно задать только в том случае, если в соединении нет открытых транзакций. Некоторые атрибуты соединения поддерживают подстановку аналогичного значения, если источник данных не поддерживает значение, указанное в \* *ValuePtr*. В таких случаях драйвер возвращает SQL_SUCCESS_WITH_INFO и SQLSTATE 01S02 (значение параметра изменено). Например, если *атрибут* имеет значение SQL_ATTR_PACKET_SIZE и \* *ValuePtr* превышает максимальный размер пакета, драйвер подставляет максимальный размер. Чтобы определить заменяющее значение, приложение вызывает **SQLGetConnectAttr**.  
  
 [4] Если SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE задан до открытия соединения, диспетчер драйверов установит атрибут драйвера при загрузке драйвера во время вызова **SQLBrowseConnect** , **SQLConnect** или **SQLDriverConnect**. Перед вызовом **SQLBrowseConnect** , **SQLConnect** или **SQLDriverConnect** диспетчер драйверов не знает, к какому драйверу подключаться, и не знает, поддерживает ли драйвер асинхронные операции подключения. Таким образом, диспетчер драйверов всегда возвращает SQL_SUCCESS. Но если драйвер не поддерживает асинхронные операции подключения, вызов **SQLBrowseConnect** , **SQLConnect** или **SQLDriverConnect** завершится ошибкой.  
  
 [5] Если SQL_ATTR_AUTOCOMMIT имеет значение FALSE, приложения должны вызывать SQLEndTran (SQL_ROLLBACK), если любой API возвращает SQL_ERROR для обеспечения согласованности транзакций.  
  
 Формат набора данных в \* буфере *ValuePtr* зависит от указанного *атрибута*. **SQLSetConnectAttr** будет принимать сведения об атрибутах в одном из двух разных форматов: строку символов, завершающуюся нулем, или целочисленное значение. Формат каждого из них отмечен в описании атрибута. Символьные строки, на которые указывает аргумент *ValuePtr* параметра **SQLSetConnectAttr** , имеют длину *StringLength* байтов.  
  
 Аргумент *StringLength* игнорируется, если длина определяется атрибутом, как и в случае всех атрибутов, введенных в ODBC 2 *. x* или более ранней версии.  
  
|*Attribute*|Содержимое *ValuePtr*|  
|-----------------|-------------------------|  
|SQL_ATTR_ACCESS_MODE (ODBC 1,0)|Значение SQLUINTEGER. SQL_MODE_READ_ONLY используется драйвером или источником данных в качестве индикатора, что соединение не требуется для поддержки инструкций SQL, которые приводят к возникновению обновлений. Этот режим можно использовать для оптимизации стратегий блокировки, управления транзакциями или других областей, соответствующих драйверу или источнику данных. Драйвер не требуется для предотвращения отправки таких инструкций в источник данных. Поведение драйвера и источника данных при запросе на обработку инструкций SQL, которые не предназначены только для чтения во время соединения только для чтения, определяется реализацией. Значение по умолчанию — SQL_MODE_READ_WRITE.|  
|SQL_ATTR_ASYNC_DBC_EVENT (ODBC 3,8)|Значение СКЛПОИНТЕР, которое является обработчиком события.<br /><br /> Уведомление о завершении асинхронных функций включается путем вызова **SQLSetConnectAttr** с атрибутом SQL_ATTR_ASYNC_STMT_EVENT и указания обработчика событий. **Примечание.**  Метод уведомления не поддерживается в библиотеке курсоров. Приложение получит сообщение об ошибке, если оно попытается включить библиотеку курсоров через SQLSetConnectAttr, если включен метод уведомления.|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE (ODBC 3,8)|Значение SQLUINTEGER, которое включает или отключает асинхронное выполнение выбранных функций в маркере соединения. Дополнительные сведения см. в разделе [асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md).<br /><br /> SQL_ASYNC_DBC_ENABLE_ON = включить асинхронную операцию для указанных функций, связанных с соединением.<br /><br /> SQL_ASYNC_DBC_ENABLE_OFF = (по умолчанию) отключить асинхронную операцию для указанных функций, связанных с соединением.<br /><br /> Параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE всегда является синхронным (то есть он никогда не будет возвращать SQL_STILL_EXECUTING).<br /><br /> Асинхронное выполнение операций с инструкциями включается с SQL_ATTR_ASYNC_ENABLE.|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK (ODBC 3,8)|Значение СКЛПОИНТЕР, которое указывает на структуру контекста.<br /><br /> Только диспетчер драйверов может вызвать функцию **SQLSetStmtAttr** драйвера с этим атрибутом.|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT (ODBC 3,8)|Значение СКЛПОИНТЕР, указывающее на структуру контекста.<br /><br /> Только диспетчер драйверов может вызвать функцию **SQLSetStmtAttr** драйвера с этим атрибутом.|  
|SQL_ATTR_ASYNC_ENABLE (ODBC 3,0)|Значение SQLULEN, указывающее, выполняется ли асинхронное выполнение функции, вызываемой с инструкцией в указанном соединении:<br /><br /> SQL_ASYNC_ENABLE_OFF = отключить поддержку асинхронного выполнения на уровне соединения для операций с инструкциями (по умолчанию).<br /><br /> SQL_ASYNC_ENABLE_ON = включить поддержку асинхронного выполнения на уровне соединения для операций с инструкциями.<br /><br /> Этот атрибут можно задать, возвращает ли **SQLGetInfo** с типом сведений SQL_ASYNC_MODE SQL_AM_CONNECTION или SQL_AM_STATEMENT.|  
|SQL_ATTR_AUTO_IPD (ODBC 3,0)|Доступное только для чтения значение SQLUINTEGER, указывающее, поддерживается ли автоматическое заполнение IPD после вызова **SQLPrepare** :<br /><br /> SQL_TRUE = автоматическое заполнение IPD после вызова **SQLPrepare** поддерживается драйвером.<br /><br /> SQL_FALSE = автоматическое заполнение IPD после вызова **SQLPrepare** не поддерживается драйвером. Серверы, не поддерживающие подготовленные инструкции, не смогут автоматически заполнять IPD.<br /><br /> Если для атрибута соединения SQL_ATTR_AUTO_IPD возвращается SQL_TRUE, атрибут инструкции SQL_ATTR_ENABLE_AUTO_IPD можно задать, чтобы включить или отключить автоматическое заполнение IPD. Если SQL_ATTR_AUTO_IPD имеет SQL_FALSE, SQL_ATTR_ENABLE_AUTO_IPD нельзя установить в SQL_TRUE. Значение по умолчанию SQL_ATTR_ENABLE_AUTO_IPD равно значению SQL_ATTR_AUTO_IPD.<br /><br /> Этот атрибут соединения может возвращаться **SQLGetConnectAttr** , но не может быть задан **SQLSetConnectAttr**.|  
|SQL_ATTR_AUTOCOMMIT (ODBC 1,0)|Значение SQLUINTEGER, указывающее, следует ли использовать автоматическую фиксацию или режим фиксации вручную.<br /><br /> SQL_AUTOCOMMIT_OFF = драйвер использует режим фиксации вручную, и приложение должно явно зафиксировать или откатить транзакции с помощью **SQLEndTran**.<br /><br /> SQL_AUTOCOMMIT_ON = драйвер использует режим автоматической фиксации. Каждый оператор фиксируется сразу же после выполнения. Это значение по умолчанию. Все открытые транзакции в соединении фиксируются, когда SQL_ATTR_AUTOCOMMIT имеет значение SQL_AUTOCOMMIT_ON, чтобы переходить от режима ручной фиксации к режиму автоматической фиксации.<br /><br /> Дополнительные сведения см. в разделе [режим фиксации](../../../odbc/reference/develop-app/commit-mode.md). **Важно.**  Некоторые источники данных удаляют планы доступа и закрывают курсоры для всех инструкций в соединении каждый раз при фиксации инструкции; режим автоматической фиксации может привести к тому, что это произойдет после выполнения каждой незапросной инструкции или закрытия курсора для запроса. Дополнительные сведения см. в статьях типы сведений SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [воздействие транзакций на курсоры и подготовленные инструкции](../../../odbc/reference/develop-app/effect-of-transactions-on-cursors-and-prepared-statements.md). <br /><br /> При выполнении пакета в режиме автоматической фиксации возможны две вещи. Весь пакет можно рассматривать как единицу с автофиксацией, или каждая инструкция в пакете рассматривается как единица с автофиксацией. Некоторые источники данных поддерживают оба этих поведения и могут предоставить способ выбора одного или другого. Драйвер определяет, будет ли пакет обрабатываться как единица с автофиксацией или же каждая отдельная инструкция в пакете будет зафиксирована.|  
|SQL_ATTR_CONNECTION_DEAD<br /><br /> (ODBC 3,5)|Доступное только для чтения значение SQLUINTEGER, указывающее состояние соединения. Если SQL_CD_TRUE, соединение потеряно. Если SQL_CD_FALSE, подключение все еще активно.|  
|SQL_ATTR_CONNECTION_TIMEOUT (ODBC 3,0)|Значение SQLUINTEGER, соответствующее количеству секунд ожидания завершения любого запроса в соединении перед возвратом в приложение. Драйвер должен возвращать значение SQLSTATE HYT00 (время ожидания истекло) в любой момент, когда возможно истечение времени ожидания в ситуации, не связанной с выполнением запроса или входом в систему.<br /><br /> Если *ValuePtr* равен 0 (по умолчанию), время ожидания отсутствует.|  
|SQL_ATTR_CURRENT_CATALOG (ODBC 2,0)|Строка символов, содержащая имя каталога, который будет использоваться источником данных. Например, в SQL Server каталог является базой данных, поэтому драйвер отправляет в источник данных инструкцию **use** _Database_ , где *Database* — это база данных, указанная в \* *ValuePtr*. Для одноуровневого драйвера каталог может быть каталогом, поэтому драйвер изменяет текущий каталог на каталог, указанный в * *ValuePtr*.|  
|SQL_ATTR_DBC_INFO_TOKEN (ODBC 3,8|Значение СКЛПОИНТЕР, используемое для установки токена сведений о соединении в обработчик DBC, если параметр [склратеконнектион](../../../odbc/reference/syntax/sqlrateconnection-function.md)( \* *пратинг* ) не равен 100.<br /><br /> SQL_ATTR_DBC_INFO_TOKEN только задано. Невозможно использовать **SQLGetConnectAttr** или **SQLGetConnectOption** для получения этого значения. **SQLSetConnectAttr** диспетчера драйверов не будет принимать SQL_ATTR_DBC_INFO_TOKEN, так как приложение не должно устанавливать этот атрибут.<br /><br /> Если драйвер возвращает SQL_ERROR после установки SQL_ATTR_DBC_INFO_TOKEN, подключение, полученное из пула, будет освобождено. Диспетчер драйверов попытается получить другое подключение из пула. Дополнительные сведения см. в статье о [разработке Connection-Pool осведомленности в драйвере ODBC](../../../odbc/reference/develop-driver/developing-connection-pool-awareness-in-an-odbc-driver.md) .|  
|SQL_ATTR_ENLIST_IN_DTC (ODBC 3,0)|Значение СКЛПОИНТЕР, указывающее, следует ли использовать драйвер ODBC в распределенных транзакциях, управляемых службами компонентов Майкрософт.<br /><br /> Передайте объект транзакции DTC OLE, указывающий транзакцию для экспорта в SQL Server, или SQL_DTC_DONE для завершения связи DTC подключения.<br /><br /> Клиент вызывает метод Microsoft координатор распределенных транзакций (MS DTC) OLE ITransactionDispenser:: BeginTransaction, чтобы начать транзакцию MS DTC и создать объект транзакции MS DTC, представляющий транзакцию. Затем приложение вызывает SQLSetConnectAttr с параметром SQL_ATTR_ENLIST_IN_DTC, чтобы связать объект транзакции с соединением ODBC. Все связанные действия базы данных будут выполняться под защитой транзакции MS DTC. Приложение вызывает SQLSetConnectAttr с параметром SQL_DTC_DONE, чтобы завершить связь соединения с координатором распределенных транзакций. Дополнительные сведения см. в документации по MS DTC.|  
|SQL_ATTR_LOGIN_TIMEOUT (ODBC 1,0)|Значение SQLUINTEGER, соответствующее количеству секунд ожидания завершения запроса на вход, прежде чем возвратить в приложение. Значение по умолчанию зависит от драйвера. Если *ValuePtr* имеет значение 0, время ожидания отключается, и попытки подключения будут ждать бесконечно.<br /><br /> Если указанное время ожидания превышает максимальное время ожидания входа в источник данных, драйвер подставляет это значение и возвращает значение SQLSTATE 01S02 (изменение значения параметра).|  
|SQL_ATTR_METADATA_ID (ODBC 3,0)|Значение SQLUINTEGER, определяющее, как обрабатываются строковые аргументы функций каталога.<br /><br /> Если SQL_TRUE, строковый аргумент функций каталога рассматривается как идентификаторы. Регистр не имеет значения. Для строк без разделителей драйвер удаляет все конечные пробелы, а строка выводится в верхний регистр. Для строк с разделителями драйвер удаляет все начальные или конечные пробелы и принимает буквальное значение между разделителями. Если для одного из этих аргументов задан пустой указатель, функция возвращает SQL_ERROR и SQLSTATE HY009 (недопустимое использование пустого указателя).<br /><br /> Если SQL_FALSE, строковые аргументы функций каталога не рассматриваются как идентификаторы. Регистр важен. Они могут содержать шаблон поиска строки или нет, в зависимости от аргумента.<br /><br /> Значение по умолчанию — SQL_FALSE.<br /><br /> Аргумент *TableType* объекта **SQLTables** , который принимает список значений, не затрагивается этим атрибутом.<br /><br /> SQL_ATTR_METADATA_ID также можно задать на уровне инструкции. (Это единственный атрибут соединения, который также является атрибутом инструкции.)<br /><br /> Дополнительные сведения см. [в разделе аргументы в функциях каталога](../../../odbc/reference/develop-app/arguments-in-catalog-functions.md).|  
|SQL_ATTR_ODBC_CURSORS (ODBC 2,0)|Значение SQLULEN, указывающее, как диспетчер драйверов использует библиотеку курсоров ODBC:<br /><br /> SQL_CUR_USE_IF_NEEDED = диспетчер драйверов использует библиотеку курсоров ODBC, только если это необходимо. Если драйвер поддерживает параметр SQL_FETCH_PRIOR в **SQLFetchScroll** , диспетчер драйверов использует возможности прокрутки драйвера. В противном случае используется библиотека курсоров ODBC.<br /><br /> SQL_CUR_USE_ODBC = диспетчер драйверов использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_DRIVER = диспетчер драйверов использует возможности прокрутки драйвера. Это параметр по умолчанию.<br /><br /> Дополнительные сведения о библиотеке курсоров ODBC см. в [приложении F: Библиотека курсоров ODBC](../../../odbc/reference/appendixes/appendix-f-odbc-cursor-library.md). **Предупреждение:**  Библиотека курсоров будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.|  
|SQL_ATTR_PACKET_SIZE (ODBC 2,0)|Значение SQLUINTEGER, указывающее размер сетевого пакета в байтах. **Примечание.**  Многие источники данных либо не поддерживают этот параметр, либо могут возвращать только, но не задают размер сетевого пакета. <br /><br /> Если указанный размер превышает максимальный размер пакета или меньше, чем минимальный размер пакета, драйвер подставляет это значение и возвращает значение SQLSTATE 01S02 (изменение значения параметра).<br /><br /> Если приложение устанавливает размер пакета после того, как соединение уже установлено, драйвер вернет значение SQLSTATE HY011 (атрибут не может быть установлен сейчас).|  
|SQL_ATTR_QUIET_MODE (ODBC 2,0)|Дескриптор окна (HWND).<br /><br /> Если указатель окна является пустым указателем, драйвер не отображает никаких диалоговых окон.<br /><br /> Если маркер окна не является пустым указателем, он должен быть обработчиком родительского окна приложения. Это значение по умолчанию. Драйвер использует этот обработчик для вывода диалоговых окон. **Примечание.**  Атрибут подключения SQL_ATTR_QUIET_MODE не применяется к диалоговым окнам, отображаемым **SQLDriverConnect**.|  
|SQL_ATTR_TRACE (ODBC 1,0)|Значение SQLUINTEGER, указывающее диспетчеру драйверов, следует ли выполнять трассировку:<br /><br /> SQL_OPT_TRACE_OFF = трассировка отключена (по умолчанию)<br /><br /> SQL_OPT_TRACE_ON = трассировка вкл.<br /><br /> Когда трассировка включена, диспетчер драйверов записывает каждый вызов функции ODBC в файл трассировки. **Примечание.**  Когда трассировка включена, диспетчер драйверов может возвращать значение SQLSTATE IM013 (ошибка файла трассировки) из любой функции. <br /><br /> Приложение задает файл трассировки с параметром SQL_ATTR_TRACEFILE. Если файл уже существует, диспетчер драйверов добавляет его к файлу. В противном случае он создает файл. Если трассировка включена и файл трассировки не указан, диспетчер драйверов записывает данные в файл SQL. Войдите в корневой каталог.<br /><br /> Приложение может установить переменную **одбкшаредтрацефлаг** , чтобы включить трассировку динамически. Затем трассировка включается для всех приложений ODBC, работающих в данный момент. Если приложение отключает трассировку, оно отключено только для этого приложения.<br /><br /> Если ключевое слово **Trace** в сведениях о системе имеет значение 1, когда приложение вызывает **функцию sqlallochandle** с *параметром handletype* SQL_HANDLE_ENV, трассировка включается для всех дескрипторов. Он включен только для приложения, которое вызвало **функцию SQLAllocHandle**.<br /><br /> Вызов **SQLSetConnectAttr** с *атрибутом* SQL_ATTR_TRACE не требует, чтобы аргумент *коннектионхандле* был допустимым и не возвращал SQL_ERROR если *коннектионхандле* имеет значение null. Этот атрибут применяется ко всем соединениям.|  
|SQL_ATTR_TRACEFILE (ODBC 1,0)|Строка символов, завершающаяся нулем, содержащая имя файла трассировки.<br /><br /> Значение по умолчанию атрибута SQL_ATTR_TRACEFILE указывается с помощью ключевого слова **TRACEFILE** в сведениях о системе. Дополнительные сведения см. в разделе [подраздела ODBC](../../../odbc/reference/install/odbc-subkey.md).<br /><br /> Вызов **SQLSetConnectAttr** с *атрибутом* SQL_ATTR_TRACEFILE не требует, чтобы аргумент *коннектионхандле* был допустимым, и не возвращал SQL_ERROR, если *коннектионхандле* является недопустимым. Этот атрибут применяется ко всем соединениям.|  
|SQL_ATTR_TRANSLATE_LIB (ODBC 1,0)|Строка символов, завершающаяся нулем, содержащая имя библиотеки, содержащей функции **склдривертодатасаурце** и **склдатасаурцетодривер** , к которым драйвер обращается для выполнения таких задач, как преобразование наборов символов. Этот параметр может быть указан только в том случае, если драйвер подключен к источнику данных. Значение этого атрибута будет сохраняться в соединениях. Дополнительные сведения о переводе данных см. в разделе [библиотеки DLL перевода](../../../odbc/reference/develop-app/translation-dlls.md) и [Справочник по функциям DLL преобразования](../../../odbc/reference/syntax/translation-dll-api-reference.md).|  
|SQL_ATTR_TRANSLATE_OPTION (ODBC 1,0)|32-разрядное значение флага, передаваемое в библиотеку DLL преобразования. Этот атрибут можно указать, только если драйвер подключен к источнику данных. Дополнительные сведения о переводе данных см. в разделе [DLL-файлы преобразования](../../../odbc/reference/develop-app/translation-dlls.md).|  
|SQL_ATTR_TXN_ISOLATION (ODBC 1,0)|32-разрядная битовая маска, которая задает уровень изоляции транзакции для текущего соединения. Приложение должно вызвать **SQLEndTran** для фиксации или отката всех открытых транзакций в соединении перед вызовом **SQLSetConnectAttr** с этим параметром.<br /><br /> Допустимые значения для *ValuePtr* можно определить с помощью вызова **SQLGetInfo** с *инфотипе* , равным SQL_TXN_ISOLATION_OPTIONS.<br /><br /> Описание уровней изоляции транзакций см. в описании типа сведений о SQL_DEFAULT_TXN_ISOLATION в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [уровнях изоляции транзакций](../../../odbc/reference/develop-app/transaction-isolation-levels.md).|  
  
 [1] эти функции можно вызывать асинхронно, только если дескриптор является дескриптором реализации, а не дескриптором приложения.  
  
## <a name="code-example"></a>Пример кода  
 См. [SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение маркера|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возврат значения атрибута соединения|[Функция SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
