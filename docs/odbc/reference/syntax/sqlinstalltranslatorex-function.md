---
description: Функция SQLInstallTranslatorEx
title: Функция Склинсталлтранслаторекс | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
apiname:
- SQLInstallTranslatorEx
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLInstallTranslatorEx
helpviewer_keywords:
- SQLInstallTranslatorEx function [ODBC]
ms.assetid: a0630602-53c1-4db0-98ce-70d160aedf8d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: e055f3f3565c6240134bf43b4b4f8951059e2725
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99189652"
---
# <a name="sqlinstalltranslatorex-function"></a>Функция SQLInstallTranslatorEx
**Соответствия**  
 Введенная версия: ODBC 3,0  
  
 **Сводка**  
 **Склинсталлтранслаторекс** добавляет сведения о трансляторе в раздел Odbcinst.ini сведений о системе (HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBCINST.INI \одбк Translator).  
  
 Функциональность **склинсталлтранслаторекс** также можно получить с помощью [ODBCCONF.EXE](../../../odbc/odbcconf-exe.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLInstallTranslatorEx(  
     LPCSTR    lpszTranslator,  
     LPCSTR    lpszPathIn,  
     LPSTR     lpszPathOut,  
     WORD      cbPathOutMax,  
     WORD *    pcbPathOut,  
     WORD      fRequest,  
     LPDWORD   lpdwUsageCount);  
```  
  
## <a name="arguments"></a>Аргументы  
 *лпсзтранслатор*  
 Входной Это должен быть список пар "ключевое слово-значение", описывающих транслятор, с удвоенным нулем. Дополнительные сведения о синтаксисе пар "ключевое слово-значение" см. в статье [подразделы спецификации переводчика](../../../odbc/reference/install/translator-specification-subkeys.md).  
  
 Ключевые слова **Translator** и **Setup** должны быть добавлены в строку *лпсзтранслатор* . Библиотека DLL преобразования указывается с помощью ключевого слова **Translator** , а библиотека DLL установки переводчика указывается с помощью ключевого слова **Setup** . Каждая пара завершается нулевым байтом, а весь список завершается нулевым байтом. (То есть, в конце списка отмечаются два нуль-байта.) Формат *лпсзтранслатор* выглядит следующим образом:  
  
 \0Translator =*Translator-DLL-имя_файла*\ 0 [Setup =*Setup-DLL-имя_файла*\ 0] \ 0  
  
 *лпсзпасин*  
 Входной Полный путь к месту установки транслятора или указатель null. Если *лпсзпас* является пустым указателем, переводчики будут установлены в системный каталог.  
  
 *лпсзпасаут*  
 Проверки Путь к целевому каталогу, в котором должен быть установлен переводчик. Если переводчик не был установлен, *лпсзпасаут* совпадает с *лпсзпасин*. При наличии предыдущей установки переводчика *лпсзпасаут* — это путь к предыдущей установке.  
  
 *кбпасаутмакс*  
 Входной Длина *лпсзпасаут.*  
  
 *пкбпасаут*  
 Проверки Общее число байт, доступных для возврата в *лпсзпасаут*. Если число возвращаемых байт больше или равно *кбпасаутмакс*, путь вывода в *лпсзпасаут* усекается до *пкбпасаутмакс* минус символ завершения null. Аргумент *пкбпасаут* может быть пустым указателем.  
  
 *фрекуест*  
 Входной Тип запроса. *фрекуест* должен содержать одно из следующих значений:  
  
 ODBC_INSTALL_INQUIRY: запрос о том, где можно установить переводчик.  
  
 ODBC_INSTALL_COMPLETE: завершите запрос на установку.  
  
 *лпдвусажекаунт*  
 Проверки Число использований транслятора после вызова этой функции.  
  
 Приложения не должны устанавливать счетчик использования. Этот счетчик будет поддерживаться в ODBC.  
  
## <a name="returns"></a>Возвращаемое значение  
 Функция возвращает TRUE, если она успешна, и FALSE в случае сбоя.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склинсталлтранслаторекс** возвращает значение false, связанное значение *\* пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения *\* пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_INVALID_BUFF_LEN|Недопустимая длина буфера|Аргумент *лпсзпасаут* недостаточно велик для размещения пути вывода. Буфер содержит усеченный путь.<br /><br /> Аргумент *кбпасаутмакс* был равен 0, а аргумент *фрекуест* — ODBC_INSTALL_COMPLETE.|  
|ODBC_ERROR_INVALID_REQUEST_TYPE|Недопустимый тип запроса|Аргумент *фрекуест* не является одним из следующих:<br /><br /> ODBC_INSTALL_INQUIRY ODBC_INSTALL_COMPLETE|  
|ODBC_ERROR_INVALID_KEYWORD_VALUE|Недопустимые пары "ключевое слово-значение"|Аргумент *лпсзтранслатор* содержал синтаксическую ошибку.|  
|ODBC_ERROR_INVALID_PATH|Недопустимый путь установки|Аргумент *лпсзпасин* содержит недопустимый путь.|  
|ODBC_ERROR_INVALID_PARAM_SEQUENCE|Недопустимая последовательность параметров|Аргумент *лпсзтранслатор* не содержит список пар "ключевое слово-значение".|  
|ODBC_ERROR_USAGE_UPDATE_FAILED|Не удалось увеличить или уменьшить счетчик использования компонентов реестра|Установщику не удалось увеличить счетчик использования транслятора.|  
  
## <a name="comments"></a>Комментарии  
 **Склинсталлтранслаторекс** предоставляет механизм установки только переводчика. Эта функция фактически не копирует какие бы то ни было файлы. Вызывающая программа отвечает за копирование файлов переводчиков.  
  
 **Склинсталлтранслаторекс** увеличивает число использований компонентов для установленного транслятора на 1. Если версия транслятора уже существует, но счетчик использования компонентов для транслятора не существует, то новое значение счетчика использования компонентов устанавливается равным 2.  
  
 Программа установки приложения несет ответственность за физическое копирование файла переводчика и на поддержание счетчика использования файлов. Если файл переводчика ранее не был установлен, программа установки приложения должна скопировать файл или файлы и создать счетчик использования файлов или файлов. Если файл уже был установлен, программа установки просто увеличивает счетчик использования файлов.  
  
 Если предыдущая версия транслятора была ранее установлена приложением, необходимо удалить его, а затем повторно установить, чтобы счетчик использования компонента транслятора был допустимым. **Склремоветранслатор** следует вызывать для уменьшения числа использований компонентов, а затем вызывать **склинсталлтранслаторекс** для увеличения числа использований компонентов. Программа установки приложения должна заменить старый файл или файлы новым файлом. Количество использованных файлов останется прежним, а другие приложения, в которых использовался файл более старой версии, теперь будут использовать более новую версию.  
  
 Длина пути в *лпсзпасаут* в **склинсталлтранслаторекс** позволяет установить двухэтапный процесс установки, поэтому приложение может определить, что должно быть *кбпасаутмакс* , вызвав **склинсталлтранслаторекс** с *фрекуест* режимом ODBC_INSTALL_INQUIRY. Будет возвращено общее число байтов, доступных в буфере *пкбпасаут* . Затем **склинсталлтранслаторекс** можно вызвать с *фрекуест* ODBC_INSTALL_COMPLETE, а аргумент *кбпасаутмакс* — со значением в буфере *пкбпасаут* , а также с завершающим символом NULL.  
  
 Если вы решили не использовать двустороннюю модель для **склинсталлтранслаторекс**, необходимо задать *кбпасаутмакс*, который определяет размер хранилища для пути к целевому каталогу, значение _MAX_PATH, как определено в STDLIB. h, чтобы предотвратить усечение.  
  
 Если *фрекуест* имеет ODBC_INSTALL_COMPLETE, **склинсталлтранслаторекс** не допускает, чтобы *Лпсзпасаут* было NULL (или *кбпасаутмакс* в значение 0). Если *фрекуест* имеет ODBC_INSTALL_COMPLETE, то возвращается значение false, если число возвращаемых байт больше или равно *кбпасаутмакс*, и результат усечения.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Возврат параметра преобразования по умолчанию|[конфигтранслатор](../../../odbc/reference/syntax/configtranslator-function.md)|  
|Выбор переводчиков|[склжеттранслатор](../../../odbc/reference/syntax/sqlgettranslator-function.md)|  
|Удаление переводчиков|[склремоветранслатор](../../../odbc/reference/syntax/sqlremovetranslator-function.md)|
