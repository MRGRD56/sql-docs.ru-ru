---
description: Функция SQLParamData
title: Функция метод SQLParamData | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
apiname:
- SQLParamData
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLParamData
helpviewer_keywords:
- SQLParamData function [ODBC]
ms.assetid: 68fe010d-9539-4e5b-a260-c8d32423b1db
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: e050102612c7e5d370e730909522fa23e801a8f2
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99195850"
---
# <a name="sqlparamdata-function"></a>Функция SQLParamData
**Соответствия**  
 Представленная версия: соответствие стандартам ODBC 1,0: ISO 92  
  
 **Сводка**  
 **Метод SQLParamData** используется вместе с **SQLPutData** для предоставления данных параметра во время выполнения инструкции, а также с **SQLGetData** для получения потоковых выходных данных параметров.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLParamData(  
     SQLHSTMT       StatementHandle,  
     SQLPOINTER *   ValuePtrPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *статеменсандле*  
 Входной Маркер инструкции.  
  
 *валуептрптр*  
 Проверки Указатель на буфер, в котором возвращается адрес буфера *параметервалуептр* , указанного в **SQLBindParameter** (для данных параметров), или адрес буфера *таржетвалуептр* , указанного в **SQLBindCol** (для данных столбца), который содержится в поле записи дескриптора SQL_DESC_DATA_PTR.  
  
## <a name="returns"></a>Возвращаемое значение  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NEED_DATA, SQL_NO_DATA, SQL_STILL_EXECUTING, SQL_ERROR, SQL_INVALID_HANDLE или SQL_PARAM_DATA_AVAILABLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **метод SQLParamData** возвращает SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное значение SQLSTATE может быть получено путем вызова **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_STMT и *маркером* *статеменсандле*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые функцией **метод SQLParamData** , и объясняется каждый из них в контексте этой функции. Нотация "(DM)" предшествует описаниям SQLSTATE, возвращаемым диспетчером драйверов. Код возврата, связанный с каждым значением SQLSTATE, имеет SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение для конкретного драйвера. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|07006|Нарушение атрибута ограниченного типа данных|Значение данных, определяемое аргументом *ValueType* в **SQLBindParameter** для привязанного параметра, не может быть преобразовано в тип данных, определяемый аргументом *ParameterType* в **SQLBindParameter**.<br /><br /> Значение данных, возвращаемое для параметра, привязанного как SQL_PARAM_INPUT_OUTPUT или SQL_PARAM_OUTPUT, не может быть преобразовано в тип данных, определяемый аргументом *ValueType* в **SQLBindParameter**.<br /><br /> (Если не удалось преобразовать значения данных для одной или нескольких строк, но одна или несколько строк были успешно возвращены, эта функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|08S01|Сбой канала связи|Канал связи между драйвером и источником данных, к которому был подключен драйвер, был неудачен до завершения обработки функции.|  
|22026|Строковые данные, несовпадение длины|SQL_NEED_LONG_DATA_LEN тип сведений в **SQLGetInfo** был "Y", а для длинного параметра было отправлено меньше данных (тип данных был SQL_LONGVARCHAR, SQL_LONGVARBINARY или тип данных, относящийся к источнику данных), чем было указано с помощью аргумента *StrLen_or_IndPtr* в **SQLBindParameter**.<br /><br /> SQL_NEED_LONG_DATA_LEN тип сведений в **SQLGetInfo** имел значение "Y", а для длинного столбца были отправлены данные меньшего размера (тип данных был SQL_LONGVARCHAR, SQL_LONGVARBINARY или тип данных Long, относящийся к источнику данных), чем указано в буфере длины, соответствующем столбцу в строке данных, которая была добавлена или изменена с помощью **SQLBulkOperations** или с помощью функции **SQLSetPos**.|  
|40001|Сбой сериализации|Выполнен откат транзакции из-за взаимоблокировки ресурсов с другой транзакцией.|  
|40003|Неизвестное завершение инструкции|Не удалось выполнить связанное соединение во время выполнения этой функции, и состояние транзакции не может быть определено.|  
|HY000|Общая ошибка|Произошла ошибка, для которой нет определенного SQLSTATE и для которого не определен SQLSTATE для конкретной реализации. Сообщение об ошибке, возвращаемое функцией **SQLGetDiagRec** в буфере *\* MessageText* , описывает ошибку и ее причину.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Operation canceled|Асинхронная обработка включена для *статеменсандле*. Функция была вызвана, и до ее завершения была вызвана **SQLCancel** или **склканцелхандле** для *статеменсандле*; Затем функция снова вызывалась в *статеменсандле*.<br /><br /> Функция была вызвана и до ее завершения была вызвана **SQLCancel** или **склканцелхандле** в *статеменсандле* из другого потока многопоточного приложения.|  
|HY010|Ошибка последовательности функций|(DM) предыдущий вызов функции не был вызовом **SQLExecDirect**, **SQLExecute**, **SQLBulkOperations** или **SQLSetPos** , где был SQL_NEED_DATA код возврата, или предыдущий вызов функции был вызовом **SQLPutData**.<br /><br /> Предыдущий вызов функции был вызовом **метод SQLParamData**.<br /><br /> (DM) вызвана асинхронно исполняемая функция для маркера соединения, связанного с *статеменсандле*. Эта асинхронная функция все еще выполнялась при вызове функции **метод SQLParamData** .<br /><br /> (DM) вызывается асинхронно исполняемая функция (не эта одна) для *статеменсандле* и все еще выполнялась при вызове этой функции.<br /><br /> **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations** или **SQLSetPos** были вызваны для *статеменсандле* и возвращены SQL_NEED_DATA. **SQLCancel** был вызван до отправки данных для всех параметров или столбцов данных, выполняемых во время выполнения.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как не удалось получить доступ к базовым объектам памяти, возможно, из-за нехватки памяти.|  
|HY117|Подключение приостановлено из-за неизвестного состояния транзакции. Допускаются только функции отключения и только для чтения.|(DM) Дополнительные сведения о состоянии SUSPENDED см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания подключения истекло|Время ожидания соединения истекло до ответа источника данных на запрос. Время ожидания соединения задается через **SQLSetConnectAttr**, SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) драйвер, соответствующий *статеменсандле* , не поддерживает функцию.|  
|IM017|Опрос отключен в режиме асинхронного уведомления|При использовании модели уведомления опрос отключен.|  
|IM018|**Склкомплетеасинк** не был вызван для завершения предыдущей асинхронной операции с этим обработчиком.|Если предыдущий вызов функции в обработчике возвращает SQL_STILL_EXECUTING и если включен режим уведомления, то для обработки после обработки и завершения операции необходимо вызвать **склкомплетеасинк** .|  
  
 Если при отправке данных для параметра в инструкции SQL вызывается **метод SQLParamData** , он может вернуть любое значение SQLSTATE, которое может быть возвращено функцией, вызываемой для выполнения инструкции (**SQLExecute** или **SQLExecDirect**). При вызове во время отправки данных для столбца, обновляемого или добавляемого с помощью **SQLBulkOperations** или обновляемого с помощью функции **SQLSetPos**, он может вернуть любое значение SQLSTATE, которое может быть возвращено **SQLBulkOperations** или **SQLSetPos**.  
  
## <a name="comments"></a>Комментарии  
 **Метод SQLParamData** можно вызвать для предоставления данных на выполнение для двух целей: данные параметров, которые будут использоваться при вызове **SQLExecute** или **SQLExecDirect**, или данные столбца, которые будут использоваться при обновлении или добавлении строки путем вызова **SQLBulkOperations** или обновления путем вызова функции **SQLSetPos**. Во время выполнения **метод SQLParamData** возвращает в приложение индикатор того, какие данные требуются драйверу.  
  
 Когда приложение вызывает **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations** или **SQLSetPos**, драйвер возвращает SQL_NEED_DATA, если ему требуются данные на момент выполнения. Затем приложение вызывает **метод SQLParamData** , чтобы определить, какие данные следует отправить. Если драйверу требуются данные параметров, драйвер возвращает значение, помещенное приложением в буфер набора строк, в буфере вывода *\* валуептрптр* . Приложение может использовать это значение для определения данных параметров, запрашиваемых драйвером. Если драйверу требуются данные столбца, драйвер возвращает в буфере *\* валуептрптр* адрес, к которому изначально привязан столбец, следующим образом:  
  
 *Связанный адрес*  +  *Смещение привязки* + ((*номер строки* -1) x *размер элемента*)  
  
 где переменные определяются, как показано в следующей таблице.  
  
|Переменная|Описание|  
|--------------|-----------------|  
|*Связанный адрес*|Адрес, указанный в аргументе *таржетвалуептр* в **SQLBindCol**.|  
|*Смещение привязки*|Значение, хранящееся в адресе, указанном с помощью атрибута инструкции SQL_ATTR_ROW_BIND_OFFSET_PTR.|  
|*Номер строки*|Номер строки в наборе строк, отсчитываемый от 1. Для однострочных выборок, которые являются значением по умолчанию, это значение равно 1.|  
|*Размер элемента*|Значение атрибута инструкции SQL_ATTR_ROW_BIND_TYPE для буферов данных и длины/индикатора.|  
  
 Он также возвращает SQL_NEED_DATA, который является индикатором для приложения, которое должно вызывать **SQLPutData** для отправки данных.  
  
 Приложение вызывает **SQLPutData** столько раз, сколько необходимо для отправки данных по выполнению данных для столбца или параметра. После отправки всех данных для столбца или параметра приложение вызывает **метод SQLParamData** еще раз. Если **метод SQLParamData** снова возвращает SQL_NEED_DATA, данные должны быть отправлены для другого параметра или столбца. Поэтому приложение снова вызывает **SQLPutData**. Если все данные, выполняемые при выполнении, были отправлены для всех параметров или столбцов, **метод SQLParamData** возвращает SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, значение в *\* валуептрптр* не определено, и инструкция SQL может быть выполнена, а также может быть обработана функция **SQLBulkOperations** или **SQLSetPos** .  
  
 Если **метод SQLParamData** предоставляет данные параметров для инструкции UPDATE или DELETE, которая не влияет ни на какие строки в источнике данных, вызов **метод SQLParamData** возвращает SQL_NO_DATA.  
  
 Дополнительные сведения о передаче данных параметров при выполнении во время выполнения инструкции см. в разделе "передача значений параметров" в [SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md) и [Отправка длинных данных](../../../odbc/reference/develop-app/sending-long-data.md). Дополнительные сведения о том, как обновляются или добавляются данные в столбцах данных, см. в подразделе «Использование SQLSetPos» раздела [SQLSetPos](../../../odbc/reference/syntax/sqlsetpos-function.md), «выполнение массовых обновлений с помощью закладок» в [SQLBulkOperations](../../../odbc/reference/syntax/sqlbulkoperations-function.md)и « [Long Data](../../../odbc/reference/develop-app/long-data-and-sqlsetpos-and-sqlbulkoperations.md)», «SQLSetPos» и «SQLBulkOperations».  
  
 **Метод SQLParamData** можно вызвать для получения потоковых выходных параметров. Если **SQLMoreResults**, **SQLExecute**, **SQLGetData** или **SQLExecDirect** возвращает SQL_PARAM_DATA_AVAILABLE, вызовите **метод SQLParamData** , чтобы определить, какой параметр имеет доступное значение. Дополнительные сведения о SQL_PARAM_DATA_AVAILABLE и потоковых выходных параметрах см. в разделе [получение выходных параметров с помощью SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md).  
  
## <a name="code-example"></a>Пример кода  
 См. [SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка буфера к параметру|[Функция SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md)|  
|Отмена обработки инструкции|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
|Возврат сведений о параметре в операторе|[Функция SQLDescribeParam](../../../odbc/reference/syntax/sqldescribeparam-function.md)|  
|Исполнение инструкции SQL|[Функция SQLExecDirect](../../../odbc/reference/syntax/sqlexecdirect-function.md)|  
|Исполнение подготовленной инструкции SQL|[Функция SQLExecute](../../../odbc/reference/syntax/sqlexecute-function.md)|  
|Отправка данных параметров во время выполнения|[SQLPutData, функция](../../../odbc/reference/syntax/sqlputdata-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md)
