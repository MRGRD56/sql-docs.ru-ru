---
description: Функция SQLInstallDriverManager
title: Функция Склинсталлдриверманажер | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
apiname:
- SQLInstallDriverManager
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLInstallDriverManager
helpviewer_keywords:
- SQLInstallDriverManager function [ODBC]
ms.assetid: aebc439b-fffd-4d98-907a-0163f79aee8d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b85af0323de46972ec6d6c4bf88359209b0015d5
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99189700"
---
# <a name="sqlinstalldrivermanager-function"></a>Функция SQLInstallDriverManager
**Соответствия**  
 Представленная версия: ODBC 1,0: не рекомендуется в Windows XP с пакетом обновления 2, Windows Server 2003 с пакетом обновления 1 (SP1) и более поздних операционных системах  
  
 **Сводка**  
 **Склинсталлдриверманажер** Возвращает путь к целевому каталогу для установки компонентов ODBC Core. Вызывающая программа должна фактически копировать файлы диспетчера драйверов в целевой каталог.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLInstallDriverManager(  
     LPSTR    lpszPath,  
     WORD     cbPathMax,  
     WORD *   pcbPathOut);  
```  
  
## <a name="arguments"></a>Аргументы  
 *лпсзпас*  
 Проверки Путь к целевому каталогу установки.  
  
 *кбпасмакс*  
 Входной Длина *лпсзпас*. Это должен быть по крайней мере _MAX_PATH байт.  
  
 *пкбпасаут*  
 Проверки Общее число байтов (за исключением байта с завершающим нулем), возвращаемых в *лпсзпас*. Если число возвращаемых байт больше или равно *кбпасмакс*, путь в *лпсзпас* усекается до *кбпасмакс* минус символ завершения null. Аргумент *пкбпасаут* может быть пустым указателем.  
  
## <a name="returns"></a>Возвращаемое значение  
 Функция возвращает TRUE, если она успешна, и FALSE в случае сбоя.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склинсталлдриверманажер** возвращает значение false, связанное значение *\* пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения *\* пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_INVALID_BUFF_LEN|Недопустимая длина буфера|Аргумент *лпсзпас* недостаточно велик для размещения пути вывода. Буфер содержит усеченный путь.<br /><br /> Аргумент *кбпасмакс* меньше _MAX_PATH.|  
|ODBC_ERROR_USAGE_UPDATE_FAILED|Не удалось увеличить или уменьшить счетчик использования компонентов|Установщику не удалось увеличить число использований компонента ODBC Core.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщику не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 **Склинсталлдриверманажер** вызывается для возврата пути к компонентам ODBC Core и увеличения числа использований компонентов в системных сведениях. Если версия диспетчера драйверов уже существует, но счетчик использования компонентов для драйвера не существует, то новое значение счетчика использования компонентов устанавливается равным 2.  
  
 Программа установки приложения несет ответственность за физическое копирование основных файлов компонентов и на поддержание счетчиков использования файлов. Если основной файл компонента не был установлен ранее, программа установки приложения должна скопировать файл и создать счетчик использования файлов. Если файл был ранее установлен, программа установки увеличивает счетчик использования файлов.  
  
 Если более старая версия диспетчера драйверов была ранее установлена программой установки приложения, то необходимо удалить и заново установить основные компоненты, чтобы счетчик использования основных компонентов был допустимым. Сначала необходимо вызвать **склремоведриверманажер** , чтобы уменьшить число использований компонента. Чтобы увеличить число использований компонента, необходимо вызвать **склинсталлдриверманажер** . Программа установки приложения должна заменить старые файлы основных компонентов новыми файлами. Счетчики использования файлов останутся прежними, а другие приложения, в которых используются более старые версии файлов компонентов, теперь будут использовать более новые версии файлов.  
  
 В новой установке основных компонентов, драйверов и переводчиков ODBC программа установки приложения должна вызывать следующие функции последовательно: **склинсталлдриверманажер**, **склинсталлдриверекс**, **склконфигдривер** ( *Фрекуест* of ODBC_INSTALL_DRIVER), а затем **склинсталлтранслаторекс**. При удалении основных компонентов, драйверов и переводчиков программа установки приложения должна последовательно вызывать следующие функции: **склремоветранслатор**, **склремоведривер**, а затем **склремоведриверманажер**. Эти функции должны вызываться в этой последовательности. При обновлении всех компонентов все функции удаления должны вызываться последовательно, а затем последовательно вызываться все функции установки.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Добавление, изменение или удаление драйвера|[склконфигдривер](../../../odbc/reference/syntax/sqlconfigdriver-function.md)|  
|Установка драйвера|[склинсталлдриверекс](../../../odbc/reference/syntax/sqlinstalldriverex-function.md)|  
|Установка транслятора|[склинсталлтранслаторекс](../../../odbc/reference/syntax/sqlinstalltranslatorex-function.md)|  
|Удаление драйвера|[склремоведривер](../../../odbc/reference/syntax/sqlremovedriver-function.md)|  
|Удаление диспетчера драйверов|[склремоведриверманажер](../../../odbc/reference/syntax/sqlremovedrivermanager-function.md)|  
|Удаление транслятора|[склремоветранслатор](../../../odbc/reference/syntax/sqlremovetranslator-function.md)|
