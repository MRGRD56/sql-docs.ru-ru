---
description: Функция SQLGetDescRec
title: Функция SQLGetDescRec | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
apiname:
- SQLGetDescRec
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLGetDescRec
helpviewer_keywords:
- SQLGetDescRec function [ODBC]
ms.assetid: 325e0907-8e87-44e8-a111-f39e636a9cbc
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a340ecc75e7ae4f03c44051f594fda7305a2a00f
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99205639"
---
# <a name="sqlgetdescrec-function"></a>Функция SQLGetDescRec
**Соответствия**  
 Представленная версия: соответствие стандартам ODBC 3,0: ISO 92  
  
 **Сводка**  
 **SQLGetDescRec** возвращает текущие параметры или значения нескольких полей записи дескриптора. Возвращаемые поля описывают имя, тип данных и хранение данных столбца или параметра.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLGetDescRec(  
      SQLHDESC        DescriptorHandle,  
      SQLSMALLINT     RecNumber,  
      SQLCHAR *       Name,  
      SQLSMALLINT     BufferLength,  
      SQLSMALLINT *   StringLengthPtr,  
      SQLSMALLINT *   TypePtr,  
      SQLSMALLINT *   SubTypePtr,  
      SQLLEN *        LengthPtr,  
      SQLSMALLINT *   PrecisionPtr,  
      SQLSMALLINT *   ScalePtr,  
      SQLSMALLINT *   NullablePtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *DescriptorHandle*  
 Входной Дескриптор дескриптора.  
  
 *RecNumber*  
 Входной Указывает запись дескриптора, из которой приложение ищет сведения. Записи дескрипторов нумеруются с 1, а номер записи 0 является записью закладки. Аргумент *рекнумбер* должен быть меньше или равен значению SQL_DESC_COUNT. Если *рекнумбер* меньше или равен SQL_DESC_COUNT но строка не содержит данных для столбца или параметра, вызов **SQLGetDescRec** будет возвращать значения по умолчанию для полей. (Дополнительные сведения см. в разделе "Инициализация полей дескриптора" в [SQLSetDescField](../../../odbc/reference/syntax/sqlsetdescfield-function.md).)  
  
 *Имя*  
 Проверки Указатель на буфер, в который возвращается поле SQL_DESC_NAME для записи дескриптора.  
  
 Если *Name* имеет значение null, *стрингленгсптр* будет возвращать общее количество символов (исключая символ завершения null для символьных данных), доступных для возврата в буфер, на который указывает *имя*.  
  
 *BufferLength*  
 Входной Длина буфера *имени* * в символах.  
  
 *стрингленгсптр*  
 Проверки Указатель на буфер, в котором возвращается количество символов данных, доступных для возврата в \* буфер *имен* , за исключением символа завершения null. Если число символов больше или равно *BufferLength*, то данные в \* *имени* усекаются до *BufferLength* , а длина завершающего символа заканчивается символом NULL и завершается драйвером.  
  
 *типептр*  
 Проверки Указатель на буфер, в котором возвращается значение поля SQL_DESC_TYPE для записи дескриптора.  
  
 *субтипептр*  
 Проверки Для записей, тип которых — SQL_DATETIME или SQL_INTERVAL, это указатель на буфер, в котором возвращается значение поля SQL_DESC_DATETIME_INTERVAL_CODE.  
  
 *ленгсптр*  
 Проверки Указатель на буфер, в котором возвращается значение поля SQL_DESC_OCTET_LENGTH для записи дескриптора.  
  
 *преЦисионптр*  
 Проверки Указатель на буфер, в котором возвращается значение поля SQL_DESC_PRECISION для записи дескриптора.  
  
 *скалептр*  
 Проверки Указатель на буфер, в котором возвращается значение поля SQL_DESC_SCALE для записи дескриптора.  
  
 *нуллаблептр*  
 Проверки Указатель на буфер, в котором возвращается значение поля SQL_DESC_NULLABLE для записи дескриптора.  
  
## <a name="returns"></a>Возвращаемое значение  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_NO_DATA или SQL_INVALID_HANDLE.  
  
 SQL_NO_DATA возвращается, если *рекнумбер* больше, чем текущее число записей дескрипторов.  
  
 SQL_NO_DATA возвращается, если *дескрипторхандле* является обработчиком IRD, а инструкция находится в состоянии Prepared или Executed, но с ним не связано ни одного открытого курсора.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLGetDescRec** возвращает SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное значение SQLSTATE может быть получено путем вызова **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_DESC и *маркером* *дескрипторхандле*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые функцией **SQLGetDescRec** , и объясняется каждый из них в контексте этой функции. Нотация "(DM)" предшествует описаниям SQLSTATE, возвращаемым диспетчером драйверов. Код возврата, связанный с каждым значением SQLSTATE, имеет SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение для конкретного драйвера. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, усеченные справа|\* *Имя* буфера недостаточно велико для возврата всего поля дескриптора. Поэтому поле было усечено. Длина неусеченного поля дескриптора возвращается в **стрингленгсптр*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|07009|Недопустимый индекс дескриптора|Аргумент *фиелдидентифиер* был полем записи, аргумент *рекнумбер* был установлен в 0, а аргумент *дескрипторхандле* был обработчиком IPD.<br /><br /> (DM) аргумент *рекнумбер* был установлен в 0, а атрибуту инструкции SQL_ATTR_USE_BOOKMARKS было присвоено значение SQL_UB_OFF, а аргумент *дескрипторхандле* был IRD.<br /><br /> Аргумент *рекнумбер* меньше 0.|  
|08S01|Сбой канала связи|Канал связи между драйвером и источником данных, к которому был подключен драйвер, был неудачен до завершения обработки функции.|  
|HY000|Общая ошибка|Произошла ошибка, для которой нет определенного SQLSTATE и для которого не определен SQLSTATE для конкретной реализации. Сообщение об ошибке, возвращаемое функцией **SQLGetDiagRec** в буфере *\* MessageText* , описывает ошибку и ее причину.|  
|HY001|Ошибка выделения памяти|Драйверу не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY007|Связанная инструкция не подготовлена|*Дескрипторхандле* был связан с IRD, а соответствующий маркер инструкции не находится в состоянии "подготовлено" или "выполнено".|  
|HY010|Ошибка последовательности функций|(DM) *дескрипторхандле* был связан с *статеменсандле* , для которого была вызвана асинхронно исполняемая функция (а не эта одна), и она все еще выполнялась при вызове этой функции.<br /><br /> (DM) *дескрипторхандле* был связан с *статеменсандле* , для которого были вызваны **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations** или **SQLSetPos** и возвращены SQL_NEED_DATA. Эта функция была вызвана перед отправкой данных для всех параметров или столбцов данных, выполняемых во время выполнения.<br /><br /> (DM) вызвана асинхронно исполняемая функция для маркера соединения, связанного с *дескрипторхандле*. Эта асинхронная функция все еще выполнялась при вызове **SQLGetDescRec** .|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как не удалось получить доступ к базовым объектам памяти, возможно, из-за нехватки памяти.|  
|HY117|Подключение приостановлено из-за неизвестного состояния транзакции. Допускаются только функции отключения и только для чтения.|(DM) Дополнительные сведения о состоянии SUSPENDED см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания подключения истекло|Время ожидания соединения истекло до ответа источника данных на запрос. Время ожидания соединения задается через **SQLSetConnectAttr**, SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) драйвер, связанный с *дескрипторхандле* , не поддерживает функцию.|  
  
## <a name="comments"></a>Комментарии  
 Приложение может вызвать **SQLGetDescRec** для получения значений следующих полей дескриптора для одного столбца или параметра:  
  
-   SQL_DESC_NAME  
  
-   SQL_DESC_TYPE  
  
-   SQL_DESC_DATETIME_INTERVAL_CODE (для записей, тип которых — SQL_DATETIME или SQL_INTERVAL)  
  
-   SQL_DESC_OCTET_LENGTH  
  
-   SQL_DESC_PRECISION  
  
-   SQL_DESC_SCALE  
  
-   SQL_DESC_NULLABLE  
  
 **SQLGetDescRec** не извлекает значения для полей заголовка.  
  
 Приложение может препятствовать возврату значения поля путем установки аргумента, соответствующего полю, в указатель null.  
  
 Когда приложение вызывает **SQLGetDescRec** для получения значения поля, которое не определено для конкретного типа дескриптора, функция возвращает SQL_SUCCESS, но значение, возвращаемое для поля, не определено. Например, вызов **SQLGetDescRec** для SQL_DESC_NAME или SQL_DESC_NULLABLE поля APD или ард возвратит SQL_SUCCESS, но неопределенное значение для поля.  
  
 Когда приложение вызывает **SQLGetDescRec** для получения значения поля, определенного для конкретного типа дескриптора, но не имеющего значения по умолчанию и еще не установленного, функция возвращает SQL_SUCCESS, но значение, возвращаемое для поля, не определено. Дополнительные сведения см. в разделе "Инициализация полей дескриптора" в [SQLSetDescField](../../../odbc/reference/syntax/sqlsetdescfield-function.md).  
  
 Значения полей также можно получить по отдельности путем вызова **SQLGetDescField**. Описание полей в заголовке или записи дескриптора см. в разделе [SQLSetDescField](../../../odbc/reference/syntax/sqlsetdescfield-function.md). Дополнительные сведения о дескрипторах см. в разделе [дескрипторы](../../../odbc/reference/develop-app/descriptors.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка столбца|[SQLBindCol, функция](../../../odbc/reference/syntax/sqlbindcol-function.md)|  
|Привязка параметра|[Функция SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md)|  
|Получение поля дескриптора|[Функция SQLGetDescField](../../../odbc/reference/syntax/sqlgetdescfield-function.md)|  
|Установка нескольких полей дескриптора|[Функция SQLSetDescRec](../../../odbc/reference/syntax/sqlsetdescrec-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
