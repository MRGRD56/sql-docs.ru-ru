---
description: Функция SQLGetTranslator
title: Функция Склжеттранслатор | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
apiname:
- SQLGetTranslator
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLGetTranslator
helpviewer_keywords:
- SQLGetTranslator function [ODBC]
ms.assetid: 33879db3-5ef9-4585-9be5-69376157e017
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 5ec960312c652c625a6fb27388bd9c21a09f3206
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99189726"
---
# <a name="sqlgettranslator-function"></a>Функция SQLGetTranslator
**Соответствия**  
 Введенная версия: ODBC 2,0  
  
 **Сводка**  
 **Склжеттранслатор** отображает диалоговое окно, из которого пользователь может выбрать транслятор.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLGetTranslator(  
     HWND      hwndParent,  
     LPSTR     lpszName,  
     WORD      cbNameMax,  
     WORD *    pcbNameOut,  
     LPSTR     lpszPath,  
     WORD      cbPathMax,  
     WORD *    pcbPathOut,  
     DWORD *   pvOption);  
```  
  
## <a name="arguments"></a>Аргументы  
 *хвндпарент*  
 Входной Маркер родительского окна.  
  
 *лпсзнаме*  
 [Входные и выходные данные] Имя транслятора из сведений о системе.  
  
 *кбнамемакс*  
 Входной Максимальная длина буфера *лпсзнаме* .  
  
 *пкбнамеаут*  
 [Входные и выходные данные] Общее число байтов (за исключением байта завершения null), переданных или возвращенных в *лпсзнаме*. Если число возвращаемых байт больше или равно *кбнамемакс*, имя переводчика в *лпсзнаме* усекается до *кбнамемакс* минус символ завершения null. Аргумент *пкбнамеаут* может быть пустым указателем.  
  
 *лпсзпас*  
 Проверки Полный путь к библиотеке DLL преобразования.  
  
 *кбпасмакс*  
 Входной Максимальная длина буфера *лпсзпас* .  
  
 *пкбпасаут*  
 Проверки Общее число байтов (за исключением байта с завершающим нулем), возвращаемых в *лпсзпас*. Если число возвращаемых байт больше или равно значению *кбпасмакс*, путь к DLL-библиотеке преобразования в *лпсзпас* усекается до *кбпасмакс* минус символ завершения null. Аргумент *пкбпасаут* может быть пустым указателем.  
  
 *пвоптион*  
 [Output] 32-разрядный параметр преобразования.  
  
## <a name="returns"></a>Возвращаемое значение  
 Функция возвращает TRUE, если она выполнена успешно, значение FALSE, если происходит сбой или пользователь отменяет диалоговое окно.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **склжеттранслатор** возвращает значение false, связанное значение *\* пферроркоде* может быть получено путем вызова **склинсталлереррор**. В следующей таблице перечислены значения *\* пферроркоде* , которые могут быть возвращены **склинсталлереррор** , и объясняется каждый из них в контексте этой функции.  
  
|*\*пферроркоде*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установщика|Произошла ошибка, для которой не возникала конкретная ошибка установщика.|  
|ODBC_ERROR_INVALID_BUFF_LEN|Недопустимая длина буфера|Аргумент *кбнамемакс* или *кбпасмакс* меньше или равен 0.|  
|ODBC_ERROR_INVALID_HWND|Недопустимый маркер окна|Аргумент *хвндпарент* недопустим или имеет значение null.|  
|ODBC_ERROR_INVALID_NAME|Недопустимое имя драйвера или транслятора|Недопустимый аргумент *лпсзнаме* . Не удалось найти его в реестре.|  
|ODBC_ERROR_LOAD_LIBRARY_FAILED|Не удалось загрузить драйвер или библиотеку установки переводчика|Не удалось загрузить библиотеку переводчиков.|  
|ODBC_ERROR_INVALID_OPTION|Недопустимый параметр транзакции|Аргумент *пвоптион* содержал недопустимое значение.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщику не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 Если *хвндпарент* имеет значение null или *лпсзнаме*, *лпсзпас* или *пвоптион* является пустым указателем, **склжеттранслатор** возвращает значение false. В противном случае отобразится список установленных переводчиков в следующем диалоговом окне.  
  
 ![Диалоговое окно выбора переводчика](../../../odbc/reference/syntax/media/ch23j.gif "CH23J")  
  
 Если *лпсзнаме* содержит допустимое имя транслятора, оно будет выбрано. В противном случае \<No Translator> выбирается.  
  
 Если пользователь выбрал \<No Translator> , содержимое *лпсзнаме*, *лпсзпас* и *пвоптион* не будет затронуты. **Склжеттранслатор** устанавливает значение *пкбнамеаут* и *пкбпасаут* в 0 и возвращает true.  
  
 Если пользователь выбирает транслятор, **склжеттранслатор** вызывает **конфигтранслатор** в библиотеке DLL установки транслятора. Если **конфигтранслатор** возвращает значение false, **склжеттранслатор** возвращается в соответствующее диалоговое окно. Если **конфигтранслатор** возвращает true, **склжеттранслатор** возвращает значение true вместе с выбранным именем транслятора, путем и параметром перевода.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Настройка транслятора|[конфигтранслатор](../../../odbc/reference/syntax/configtranslator-function.md)|  
|Получение атрибута перевода|[SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
|Задание атрибута перевода|[SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)|
