---
description: ALTER TABLE (команда SQL)
title: ALTER TABLE-команда SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- alter table [ODBC]
ms.assetid: 3a01a291-f4d9-43bc-a725-5a95546ff364
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 186647c40517c5ecf77a55e6bbc08155c98ffed9
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99205758"
---
# <a name="alter-table---sql-command"></a>ALTER TABLE (команда SQL)
Программно изменяет структуру таблицы.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
ALTER TABLE TableName1  
   ADD | ALTER [COLUMN] FieldName1  
      FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]  
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
 - Or -  
ALTER TABLE TableName1  
   ALTER [COLUMN] FieldName2  
      [NULL | NOT NULL]  
      [SET DEFAULT eExpression2]  
      [SET CHECK lExpression2 [ERROR cMessageText2]]  
      [DROP DEFAULT]  
      [DROP CHECK]  
 - Or -  
ALTER TABLE TableName1  
   [DROP [COLUMN] FieldName3]  
   [SET CHECK lExpression3 [ERROR cMessageText3]]  
   [DROP CHECK]  
   [ADD PRIMARY KEY eExpression3 TAG TagName2]  
   [DROP PRIMARY KEY]  
   [ADD UNIQUE eExpression4 [TAG TagName3]]  
   [DROP UNIQUE TAG TagName4]  
   [ADD FOREIGN KEY [eExpression5] TAG TagName4  
      REFERENCES TableName2 [TAG TagName5]]  
   [DROP FOREIGN KEY TAG TagName6 [SAVE]]  
   [RENAME COLUMN FieldName4 TO FieldName5]  
   [NOVALIDATE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *TableName1*  
 Указывает имя таблицы, структура которой изменяется.  
  
 Добавить [столбец] *FieldName1*  
 Указывает имя добавляемого поля.  
  
 ALTER [COLUMN] *FieldName1*  
 Указывает имя существующего поля для изменения.  
  
 *FieldType* [( *Нфиелдвидс* [, *нпреЦисион*]])  
 Задает тип поля, ширину поля и точность поля (число десятичных разрядов) для нового или измененного поля.  
  
 *FieldType* — это одна буква, указывающая [тип данных](../../odbc/microsoft/visual-foxpro-field-data-types.md)поля. Для некоторых типов данных полей требуется указать *нфиелдвидс* или *нпреЦисион* .  
  
 *нфиелдвидс* и *нпреЦисион* игнорируются для типов D, G, I, L, M, P, T и Y. По умолчанию *нпреЦисион* равен нулю (без десятичных разрядов), если *нпреЦисион* не включен для типов B, F или N.  
  
 NULL &#124; NOT NULL  
 Разрешает или предотвращает значения NULL в поле.  
  
 Если опустить NULL и NOT NULL, текущее значение параметра SET NULL определяет, разрешены ли в поле значения NULL. Однако если опустить NULL и NOT NULL и включить ключевое слово PRIMARY или UNIQUE, текущее значение параметра SET NULL игнорируется, а по умолчанию поле не имеет значение NULL.  
  
 Проверка *lExpression1*  
 Задает правило проверки для поля. *lExpression1* должен оцениваться как логическое выражение и может быть определяемой пользователем функцией или хранимой процедурой. При добавлении пустой записи проверяется правило проверки. Если правило проверки не допускает значения пустого поля в присоединенной записи, возникает ошибка.  
  
 Ошибка *cMessageText1*  
 Указывает сообщение об ошибке, отображаемое при возникновении ошибки в правиле проверки поля.  
  
 *EExpression1* по умолчанию  
 Задает значение по умолчанию для поля. Тип данных *eExpression1* должен совпадать с типом данных для поля.  
  
 PRIMARY KEY  
 Создает первичный тег индекса. Имя тега индекса совпадает с именем поля.  
  
 UNIQUE  
 Создает тег индекса-кандидата с тем же именем, что и поле.  
  
> [!NOTE]  
>  Индексы кандидатов (созданные путем включения параметра UNIQUE, предоставленные для совместимости с ANSI в инструкции ALTER TABLE или CREATE TABLE) отличаются от индексов, созданных с помощью параметра UNIQUE в команде INDEX. Индекс, созданный с помощью функции UNIQUE в команде INDEX, позволяет использовать повторяющиеся ключи индекса. индексы кандидатов не допускают дублирования ключей индекса.  
  
 Значения NULL и дублирующиеся записи не допускаются в поле, используемом для первичного или индекса-кандидата.  
  
 Если вы создаете новое поле с помощью команды Добавить столбец, Visual FoxPro не выдаст ошибку, если вы создадите первичный или потенциальный индекс для поля, которое поддерживает значения NULL. Однако Visual FoxPro выдаст ошибку при попытке ввести нулевое или повторяющееся значение в поле, используемое для первичного или индекса-кандидата.  
  
 Если вы изменяете существующее поле, а первичное или ключевое выражение индекса-кандидата состоит из полей в таблице, Visual FoxPro проверяет поля на наличие значений NULL или повторяющихся записей. В противном случае Visual FoxPro выдает ошибку, а таблица не изменяется.  
  
 ССЫЛАЕТСЯ на тег *TableName2* *TagName1*  
 Указывает родительскую таблицу, для которой устанавливается постоянная связь. TAG *TagName1* указывает тег индекса родительской таблицы, на котором основана связь. Имена тегов индекса могут содержать до 10 символов.  
  
 нокптранс  
 Предотвращает перевод на другую кодовую страницу для полей со знаками и полями MEMO. Если таблица преобразуется в другую кодовую страницу, поля, для которых была указана НОКПТРАНС, не переводятся. НОКПТРАНС можно указать только для полей символов и MEMO.  
  
 В следующем примере создается таблица с именем MyTable, которая содержит два поля символов и два поля MEMO. Второе поле символа, char2 и второе поле MEMO, memo2, включают НОКПТРАНС для предотвращения перевода.  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 ALTER [COLUMN] *FieldName2*  
 Указывает имя существующего поля для изменения.  
  
 ЗАДАТЬ *eExpression2* по умолчанию  
 Задает новое значение по умолчанию для существующего поля. Тип данных *eExpression2* должен совпадать с типом данных для поля.  
  
 SET CHECK *lExpression2*  
 Указывает новое правило проверки для существующего поля. *lExpression2* должен оцениваться как логическое выражение и может быть определяемой пользователем функцией или хранимой процедурой.  
  
 Ошибка *cMessageText2*  
 Указывает сообщение об ошибке, отображаемое при возникновении ошибки в правиле проверки поля. Сообщение отображается только в том случае, если данные изменяются в окне просмотра или редактирования.  
  
 DROP DEFAULT  
 Удаляет значение по умолчанию для существующего поля.  
  
 УДАЛИТЬ ПРОВЕРКУ  
 Удаляет правило проверки для существующего поля.  
  
 DROP [столбец] *FieldName3*  
 Указывает поле, удаляемое из таблицы. При удалении поля из таблицы также удаляется значение поля по умолчанию и правило проверки поля.  
  
 Если выражение ключа индекса или триггера ссылается на поле, выражения становятся недействительными при удалении поля. В этом случае ошибка не создается при удалении поля, но недопустимые ключи индекса или выражения триггера будут формировать ошибки во время выполнения.  
  
 SET CHECK *lExpression3*  
 Задает правило проверки таблицы. *lExpression3* должен оцениваться как логическое выражение и может быть определяемой пользователем функцией или хранимой процедурой.  
  
 Ошибка *cMessageText3*  
 Указывает сообщение об ошибке, отображаемое при возникновении ошибки в правиле проверки таблицы. Сообщение отображается только в том случае, если данные изменяются в окне просмотра или редактирования.  
  
 УДАЛИТЬ ПРОВЕРКУ  
 Удаляет правило проверки таблицы.  
  
 Добавьте тег *EEXPRESSION3* первичного ключа *TagName2*  
 Добавляет первичный индекс в таблицу. *eExpression3* указывает ключевое выражение первичного индекса, а *TagName2* указывает имя первичного тега индекса. Имена тегов индекса могут содержать до 10 символов. Если тег *TagName2* опущен и *eExpression3* является одним полем, то имя тега первичного индекса совпадает с именем поля, указанного в *eExpression3*.  
  
 УДАЛИТЬ ПЕРВИЧНЫЙ КЛЮЧ  
 Удаляет первичный индекс и его тег индекса. Поскольку таблица может иметь только один первичный ключ, указывать имя первичного ключа не обязательно. При удалении первичного индекса также удаляются все постоянные связи, основанные на первичном ключе.  
  
 Добавление УНИКАЛЬного *eExpression4*[Tag *TagName3*]  
 Добавляет в таблицу индекс-кандидат. *eExpression4* указывает ключевое выражение индекса кандидата, а *TagName3* указывает имя тега индекса-кандидата. Имена тегов индекса могут содержать до 10 символов. Если опустить тег *TagName3* и если *eExpression4* является одним полем, то тег индекса-кандидата будет иметь то же имя, что и поле, указанное в *eExpression4*.  
  
 УДАЛИТЬ уникальный тег *TagName4*  
 Удаляет индекс-кандидат и его тег индекса. Так как таблица может иметь несколько потенциальных ключей, необходимо указать имя тега индекса-кандидата.  
  
 ДОБАВИТЬ внешний ключ [ *eExpression5*] тег *TagName4*  
 Добавляет в таблицу внешний (непервичный) индекс. *eExpression5* указывает ключевое выражение для внешнего индекса, а *TagName4* указывает имя тега внешнего индекса. Имена тегов индекса могут содержать до 10 символов.  
  
 ССЫЛКИ на *TableName2*[Tag *TagName5*]  
 Указывает родительскую таблицу, для которой устанавливается постоянная связь. Включите тег *TagName5* , чтобы установить связь на основе существующего тега индекса для родительской таблицы. Имена тегов индекса могут содержать до 10 символов. Если опустить тег *TagName5*, связь устанавливается с использованием первичного тега индекса родительской таблицы.  
  
 УДАЛИТЬ тег внешнего ключа *TagName6*[Save]  
 Удаляет внешний ключ, тег индекса которого — *TagName6*. Если параметр SAVE не задан, тег индекса удаляется из структурного индекса. Включить SAVE, чтобы запретить удаление тега индекса из структурного индекса.  
  
 Переименование СТОЛБЦА *FieldName4* в *FieldName5*  
 Позволяет изменить имя поля в таблице. *FieldName4* указывает имя поля, которое переименовывается. *FieldName5* указывает новое имя поля.  
  
> [!CAUTION]  
>  Будьте осторожны при переименовании полей таблицы, так как выражения индекса, правила проверки полей и таблиц, команды и функции могут ссылаться на имена исходных полей.  
  
 Не проверять  
 Указывает, что Visual FoxPro позволяет вносить изменения в структуру таблицы; Эти изменения могут нарушать целостность данных в таблице. По умолчанию Visual FoxPro не позволяет ALTER TABLE вносить изменения, нарушающие целостность данных в таблице. Включите "unvalidate", чтобы переопределить это поведение по умолчанию.  
  
## <a name="remarks"></a>Замечания  
 Инструкцию ALTER TABLE можно использовать для изменения структуры таблицы, которая не была добавлена в базу данных. Однако Visual FoxPro выдает ошибку, если при изменении свободной таблицы в нее включаются предложения DEFAULT, FOREIGN KEY, PRIMARY KEY, REFERENCEs или SET.  
  
 Инструкция ALTER TABLE может перестроить таблицу путем создания нового заголовка таблицы и добавления записей к заголовку таблицы. Например, изменение типа или ширины поля может привести к перестроению таблицы.  
  
 После перестроения таблицы правила проверки полей выполняются для всех полей, тип или ширина которых изменяется. При изменении типа или ширины любого поля в таблице выполняется правило таблицы.  
  
 При изменении правил проверки полей или таблиц для таблицы, которая содержит записи, Visual FoxPro проверяет новые правила проверки полей или таблицы на соответствие существующим данным и выдает предупреждение при первом возникновении правила проверки поля или таблицы или нарушения триггера.  
  
 Если изменяемая таблица находится в базе данных, то инструкция ALTER TABLE-SQL требует эксклюзивного использования базы данных. Чтобы открыть базу данных для монопольного использования, включите ЭКСКЛЮЗИВное использование в открытой базе данных.  
  
## <a name="see-also"></a>См. также:  
 [Команда CREATE TABLE-SQL](../../odbc/microsoft/create-table-sql-command.md)   
 [Команда INDEX](../../odbc/microsoft/index-command.md)
