---
description: CREATE TABLE (команда SQL)
title: Команда CREATE TABLE-SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- CREATE TABLE [ODBC]
ms.assetid: be2143ba-fc16-42c9-84f7-8985cd924860
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 0fb1e91c03f7a1a1fee98ce887be991370450999
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99183200"
---
# <a name="create-table---sql-command"></a>CREATE TABLE (команда SQL)
Создает таблицу с указанными полями.  
  
 Драйвер ODBC для Visual FoxPro поддерживает для этой команды собственный синтаксис языка Visual FoxPro. Сведения, относящиеся к драйверу, см. в разделе **Примечания к драйверам**.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
CREATE TABLE | DBF TableName1 [NAME LongTableName] [FREE]  
   (FieldName1FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]   
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
   [, FieldName2 ...]  
      [, PRIMARY KEY eExpression2 TAG TagName2  
      |, UNIQUE eExpression3 TAG TagName3]  
      [, FOREIGN KEY eExpression4 TAG TagName4 [NODUP]  
            REFERENCES TableName3 [TAG TagName5]]  
      [, CHECK lExpression2 [ERROR cMessageText2]])  
| FROM ARRAY ArrayName  
```  
  
## <a name="arguments"></a>Аргументы  
 CREATE TABLE &#124; DBF *TableName1*  
 Указывает имя создаваемой таблицы. Параметры TABLE и DBF идентичны.  
  
 ИМЯ *лонгтабленаме*  
 Задает длинное имя для таблицы. Длинное имя таблицы может быть указано только в том случае, если база данных открыта, так как длинные имена таблиц хранятся в базах данных.  
  
 Длинные имена могут содержать до 128 символов и могут использоваться вместо коротких имен файлов в базе данных.  
  
 FREE  
 Указывает, что таблица не будет добавлена в открытую базу данных. FREE не требуется, если база данных не открыта.  
  
 *(FieldName1 FieldType* [( *Нфиелдвидс* [, *нпреЦисион*])]  
 Указывает имя поля, тип поля, ширину поля и точность поля (число десятичных разрядов) соответственно.  
  
 *FieldType* — это одна буква, указывающая [тип данных](../../odbc/microsoft/visual-foxpro-field-data-types.md)поля. Для некоторых типов данных полей требуется указать *нфиелдвидс* или *нпреЦисион* .  
  
 *нфиелдвидс* и *нпреЦисион* игнорируются для типов D, G, I, L, M, P, T и Y. *нпреЦисион* по умолчанию равен нулю (без десятичных знаков), если *нпреЦисион* не включена для типов B, F или N.  
  
 NULL  
 Допускает значения NULL в поле.  
  
 NOT NULL  
 Предотвращает значения NULL в поле.  
  
 Если опустить NULL и NOT NULL, текущее значение параметра SET NULL определяет, разрешены ли в поле значения NULL. Однако если опустить значение NULL, а не NULL и включить ключевое слово PRIMARY или UNIQUE, текущее значение параметра SET NULL игнорируется, а в поле по умолчанию устанавливается значение NOT NULL.  
  
 Проверка *lExpression1*  
 Задает правило проверки для поля. *lExpression1* может быть определяемой пользователем функцией. При добавлении пустой записи проверяется правило проверки. Если правило проверки не допускает значения пустого поля в присоединенной записи, возникает ошибка.  
  
 Ошибка *cMessageText1*  
 Указывает сообщение об ошибке Visual FoxPro, отображаемое, когда правило поля создает ошибку. Сообщение отображается только в том случае, если данные изменяются в окне «Обзор» или в окне редактирования.  
  
 *EExpression1* по умолчанию  
 Задает значение по умолчанию для поля. Тип данных *eExpression1* должен совпадать с типом данных поля.  
  
 PRIMARY KEY  
 Создает первичный индекс для поля. Первичный тег индекса имеет то же имя, что и поле.  
  
 UNIQUE  
 Создает индекс кандидата для поля. Имя тега индекса-кандидата совпадает с именем поля.  
  
> [!NOTE]  
>  Индексы кандидатов (созданные путем включения УНИКАЛЬного параметра в CREATE TABLE или ALTER TABLE-SQL) не совпадают с индексами, созданными с помощью параметра UNIQUE в команде INDEX. Индекс, созданный с помощью параметра UNIQUE в команде INDEX, допускает наличие повторяющихся ключей индекса. индексы кандидатов не допускают дублирования ключей индекса. Дополнительные сведения о параметре UNIQUE см. в разделе [index](../../odbc/microsoft/index-command.md) .  
  
 Значения NULL и дублирующиеся записи не допускаются в поле, используемом для первичного или индекса-кандидата. Однако Visual FoxPro не выдаст ошибку, если вы создадите первичный или потенциальный индекс для поля, которое поддерживает значения NULL. Visual FoxPro выдаст ошибку, если вы попытаетесь ввести значение null или повторяющееся в поле, используемое для первичного или индекса-кандидата.  
  
 ССЫЛКИ на *TableName2*[Tag *TagName1*]  
 Указывает родительскую таблицу, для которой устанавливается постоянная связь. Если опустить тег *TagName1*, связь устанавливается с использованием первичного ключа индекса родительской таблицы. Если у родительской таблицы нет первичного индекса, Visual FoxPro выдает ошибку.  
  
 Включите тег *TagName1* , чтобы установить связь на основе существующего тега индекса для родительской таблицы. Имена тегов индекса могут содержать до 10 символов.  
  
 Родительская таблица не может быть свободной таблицей.  
  
 нокптранс  
 Предотвращает перевод на другую кодовую страницу для полей со знаками и полями MEMO. Если таблица преобразуется в другую кодовую страницу, поля, для которых была указана НОКПТРАНС, не переводятся. НОКПТРАНС можно указать только для полей символов и MEMO.  
  
 В следующем примере создается таблица с именем MyTable, содержащая два поля символов и два поля MEMO. Второе поле символа, char2 и второе поле MEMO, memo2, включают НОКПТРАНС для предотвращения перевода.  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 Тег *EEXPRESSION2* первичного ключа *TagName2*  
 Указывает первичный индекс для создания. *eExpression2* указывает любое поле или сочетание полей в таблице. TAG *TagName2* указывает имя создаваемого тега первичного индекса. Имена тегов индекса могут содержать до 10 символов.  
  
 Поскольку у таблицы может быть только один первичный индекс, это предложение нельзя включить, если первичный индекс для поля уже создан. Visual FoxPro выдает ошибку, если в CREATE TABLE включается более одного предложения ПЕРВИЧного ключа.  
  
 УНИКАЛЬНЫЙ тег eExpression3 *TagName3*  
 Создает индекс кандидата. *eExpression3* указывает любое поле или сочетание полей в таблице. Однако если вы создали первичный индекс с одним из параметров ПЕРВИЧного ключа, то не можете включить поле, указанное для первичного индекса. TAG *TagName3* указывает имя тега для создаваемого тега индекса-кандидата. Имена тегов индекса могут содержать до 10 символов.  
  
 Таблица может иметь несколько потенциальных индексов.  
  
 ВНЕШНИЙ ключ *eExpression4* тег *TagName4*[нодуп]  
 Создает внешний (неосновной) индекс и устанавливает связь с родительской таблицей. *eExpression4* указывает ключевое выражение для внешнего индекса, а *TagName4* указывает имя создаваемого тега ключа внешнего индекса. Имена тегов индекса могут содержать до 10 символов. Включите НОДУП, чтобы создать потенциальный внешний индекс.  
  
 Можно создать несколько внешних индексов для таблицы, но выражения внешнего индекса должны указывать различные поля в таблице.  
  
 ССЫЛКИ на *TableName3*[Tag *TagName5*]  
 Указывает родительскую таблицу, для которой устанавливается постоянная связь. Включите тег *TagName5* , чтобы установить связь на основе тега индекса для родительской таблицы. Имена тегов индекса могут содержать до 10 символов. По умолчанию, если опустить тег *TagName5,* связь устанавливается с использованием первичного ключа индекса родительской таблицы.  
  
 CHECK *eExpression2*[Ошибка *cMessageText2*]  
 Задает правило проверки таблицы. ERROR *cMessageText2* указывает сообщение об ошибке Visual FoxPro, отображаемое при выполнении правила проверки таблицы. Сообщение отображается только в том случае, если данные изменяются в окне «Обзор» или в окне редактирования.  
  
 ИЗ массива *ArrayName*  
 Задает имя существующего массива, содержимое которого имеет имя, тип, точность и масштаб для каждого поля в таблице. Содержимое массива может быть определено с помощью функции **афиелдс**().  
  
## <a name="remarks"></a>Замечания  
 Новая таблица открывается в самой нижней доступной рабочей области и доступна по ее псевдониму. Новая таблица открывается исключительно независимо от текущего значения параметра SET EXCLUSIVE.  
  
 Если база данных открыта и предложение FREE не включено, Новая таблица добавляется в базу данных. Нельзя создать новую таблицу с тем же именем, что и таблица в базе данных.  
  
 Если база данных открыта, CREATE TABLE-SQL требует эксклюзивного использования базы данных. Чтобы открыть базу данных для монопольного использования, включите ЭКСКЛЮЗИВное использование в открытой базе данных.  
  
 Если при создании новой таблицы база данных не открыта, включая предложения NAME, CHECK, DEFAULT, FOREIGN KEY, PRIMARY KEY и REFERENCEs, выдает ошибку.  
  
> [!NOTE]  
>  CREATE TABLE синтаксис использует запятые для разделения определенных параметров CREATE TABLE. Кроме того, в круглых скобках, содержащих определения столбцов, должны быть помещены значения NULL, NOT NULL, проверки, значения по умолчанию, ПЕРВИЧный ключ и уникальное выражение.  
  
## <a name="driver-remarks"></a>Примечания к драйверам  
 Когда приложение отправляет инструкцию SQL ODBC CREATE TABLE источнику данных, драйвер ODBC для Visual FoxPro преобразует команду в команду Visual Фокспрокреате TABLE, используя синтаксис, приведенный в следующей таблице.  
  
|Синтаксис ODBC|Синтаксис Visual FoxPro|  
|-----------------|--------------------------|  
|CREATE TABLE *имя базового имени таблицы*<br /><br /> (*тип данных «столбец-Идентификатор* »<br /><br /> [НЕ РАВНО NULL]<br /><br /> [,*столбец-Идентификатор типа данных*<br /><br /> [НЕ РАВНО NULL]...)|CREATE TABLE *TableName1* [имя *лонгтабленаме*]<br /><br /> (*FieldName1* *FieldType*<br /><br /> [(*нфиелдвидс* [, *нпреЦисион*])]<br /><br /> [НЕ РАВНО NULL])|  
  
 При создании таблицы с помощью драйвера Драйвер закрывает таблицу сразу после создания, чтобы разрешить доступ к ней другим пользователям. Это отличается от Visual FoxPro, в результате чего таблица остается открытой только при создании. Однако если хранимая процедура в источнике данных, содержащая инструкцию CREATE TABLE, выполняется, то таблица остается открытой.  
  
 Если источником данных является база данных (DBC-файл), драйвер ODBC для Visual FoxPro создает таблицу с именем *лонгтабленаме* с тем же именем, что и имя *базового-Table-name*.  
  
### <a name="using-data-definition-language-ddl"></a>Использование языка описания данных (DDL)  
 Нельзя включить DDL в следующие места:  
  
-   В инструкции пакетной службы SQL, для которой требуется транзакция  
  
-   В режиме фиксации вручную после инструкции, которая потребовала транзакцию, если только приложение не вызывает **SQLTransact**.  
  
 Например, если необходимо создать временную таблицу, то перед началом инструкции, требующей транзакции, следует создать таблицу. Если включить инструкцию CREATE TABLE в пакетную инструкцию SQL, для которой требуется транзакция, драйвер возвращает сообщение об ошибке.  
  
## <a name="see-also"></a>См. также:  
 [ALTER TABLE-команда SQL](../../odbc/microsoft/alter-table-sql-command.md)   
 [Поддерживаемые типы данных (драйвер ODBC для Visual FoxPro)](../../odbc/microsoft/supported-data-types-visual-foxpro-odbc-driver.md)   
 [Команда INSERT-SQL](../../odbc/microsoft/insert-sql-command.md)   
 [SELECT (команда SQL)](../../odbc/microsoft/select-sql-command.md)
