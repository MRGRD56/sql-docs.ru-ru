---
title: Запуск Database Experimentation Assistant из командной строки
description: Узнайте, как записать трассировку в Database Experimentation Assistant (ДЕА), а затем анализировать результаты из командной строки.
ms.custom: seo-lt-2019
ms.date: 02/25/2020
ms.prod: sql
ms.prod_service: dea
ms.suite: sql
ms.technology: dea
ms.tgt_pltfrm: ''
ms.topic: conceptual
author: pochiraju
ms.author: rajpo
ms.reviewer: mathoma
ms.openlocfilehash: 0e52cf31a94f2fd63f92305b80f7f7ae049c2809
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100066449"
---
# <a name="run-database-experimentation-assistant-at-a-command-prompt"></a>Запуск Database Experimentation Assistant из командной строки

В этой статье описывается, как записать трассировку в Database Experimentation Assistant (ДЕА), а затем анализировать результаты из командной строки.

   > [!NOTE]
   > Чтобы узнать больше о каждой операции Деа, попробуйте выполнить следующую команду:
   >
   > `Deacmd.exe -o <operation> --help`
   >
   > Требуется имя операции; допустимые операции: **Analysis**, **старткаптуре** и **стопкаптуре**.

## <a name="start-a-new-workload-capture-by-using-the-dea-command"></a>Запуск новой записи рабочей нагрузки с помощью команды ДЕА

Чтобы начать новую запись рабочей нагрузки, в командной строке выполните следующую команду:

`Deacmd.exe -o StartCapture -n <Trace FileName> -x <Trace Format> -h <SQLServerInstance> -f <database name> -e <Encrypt Connection> -m <Authetication Mode> -u <user name> -p <password> -l <Location of Output Folder> -d <duration>`

**Пример**

`Deacmd.exe -o StartCapture -n sql2008capture -x 0 -h localhost -f adventureworks -e --trust -m 0 -l c:\test  -d 60`

**Дополнительные параметры**

При запуске новой записи рабочей нагрузки с помощью `Deacmd.exe` команды можно использовать следующие дополнительные параметры:

| Параметр| Описание |  
| --- | --- |
| -n, --name | Необходимости имя файла трассировки |
| -x,--Format | Необходимости формат трассировки (Trace = 0, XEvents = 1) |
| -d,--длительность | Необходимости Максимальная продолжительность записи в минутах |
| -l, --location | Необходимости Расположение выходной папки для хранения файлов трассировки и XEvent на главном компьютере |
| -t,--тип | (По умолчанию: 0) тип или выпуск SQL Server (SqlServer = 0, Азуресклдб = 1, Azure SQL Управляемый экземпляр = 2) |
| -h, --host | Необходимости SQL Server имя узла и/или имя экземпляра для запуска записи |
| -e,--Encrypt | (Значение по умолчанию: true) Шифрование соединения с SQL Serverным экземпляром. Значение по умолчанию — true. |
| --Trust | (По умолчанию: false) Доверять сертификату сервера при подключении к SQL Server экземпляру. Значение по умолчанию — false. |
| -f,--DatabaseName | (По умолчанию:) Имя базы данных для фильтрации трассировок. Если не указано, запись начнется для всех баз данных |
| -m,--аусмоде | (По умолчанию: 0) режим проверки подлинности (Windows = 0, проверка подлинности SQL = 1) |
| -u,--username | Имя пользователя для подключения к SQL Server |
| -p,--Password | Пароль для подключения к SQL Server |

## <a name="replay-a-workload-capture"></a>Воспроизведение записи рабочей нагрузки

**Использование распределенное воспроизведение**

Если вы используете распределенное воспроизведение, выполните следующие действия.

1. Войдите на компьютер контроллера распределенное воспроизведение.
2. Чтобы преобразовать трассировку рабочей нагрузки, захваченную с помощью команды Деа, в файл ИРФ, в командной строке выполните следующую команду:

    `DReplay preprocess -m "dreplaycontroller" -i "Path to first trace file" -d "<Folder path on controller>\IrfFolder"`

3. Запустите запись трассировки на целевом компьютере, на котором работает SQL Server с помощью Стартреплайкаптуретраце. SQL.

    а.  В SQL Server Management Studio (SSMS) откройте <Dea_InstallPath \> \скриптс\стартреплайкаптуретраце.скл.

    b.  Запустите `Set @durationInMins=0` , чтобы запись трассировки не была автоматически прервана через указанное время.

    c.  Чтобы задать максимальный размер файла для каждого файла трассировки, выполните команду `Set @maxfilesize` . Рекомендуемый размер — 200 (в МБ).

    d.  Измените `@Tracefile` , чтобы задать уникальное имя для файла трассировки.

    д)  Измените `@dbname` , чтобы указать имя базы данных, если Рабочая нагрузка должна быть захвачена только в определенной базе данных. По умолчанию записывается Рабочая нагрузка на весь сервер.

4. Чтобы воспроизвести файл ИРФ на целевом экземпляре SQL Server, в командной строке выполните следующую команду:

    `DReplay replay -m "dreplaycontroller" -d "<Folder Path on Dreplay Controller>\IrfFolder" -o -s "SQL2016Target" -w "dreplaychild1,dreplaychild2,dreplaycild3,dreplaychild4"`

    а.  Чтобы отслеживать состояние, в командной строке выполните команду `DReplay status -f 1` .

    b.  Чтобы прерывать воспроизведение, например, если вы видите, что уровень прохождения% ниже ожидаемого, в командной строке выполните команду `DReplay cancel` .

5. Останавливает запись трассировки на целевом экземпляре SQL Server.
6. В среде SSMS откройте `<Dea_InstallPath>\Scripts\StopCaptureTrace.sql` .
7. Измените `@Tracefile` в соответствии с путем к файлу трассировки на целевом компьютере, на котором работает SQL Server.
8. Запустите сценарий на целевом компьютере с SQL Server.

**Использование встроенного воспроизведения**

Если вы используете встроенное воспроизведение, вам не придется настраивать распределенное воспроизведение. Возможность использования встроенного воспроизведения с помощью командной строки заключается в том, что в промежуточном графическом интерфейсе можно запустить воспроизведение с помощью встроенного воспроизведения.

## <a name="analyze-traces-using-the-dea-command"></a>Анализ трассировок с помощью команды ДЕА

Чтобы запустить новый анализ трассировки, в командной строке выполните следующую команду:

`Deacmd.exe -o analysis -a <Target1 trace filepath> -b <Target2 trace filepath> -r reportname -h <SQLserverInstance> -e <encryptconnection> -u <username>`

**Пример**

`Deacmd.exe -o analysis -a C:\Trace\SQL2008Source\Trace.trc -b C:\ Trace\SQL2014Trace\Trace.trc -r upgrade20082014 -h localhost -e`

Чтобы просмотреть отчеты об анализе этих файлов трассировки, необходимо использовать графический интерфейс пользователя для просмотра диаграмм и упорядоченных метрик.  Однако база данных анализа записывается в указанный экземпляр SQL Server, поэтому можно также напрямую запрашивать созданные таблицы анализа.

**Дополнительные параметры**

При анализе трассировок с помощью команды ДЕА можно использовать следующие дополнительные параметры:

| Параметр| Описание |  
| --- | --- |
| -а,--Trace | Необходимости путь к файлу события для экземпляра. Пример C:\traces\Sql2008trace.trc.  Если имеется пакет файлов, выберите первый файл, и ДЕА будет автоматически проверять файлы продолжения. Если файлы находятся в большом двоичном объекте, укажите путь к папке, в которой должны храниться локальные файлы событий.  Пример К:\трацес\ |
| -b,--Трацеб | Необходимости путь к файлу событий для экземпляра B. Пример C:\traces\Sql2014trace.trc. Если имеется пакет файлов, выберите первый файл, и ДЕА будет автоматически проверять файлы продолжения. Если файлы находятся в большом двоичном объекте, укажите путь к папке, в которой должны храниться локальные файлы событий.  Пример К:\трацес\ |
| -r,--ReportName | Необходимости имя для текущего анализа. Формируемый аналитический отчет будет идентифицирован по этому имени. |
| -t,--тип | (По умолчанию: 0) тип или выпуск SQL Server (SqlServer = 0, Азуресклдб = 1, Azure SQL Управляемый экземпляр = 2) |
| -h, --host | Необходимости SQL Server имя узла и/или имя экземпляра |
| -e,--Encrypt | (Значение по умолчанию: true) Шифрование соединения с SQL Serverным экземпляром. Значение по умолчанию — true. |
| --Trust | (По умолчанию: false) Доверять сертификату сервера при подключении к SQL Server экземпляру. Значение по умолчанию — false. |
| -m,--аусмоде | (По умолчанию: 0) режим проверки подлинности (Windows = 0, проверка подлинности SQL = 1) |
| -u,--username | Имя пользователя для подключения к SQL Server |
| --p | Пароль для подключения к SQL Server |
| --AB | (По умолчанию: false) Место хранения трассировки A находится в большом двоичном объекте. Если используется, необходимо также указать--Абу (Trace URL-адрес большого двоичного объекта). |
| --BB | (По умолчанию: false) Место хранения трассировки B находится в большом двоичном объекте. Если используется, необходимо также указать--ББУ (URL-адрес объекта Trace B). |
| --Абу | URL-адрес большого двоичного объекта для экземпляра с ключом SAS |
| --ББУ | URL-адрес большого двоичного объекта для экземпляра B с ключом SAS |

## <a name="see-also"></a>См. также раздел

- Дополнительные сведения об использовании ДЕА см. в разделе [обзор Database experimentation Assistant](database-experimentation-assistant-overview.md).
