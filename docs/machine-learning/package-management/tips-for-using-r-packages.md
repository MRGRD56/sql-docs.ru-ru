---
title: Советы по использованию пакетов R
titleSuffix: SQL machine learning
description: Ознакомьтесь с полезными советами по использованию пакетов R в SQL Server для тех, кто только начинает работу с R или SQL Server.
ms.prod: sql
ms.technology: machine-learning
ms.date: 08/06/2019
ms.topic: how-to
author: garyericson
ms.author: garye
monikerRange: '>=sql-server-2016||>=sql-server-linux-ver15||=azuresqldb-mi-current||=sqlallproducts-allversions'
ms.openlocfilehash: c43c5e252c016d8d2094dc2b26d6e87fe3f05749
ms.sourcegitcommit: 82b92f73ca32fc28e1948aab70f37f0efdb54e39
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "94869964"
---
# <a name="tips-for-using-r-packages"></a>Советы по использованию пакетов R

[!INCLUDE [SQL Server 2016 SQL MI](../../includes/applies-to-version/sqlserver2016-asdbmi.md)]

В этой статье приводятся полезные советы по использованию пакетов R в SQL Server. Эти советы предназначены для администраторов баз данных, которые не знакомы с R, и опытных разработчиков R, не знакомых с доступом к пакетам в экземпляре SQL Server.

## <a name="if-youre-new-to-r"></a>Если вы не знакомы с R

Администратору, устанавливающему пакеты R в первый раз, будет полезно знать основы управления пакетами R.

### <a name="package-dependencies"></a>Зависимости пакетов

Пакеты R часто зависят от нескольких других пакетов, и некоторые из них могут быть недоступны в библиотеке R по умолчанию, используемой экземпляром. Иногда пакету требуется другая версия зависимого пакета, отличная от установленной. Зависимости пакета указаны в файле описания, внедренном в пакет, но иногда являются неполными. Для полной формулировки графа зависимостей можно использовать пакет [iGraph](https://igraph.org/r/).

Если необходимо установить несколько пакетов или вы хотите, чтобы все пользователи в организации получали правильный тип и версию пакета, рекомендуется использовать пакет [miniCRAN](https://mran.microsoft.com/package/miniCRAN) для анализа всей цепочки зависимостей. minicRAN создает локальный репозиторий, который может совместно использоваться несколькими пользователями или компьютерами. Дополнительные сведения см. в разделе [Создание локального репозитория пакетов с помощью miniCRAN](create-a-local-package-repository-using-minicran.md).

### <a name="package-sources-versions-and-formats"></a>Источники, версии и форматы пакетов

Существует несколько источников пакетов R, например [CRAN](https://cran.r-project.org/) и [Bioconductor](https://www.bioconductor.org/). На официальном сайте для языка R (<https://www.r-project.org/>) перечислены многие такие ресурсы. Корпорация Майкрософт предлагает [MRAN](https://mran.microsoft.com/) для версий R с открытым исходным кодом ([MRO](https://mran.microsoft.com/open)) и других пакетов. Многие пакеты публикуются на портале GitHub, где можно получить исходный код.

::: moniker range=">=sql-server-2016||=sqlallproducts-allversions"
Пакеты R работают на нескольких вычислительных платформах. Убедитесь, что устанавливаемые версии являются двоичными файлами Windows.
::: moniker-end

::: moniker range=">=sql-server-linux-ver15||=sqlallproducts-allversions"
Пакеты R работают на нескольких вычислительных платформах. Убедитесь, что устанавливаемые версии являются двоичными файлами Linux.
::: moniker-end

### <a name="know-which-library-youre-installing-to-and-which-packages-are-already-installed"></a>Знайте, в какую библиотеку вы устанавливаете пакеты и какие пакеты уже установлены

Если вы ранее изменяли среду R на компьютере, перед установкой убедитесь, что переменная среды R `.libPath` использует только один путь.

Этот путь должен указывать на папку R_SERVICES для экземпляра. Дополнительные сведения, в том числе об определении уже установленных пакетов, см. в разделе [Получение сведений о пакете R](../package-management/r-package-information.md).

## <a name="if-youre-new-to-sql-server"></a>Если вы не знакомы с SQL Server

Когда разработчик R работает над кодом, который выполняется на SQL Server, политики безопасности, защищающие сервер, ограничивают возможности управления средой R. Следующие советы описывают типичные ситуации и предоставляют рекомендации по работе в этой среде.

### <a name="r-user-libraries-not-supported-on-sql-server"></a>Пользовательские библиотеки R: не поддерживаются на SQL Server.

Разработчики R, которым требуется установить новые пакеты R, привыкли устанавливать пакеты по желанию, используя закрытую пользовательскую библиотеку, когда библиотека по умолчанию недоступна или разработчик не является администратором компьютера. Например, в типичной среде разработки R пользователю потребуется добавить расположение пакета R в переменную среды R `libPath` или добавить ссылку на полный путь к пакету следующим образом:

```R
library("c:/Users/<username>/R/win-library/packagename")
```

Это не работает при выполнении решений R в SQL Server, так как пакеты R должны быть установлены в определенную библиотеку по умолчанию, связанную с экземпляром. Когда пакет отсутствует в библиотеке по умолчанию, при попытке вызова пакета может появиться следующая ошибка:

*Произошла ошибка в библиотеке (xxx). Отсутствует пакет с именем "имя_пакета"*

Сведения об установке пакетов R в SQL Server см. в разделе [Установка новых пакетов R в Службах машинного обучения SQL Server или SQL Server R Services](install-additional-r-packages-on-sql-server.md).

### <a name="how-to-avoid-package-not-found-errors"></a>Как избежать ошибок "пакет не найден"

Использование следующих рекомендаций поможет избежать ошибок "пакет не найден".

+ Исключите зависимости от пользовательских библиотек.

    Не рекомендуется устанавливать необходимые пакеты R в пользовательскую библиотеку. Это может привести к ошибкам, если решение запускается другим пользователем, у которого нет доступа к расположению библиотеки.

    Кроме того, если пакет установлен в библиотеку по умолчанию, среда выполнения R загрузит его из этой библиотеки, даже если в коде R указана другая версия.

+ Убедитесь, что код может выполняться в общей среде.

+ Избегайте установки пакетов как части решения. Если у вас нет разрешений на установку пакетов, код завершится ошибкой. Даже если у вас есть разрешения на установку пакетов, это следует делать отдельно от другого кода, который необходимо выполнить.

+ проверьте код, чтобы убедиться в отсутствии вызовов к удаленным пакетам;

+ Обновите код, чтобы удалить прямые ссылки на пути пакетов R или библиотек R.

+ Определите, какая библиотека пакетов связана с экземпляром. Дополнительные сведения см. в статье [Получение сведений о пакете R](../package-management/r-package-information.md).

## <a name="see-also"></a>См. также раздел

::: moniker range="<=sql-server-2017||=sqlallproducts-allversions"
+ [Установка пакетов с инструментами R](install-r-packages-standard-tools.md)
::: moniker-end
::: moniker range=">sql-server-2017||>=sql-server-linux-ver15||=azuresqldb-mi-current||=sqlallproducts-allversions"
+ [Установка новых пакетов R с помощью sqlmlutils](install-additional-r-packages-on-sql-server.md)
::: moniker-end
