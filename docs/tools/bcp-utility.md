---
title: Программа bcp
description: Служебная программа bcp предназначена для массового копирования данных между экземпляром SQL Server и файлом данных в заданном пользователем формате.
ms.prod: sql
ms.prod_service: sql-tools
ms.technology: tools-other
ms.topic: conceptual
helpviewer_keywords:
- bcp utility [SQL Server]
- exporting data
- row exporting [SQL Server]
- copying data [SQL Server], bcp utility
- command prompt utilities [SQL Server], bcp
- tables [SQL Server], importing data
- column importing [SQL Server]
- bcp utility [SQL Server], command options
- file exporting [SQL Server]
- bulk copy [SQL Server]
- bcp utility [SQL Server], about bcp utility
- tables [SQL Server], exporting data
- row importing [SQL Server]
- importing data, bcp utility
- file importing [SQL Server]
- column exporting [SQL Server]
ms.assetid: c0af54f5-ca4a-4995-a3a4-0ce39c30ec38
author: markingmyname
ms.author: maghan
ms.reviewer: v-daenge
ms.custom: seo-lt-2019
ms.date: 09/11/2020
monikerRange: '>=aps-pdw-2016||=azuresqldb-current||=azure-sqldw-latest||>=sql-server-2016||>=sql-server-linux-2017'
ms.openlocfilehash: ac37754513e5c204399e8ac4ae57141f229b4681
ms.sourcegitcommit: 1a544cf4dd2720b124c3697d1e62ae7741db757c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2020
ms.locfileid: "97465795"
---
# <a name="bcp-utility"></a>Программа bcp

[!INCLUDE[SQL Server Azure SQL Database Synapse Analytics PDW ](../includes/applies-to-version/sql-asdb-asdbmi-asa-pdw.md)]

> Сведения об использовании программы bcp в Linux см. в статье [Установка программ командной строки SQL Server sqlcmd и bcp в Linux](../linux/sql-server-linux-setup-tools.md).
>
> Подробные сведения об использовании программы bcp с Azure Synapse Analytics см. в статье [Загрузка данных с bcp](/azure/sql-data-warehouse/sql-data-warehouse-load-with-bcp).

Служебная программа **b** ulk **c** opy **p** rogram (**bcp**) используется для массового копирования данных между экземпляром [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] и файлом данных в указанном пользователем формате. С помощью программы **bcp** можно выполнять импорт большого количества новых строк в таблицы [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] или экспорт данных из таблиц в файлы данных. За исключением случаев использования параметра **queryout** , применение программы не требует знания языка [!INCLUDE[tsql](../includes/tsql-md.md)]. Чтобы выполнить импорт данных в таблицу, необходимо или использовать файл форматирования, созданный для этой таблицы, либо изучить структуру таблицы и типов данных, допустимых для ее столбцов.  

![Значок ссылки на раздел](../database-engine/configure-windows/media/topic-link.gif "Значок ссылки на раздел") Сведения о синтаксических обозначениях в **bcp** см. в разделе [Синтаксические обозначения в Transact-SQL (Transact-SQL)](../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md).  

> [!NOTE]
> При использовании программы **bcp** для резервного копирования данных создайте файл форматирования для записи формата данных. Файлы данных **bcp** **не включают** сведения о схеме или формате, поэтому при удалении таблицы или представления, если отсутствует файл форматирования, импорт данных будет невозможен.

## <a name="download-the-latest-version-of-bcp-utility"></a>Скачивание последней версии программы bcp

**[![Скачивание bcp для x64](../ssdt/media/download.png) Скачать программы командной строки Microsoft 15 для SQL Server (х64)](https://go.microsoft.com/fwlink/?linkid=2142258)**
<br>**[![Скачивание bcp для x86](../ssdt/media/download.png) Скачать программы командной строки Microsoft 15 для SQL Server (х86)](https://go.microsoft.com/fwlink/?linkid=2142257)**

Инструменты командной строки предоставляются в общедоступной версии, тем не менее они выпускаются вместе с пакетом установщика для [!INCLUDE[sql-server-2019](../includes/sssqlv15-md.md)].

### <a name="version-information"></a>Сведения о версии

Номер выпуска: 15.0.2 <br>
Номер сборки: 15.0.2000.5<br>
Дата выпуска: 11 сентября 2020 г.

Новая версия SQLCMD поддерживает проверку подлинности Azure AD, в том числе многофакторную проверку подлинности (MFA) для базы данных SQL, Azure Synapse Analytics и функции Always Encrypted.
Новая версия программы BCP поддерживает проверку подлинности Azure AD, в том числе многофакторную проверку подлинности (MFA) для базы данных SQL и Azure Synapse Analytics.

### <a name="system-requirements"></a>Требования к системе

Windows 10, Windows 7, Windows 8, Windows 8.1, Windows Server 2008, Windows Server 2008 R2, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows Server 2016, Windows Server 2019.

Этот компонент требует наличия [установщика Windows версии 4.5](https://www.microsoft.com/download/details.aspx?id=8483) и [драйвера Microsoft ODBC 17 для SQL Server](https://aka.ms/downloadmsodbcsql).

Чтобы проверить версию BCP, выполните команду `bcp /v` и убедитесь, что используется версия 15.0.2000.5 или выше.

<table><th>Синтаксис</th><tr><td><pre>
bcp [<a href="#db_name">database_name.</a>] <a href="#schema">schema</a>.{<a href="#tbl_name">table_name</a> | <a href="#vw_name">view_name</a> | <a href="#query">"query"</a>}
    {<a href="#in">in</a> <a href="#data_file">data_file</a> | <a href="#out">out</a> <a href="#data_file">data_file</a> | <a href="#qry_out">queryout</a> <a href="#data_file">data_file</a> | <a href="#format">format</a> <a href="#format">nul</a>}
<a>                                                                                                         </a>
    [<a href="#a">-a packet_size</a>]
    [<a href="#b">-b batch_size</a>]
    [<a href="#c">-c</a>]
    [<a href="#C">-C { ACP | OEM | RAW | code_page } </a>]
    [<a href="#d">-d database_name</a>]
    [<a href="#D">-D</a>]
    [<a href="#e">-e err_file</a>]
    [<a href="#E">-E</a>]
    [<a href="#f">-f format_file</a>]
    [<a href="#F">-F first_row</a>]
    [<a href="#G">-G Azure Active Directory Authentication</a>]
    [<a href="#h">-h"hint [,...n]"</a>]
    [<a href="#i">-i input_file</a>]
    [<a href="#k">-k</a>]
    [<a href="#K">-K application_intent</a>]
    [<a href="#l">-l login_timeout</a>]
    [<a href="#L">-L last_row</a>]
    [<a href="#m">-m max_errors</a>]
    [<a href="#n">-n</a>]
    [<a href="#N">-N</a>]
    [<a href="#o">-o output_file</a>]
    [<a href="#P">-P password</a>]
    [<a href="#q">-q</a>]
    [<a href="#r">-r row_term</a>]
    [<a href="#R">-R</a>]
    [<a href="#S">-S [server_name[\instance_name]</a>]
    [<a href="#t">-t field_term</a>]
    [<a href="#T">-T</a>]
    [<a href="#U">-U login_id</a>]
    [<a href="#v">-v</a>]
    [<a href="#V">-V (80 | 90 | 100 | 110 | 120 | 130 ) </a>]
    [<a href="#w">-w</a>]
    [<a href="#x">-x</a>]
</pre></td></tr></table>

## <a name="arguments"></a>Аргументы

 _**файл\_данных**_<a name="data_file"></a>  
 Полный путь файла данных. После выполнения массового импорта данных в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]файл данных содержит данные, которые будут скопированы в указанную таблицу или представление. После выполнения массового экспорта данных из [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]файл данных содержит данные, скопированные из таблицы или представления. Путь может содержать от 1 до 255 символов. Файл данных может содержать максимум 2^63 – 1 строк.  

 _**имя\_базы данных**_<a name="db_name"></a>  
 Имя базы данных, в которой находится указанная таблица или представление. Эта база данных будет по умолчанию использоваться для пользователя, если не указано иное.  

 Можно также явным образом указать имя базы данных с помощью параметра **-d**.  

 **in** *файл_данных*\|**out** *файл_данных*\|**queryout** *файл_данных*\|**format nul**  
 Указывает направление массового копирования следующим образом:  
  
- **in**<a name="in"></a> — копирует данные из файла в таблицу или представление базы данных.  
  
- **out**<a name="out"></a> — копирует данные из таблицы или представления базы данных в файл. Если указать существующий файл, то файл перезаписывается. При извлечении данных программа **bcp** представляет пустую строку как строку NULL, а строку NULL — как пустую строку.  
  
- **queryout**<a name="qry_out"></a> — копирует данные из запроса. Этот аргумент может быть указан только при массовом копировании данных из запроса.  
  
- **format**<a name="format"></a> — создает файл форматирования, основанный на указанных параметрах ( **-n**, **-c**, **-w** или **-N**) и разделителях таблиц или представлений. При выполнении массового копирования данных программа **bcp** может обратиться к файлу форматирования, что позволяет избежать повторного ввода данных о формате в интерактивном режиме. Параметр **format** требует наличия параметра **-f** . Для создания XML-файла форматирования, кроме того, необходим параметр **-x** . Дополнительные сведения см. в разделе [Создание файла форматирования (SQL Server)](../relational-databases/import-export/create-a-format-file-sql-server.md). В качестве значения необходимо указать **nul** (**format nul**).  
  
 _**владелец**_<a name="schema"></a>  
 Имя владельца таблицы или представления. Можно не указывать необязательный параметр *owner* , если пользователь, выполняющий операцию, является владельцем указанной таблицы или представления. *вернет сообщение об ошибке и операция завершится, если аргумент* owner [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] не указан, а пользователь, выполняющий операцию, не является владельцем указанной таблицы или представления.  
  
**"** _**query**_ **"** <a name="query"></a> — это запрос на языке [!INCLUDE[tsql](../includes/tsql-md.md)], который возвращает результирующий набор. Если запрос возвращает несколько результирующих наборов, то в файл данных будет скопирован только первый результирующий набор. Последующие результирующие наборы не учитываются. Используйте двойные кавычки для запроса и одинарные кавычки для выражений, внедренных в запрос. При выполнении массового копирования данных из запроса необходимо, помимо прочего, указывать аргумент **queryout** .  
  
 Запрос может ссылаться на хранимую процедуру, если все таблицы, на которые имеются ссылки в хранимой процедуре, существуют до выполнения инструкции bcp. Например, если хранимая процедура порождает временную таблицу, инструкция **bcp** завершается с ошибкой, поскольку временная таблица доступна только во время выполнения, а не во время запуска инструкции. В этом случае можно вставить результаты работы хранимой процедуры в таблицу, после чего использовать **bcp** для копирования данных из этой таблицы в файл данных.  
  
 _**имя\_таблицы**_<a name="tbl_name"></a>  
 Имя целевой таблицы при импорте данных в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] (**in**) или таблицы-источника при экспорте данных из [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] (**out**).  
  
 _**имя\_представления**_<a name="vw_name"></a>   
 Имя целевого представления при копировании данных в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] (**in**) или представления-источника при копировании данных из [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] (**out**). В качестве целевых представлений могут выступать только те представления, в которых все столбцы ссылаются на одну таблицу. Дополнительные сведения об ограничениях, накладываемых на копирование данных в представления, см. в разделе [INSERT (Transact-SQL)](../t-sql/statements/insert-transact-sql.md).  
  
 **-a** _**размер\_пакета**_<a name="a"></a>  
 Указывает число байтов в каждом сетевом пакете, отправляемом от сервера и к серверу. Параметр конфигурации сервера можно задать с помощью среды [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] (или системной хранимой процедуры **sp_configure** ). Однако параметр конфигурации сервера в отдельных случаях можно изменить с помощью этого параметра. Значение *packet_size* может находиться в пределах от 4096 до 65535 байт, значение по умолчанию равно 4096.  
  
 Увеличение размера пакета может повысить производительность операций массового копирования. Если был запрошен пакет большего размера, но он не может быть предоставлен, то используется значение по умолчанию. Статистика производительности, формируемая программой **bcp** , показывает используемый размер пакета.  
  
 **-b** _**размер\_пакета**_<a name="b"></a>  
 Указывает количество строк в каждом пакете импортированных данных. Каждый пакет импортируется и регистрируется как отдельная транзакция, которая фиксируется после выполнения импорта всего пакета. По умолчанию импорт всех строк в файле данных выполняется в одном пакете. Чтобы распределить строки между несколькими пакетами, укажите значение *batch_size* меньшее, чем количество строк в файле данных. Если транзакция пакета завершится неудачно, то будет выполнен откат только операций вставки в текущем пакете. Произошедшая ошибка не затрагивает пакеты, импорт которых уже выполнен зафиксированными транзакциями.  
  
 Не применяйте этот параметр вместе с параметром **-h "** ROWS_PER_BATCH **=** _bb_ **"** .  
 
 **-c**<a name="c"></a>  
 Выполняет операцию, используя символьный тип данных. При использовании этого параметра не запрашивается тип данных каждого поля. Для хранения данных используется тип **char** , префиксы отсутствуют, в качестве разделителя полей используется символ табуляции **\t** , а в качестве признака конца строки — символ новой строки **\r\n** . **-c** не совместим с **-w**.  
  
 Дополнительные сведения см. в разделе [Использование символьного формата для импорта и экспорта данных (SQL Server)](../relational-databases/import-export/use-character-format-to-import-or-export-data-sql-server.md).  
  
 **-C** { **ACP** \| **OEM** \| **RAW** \| *кодовая_страница* }<a name="C"></a>   
 Указывает кодовую страницу данных в файле данных. Аргумент *code_page* имеет смысл только в том случае, если данные содержат столбцы типа **char**, **varchar** или **text** с символами, коды которых больше 127 или меньше 32.  
  
> [!NOTE]
> Рекомендуется указывать имя параметра сортировки для каждого столбца в файле форматирования, кроме случаев, когда параметр 65001 должен иметь приоритет над спецификацией параметров сортировки или кодовой страницы.
  
|Значение кодовой страницы|Описание|  
|---------------------|-----------------|  
|ACP|[!INCLUDE[vcpransi](../includes/vcpransi-md.md)]/Microsoft Windows (ISO 1252).|  
|OEM|Кодовая страница, используемая клиентом по умолчанию. Это кодовая страница, используемая по умолчанию, если не указан параметр **-C** .|  
|RAW|Преобразование из одной кодовой страницы в другую не выполняется. Этот параметр обеспечивает высокую производительность, так как преобразование не выполняется.|  
|*code_page*|Определенный номер кодовой страницы, например 850.<br /><br /> Версии раньше 13 ([!INCLUDE[ssSQL15](../includes/sssql15-md.md)]) не поддерживают кодовую страницу 65001 (кодировка UTF-8). Начиная с версии 13, кодировку UTF-8 можно импортировать в более ранние версии [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].|  
|||
  
 **-d** _**имя\_базы_данных**_<a name="d"></a>   
 Указывает базу данных, с которой надо соединиться. По умолчанию программа bcp.exe соединяется с пользовательской базой данных по умолчанию. Если указаны -d имя_базы_данных и имя, состоящее из трех частей (имя_базы_данных.schema.table, переданное в качестве первого параметра в bcp.exe), возникнет ошибка, так как вы не можете указать имя базы данных дважды. Если параметр *database_name* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-d** и именем базы данных.  

**-D**<a name="D"></a>  
Значение, передаваемое в параметр `bcp` `-S`, интерпретируется как имя источника данных (DSN). DSN может использоваться для внедрения параметров драйвера для упрощения командных строк, применения параметров драйвера, которые недоступны иным образом из командной строки, например MultiSubnetFailover, или для защиты конфиденциальных учетных данных от обнаружения в качестве аргументов командной строки. Дополнительные сведения см. в разделе _Поддержка имени DSN в sqlcmd и bcp_ статьи [Соединение с помощью sqlcmd](../connect/odbc/linux-mac/connecting-with-sqlcmd.md).


 **-e** _**файл\_ошибок**_<a name="e"></a>  
 Указывает полный путь к файлу ошибок, используемому для хранения строк, которые служебная программа **bcp** не может передать из файла в базу данных. Сообщения об ошибках команды **bcp** поступают на рабочую станцию пользователя. Если этот параметр не используется, то файл ошибок не создается.  
  
 Если параметр *err_file* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-e** и значением *err_file* .  
  
**-E**<a name="E"></a>

Указывает, что значение или значения идентификаторов в файле импортированных данных будут использоваться для столбца идентификаторов. Если аргумент **-E** не указан, значения идентификаторов для этого столбца в импортируемом файле данных не учитываются, и [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] автоматически назначает уникальные значения на основе начального значения и значения приращения, указанных во время создания таблицы.  Дополнительные сведения см. в статье [DBCC CHECKIDENT](../t-sql/database-console-commands/dbcc-checkident-transact-sql.md).
  
 Если файл данных не содержит значений для столбца идентификаторов в таблице или представлении, то с помощью файла форматирования укажите, что столбец идентификаторов в таблице или представлении должен быть пропущен при импорте данных. [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] автоматически присвоит столбцу уникальные значения.
  
 Для использования параметра **-E** необходимы специальные разрешения. Дополнительные сведения см. в подразделе "[Примечания](#remarks)" ниже.  
   
 **-f** _**файл\_форматирования**_<a name="f"></a>  
 Указывает полный путь к файлу форматирования. Назначение этого параметра зависит от окружения, в котором он используется (см. далее):  
  
- Если параметр **-f** используется с параметром **format** , для указанной таблицы или представления создается файл с именем *format_file* . Чтобы создать XML-файл форматирования, укажите параметр **-x** . Дополнительные сведения см. в разделе [Создание файла форматирования (SQL Server)](../relational-databases/import-export/create-a-format-file-sql-server.md).  
  
- При использовании параметра **in** или **out** для **-f** должен существовать файл форматирования.  
  
    > [!NOTE]
    > Необязательно использовать файл форматирования с параметром **in** или **out** . Если отсутствует параметр **-f** и не указаны параметры **-n**, **-c**, **-w** или **-N** , команда запрашивает сведения о форматировании и позволяет сохранить ответы в файле форматирования (имя файла по умолчанию — Bcp.fmt).
  
 Если параметр *format_file* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-e** и значением *format_file* .  
  
**-F** _**первая\_строка**_<a name="F"></a>  
 Указывает номер первой строки для экспорта из таблицы или импорта из файла данных. Значение параметра должно быть больше (>) 0, но меньше (<) или равно (=) общему количеству строк. Если параметр отсутствует, по умолчанию используется первая строка файла.  
  
 Параметр *first_row* может иметь положительное целое значение до 2^63-1. Аргумент **-F***первая_строка* имеет нумерацию, которая начинается с 1.  

**-G**<a name="G"></a>

 Клиент использует этот переключатель при подключении к базе данных SQL Azure или Azure Synapse Analytics, чтобы указать, что проверка подлинности пользователя выполняется с помощью Azure Active Directory. Для использования аргумента -G требуется [версия 14.0.3008.27 или выше](https://go.microsoft.com/fwlink/?LinkID=825643). Чтобы определить версию, выполните команду bcp -v. Дополнительные сведения см. в статье [Использование проверки подлинности Azure Active Directory для базы данных SQL или Azure Synapse Analytics](/azure/sql-database/sql-database-aad-authentication). 

> [!IMPORTANT]
> Параметр **-G** применяется только для базы данных SQL Azure и хранилища данных Azure.
> Встроенная и интерактивная проверка подлинности AAD в настоящее время не поддерживается в Linux и macOS.

> [!TIP]
> Чтобы проверить, поддерживает ли ваша версия программы bcp проверку подлинности Azure Active Directory (AAD), введите **bcp --** (bcp\<space>\<dash>\<dash>) и убедитесь, что в списке доступных аргументов отображается -G.

- **Имя пользователя и пароль Azure Active Directory** 

    Если вы хотите использовать имя пользователя и пароль Azure Active Directory, можно указать параметр **-G** , а также использовать имя пользователя и пароль, задав параметры **-U** и **-P** . 

    В приведенном ниже примере показан экспорт данных с помощью имени пользователя и пароля Azure AD, которые являются учетными данными AAD. Здесь показана процедура экспорта таблицы `bcptest` из базы данных `testdb` на сервере Azure `aadserver.database.windows.net` и сохранения данных в файле `c:\last\data1.dat`:

    ```cmd
    bcp bcptest out "c:\last\data1.dat" -c -t -S aadserver.database.windows.net -d testdb -G -U alice@aadtest.onmicrosoft.com -P xxxxx
    ```

    В приведенном ниже примере показан импорт данных с помощью имени пользователя и пароля Azure AD, которые являются учетными данными AAD. Здесь показана процедура импорта данных из файла `c:\last\data1.dat` в таблицу `bcptest` базы данных `testdb` на сервере Azure `aadserver.database.windows.net` с помощью имени пользователя и пароля Azure AD:

    ```cmd
    bcp bcptest in "c:\last\data1.dat" -c -t -S aadserver.database.windows.net -d testdb -G -U alice@aadtest.onmicrosoft.com -P xxxxx
    ```

- **Встроенная проверка подлинности Azure Active Directory**

    Чтобы использовать встроенную проверку подлинности Azure Active Directory, укажите параметр **-G** без имени пользователя или пароля. В этой конфигурации предполагается, что текущая учетная запись пользователя Windows (учетная запись, в которой выполняется команда bcp) включена в федерацию с Azure AD.

    В приведенном ниже примере показан экспорт данных с использованием учетной записи с Azure AD. Здесь показана процедура экспорта таблицы `bcptest` из базы данных `testdb` с помощью учетной записи с Azure AD с сервера Azure `aadserver.database.windows.net` и сохранения данных в файле `c:\last\data2.dat`:

    ```cmd
    bcp bcptest out "c:\last\data2.dat" -S aadserver.database.windows.net -d testdb -G -c -t
    ```

    В приведенном ниже примере показан импорт данных с помощью встроенной проверки подлинности Azure AD. Здесь показана процедура импорта данных из файла `c:\last\data2.txt` в таблицу `bcptest` базы данных `testdb` на сервере Azure `aadserver.database.windows.net` с помощью встроенной проверки подлинности Azure AD:

    ```cmd
    bcp bcptest in "c:\last\data2.dat" -S aadserver.database.windows.net -d testdb -G -c -t
    ```

- **Интерактивная проверка подлинности Azure Active Directory**  

   Интерактивная проверка подлинности Azure AD для Базы данных SQL Azure и Azure Synapse Analytics позволяет использовать интерактивный метод, поддерживающий многофакторную проверку подлинности. Дополнительные сведения см. в разделе [Интерактивная проверка подлинности Active Directory](../ssdt/azure-active-directory.md#active-directory-interactive-authentication).

   Для интерактивного режима Azure AD требуется программа **bcp** [версии 15.0.1000.34](#download-the-latest-version-of-bcp-utility) или выше, а также [ODBC версии 17.2 или выше](https://aka.ms/downloadmsodbcsql).  

   Чтобы включить интерактивную проверку подлинности, укажите аргумент -G только с именем пользователя (-U) без пароля.

   В приведенном ниже примере данные экспортируются с помощью интерактивного режима Azure AD с указанием имени пользователя, который представляет собой учетную запись AAD. Это тот же пример, который использовался в предыдущем разделе: *Имя пользователя и пароль Azure Active Directory*.  

   Для интерактивного режима требуется вводить пароль вручную. Для учетных записей с включенной многофакторной проверкой подлинности следует выполнить настроенный метод аутентификации MFA.

   ```cmd
   bcp bcptest out "c:\last\data1.dat" -c -t -S aadserver.database.windows.net -d testdb -G -U alice@aadtest.onmicrosoft.com
   ```

   Если пользователь Azure AD является федеративным пользователем домена с учетной записью Windows, имя пользователя, необходимое в командной строке, содержит учетную запись домена (например, joe@contoso.com; см. пример ниже):

   ```cmd
   bcp bcptest out "c:\last\data1.dat" -c -t -S aadserver.database.windows.net -d testdb -G -U joe@contoso.com
   ```

   Если гостевые пользователи есть в определенной службе Azure AD и являются частью группы, которая существует в Базе данных SQL с разрешением на выполнение команды bcp, будет использоваться псевдоним гостевого пользователя (например, *keith0@adventureworks.com* ).
  
**-h**_**"указания_загрузки**_[ ,... *n*] **"** <a name="h"></a> — определяет одно или несколько указаний для использования во время массового импорта данных в таблицу или представление.  
  
* **ORDER**(**_column_[ASC | DESC] [** , **..._n_])**  
Порядок сортировки данных в файле данных. Производительность массового импорта увеличивается, если импортируемые данные упорядочены согласно кластеризованному индексу таблицы (при наличии). Если файл данных отсортирован в порядке, отличном от порядка ключа кластеризованного индекса, или если в таблице отсутствует кластеризованный индекс, то предложение ORDER пропускается. В целевой таблице должны быть указаны имена столбцов. По умолчанию программа **bcp** предполагает, что файл данных не упорядочен. Для оптимизированного массового импорта [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , помимо прочего, проверяет сортировку импортируемых данных.  
  
* **ROWS_PER_BATCH** **=** _**bb**_  
Количество строк данных в каждом пакете (значение *bb*). Используется в случае, если не указан параметр **-b** , что приводит к тому, что весь файл данных отправляется на сервер в ходе одной транзакции. Сервер оптимизирует массовую загрузку в соответствии со значением *bb*. По умолчанию значение аргумента ROWS_PER_BATCH неизвестно.  
  
* **KILOBYTES_PER_BATCH** **=** _**cc**_  
Приблизительный объем данных в каждом пакете в килобайтах (значение *cc*). По умолчанию, значение KILOBYTES_PER_BATCH неизвестно.  
  
* **TABLOCK**  
Указывает, что при выполнении массового обновления на период операции массовой загрузки будет получена блокировка на уровне таблицы. В противном случае запрашивается блокировка на уровне строки. Применение этого указания значительно повышает производительность, так как удержание блокировки в течение операции массового копирования уменьшает вероятность состязаний блокировок в таблице. Если таблица не имеет индексов и указано ключевое слово **TABLOCK** , загрузка в таблицу может производиться параллельно несколькими клиентами. По умолчанию работа блокировки определяется параметром таблицы **table lock on bulkload**.  
  
  > [!NOTE]
  > Если целевая таблица представляет собой кластеризованный индекс columnstore, подсказка TABLOCK для параллельной загрузки сразу нескольких клиентов не требуется, так как каждый параллельный поток назначается отдельной группе строк в индексе и загружает в нее данные. Дополнительные сведения см. в справочных материалах по индексу columnstore.
  
  **CHECK_CONSTRAINTS**  
  Указывает, что при выполнении операции массового импорта будет выполняться проверка всех ограничений целевой таблицы или представления. Если указание CHECK_CONSTRAINTS не задано, то все ограничения CHECK и FOREIGN KEY пропускаются, и после выполнения операции ограничение таблицы отмечается как ненадежное.  
  
  > [!NOTE]
  > Ограничения UNIQUE, PRIMARY KEY и NOT NULL проверяются в любом случае.
  
  На некотором этапе понадобится проверить ограничения во всей таблице. Если таблица была непустой до операции массового импорта данных, стоимость повторной проверки правильности ограничения может превысить стоимость применения ограничений CHECK к добавочным данным. Поэтому корпорация Майкрософт рекомендует включить проверку ограничений во время выполнения добавочного массового импорта данных.  
  
  Отключение проверки ограничений (настройка по умолчанию) может потребоваться в тех ситуациях, когда входные данные содержат строки, нарушающие эти ограничения. Импорт данных можно выполнить с отключенными ограничениями CHECK, после чего использовать инструкции языка [!INCLUDE[tsql](../includes/tsql-md.md)] для удаления недопустимых значений.  
  
  > [!NOTE]
  > Теперь программа **bcp** производит проверку данных, которые могут привести к ошибкам в работе существующих скриптов, если файлы данных будут содержать недопустимые данные.

  > [!NOTE]
  > Параметр **-m** *максимальное_количество_ошибок* не применяется при проверке ограничений.
  
* **FIRE_TRIGGERS**  
Применяется вместе с аргументом **in** и указывает, что в течение операции массового копирования будут работать триггеры Insert, определенные в целевой таблице. Если параметр FIRE_TRIGGERS не указан, то триггеры Insert выполняться не будут. Параметр FIRE_TRIGGERS для аргументов **out**, **queryout** и **format** не учитывается.  
  
**-i** _**входной\_файл**_<a name="i"></a>  
Указывает имя файла ответов, содержащего ответы на вопросы командной строки для каждого поля данных при выполнении массового копирования в интерактивном режиме, когда не указаны параметры ( **-n**, **-c**, **-w** или **-N** ).  
  
Если параметр *input_file* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-e** и значением *input_file* .  
  
**-k**<a name="k"></a>  
Указывает, что пустые столбцы во время данной операции должны сохранить значение NULL вместо любых вставляемых значений столбцов по умолчанию. Дополнительные сведения см. в разделе [Сохранение значений NULL или использование значений по умолчанию при массовом импорте данных (SQL Server)](../relational-databases/import-export/keep-nulls-or-use-default-values-during-bulk-import-sql-server.md).  
  
**-K** _**намерение\_приложения**_<a name="K"></a>   
Объявляет тип рабочей нагрузки приложения при соединении с сервером. Единственным возможным значением является **ReadOnly**. Если параметр **-K** не указан, программа bcp не будет поддерживать соединение с вторичной репликой в группе доступности AlwaysOn. Дополнительные сведения см. в статье [Активные вторичные реплики: вторичные реплики для чтения (группы доступности Always On)](../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).  
  
**-l** _**время_ожидания\_входа**_<a name="l"></a>  
Указывает время ожидания входа. Параметр -l задает время ожидания (в секундах) для входа в SQL Server при попытке подключения к серверу. Значение времени ожидания по умолчанию — 15 секунд. Время ожидания входа должно быть числом в диапазоне от 0 до 65 534. Если указанное значение не является числом или выходит за пределы указанного диапазона, bcp выдает сообщение об ошибке. Значение 0 указывает на бесконечное время ожидания.
  
**-L** _**последняя\_строка**_<a name="L"></a>  
Указывает номер последней строки для экспорта из таблицы или импорта из файла данных. Значение параметра должно быть больше (>) 0, но меньше (<) или равно (=) номеру последней строки. Если параметр отсутствует, по умолчанию используется последняя строка файла.  
  
Параметр *last_row* может иметь положительное целое значение до 2^63-1.  
  
**-m** _**максимальное_количество\_ошибок**_<a name="m"></a>  
Указывает максимальное количество синтаксических ошибок, которые могут произойти до отмены операции **bcp** . Синтаксическая ошибка подразумевает ошибку преобразования данных в целевой тип данных. В общее количество ошибок *max_errors* не включаются ошибки, которые могут быть обнаружены только на сервере, например нарушения ограничений.  
  
 Строка, которую нельзя скопировать с помощью программы **bcp** , не обрабатывается и считается одной ошибкой. Если параметр не указан, то используется значение по умолчанию, равное 10.  
  
> [!NOTE]
> Параметр **-m** , кроме того, не применяется для преобразования типов данных **money** или **bigint** .
  
**-n**<a name="n"></a>  
Выполняет операцию массового копирования, используя собственные типы данных (базы данных). Этот параметр не запрашивает тип данных для каждого поля, он использует собственные значения.  
  
Дополнительные сведения см. в разделе [Использование собственного формата для импорта и экспорта данных (SQL Server)](../relational-databases/import-export/use-native-format-to-import-or-export-data-sql-server.md).  
  
**-N**<a name="N"></a>  
Выполняет операцию массового копирования, используя собственные типы данных (базы данных) для несимвольных данных и символы Юникода для символьных данных. Этот параметр предлагает более высокопроизводительную альтернативу параметру **-w** и предназначен для передачи данных с одного экземпляра [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] на другой с помощью файла данных. Он не запрашивает тип данных каждого поля. Используйте этот параметр при передаче данных, которые содержат символы национального алфавита ANSI, а также, чтобы повысить производительность работы в собственном режиме.  
  
 Дополнительные сведения см. в разделе [Использование собственного формата Юникод для импорта и экспорта данных (SQL Server)](../relational-databases/import-export/use-unicode-native-format-to-import-or-export-data-sql-server.md).  
  
 Если выполнить экспорт, а затем импорт данных одной и той же схемы таблицы с помощью программы bcp.exe с параметром **-N**, может появиться предупреждающее сообщение об усечении при наличии символьного столбца фиксированной длины в кодировке, отличной от Юникода (например, **char(10)** ).  
  
 Это предупреждение можно пропустить. Одним из способов его устранения является применение аргумента командной строки **-n** вместо **-N**.  
  
 **-o** _**выходной\_файл**_<a name="o"></a>  
 Указывает имя файла, который принимает перенаправленные из командной строки выходные данные.  
  
 Если параметр *output_file* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-e** и значением *output_file* .  
  
 **-P** _**пароль**_<a name="P"></a>  
 Указывает пароль для идентификатора имени входа. Если данный параметр не указан, команда **bcp** запрашивает пароль. Если этот параметр используется в конце командной строки без указания пароля, программа **bcp** применяет пароль по умолчанию (NULL).  
  
> [!IMPORTANT]
> [!INCLUDE[ssNoteStrongPass](../includes/ssnotestrongpass-md.md)]
  
 Чтобы скрыть пароль, не указывайте параметр **-P** вместе с параметром **-U** . Вместо этого после ввода команды **bcp** с параметром **-U** и другими параметрами (не указывая **-P**) нажмите клавишу ВВОД, и команда предложит ввести пароль. Этот метод обеспечивает скрытие пароля при вводе.  
  
 Если параметр *password* начинается с дефиса (-) или косой черты (/), не включайте пробел между **-P** и значением *password* .  
  
 **-q**<a name="q"></a>  
 Выполняет инструкцию SET QUOTED_IDENTIFIERS ON в соединении между служебной программой **bcp** и экземпляром [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Используйте этот параметр для указания базы данных, владельца, таблицы или имени представления, содержащих пробел или одинарную кавычку. Заключите все имя таблицы или представления, состоящее из трех частей, в кавычки ("").  
  
 Чтобы указать имя базы данных, содержащее пробел или одинарные кавычки, следует использовать параметр **-q**.  
  
 **-q** не применяется к значениям, переданным в **-d**.  
  
 Дополнительные сведения см. в подразделе " [Примечания](#remarks)" ниже.  
  
 **-r** _**термин\_строки**_<a name="r"></a>  
 Указывает признак конца строки. Значением по умолчанию является **\n** (символ перевода строки). Используйте этот параметр, чтобы переопределить признак конца строки по умолчанию. Дополнительные сведения см. в разделе [Определение признаков конца поля и строки (SQL Server)](../relational-databases/import-export/specify-field-and-row-terminators-sql-server.md).  
  
 Если в команде bcp.exe указан признак конца строки в шестнадцатеричном виде, то значение будет усечено до 0x00. Например, если указать значение 0x410041, то будет использовано значение 0x41.  
  
 Если параметр *row_term* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-r** и значением *row_term* .  
  
 **-R**<a name="R"></a>  
 Указывает, что массовое копирование в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] данных в денежном формате, в формате даты и времени выполняется с помощью регионального формата, определенного настройками локали клиентского компьютера. По умолчанию региональные настройки не учитываются.  
  
 **-S** _**имя\_сервера**_ [\\_**имя\_экземпляра**_]<a name="S"></a> — указывает экземпляр [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], к которому устанавливается подключение. Если сервер не указан, программа **bcp** выполняет подключение к экземпляру [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] по умолчанию на локальном компьютере. Этот параметр необходим, если команда **bcp** выполняется с удаленного компьютера в сети или с локального именованного экземпляра. Чтобы подключиться к экземпляру по умолчанию [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] на сервере, укажите только *server_name*. Чтобы подключиться к именованному экземпляру [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], укажите _имя\_сервера_ **\\** _имя\_экземпляра_.  
  
 **-t** _**термин\_поля**_<a name="t"></a>  
 Указывает признак конца поля. Значением по умолчанию является **\t** (символ табуляции). Используйте этот параметр, чтобы переопределить признак конца поля по умолчанию. Дополнительные сведения см. в разделе [Определение признаков конца поля и строки (SQL Server)](../relational-databases/import-export/specify-field-and-row-terminators-sql-server.md).  
  
 Если в команде bcp.exe указан признак конца поля в шестнадцатеричном виде, то значение будет усечено до 0x00. Например, если указать значение 0x410041, то будет использовано значение 0x41.  
  
 Если параметр *field_term* начинается с дефиса (-) или косой черты (/), не ставьте пробел между **-r** и значением *field_term* .  
  
 **-T**<a name="T"></a>  
 Указывает, что программа **bcp** устанавливает доверительное соединение с [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] с использованием встроенной безопасности. Не требуются учетные данные безопасности для сетевого пользователя, параметры *login_id* и *password* . Если параметр **-T** не указан, для входа необходимо указать **-U** и **-P** .

> [!IMPORTANT]
> Если программа **bcp** подключается к [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] с помощью доверенного соединения, используя встроенную безопасность, укажите параметр **-T** (доверенное соединение) вместо сочетания параметров *user name* и *password* . Когда программа **bcp** подключается к базе данных SQL или Azure Synapse Analytics, использование проверки подлинности Windows или Azure Active Directory не поддерживается. Используйте параметры **-U** и **-P** . 
  
 **-U** _**имя\_для_входа**_<a name="U"></a>  
 Указывает идентификатор входа, используемый для соединения с [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
> [!IMPORTANT]
> Если программа **bcp** подключается к [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] с помощью доверенного соединения, используя встроенную безопасность, укажите параметр **-T** (доверенное соединение) вместо сочетания параметров *user name* и *password* . Когда программа **bcp** подключается к базе данных SQL или Azure Synapse Analytics, использование проверки подлинности Windows или Azure Active Directory не поддерживается. Используйте параметры **-U** и **-P** .
  
 **-v**<a name="v"></a>  
 Выводит номер версии и сведения об авторских правах для служебной программы **bcp** .  
  
 **-V** (**80** \| **90** \| **100** \| **110** \| **120** \| **130**)<a name="V"></a>  
 Выполняет операцию массового копирования, используя типы данных более ранней версии [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Этот параметр не запрашивает тип данных каждого поля, он использует значения по умолчанию.  
  
 **80** = [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)]  
  
 **90** = [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)]  
  
 **100** = [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)] и [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)]  
  
 **110** = [!INCLUDE[ssSQL11](../includes/sssql11-md.md)]  
  
 **120** = [!INCLUDE[ssSQL14](../includes/sssql14-md.md)]  
  
 **130** = [!INCLUDE[ssSQL15](../includes/sssql15-md.md)]  
  
 Например, чтобы создать данные для типов, не поддерживаемых [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)], но введенных в более поздних версиях [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], используйте параметр -V80.  
  
 Дополнительные сведения см. в разделе [Импорт данных в собственном и символьном формате из предыдущих версий SQL Server](../relational-databases/import-export/import-native-and-character-format-data-from-earlier-versions-of-sql-server.md).  
  
 **-w**<a name="w"></a>  
 Выполняет операцию массового копирования, используя символы Юникода. При использовании этого параметра не запрашивается тип данных каждого поля, для хранения данных используется тип **nchar** , отсутствуют префиксы, в качестве разделителя полей используется символ табуляции **\t** , а в качестве признака конца строки — символ новой строки **\n** . **-w** не совместим с **-c**.  
  
 Дополнительные сведения см. в разделе [Использование символьного формата Юникод для импорта и экспорта данных (SQL Server)](../relational-databases/import-export/use-unicode-character-format-to-import-or-export-data-sql-server.md).  
  
 **-x**<a name="x"></a>  
 При использовании вместе с параметрами **format** и **-f** *файл_формата* приводит к созданию файла форматирования на основе XML. По умолчанию создается файл форматирования в формате, отличном от XML. Параметр **-x** не работает при импорте или экспорте данных. Применение этого параметра без параметров **format** и **-f***файл_формата* приведет к ошибке.  

## <a name="remarks"></a>Примечания<a name="remarks"></a>

- Программа **bcp** 13.0 устанавливается при установке средств [!INCLUDE[msCoName](../includes/msconame-md.md)][!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] . Если установлены средства как [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] , так и более ранней версии [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], то в зависимости от значения переменной среды PATH вместо **bcp** 13.0 необходимо использовать более раннюю версию клиента **bcp** . Переменная среды определяет набор каталогов, используемых Windows для поиска исполняемых файлов. Чтобы определить используемую версию, выполните в командной строке Windows команду **bcp /v** или **bcp -v**. Чтобы получить информацию о том, как задать путь к команде в переменной среды PATH, обратитесь к разделу [Переменные среды](/windows/win32/shell/user-environment-variables) или выполните поиск по запросу "Переменные среды" в справке Windows.

    Чтобы при запуске использовалась последняя версия программы bcp, необходимо удалить все более старые версии программы bcp.

    Чтобы определить, где установлены все версии программы bcp, введите в командной строке следующую команду:

    ```cmd
    where bcp.exe
    ```

- Служебную программу bcp можно скачать отдельно от [пакета дополнительных компонентов Microsoft SQL Server 2016](https://www.microsoft.com/download/details.aspx?id=56833).  Выберите `ENU\x64\MsSqlCmdLnUtils.msi` или `ENU\x86\MsSqlCmdLnUtils.msi`.

- XML-файлы форматирования поддерживаются только при установке средств [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] вместе с собственным клиентом [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .

- Сведения о том, как найти и запустить программу **bcp**, а также соглашение о синтаксисе программ командной строки см. в разделе [Справочник по программе командной строки (компонент Database Engine)](../tools/command-prompt-utility-reference-database-engine.md).

- Дополнительные сведения о подготовке данных к массовому импорту или экспорту см. в разделе [Подготовка данных к массовому экспорту или импорту (SQL Server)](../relational-databases/import-export/prepare-data-for-bulk-export-or-import-sql-server.md).

- Сведения о том, когда в журнале транзакций регистрируются операции вставки строк, выполняемые при массовом импорте, см. в разделе [Предварительные условия для минимального протоколирования массового импорта данных](../relational-databases/import-export/prerequisites-for-minimal-logging-in-bulk-import.md).

- [Использование дополнительных специальных символов](/windows-server/administration/windows-commands/set_1#remarks)

    Символы <, >, |, &, ^ являются специальными символами командной оболочки, и перед ними необходимо указать escape-символы (^) или заключить их в кавычки (например, "StringContaining&Symbol"). Если строка, содержащая специальный символ, заключена в кавычки, кавычки необходимо указывать как часть значения переменной среды.

## <a name="native-data-file-support"></a>Поддержка собственного формата файлов данных

 В [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)]программа **bcp** поддерживает только собственные файлы данных, совместимые с [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)], [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)], [!INCLUDE[ssKatmai](../includes/sskatmai-md.md)], [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)]и [!INCLUDE[ssSQL11](../includes/sssql11-md.md)].  

## <a name="computed-columns-and-timestamp-columns"></a>Вычисляемые столбцы и столбцы типа timestamp

 При выполнении импорта значений в файле данных для вычисляемых столбцов и столбцов типа **timestamp** столбцы пропускаются, и [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] присваивает значения автоматически. Если файл данных не содержит значений для вычисляемых столбцов или столбцов типа **timestamp** в таблице, следует использовать файл форматирования, в котором будет указано, что вычисляемые столбцы или столбцы типа **timestamp** в таблице должны быть пропущены при импорте данных. [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] автоматически присвоит значения для столбца.  
  
 При массовом копировании вычисляемые столбцы и столбцы типа **timestamp** копируются из [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] в файл данных обычным способом.  

## <a name="specifying-identifiers-that-contain-spaces-or-quotation-marks"></a>Указание идентификаторов, содержащих пробелы или кавычки

 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] могут содержать такие символы, как внедренные пробелы и кавычки. Такие идентификаторы должны обрабатываться следующим образом.  
  
- Если идентификатор или имя файла содержит пробел или кавычку в командной строке, заключите идентификатор в двойные кавычки ("").  

    Например, следующая команда `bcp out` создает файл данных с именем `Currency Types.dat`:  

    ```cmd
    bcp AdventureWorks2012.Sales.Currency out "Currency Types.dat" -T -c  
    ```
  
- Чтобы указать имя базы данных, содержащее пробел или кавычки, необходимо использовать параметр **-q** .  
  
- Для имен владельца, таблицы или представления, содержащих внедренные пробелы или кавычки, также можно:  
  
    - указать параметр **-q** ; или  
  
    - заключить имя владельца, таблицы или представления в квадратные скобки ([]) внутри кавычек.  

## <a name="data-validation"></a>Проверка данных

 Теперь программа **bcp** производит проверку данных, которые могут привести к ошибкам в работе существующих скриптов, если файлы данных будут содержать недопустимые данные. Например, программа **bcp** проверяет, что:  
  
- собственные представления типов данных float или real являются допустимыми.  
  
- Данные в Юникоде имеют четную длину.  
  
 Возможно, те недопустимые данные, импорт которых мог выполняться операцией массового импорта в предыдущих версиях [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , теперь не удастся загрузить, тогда как в предыдущих версиях ошибка возникала только при попытке клиента подключиться к недопустимым данным. Добавленная проверка снижает вероятность непредвиденных ситуаций во время запроса данных после массовой загрузки.  

## <a name="bulk-exporting-or-importing-sqlxml-documents"></a>Массовый экспорт или импорт документов SQLXML

Чтобы выполнить массовый экспорт или импорт SQLXML-данных используйте один из следующих типов данных в файле форматирования:  
  
|Тип данных|Действие|  
|---------------|------------|  
|SQLCHAR или SQLVARYCHAR|Данные отправляются в кодовой странице клиента или кодовой странице, определенной параметрами сортировки. Результат тот же, что и при указании параметра **-c** без указания файла форматирования.|  
|SQLNCHAR или SQLNVARCHAR|Данные отправляются в Юникоде. Результат тот же, что и при указании параметра **-w** без указания файла форматирования.|  
|SQLBINARY или SQLVARYBIN|Данные отправляются без преобразования.|  

## <a name="permissions"></a>Разрешения

 Для операции **bcp out** необходимо разрешение SELECT на исходную таблицу.  
  
 Для операции **bcp in** необходимы как минимум разрешения SELECT/INSERT на целевую таблицу. Кроме того, разрешение ALTER TABLE необходимо в следующих случаях.  
  
- Ограничения существуют, а указание CHECK_CONSTRAINTS не задано.  
  
    > [!NOTE]
    > Ограничения отключены по умолчанию. Чтобы явно включить ограничения, используйте параметр **-h** с подсказкой CHECK_CONSTRAINTS.
  
- Триггеры существуют, а указание FIRE_TRIGGER не задано.  
  
    > [!NOTE]
    > По умолчанию, триггеры не срабатывают. Чтобы запустить триггеры явно, используйте параметр **-h** с подсказкой FIRE_TRIGGERS.
  
- Используйте параметр **-E** , чтобы выполнить импорт значений идентификаторов из файла данных.  
  
> [!NOTE]
> Необходимость наличия разрешения ALTER TABLE на целевую таблицу было новой особенностью [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)]. Если у учетной записи пользователя нет разрешений ALTER на целевую таблицу, это новое требование может привести к ошибке скриптов **bcp** , не применяющих принудительно триггеры и проверку ограничений.

## <a name="character-mode--c-and-native-mode--n-best-practices"></a>Рекомендации для символьного режима (-c) и собственного режима (-n)

 Этот раздел содержит рекомендации для символьного режима (-c) и собственного режима (-n).  
  
- (Администратор/пользователь) Если возможно, используйте собственный формат (-n) во избежание проблем с разделением. Используйте собственный формат для экспорта и импорта с помощью [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Экспортируйте данные из [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] с помощью параметра - c или -w, если данные планируется импортировать в базу данных, отличную от[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .  
  
- (Администратор) Проверьте данные при использовании BCP OUT. Например, при использовании BCP OUT, BCP IN, а затем BCP OUT убедитесь, что данные экспортируются правильно и значения признака конца не используются как часть какого-либо значения данных. Попробуйте переопределить признаки конца по умолчанию (с помощью параметров -t и -r) на случайные шестнадцатеричные значения, чтобы избежать конфликта между значениями признака конца и значениями данных.  
  
- (Пользователь) Используйте длинные и уникальные признаки конца (любая последовательность байт или символов), чтобы свести к минимуму возможность конфликта с фактическим строковым значением. Это можно выполнить с помощью параметров -t и -r.  

## <a name="examples"></a>Примеры

Этот раздел содержит следующие примеры.

A. Определение версии служебной программы **bcp**

Б. Копирование строк из таблицы в файл данных (с помощью доверительного соединения)

В. Копирование строк из таблицы в файл данных (в смешанном режиме проверки подлинности)

Г. Копирование данных из файла в таблицу

Д. Копирование отдельного столбца в файл данных

Е. Копирование отдельной строки в файл данных

Ж. Копирование данных из запроса в файл данных

З. Создание файлов форматирования

И. Использование файла форматирования для массового импорта данных c помощью программы **bcp**

К. Указание кодовой страницы

### <a name="example-test-conditions"></a>**Пример условий теста**

В примерах ниже используется образец базы данных `WideWorldImporters` для SQL Server (начиная с 2016) и База данных SQL Azure.  `WideWorldImporters` можно скачать отсюда: [https://github.com/Microsoft/sql-server-samples/releases/tag/wide-world-importers-v1.0](https://github.com/Microsoft/sql-server-samples/releases/tag/wide-world-importers-v1.0).  Синтаксис для восстановления образца базы данных см. в разделе [RESTORE (Transact-SQL)](../t-sql/statements/restore-statements-transact-sql.md) .  Если не указано иное, в этом примере предполагается, что используется проверка подлинности Windows и существует доверительное подключение к экземпляру сервера, на котором запускается команда **bcp** .  Каталог с именем `D:\BCP` будет использоваться во многих примерах.

Приведенный ниже скрипт создает пустую копию таблицы `WideWorldImporters.Warehouse.StockItemTransactions` , а затем добавляет ограничение первичного ключа.  Запустите следующий скрипт T-SQL в SQL Server Management Studio (SSMS):

```sql  
USE WideWorldImporters;  
GO  

SET NOCOUNT ON;

IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'Warehouse.StockItemTransactions_bcp')
BEGIN
    SELECT * INTO WideWorldImporters.Warehouse.StockItemTransactions_bcp
    FROM WideWorldImporters.Warehouse.StockItemTransactions  
    WHERE 1 = 2;  

    ALTER TABLE Warehouse.StockItemTransactions_bcp 
    ADD CONSTRAINT PK_Warehouse_StockItemTransactions_bcp PRIMARY KEY NONCLUSTERED 
    (StockItemTransactionID ASC);
END
```

> [!NOTE]
> Усеките таблицу `StockItemTransactions_bcp` по мере необходимости.
>
> TRUNCATE TABLE WideWorldImporters.Warehouse.StockItemTransactions_bcp;

### <a name="a--identify-bcp-utility-version"></a>A.  Определение версии служебной программы **bcp**

В командной строке введите следующую команду:

```cmd
bcp -v
```
  
### <a name="b-copying-table-rows-into-a-data-file-with-a-trusted-connection"></a>Б. Копирование строк из таблицы в файл данных (с помощью доверительного соединения)

В следующих примерах показано применение параметра **out** к таблице `WideWorldImporters.Warehouse.StockItemTransactions`.

- **Базовый** В этом примере создается файл данных с именем `StockItemTransactions_character.bcp`, и в него копируются данные таблицы в **символьном** формате.

  В командной строке введите следующую команду:

  ```cmd
  bcp WideWorldImporters.Warehouse.StockItemTransactions out D:\BCP\StockItemTransactions_character.bcp -c -T
  ```

- **Расширенный** В этом примере создается файл данных с именем `StockItemTransactions_native.bcp`, и в него копируются данные таблицы в **собственном** формате.  Пример также указывает максимальное количество синтаксических ошибок, файл ошибок и выходной файл.

    В командной строке введите следующую команду:

    ```cmd
    bcp WideWorldImporters.Warehouse.StockItemTransactions OUT D:\BCP\StockItemTransactions_native.bcp -m 1 -n -e D:\BCP\Error_out.log -o D:\BCP\Output_out.log -S -T
    ```

Просмотрите `Error_out.log` и `Output_out.log`.  `Error_out.log` должно быть пустым.  Сравните размеры файлов между `StockItemTransactions_character.bcp` и `StockItemTransactions_native.bcp`.

### <a name="c-copying-table-rows-into-a-data-file-with-mixed-mode-authentication"></a>В. Копирование строк из таблицы в файл данных (в смешанном режиме проверки подлинности)

В следующем примере показано применение параметра **out** к таблице `WideWorldImporters.Warehouse.StockItemTransactions` .  В этом примере создается файл данных с именем `StockItemTransactions_character.bcp` , и в него копируются данные таблицы в **символьном** формате.  
  
 В этом примере предполагается, что применяется смешанный режим проверки подлинности. Для указания идентификатора входа необходимо использовать параметр **-U** . Кроме того, за исключением случаев, когда выполняется соединение с экземпляром, не являющимся экземпляром [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] по умолчанию на локальном компьютере, нужно использовать параметр **-S** , чтобы указать системное имя и (при необходимости) имя экземпляра.  

В командной строке введите следующую команду: \(Система предложит ввести пароль.\)

```cmd
bcp WideWorldImporters.Warehouse.StockItemTransactions out D:\BCP\StockItemTransactions_character.bcp -c -U<login_id> -S<server_name\instance_name>
```

### <a name="d-copying-data-from-a-file-to-a-table"></a>Г. Копирование данных из файла в таблицу

В следующих примерах показано применение параметра **in** к таблице `WideWorldImporters.Warehouse.StockItemTransactions_bcp` с использованием созданных выше файлов.

- **Базовый** В этом примере используется ранее созданный файл данных `StockItemTransactions_character.bcp`.

  В командной строке введите следующую команду:

  ```cmd
  bcp WideWorldImporters.Warehouse.StockItemTransactions_bcp IN D:\BCP\StockItemTransactions_character.bcp -c -T
  ```

- **Расширенный** В этом примере используется ранее созданный файл данных `StockItemTransactions_native.bcp`.  Пример также использует указание **TABLOCK**, указывает размер пакета, максимальное количество синтаксических ошибок, файл ошибок и выходной файл.
  
В командной строке введите следующую команду:

```cmd
bcp WideWorldImporters.Warehouse.StockItemTransactions_bcp IN D:\BCP\StockItemTransactions_native.bcp -b 5000 -h "TABLOCK" -m 1 -n -e D:\BCP\Error_in.log -o D:\BCP\Output_in.log -S -T
```

  Просмотрите `Error_in.log` и `Output_in.log`.

### <a name="e-copying-a-specific-column-into-a-data-file"></a>Д. Копирование отдельного столбца в файл данных

Чтобы выполнить копирование конкретного столбца, можно использовать параметр **queryout** .  Следующий пример копирует в файл данных из таблицы `StockItemTransactionID` только столбец `Warehouse.StockItemTransactions` .
  
В командной строке введите следующую команду:

```cmd
bcp "SELECT StockItemTransactionID FROM WideWorldImporters.Warehouse.StockItemTransactions WITH (NOLOCK)" queryout D:\BCP\StockItemTransactionID_c.bcp -c -T
```

### <a name="f-copying-a-specific-row-into-a-data-file"></a>Е. Копирование отдельной строки в файл данных

Чтобы выполнить копирование конкретной строки, можно использовать параметр **queryout** . Следующий пример копирует только строку человека с именем `Amy Trefl` из таблицы `WideWorldImporters.Application.People` в файл данных `Amy_Trefl_c.bcp`.  Примечание. Параметр **-d** используется для идентификации базы данных.
  
В командной строке введите следующую команду:

```cmd
bcp "SELECT * from Application.People WHERE FullName = 'Amy Trefl'" queryout D:\BCP\Amy_Trefl_c.bcp -d WideWorldImporters -c -T
```

### <a name="g-copying-data-from-a-query-to-a-data-file"></a>Ж. Копирование данных из запроса в файл данных

Результирующий набор инструкции Transact-SQL копируется в файл данных с помощью параметра **queryout** .  Следующий пример копирует имена из таблицы `WideWorldImporters.Application.People` , упорядоченные по полному имени, в файл данных `People.txt` .  Примечание. Параметр **-t** используется для создания файла с разделителями-запятыми.

В командной строке введите следующую команду:

```cmd
bcp "SELECT FullName, PreferredName FROM WideWorldImporters.Application.People ORDER BY FullName" queryout D:\BCP\People.txt -t, -c -T
```

### <a name="h-creating-format-files"></a>З. Создание файлов форматирования

Следующий пример создает три разных файла форматирования для таблицы `Warehouse.StockItemTransactions` в базе данных `WideWorldImporters` .  Просмотрите содержимое каждого из созданных файлов.

В командной строке введите следующие команды:

```cmd
REM non-XML character format
bcp WideWorldImporters.Warehouse.StockItemTransactions format nul -f D:\BCP\StockItemTransactions_c.fmt -c -T 

REM non-XML native format
bcp WideWorldImporters.Warehouse.StockItemTransactions format nul -f D:\BCP\StockItemTransactions_n.fmt -n -T

REM XML character format
bcp WideWorldImporters.Warehouse.StockItemTransactions format nul -f D:\BCP\StockItemTransactions_c.xml -x -c -T
```

> [!NOTE]
> Для использования параметра **-x** необходима версия клиента **bcp** 9.0. Дополнительные сведения об использовании клиента **bcp** 9.0 см. в разделе "[Примечания](#remarks)".
  
 Дополнительные сведения см. в разделах [Файлы формата, отличные от XML &#40;SQL Server&#41;](../relational-databases/import-export/non-xml-format-files-sql-server.md) и [XML-файлы форматирования &#40;SQL Server&#41;](../relational-databases/import-export/xml-format-files-sql-server.md).
  
### <a name="i-using-a-format-file-to-bulk-import-with-bcp"></a>И. Использование файла форматирования для массового импорта данных c помощью программы bcp

Чтобы использовать ранее созданный файл форматирования при выполнении импорта данных в экземпляр [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], укажите параметр **-f** и параметр **in** .  Например, следующая команда выполняет массовое копирование содержимого файла данных `StockItemTransactions_character.bcp`в копию таблицы `Warehouse.StockItemTransactions_bcp` с помощью ранее созданного файла форматирования `StockItemTransactions_c.xml`.  Примечание. Параметр **-L** используется для импорта только первых 100 записей.

В командной строке введите следующую команду:

```cmd
bcp WideWorldImporters.Warehouse.StockItemTransactions_bcp in D:\BCP\StockItemTransactions_character.bcp -L 100 -f D:\BCP\StockItemTransactions_c.xml -T
```

> [!NOTE]
> Файлы форматирования используются в тех случаях, когда поля файла данных отличаются от столбцов таблицы, например: по количеству, порядку или типу данных. Дополнительные сведения см в разделе [Файлы форматирования для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/format-files-for-importing-or-exporting-data-sql-server.md).  

### <a name="j-specifying-a-code-page"></a>К. Указание кодовой страницы

В следующем фрагменте кода показан импорт bcp с указанием страницы кода 65001:

```cmd
bcp.exe MyTable in "D:\data.csv" -T -c -C 65001 -t , ...  
```

## <a name="additional-examples"></a>Дополнительные примеры

|Следующие разделы содержат примеры использования программы bcp: |
|---|
|Форматы данных для массового экспорта или импорта (SQL Server)<br />&emsp;&#9679;&emsp;[Использование собственного формата для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/use-native-format-to-import-or-export-data-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование символьного формата для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/use-character-format-to-import-or-export-data-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование собственного формата Юникода для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/use-unicode-native-format-to-import-or-export-data-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование символьного формата Юникода для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/use-unicode-character-format-to-import-or-export-data-sql-server.md)<br /><br />[Определение признаков конца поля и строки (SQL Server)](../relational-databases/import-export/specify-field-and-row-terminators-sql-server.md)<br /><br />[Сохранение значений NULL или использование значений по умолчанию при массовом импорте данных (SQL Server)](../relational-databases/import-export/keep-nulls-or-use-default-values-during-bulk-import-sql-server.md)<br /><br />[Сохранение значений идентификаторов при массовом импорте данных (SQL Server)](../relational-databases/import-export/keep-identity-values-when-bulk-importing-data-sql-server.md)<br /><br />Файлы форматирования для импорта или экспорта данных (SQL Server)<br />&emsp;&#9679;&emsp;[Создание файла форматирования (SQL Server)](../relational-databases/import-export/create-a-format-file-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование файла форматирования для массового импорта данных (SQL Server)](../relational-databases/import-export/use-a-format-file-to-bulk-import-data-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование файла форматирования для пропуска столбца таблицы (SQL Server)](../relational-databases/import-export/use-a-format-file-to-skip-a-table-column-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование файла форматирования для пропуска поля данных (SQL Server)](../relational-databases/import-export/use-a-format-file-to-skip-a-data-field-sql-server.md)<br />&emsp;&#9679;&emsp;[Использование файла форматирования для сопоставления столбцов таблицы с полями файла данных (SQL Server)](../relational-databases/import-export/use-a-format-file-to-map-table-columns-to-data-file-fields-sql-server.md)<br /><br />[Примеры массового импорта и экспорта XML-документов (SQL Server)](../relational-databases/import-export/examples-of-bulk-import-and-export-of-xml-documents-sql-server.md)<br /><p>  </p>|

## <a name="considerations-and-limitations"></a>Рекомендации и ограничения

- Служебная программа bcp имеет ограничение на отображение в сообщении об ошибке только 512 байт символов. Отображаются только первые 512 байт сообщения об ошибке.

## <a name="next-steps"></a>Дальнейшие действия

- [Подготовка данных к массовому экспорту или импорту (SQL Server)](../relational-databases/import-export/prepare-data-for-bulk-export-or-import-sql-server.md)
- [BULK INSERT (Transact-SQL)](../t-sql/statements/bulk-insert-transact-sql.md)
- [OPENROWSET (Transact-SQL)](../t-sql/functions/openrowset-transact-sql.md)
- [SET QUOTED_IDENTIFIER (Transact-SQL)](../t-sql/statements/set-quoted-identifier-transact-sql.md)
- [sp_configure (Transact-SQL)](../relational-databases/system-stored-procedures/sp-configure-transact-sql.md)
- [sp_tableoption (Transact-SQL)](../relational-databases/system-stored-procedures/sp-tableoption-transact-sql.md)
- [Файлы форматирования для импорта или экспорта данных (SQL Server)](../relational-databases/import-export/format-files-for-importing-or-exporting-data-sql-server.md)

[!INCLUDE[get-help-options](../includes/paragraph-content/get-help-options.md)]
