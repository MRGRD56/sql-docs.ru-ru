---
title: Загрузчик Command-Line dwloader
description: dwloader — это средство командной строки для параллельного хранилища данных (PDW), которое загружает строки таблицы в существующую таблицу.
author: mzaman1
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.custom: seo-dt-2019
ms.openlocfilehash: 3635aff3c3dad371c969acd3d72b2fb738748ecc
ms.sourcegitcommit: 3bd188e652102f3703812af53ba877cce94b44a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2020
ms.locfileid: "97489694"
---
# <a name="dwloader-command-line-loader-for-parallel-data-warehouse"></a>dwloader Command-Line загрузчик для параллельного хранилища данных
**dwloader** — это средство командной строки для параллельного хранилища данных (PDW), которое загружает строки таблицы в существующую таблицу. При загрузке строк можно добавить все строки в конец таблицы (*режим добавления* или *FastAppend*), добавить новые строки и обновить существующие строки (*режим Upsert*) или удалить все существующие строки перед загрузкой, а затем вставить все строки в пустую таблицу (*режим перезагрузки*).  
  
**Процесс загрузки данных**  
  
1.  Подготовьте исходные данные.  
  
    Используйте собственный процесс извлечения, преобразования и загрузки, чтобы создать исходные данные, которые вы хотите загрузить. Исходные данные должны быть отформатированы в соответствии со схемой целевой таблицы. Сохраните исходные данные в один или несколько текстовых файлов и скопируйте текстовые файлы в тот же каталог на сервере загрузки. Дополнительные сведения о сервере загрузки см. в разделе [Получение и настройка сервера загрузки](acquire-and-configure-loading-server.md) .  
  
2.  Подготовка параметров загрузки.  
  
    Определите, какие параметры загрузки будут использоваться. Сохранение параметров загрузки в файле конфигурации. Скопируйте файл конфигурации в локальное расположение на сервере загрузки. Параметры конфигурации **dwloader** описаны в этом разделе.  
  
3.  Подготовьте параметры сбоя загрузки.  
  
    Определите, каким способом **dwloader** будет выполнять обработку строк, которые не удалось загрузить. Для выполнения загрузки **dwloader** сначала загружает данные в промежуточную таблицу, а затем передает данные в целевую таблицу. Когда загрузчик загружает данные в промежуточную таблицу, он отслеживает количество строк, которые не удалось загрузить. Например, при неправильном форматировании строки не будут загружаться. Строки с ошибками копируются в файл отклонения. По умолчанию нагрузка прекращается после первого отклонения, если не указано другое пороговое значение отклонения.  
  
4.  Установите **dwloader**.  
  
    Установите dwloader на сервер загрузки, если он еще не установлен. 

<!-- MISSING LINK
    See [Install dwloader Command-Line Loader &#40;SQL Server PDW&#41;](install-dwloader-command-line-loader-sql-server-pdw.md). 
--> 
  
5.  Запустите **dwloader**.  
  
    Войдите на сервер загрузки и запустите исполняемый файл **dwloader.exe** с соответствующими параметрами командной строки.  
  
6.  Проверьте результаты.  
  
    Можно проверить файл строк с ошибками (указанный с помощью-R), чтобы узнать, не удалось ли загрузить какие-либо строки. Если этот файл пуст, все строки успешно загружены. **dwloader** является транзакционной, поэтому при сбое какого-либо шага (за исключением отклоненных строк) все шаги будут возвращены в исходное состояние.  
  
<!-- 
![Topic link icon](media/topic-link.gif "Topic_Link")[Syntax Conventions](syntax-conventions-sql-server-pdw.md)  
-->  


## <a name="syntax"></a>Синтаксис  
  
```  
dwloader.exe { -h }  
  
dwloader.exe   
    {  
        { -U login_name  -P password  }  
        | -W  
    }  
    [ -f parameter_file ]  
    [ -S target_appliance ]  
    { -T target_database_name . [ schema ] . table_name }   
    { -i source_data_location } [ <source_data_options> ]  
    { -R load_failure_file_name } [ <load_failure_options> ]  
    [ <loading_options> ]  
}  
  
<source_data_options> ::=  
{  
    [ -fh number_header_rows ]  
    [ < variable_length_column_options > | < fixed_width_column_options > ]  
    [ -D { mdy | myd | ymd | ydm | dmy | dym | custom_date_format } ]  
    [ -dt datetime_format_file ]  
}  
  
<variable_length_column_options> ::=  
{  
    [ -e character_encoding ]  
    -r row_delimiter   
    [ -s string_delimiter ]  
    -t field_delimiter   
}  
  
<fixed_width_column_options> ::=  
{  
    -w fixed_width_config_file   
    [ -e character_encoding ]   
    -r row_delimiter   
}  
  
<load_failure_options> ::=  
{  
    [ -rt { value | percentage } ]  
    [ -rv reject_value ]  
    [ -rs reject_sample_value ]  
}  
  
<loading_options> ::=  
{  
    [ -d staging_database_name ]  
    [ -M { append | fastappend | upsert -K merge_column [ ,...n ] | reload } ]  
    [ -b batchsize ]   
    [ -c ]  
    [ -E ]  
    [ -m ]  
    [ -N ]  
    [ -se ]
    [ -l ]   
}  
```  
  
## <a name="arguments"></a>Аргументы  
**-h**  
Отображает простую справочную информацию об использовании загрузчика. Справка отображается, только если не указаны другие параметры командной строки.  
  
**-U** *login_name*  
Допустимое имя входа SQL Server проверки подлинности с соответствующими разрешениями для выполнения загрузки.  
  
**-P** *пароль*  
Пароль для *Login_name* проверки подлинности SQL Server.  
  
**-W**  
Использовать проверку подлинности Windows. ( *Login_name* или *пароль* не требуются.) 

<!-- MISSING LINK
For information about configuring Windows Authentication, see [Security - Configure Domain Trusts](security-configure-domain-trusts.md).  
-->
  
**-f** *parameter_file_name*  
Вместо параметров командной строки используйте файл параметров *parameter_file_name*. *parameter_file_name* может содержать любой параметр командной строки, кроме *user_name* и *пароля*. Если параметр указан в командной строке и в файле параметров, то Командная строка переопределяет параметр File.  
  
Файл параметров содержит один параметр без **-** префикса в строке.  
  
Примеры:  
  
`rt=percentage`  
  
`rv=25`  
  
**-S** *target_appliance*  
Указывает устройство SQL Server PDW, которое будет принимать загруженные данные.  
  
*Для соединений Infiniband* *target_appliance* указывается как <Appliance-Name>-SQLCTL01. Чтобы настроить это именованное соединение, см. раздел [Настройка сетевых адаптеров Infiniband](configure-infiniband-network-adapters.md).  
  
Для подключений Ethernet *target_appliance* — это IP-адрес кластера управляющих узлов.  
  
Если параметр опущен, dwloader по умолчанию принимает значение, указанное при установке dwloader. 

<!-- MISSING LINK
For more information about this install option, see [Install dwloader Command-Line Loader](install-dwloader.md).  
-->
  
**-T** *target_database_name.* [*схема*]. *table_name*  
Имя из трех частей для целевой таблицы.  
  
**-I** *source_data_location*  
Расположение одного или нескольких исходных файлов для загрузки. Каждый исходный файл должен быть текстовым файлом или текстовым файлом, который сжат с помощью gzip. В каждый файл gzip можно сжать только один исходный файл.  
  
Чтобы отформатировать исходный файл, выполните следующие действия.  
  
-   Исходный файл должен быть отформатирован в соответствии с параметрами загрузки.  
  
-   Каждая строка в исходном файле содержит данные для одной строки таблицы. Исходные данные должны соответствовать схеме целевой таблицы. Порядок столбцов и типы данных также должны совпадать. Каждое поле в строке представляет столбец в целевой таблице.  
  
-   По умолчанию поля имеют переменную длину и разделяются разделителем. Чтобы указать тип разделителя, используйте параметры командной строки <variable_length_column_options>. Чтобы указать поля фиксированной длины, используйте параметры командной строки <fixed_width_column_options>.  
  
Чтобы указать расположение исходных данных, выполните следующие действия.  
  
-   Расположением исходных данных может быть сетевой путь или локальный путь к каталогу на сервере загрузки.  
  
-   Чтобы указать все файлы в каталоге, введите путь к каталогу, за которым следует подстановочный знак *.  Загрузчик не загружает файлы из подкаталогов, наявляющихся в расположении исходных данных. Загрузчик ошибок при наличии каталога в файле gzip.  
  
-   Чтобы указать некоторые файлы в каталоге, используйте сочетание символов и подстановочный знак *.  
  
Загрузка нескольких файлов с помощью одной команды:  
  
-   Все файлы должны находиться в одном каталоге.  
  
-   Файлы должны представлять собой все текстовые файлы, все файлы gzip или сочетание текстовых и gzip-файлов.  
  
-   Ни один из файлов не может содержать данные заголовка.  
  
-   Все файлы должны использовать один и тот же тип кодировки символов. См. параметр-e.  
  
-   Все файлы должны быть загружены в одну и ту же таблицу.  
  
-   Все файлы будут объединены и загружены, как если бы они были одним файлом, а отклоненные строки перейдут в один файл отклонения.  
  
Примеры:  
  
-   -i \\ \лоадсервер\лоадс\даили \\ *. gz  
  
-   -i \\ \лоадсервер\лоадс\даили \\ *. txt  
  
-   -i \\ \лоадсервер\лоадс\даили\мондай. *  
  
-   -i \\\loadserver\loads\daily\monday.txt  
  
-   -i \\ \лоадсервер\лоадс\даили\\*  
  
**-R** *load_failure_file_name*  
При возникновении ошибок загрузки **dwloader** сохраняет строку, которую не удалось загрузить, и описание ошибки в файле с именем *load_failure_file_name*. Если этот файл уже существует, dwloader перезапишет существующий файл. *load_failure_file_name* создается при возникновении первого сбоя. Если все строки успешно загружены, *load_failure_file_name* не создается.  
  
**-fh** *number_header_rows*  
Число строк (строк), которые должны быть пропущены в начале *source_data_file_name*. Значение по умолчанию равно 0.  
  
<variable_length_column_options>  
Параметры для *source_data_file_name* с столбцами переменной длины с разделителями-символами. По умолчанию *source_data_file_name* содержит символы ASCII в столбцах переменной длины.  
  
Для файлов ASCII значения NULL представлены путем последовательного добавления разделителей. Например, в файле с разделителями-каналом ("|") значение NULL обозначается "| |". В файле с разделителями-запятыми значение NULL обозначается символом ",,". Кроме того, необходимо указать параметр **-E** (--емптистрингаснулл). Дополнительные сведения о-E см. ниже.  
  
**-e** *character_encoding*  
Задает тип кодировки символов для загрузки данных из файла данных. Параметры: ASCII (по умолчанию), UTF8, UTF16 или UTF16BE, где UTF16 имеет прямой порядок байтов, а UTF16BE — обратный порядок байтов. В этих параметрах регистр не учитывается.  
  
**-t** *field_delimiter*  
Разделитель для каждого поля (столбца) в строке. Разделитель полей — это один или несколько из этих escape-символов ASCII или шестнадцатеричных значений ASCII.  
  
|Имя|Escape-символ|Шестнадцатеричный символ|  
|--------|--------------------|-----------------|  
|Вкладка|\t|0x09|  
|Возврат каретки (CR)|\r|0x0D|  
|Перевод строки (LF)|\n|0x0A|  
|CRLF|\r\n|0x0d0x0a|  
|Запятая|','|0x2c|  
|Двойная кавычка|\\"|0x22|  
|Одинарная кавычка|\\'|0x27|  
  
Чтобы указать символ вертикальной черты в командной строке, заключите его в двойные кавычки "|". Это позволит избежать невозможности интерпретации синтаксическим анализатором командной строки. Другие символы заключаются в одинарные кавычки.  
  
Примеры:  
  
-t "|"  
  
-t ' '  
  
-t 0x0A  
  
-t \t  
  
-t ' ~ | ~ '  
  
**-r** *row_delimiter*  
Разделитель для каждой строки исходного файла данных. Разделитель строк — это одно или несколько значений ASCII.  
  
Чтобы задать символ возврата каретки (CR), перевода строки (LF) или символа табуляции в качестве разделителя, можно использовать escape-символы (\r, \n, \t) или их шестнадцатеричные значения (0x, 0D, 09). Чтобы указать другие специальные символы в качестве разделителей, используйте их шестнадцатеричное значение.  
  
Примеры CR + LF:  
  
-r \r\n  
  
-r 0x0d0x0a  
  
Примеры CR:  
  
-r \r  
  
-r 0x0D  
  
Примеры LF:  
  
-r \n  
  
-r 0x0A  
  
Для UNIX требуется LF. Для Windows требуется CR.  
  
**-s** *string_delimiter*  
Разделитель для поля строкового типа данных входного файла с разделителями текста. Разделитель строк — это одно или несколько значений ASCII.  Его можно указать как символ (например,-s *) или как шестнадцатеричное значение (например,-s 0x22 для двойной кавычки).  
  
Примеры:  
  
#d0  
  
-s 0x22  
  
< fixed_width_column_options>  
Параметры для исходного файла данных с столбцами фиксированной длины. По умолчанию *source_data_file_name* содержит символы ASCII в столбцах переменной длины.  
  
Столбцы фиксированной ширины не поддерживаются, если-e — UTF8.  
  
**-w** *fixed_width_config_file*  
Путь и имя файла конфигурации, в котором указывается количество символов в каждом столбце. Необходимо указать каждое поле.  
  
Этот файл должен находиться на сервере загрузки. Путь может быть указан в формате UNC, относительного или абсолютного пути. Каждая строка в *fixed_width_config_file* содержит имя одного столбца и число символов для этого столбца. Существует одна строка для каждого столбца, как показано ниже, и порядок в файле должен соответствовать порядку в целевой таблице:  
  
*column_name* = *num_chars*  
  
*column_name* = *num_chars*  
  
Пример файла конфигурации с фиксированной шириной:  
  
Салескоде = 3  
  
Салесид = 10  
  
Примеры строк в *source_data_file_name*:  
  
230Shirts0056  
  
320Towels1356  
  
В предыдущем примере первая загруженная строка будет содержать Салескоде = ' 230 ' и Салесид = ' Shirts0056 '. Вторая Загруженная строка будет содержать Салескоде = ' 320 ' и Салеид = ' Towels1356 '.  
  
Дополнительные сведения об обработке начальных и конечных пробелов, а также преобразовании типов данных в режиме фиксированной ширины см. в разделе [правила преобразования типов данных для dwloader](dwloader-data-type-conversion-rules.md).  
  
**-e** *character_encoding*  
Задает тип кодировки символов для загрузки данных из файла данных. Параметры: ASCII (по умолчанию), UTF8, UTF16 или UTF16BE, где UTF16 имеет прямой порядок байтов, а UTF16BE — обратный порядок байтов. В этих параметрах регистр не учитывается.  
  
Столбцы фиксированной ширины не поддерживаются, если-e — UTF8.  
  
**-r** *row_delimiter*  
Разделитель для каждой строки исходного файла данных. Разделитель строк — это одно или несколько значений ASCII.  
  
Чтобы задать символ возврата каретки (CR), перевода строки (LF) или символа табуляции в качестве разделителя, можно использовать escape-символы (\r, \n, \t) или их шестнадцатеричные значения (0x, 0D, 09). Чтобы указать другие специальные символы в качестве разделителей, используйте их шестнадцатеричное значение.  
  
Примеры CR + LF:  
  
-r \r\n  
  
-r 0x0d0x0a  
  
Примеры CR:  
  
-r \r  
  
-r 0x0D  
  
Примеры LF:  
  
-r \n  
  
-r 0x0A  
  
Для UNIX требуется LF. Для Windows требуется CR.  
  
**-D** { **ГМД** \| гдм \| MDY \| МГД \| DMY \| ДГМ \| *custom_date_format* }  
Указывает порядок месяцев (m), дня (d) и года (y) для всех полей даты и времени во входном файле. Порядок по умолчанию — ГМД. Чтобы указать несколько форматов порядка для одного и того же исходного файла, используйте параметр-DT.  
  
ГМД \| DMY  
ГДМ и DMY допускают одни и те же форматы ввода. Оба параметра позволяют использовать год в начале или в конце даты. Например, для форматов даты **ГДМ** и **DMY** в входном файле может быть 2013-02-03 или 02-03-2013.  
  
ГДМ  
Входные данные, отформатированные как ГДМ, можно загружать в столбцы типа данных DateTime и smalldatetime. Невозможно загрузить значения ГДМ в столбец типа данных datetime2, Date или DateTimeOffset.  
  
mdy  
MDY допускает \<month> \<space> \<day> \<comma> \<year> .  
  
Примеры входных данных MDY для 1 января 1975:  
  
-   1 января 1975 г.  
  
-   01 января 75 г.  
  
-   Янв/1/75  
  
-   01011975  
  
мгд  
Примеры входного файла 4 марта 2010 г.: 03-2010-04, 3/2010/4  
  
дгм  
Примеры входного файла 4 марта 2010:04-2010-03, 4/2010/3  
  
*custom_date_format*  
*custom_date_format* является пользовательским форматом даты (например, mm/дд/гггг) и включенным только в целях обратной совместимости. dwloader не обеспечивает применение настраиваемого формата даты. Вместо этого при указании настраиваемого формата даты **dwloader** преобразует его в соответствующий параметр ГМД, ГДМ, mdy, МГД, ДГМ или DMY.  
  
Например, если указать-D мм/дд/гггг, dwloader ожидает, чтобы все входные данные даты упорядочивались в месяц сначала, затем день, а затем год (MDY). Он не требует 2 месяцев, 2-значных дней и 4-разрядных года, как указано в настраиваемом формате даты. Ниже приведены некоторые примеры способов форматирования дат во входном файле, если формат даты — D мм/дд/гггг: 01/02/2013, янв. 02.2013, 1/2/2013  
  
Более подробные сведения о форматировании см. в разделе [правила преобразования типов данных для dwloader](dwloader-data-type-conversion-rules.md).  
  
**-dt** *datetime_format_file*  
Каждый формат DateTime указывается в файле с именем *datetime_format_file*. В отличие от параметров командной строки, параметры файлов, содержащие пробелы, не должны заключаться в двойные кавычки. Нельзя изменить формат даты и времени при загрузке данных. Исходный файл данных и соответствующий ему столбец в целевой таблице должны иметь одинаковый формат.  
  
Каждая строка содержит имя столбца в целевой таблице и его формат даты и времени.  
  
Примеры:  
  
`LastReceiptDate=ymd`  
  
`ModifiedDate=dym`  
  
**-d** *staging_database_name*  
Имя базы данных, которая будет содержать промежуточную таблицу. По умолчанию используется база данных, указанная с помощью параметра-T, который является базой данных для целевой таблицы. Дополнительные сведения об использовании промежуточной базы данных см. [в разделе Создание промежуточной базы данных](staging-database.md).  
  
**-M** *load_mode_option*  
Указывает, следует ли добавлять, Upsert или перезагружать данные. Режимом по умолчанию является Append.  
  
append  
Загрузчик вставляет строки в конец существующих строк в целевой таблице.  
  
FastAppend  
Загрузчик непосредственно вставляет строки, не используя временную таблицу, в конец существующих строк в целевой таблице. для FastAppend требуется параметр Multi-Transaction (-m). Невозможно указать промежуточную базу данных при использовании FastAppend. Откат с помощью FastAppend отсутствует, что означает, что восстановление после сбоя или аварийной нагрузки должно обрабатываться собственным процессом загрузки.  
  
Вставка **-K**  *merge_column* [,...*n* ]    
Загрузчик использует инструкцию SQL Server Merge для обновления существующих строк и вставки новых строк.  
  
Параметр-K указывает столбец или столбцы, по которым будет основываться слияние. Эти столбцы формируют ключ слияния, который должен представлять уникальную строку. Если в целевой таблице существует ключ слияния, строка обновляется. Если в целевой таблице отсутствует ключ слияния, строка добавляется.  
  
Для таблиц, распределенных по хэшу, ключ слияния должен включать столбец распределения.  
  
Для реплицированных таблиц ключ слияния является сочетанием одного или нескольких столбцов. Эти столбцы указываются в соответствии с потребностями приложения.  
  
Несколько столбцов должны быть разделены запятыми без пробелов или заключаться в одинарные кавычки.  
  
Если две строки в исходной таблице имеют совпадающие значения ключей слияния, их соответствующие строки должны быть идентичными.  
  
перезагрузить  
Загрузчик Усекает целевую таблицу перед вставкой исходных данных.  
  
**-b** *BatchSize*  
Рекомендуется использовать только служба поддержки Майкрософт, *BatchSize* — это SQL Serverный размер пакета для копирования, выполняемого DMS в SQL Server экземпляров на этих узлах.  Если указан параметр *BatchSize* , SQL Server PDW будет переопределять размер нагрузки пакета, который вычисляется динамически для каждой нагрузки.  
  
Начиная с SQL Server 2012 PDW, узел управления динамически выдает размер пакета для каждой нагрузки по умолчанию. Автоматическое вычисление основано на нескольких параметрах, таких как размер памяти, тип целевой таблицы, схема целевой таблицы, тип загрузки, размер файла и класс ресурсов пользователя.  
  
Например, если режимом загрузки является FASTAPPEND и в таблице есть кластеризованный индекс columnstore, SQL Server PDW будет пытаться использовать размер пакета 1 048 576, чтобы групп строк закрылся и загрузился непосредственно в columnstore без использования разностного хранилища. Если память не допускает размер пакета 1 048 576, dwloader выберет меньше BatchSize.  
  
Если тип нагрузки — FASTAPPEND, *BatchSize* применяется для загрузки данных в таблицу, в противном случае *BatchSize* применяется для загрузки данных в промежуточную таблицу.  
  
<reject_options>  
Указывает параметры для определения количества сбоев при загрузке, которые может разрешить загрузчик. Если сбои при загрузке превышают пороговое значение, загрузчик остановится и не зафиксирует какие бы то ни было строки.  
  
**-RT** { **значение** | процент}  
Указывает, является ли параметр-*reject_value* в аргументе **-RV** *reject_value* строковым числом строк (значений) или частотой сбоев (в процентах). Значение по умолчанию — Value.  
  
Параметр «процент» — это вычисление в реальном времени, которое выполняется с интервалами в соответствии с параметром-RS.  
  
Например, если загрузчик пытается загрузить 100 строк и 25 сбоев, а 75 — успешно, то частота сбоев составляет 25%.  
  
**-rv** *reject_value*  
Указывает число или процент отклонений строк, которые должны быть разрешены перед приостановкой загрузки. Параметр **-RT** определяет, относится ли *reject_value* к числу строк или проценту строк.  
  
Значение по умолчанию *reject_value* равно 0.  
  
При использовании со значением-RT Загрузчик останавливает загрузку, если число отклоненных строк превышает reject_value.  
  
При использовании с-RT в процентах загрузчик рассчитывает процент с интервалами (параметр-RS). Таким образом, процент строк со сбоями может превысить *reject_value*.  
  
**-rs** *reject_sample_size*  
Используется с `-rt percentage` параметром для указания инкрементных процентных проверок. Например, если reject_sample_size равен 1000, загрузчик вычислит процент неудачных строк после попытки загрузить 1000 строк. Он повторно вычисляет процент невыполненных строк после попытки загрузки каждой дополнительной 1000 строки.  
  
**-c**  
Удаляет символы пробела слева и справа от полей char, nchar, varchar и nvarchar. Преобразует каждое поле, содержащее только символы пробела, в пустую строку.  
  
Примеры:  
  
"" усекается до ""  
  
"ABC" усекается до "ABC"  
  
Если параметр-c используется вместе с-E, то сначала выполняется операция-E. Поля, содержащие только символы пробелов, преобразуются в пустые строки, а не в NULL.  
  
**-E**  
Преобразование пустых строк в значение NULL. По умолчанию эти преобразования не выполняются.  
  
**-m**  
Используйте режим с несколькими транзакциями для второго этапа загрузки; при загрузке данных из промежуточной таблицы в распределенную таблицу.  
  
При использовании **-m** SQL Server PDW выполняет и фиксирует нагрузку параллельно. Это работает гораздо быстрее, чем режим загрузки по умолчанию, но не является типобезопасным.  
  
Без **-m** SQL Server PDW выполняет и фиксирует последовательные нагрузки между распределениями в пределах каждого расчетного узла и параллельно между этими узлами. Этот метод медленнее режима с несколькими транзакциями, но является типобезопасным.  
  
параметр **-m** является необязательным для *добавления*, *перезагрузки* и *Upsert*.  
  
для FastAppend требуется **-m** .  
  
параметр **-m** не может использоваться с реплицированными таблицами.  
  
**-m** применяется только к второй фазе загрузки. Он не применяется к этапу первой загрузки; Загрузка данных в промежуточную таблицу.  
  
Откат в режиме с несколькими транзакциями не выполняется, что означает, что восстановление после сбоя или аварийной нагрузки должно быть обработано собственным процессом загрузки.  
  
Рекомендуется использовать параметр **-m** только при загрузке в пустую таблицу, чтобы можно было выполнить восстановление без потери данных. Чтобы выполнить восстановление после сбоя загрузки: удалите целевую таблицу, устраните проблему загрузки, повторно создайте целевую таблицу и снова запустите загрузку.  
  
**-N**  
Убедитесь, что целевое устройство имеет действительный сертификат SQL Server PDW из доверенного центра сертификации. Используйте этот параметр, чтобы гарантировать, что данные не перехватывается злоумышленником и не отправляются в несанкционированный доступ. Сертификат уже должен быть установлен на устройстве. Единственный поддерживаемый способ установки сертификата — чтобы Администратор устройства установил его с помощью средства Configuration Manager. Если вы не уверены, установлен ли на устройстве доверенный сертификат, обратитесь к администратору устройства.  
  
**-SE**  
Пропуск загрузки пустых файлов. При этом также пропускается распаковка пустых файлов gzip.

**-l**  
Доступно в CU 7.4 Update, указывает максимальную длину строки (в байтах), которую можно загрузить. Допустимые значения — целые числа в диапазоне от 32768 до 33554432. Используется только при необходимости загрузки больших строк (больше, чем 32 КБ), так как в этом случае на клиенте и сервере выделяется больше памяти.
  
## <a name="return-code-values"></a>Значения кода возврата  
0 (успешное завершение) или другое целочисленное значение (сбой)  
  
В командном окне или в пакетном файле используйте `errorlevel` для отображения кода возврата. Пример:  
  
```  
dwloader  
echo ReturnCode=%errorlevel%  
if not %errorlevel%==0 echo Fail  
if %errorlevel%==0 echo Success  
```  
  
При использовании PowerShell используйте `$LastExitCode` .  
  
## <a name="permissions"></a>Разрешения  
Требует наличия разрешения на загрузку и соответствующих разрешений (вставки, обновления, удаления) в целевой таблице. Требуется разрешение CREATE (для создания временной таблицы) в промежуточной базе данных. Если промежуточная база данных не используется, то для целевой базы данных требуется разрешение CREATE. 

<!-- MISSING LINK
For more information, see [Grant permissions to load data](grant-permissions-to-load-data.md).  
-->
  
## <a name="general-remarks"></a>Общие замечания  
Сведения о преобразованиях типов данных при загрузке с помощью dwloader см. в разделе [правила преобразования типов данных для dwloader](dwloader-data-type-conversion-rules.md).  
  
Если параметр содержит один или несколько пробелов, заключите параметр в двойные кавычки.  
  
Загрузчик следует запустить из своего расположения установки. Исполняемый файл dwloader предварительно устанавливается вместе с устройством и находится в каталоге C:\Program Files\Microsoft SQL Server Data Варехаусе\двлоадер.  
  
Можно переопределить параметр, указанный в файле параметров (параметр-f), указав его в качестве параметра командной строки.  
  
Одновременно можно запустить несколько экземпляров загрузчика. Максимальное число экземпляров загрузчика предварительно настроено и не может быть изменено. 

<!-- MISSING LINK
For the maximum number of loads per appliance, see [Minimum and Maximum Values](minimum-maximum-values.md)  
-->
  
Загруженные данные могут потребовать больше или меньше места на устройстве, чем в исходном расположении. Вы можете выполнять тестовые импорты с подмножествами данных для оценки использования диска.  
  
Несмотря на то, что **dwloader** является процессом транзакции и постепенно выполняет откат в случае сбоя, он не может быть выполнен заново после успешного выполнения групповой загрузки. Чтобы отменить активный процесс **dwloader** , введите Ctrl + C.  
  
## <a name="limitations-and-restrictions"></a>Ограничения  
Общий размер всех нагрузок, выполняемых одновременно, должен быть меньше, чем LOG_SIZE для базы данных, и мы рекомендуем общий размер всех параллельных нагрузок менее 50% LOG_SIZE. Для достижения этого ограничения размера можно разделить большие нагрузки на несколько пакетов. Дополнительные сведения о LOG_SIZE см. в разделе [Создание базы данных](../t-sql/statements/create-database-transact-sql.md?view=aps-pdw-2016&preserve-view=true) .  
  
При загрузке нескольких файлов с одной командой load все отклоненные строки записываются в один и тот же файл отклонения. Файл отклонения не показывает, какой входной файл содержит каждую отклоненную строку.  
  
Пустая строка не должна использоваться в качестве разделителя. Если в качестве разделителя строк используется пустая строка, загрузка завершится ошибкой. При использовании в качестве разделителя столбцов при загрузке игнорируется разделитель и по умолчанию используется "|" в качестве разделителя столбцов. При использовании в качестве разделителя строк пустая строка игнорируется и применяется поведение по умолчанию.  
  
## <a name="locking-behavior"></a>Режим блокировки  
поведение блокировки **dwloader** зависит от *load_mode_option*.  
  
-   **append** – Append является рекомендуемым и наиболее распространенным параметром. Append загружает данные в промежуточную таблицу. Блокировка подробно описана ниже.  
  
-   **Быстрое добавление** — быстрое добавление в последнюю таблицу, принимающую блокировку таблицы ексклусивеупдате, и является единственным режимом, в котором не используется промежуточная таблица.  
  
-   **Перезагрузка** . Перезагрузка загружает данные в промежуточную таблицу и требует монопольной блокировки для промежуточной таблицы и последней таблицы. Перезагрузка не рекомендуется для параллельных операций.  
  
-   **Upsert** -Upsert загружает данные в промежуточную таблицу, а затем выполняет операцию слияния из промежуточной таблицы в последнюю таблицу. Upsert не требует монопольных блокировок в конечной таблице. При использовании Upsert производительность может отличаться. Проверьте поведение в вашей среде.  
  
### <a name="locking-behavior"></a>Режим блокировки  
**Блокировка режима добавления**  
  
Операция Append может выполняться в многотранзакционном режиме (с помощью аргумента-m), но не является защищенной транзакцией. Поэтому в качестве транзакционной операции (без использования аргумента-m) следует использовать операцию Append. К сожалению, во время последней операции вставки и выбора Транзакционный режим в настоящее время составляет примерно шесть раз медленнее, чем многотранзакционный режим.  
  
Режим добавления загружает данные в два этапа. Первый этап. загружает данные из исходного файла в промежуточную таблицу параллельно (может произойти фрагментация). Второй этап загружает данные из промежуточной таблицы в последнюю таблицу. Второй этап выполняет **вставку в... Выберите с помощью операции (TABLOCK)** . В следующей таблице показано поведение блокировки в конечной таблице и ведение журнала при использовании режима Append:  
  
|Тип таблицы|Множественная транзакция<br />Mode (-m)|Таблица пуста|Поддерживается параллелизм|Logging|  
|--------------|-----------------------------------|------------------|-------------------------|-----------|  
|Куча|Да|Да|Да|Небольшие|  
|Куча|Да|Нет|Да|Небольшие|  
|Куча|Нет|Да|Нет|Небольшие|  
|Куча|Нет|Нет|Нет|Небольшие|  
|CL|Да|Да|Нет|Небольшие|  
|CL|Да|Нет|Да|Полное|  
|CL|Нет|Да|Нет|Небольшие|  
|CL|Нет|Нет|Да|Полное|  
  
В приведенной выше таблице показано, как **dwloader** с помощью загрузки в кучу или таблицу кластеризованного индекса (CI) с флагом Multi-транзактное или без него и загрузкой в пустую таблицу или непустую таблицу. Режим блокировки и ведения журнала для каждого такого сочетания нагрузки отображается в таблице. Например, при загрузке (2-го) этапа с режимом добавления в кластеризованный индекс без множественного транзакционного режима и в пустую таблицу PDW создает монопольную блокировку для таблицы, и ведение журнала является минимальным. Это означает, что клиент не сможет загрузить (2) этап и запрос одновременно в пустую таблицу. Однако при загрузке с одной и той же конфигурацией в непустую таблицу PDW не будет выдавать монопольную блокировку на таблицу и возможность параллелизма. К сожалению, выполняется полное ведение журнала, что приводит к снижению процесса.  
  
## <a name="examples"></a>Примеры  
  
### <a name="a-simple-dwloader-example"></a>A. Пример простого dwloader  
В следующем примере показана Инициация запуска **загрузчика** только с выбранными необходимыми параметрами. Другие параметры берутся из глобального файла конфигурации *loadparamfile.txt*.  
  
Пример использования проверки подлинности SQL Server.  
  
```  
--Load over Ethernet  
dwloader.exe -S 10.192.63.148 -U mylogin -P 123jkl -f /configfiles/loadparamfile.txt  
  
--Load over InfiniBand to appliance named MyPDW  
dwloader.exe -S MyPDW-SQLCTL01 -U mylogin -P 123jkl -f /configfiles/loadparamfile.txt  
```  
  
Тот же пример, использующий проверку подлинности Windows.  
  
```  
--Load over Ethernet  
dwloader.exe -S 10.192.63.148 -W -f /configfiles/loadparamfile.txt  
  
--Load over InfiniBand to appliance named MyPDW  
dwloader.exe -S MyPDW-SQLCTL01 -W -f /configfiles/loadparamfile.txt  
```  
  
Пример использования аргументов для исходного файла и файла ошибок.  
  
```  
--Load over Ethernet  
dwloader.exe -U mylogin -P 123jkl -S 10.192.63.148  -i C:\SQLData\AWDimEmployees.csv -T AdventureWorksPDW2012.dbo.DimEmployees -R C:\SQLData\LoadErrors  
```  
  
### <a name="b-load-data-into-an-adventureworks-table"></a>Б. Загрузка данных в таблицу AdventureWorks  
Следующий пример является частью пакетного скрипта, который загружает данные в **AdventureWorksPDW2012**.  Чтобы просмотреть полный скрипт, откройте файл aw_create.bat, который поставляется с пакетом установки **AdventureWorksPDW2012** . 

<!-- Missing link
For more information, see [Install AdventureWorksPDW2012](install-adventureworkspdw2012.md).  
-->

Следующий фрагмент скрипта использует dwloader для загрузки данных в таблицы DimAccount и DimCurrency. Этот сценарий использует адрес Ethernet. Если бы он использовал InfiniBand, сервер будет *<appliance_name>* `-SQLCTL01` .  
  
```  
set server=10.193.63.134  
set user=<MyUser>  
set password=<MyPassword>  
  
set schema=AdventureWorksPDW2012.dbo  
set load="C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe"  
set mode=reload  
  
--Loads data into the AdventureWorksPDW2012.dbo.DimAccount table  
--Source data is stored in the file DimAccount.txt,   
--which is in the current directory.  
  
set t1=DimAccount  
%load% -S %server% -E -M %mode% -e Utf16 -i .\%t1%.txt -T %schema%.%t1% -R %t1%.bad -t "|" -r \r\n -U %user% -P %password%   
  
--Loads data from the DimCurrency.txt file into  
--AdventureWorksPDW2012.dbo.DimCurrency  
set t1=DimCurrency  
%load% -S %server% -E -M %mode% -e Utf16 -i .\%t1%.txt -T %schema%.%t1% -R %t1%.bad -t "|" -r \r\n -U %user% -P %password%  
```  
  
Ниже приведена инструкция DDL для таблицы DimAccount.  
  
```  
CREATE TABLE DimAccount(  
AccountKey int NOT NULL,  
ParentAccountKey int,  
AccountCodeAlternateKey int,  
ParentAccountCodeAlternateKey int,  
AccountDescription nvarchar(50),  
AccountType nvarchar(50),  
Operator nvarchar(50),  
CustomMembers nvarchar(300),  
ValueType nvarchar(50),  
CustomMemberOptions nvarchar(200))  
with (CLUSTERED INDEX(AccountKey),  
DISTRIBUTION = REPLICATE);  
```  
  
Ниже приведен пример файла данных DimAccount.txt, содержащего данные для загрузки в таблицу DimAccount.  
  
```  
--Sample of data in the DimAccount.txt load file.  
  
1||1||Balance Sheet||~||Currency|  
2|1|10|1|Assets|Assets|+||Currency|  
3|2|110|10|Current Assets|Assets|+||Currency|  
4|3|1110|110|Cash|Assets|+||Currency|  
5|3|1120|110|Receivables|Assets|+||Currency|  
6|5|1130|1120|Trade Receivables|Assets|+||Currency|  
7|5|1140|1120|Other Receivables|Assets|+||Currency|  
8|3|1150|110|Allowance for Bad Debt|Assets|+||Currency|  
9|3|1160|110|Inventory|Assets|+||Currency|  
10|9|1162|1160|Raw Materials|Assets|+||Currency|  
11|9|1164|1160|Work in Process|Assets|+||Currency|  
12|9|1166|1160|Finished Goods|Assets|+||Currency|  
13|3|1170|110|Deferred Taxes|Assets|+||Currency|  
```  
  
### <a name="c-load-data-from-the-command-line"></a>В. Загрузка данных из командной строки  
Сценарий в примере б можно заменить, введя все параметры в командной строке, как показано в следующем примере.  
  
```  
C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe -S <Control node IP> -E -M reload -e UTF16 -i .\DimAccount.txt -T AdventureWorksPDW2012.dbo.DimAccount -R DimAccount.bad -t "|" -r \r\n -U <login> -P <password>  
```  
  
Описание параметров командной строки:  
  
-   *C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe* — это установленное расположение dwloader.exe.  
  
-   За *-S* следует IP-адрес управляющего узла.  
  
-   *-E* указывает загрузить пустые строки как null.  
  
-   *-M перезагрузка* указывает на усечение целевой таблицы перед вставкой исходных данных.  
  
-   *-e UTF16* указывает, что исходный файл использует тип кодировки с прямым порядком байтов.  
  
-   *-i .\DimAccount.txt* указывает, что данные находятся в файле с именем DimAccount.txt, который существует в текущем каталоге.  
  
-   *-T AdventureWorksPDW2012. dbo. DimAccount* указывает 3-компонентное имя таблицы для получения данных.  
  
-   *-R DimAccount. Bad* указывает, что строки, которые не удается загрузить, будут записаны в файл с именем DimAccount. Bad.  
  
-   *-t "|"* Указывает, что поля во входном файле, DimAccount.txt, разделены символом вертикальной черты.  
  
-   *-r \r\n* указывает, что каждая строка в DimAccount.txt заканчивается символом возврата каретки и символа перевода строки.  
  
-   *-U <login_name>-P <password>* Указывает имя входа и пароль для имени входа, обладающего разрешениями на выполнение загрузки.  
  

<!-- MISSING LINK

## See Also  
[Common Metadata Query Examples](metadata-query-examples.md)  

-->
