---
title: Настройка распределения по уровням HDFS
titleSuffix: SQL Server big data clusters
description: В этой статье описывается настройка распределения по уровням HDFS для подключения внешней файловой системы Azure Data Lake Storage к HDFS в кластере больших данных SQL Server 2019.
author: nelgson
ms.author: negust
ms.reviewer: mikeray
ms.date: 08/21/2019
ms.topic: conceptual
ms.prod: sql
ms.technology: big-data-cluster
ms.openlocfilehash: 3c95bb10dbd063c56029a01b5a828f80eb5ba4d3
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100046714"
---
# <a name="configure-hdfs-tiering-on-big-data-clusters-2019"></a>Настройка распределения по уровням HDFS[!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)]

[!INCLUDE[SQL Server 2019](../includes/applies-to-version/sqlserver2019.md)]

Распределение по уровням HDFS дает возможность подключить внешнюю файловую систему, совместимую с HDFS, к HDFS. В этой статье описывается настройка распределения по уровням HDFS для Кластеров больших данных SQL Server. В настоящее время мы поддерживаем подключение к Azure Data Lake Storage 2-го поколения и Amazon S3. 

## <a name="hdfs-tiering-overview"></a>Общие сведения о распределении по уровням HDFS

Благодаря распределению по уровням приложения могут легко получать доступ к данным в различных внешних хранилищах так, как будто данные находятся в локальной системе HDFS. Подключение — это операция с метаданными, предполагающая копирование метаданных, описывающих пространство имен во внешней файловой системе, в локальную систему HDFS. Метаданные включают в себя сведения о внешних каталогах и файлах, а также их разрешения и списки управления доступом. Соответствующие данные копируются по требованию, когда к ним осуществляется доступ, например с помощью запроса. К данным во внешней файловой системе теперь можно обращаться из кластера больших данных SQL Server. Вы можете выполнять задания Spark и запросы SQL к этим данным так же, как к любым локальным данным, хранящимся в системе HDFS в кластере.

В этом семиминутном видео представлен обзор уровней HDFS:

> [!VIDEO https://channel9.msdn.com/Shows/Data-Exposed/Unify-your-data-lakes-with-HDFS-tiering/player?WT.mc_id=dataexposed-c9-niner]


### <a name="caching"></a>Caching
В настоящее время 1 % общего объема хранилища HDFS по умолчанию резервируется для кэширования подключенных данных. Кэширование настраивается глобально для всех подключенных ресурсов.

> [!NOTE]
> Распределение по уровням HDFS — это функция, разработанная корпорацией Майкрософт. Ее более ранняя версия была выпущена в составе дистрибутива Apache Hadoop 3.1. Подробные сведения см. на странице [https://issues.apache.org/jira/browse/HDFS-9806](https://issues.apache.org/jira/browse/HDFS-9806).

В следующих разделах приводится пример настройки распределения по уровням HDFS для источника данных Azure Data Lake Storage 2-го поколения.

## <a name="refresh"></a>Обновить

Распределение по уровням HDFS поддерживает обновление. Обновите существующий подключенный ресурс, чтобы получить последний моментальный снимок удаленных данных.

## <a name="prerequisites"></a>Предварительные требования

- [Развернутый кластер больших данных](deployment-guidance.md)
- [Средства работы с большими данными](deploy-big-data-tools.md)
  - **azdata**
  - **kubectl**

## <a name="mounting-instructions"></a>Инструкции по подключению

Мы поддерживаем подключение к Azure Data Lake Storage 2-го поколения и Amazon S3. Инструкции по подключению для этих типов хранилища см. в следующих статьях:

- [Подключение ADLS 2-го поколения для распределения по уровням HDFS в кластере больших данных](hdfs-tiering-mount-adlsgen2.md)
- [Подключение S3 для распределения по уровням HDFS в кластере больших данных](hdfs-tiering-mount-s3.md)

## <a name="known-issues-and-limitations"></a><a id="issues"></a> Известные проблемы и ограничения

Ниже перечислены известные проблемы и текущие ограничения при использовании распределения по уровням HDFS в [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)].

- Если подключенный ресурс долго остается в состоянии `CREATING`, скорее всего, произошел сбой. В этом случае отмените команду и при необходимости удалите подключенный ресурс. Перед повторной попыткой проверьте правильность параметров и учетных данных.

- Подключенные ресурсы нельзя создавать в существующих каталогах.

- Подключенные ресурсы нельзя создавать в существующих подключенных ресурсах.

- Если какие-либо из предков точки подключения не существуют, они будут созданы с разрешениями по умолчанию r-xr-xr-x (555).

- Создание подключения может потребовать некоторого времени в зависимости от количества и размера подключаемых файлов. Во время этого процесса файлы в подключаемом ресурсе не доступны пользователям. Во время создания подключаемого ресурса все файлы добавляются во временную папку, которая по умолчанию находится по пути `/_temporary/_mounts/<mount-location>`.

- Команда создания подключаемого ресурса выполняется асинхронно. После выполнения команды можно проверить состояние подключаемого ресурса.

- При создании подключаемого ресурса аргумент, используемый для **--mount-path**, представляет собой уникальный идентификатор подключаемого ресурса. В последующих командах следует использовать ту же строку (включая символ "/" в конце, если он имеется).

- Подключаемые ресурсы доступны только для чтения. В подключаемом ресурсе нельзя создавать каталоги или файлы.

- Мы не рекомендуем подключать каталоги или файлы, которые могут меняться. После создания подключаемого ресурса любые изменения, вносимые в удаленном расположении, не отражаются в подключаемом ресурсе в HDFS. Если в удаленном расположении есть изменения, вы можете удалить и повторно создать подключаемый ресурс, чтобы обновить состояние.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ver15.md)] см. в статье [Что такое [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ver15.md)]?](big-data-cluster-overview.md).
