---
title: Расширение "Развертывание приложения"
titleSuffix: SQL Server big data clusters
description: Развертывание скрипта Python или R в качестве приложения в кластерах больших данных SQL Server.
author: cloudmelon
ms.author: melqin
ms.reviewer: mikeray
ms.date: 08/21/2019
ms.topic: conceptual
ms.prod: sql
ms.technology: big-data-cluster
ms.openlocfilehash: 01ff6844019cfed0dbfa614fee156680ecd8f38e
ms.sourcegitcommit: d1051f05a7db81ec62d9785bb6af572408f3d4e0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "88680607"
---
# <a name="how-to-use-visual-studio-code-to-deploy-applications-to-big-data-clusters-2019"></a>Использование Visual Studio Code для развертывания приложений в [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)]

[!INCLUDE[SQL Server 2019](../includes/applies-to-version/sqlserver2019.md)]

В этой статье описывается, как развертывать приложения в кластере больших данных SQL Server с помощью Microsoft Visual Studio Code с расширением "Развертывание приложения".

## <a name="prerequisites"></a>предварительные требования

- [Visual Studio Code](https://code.visualstudio.com/)
- [Кластер больших данных SQL Server](big-data-cluster-overview.md)

## <a name="capabilities"></a>Возможности

Это расширение поддерживает следующие задачи в Visual Studio Code:

- проверка подлинности в кластере больших данных SQL Server;
- получение шаблона приложения из репозитория GitHub для развертывания поддерживаемых сред выполнения;
- управление открытыми в настоящее время шаблонами приложений в рабочей области пользователя;
- развертывание приложения с помощью спецификации в формате YAML;
- управление развернутыми приложениями в кластере больших данных SQL Server;
- просмотр всех развернутых приложений с дополнительными сведениями на боковой панели;
- создание спецификации запуска для использования приложения или его удаления из кластера;
- использование развернутых приложений с помощью спецификации запуска YAML.

В следующих разделах поэтапно описывается процесс установки и приводятся общие сведения о том, как работает расширение. 

### <a name="install"></a>Установка

Сначала установите расширение "Развертывание приложения" в Visual Studio Code:

1. Скачайте [расширение "Развертывание приложения"](https://aka.ms/app-deploy-vscode), чтобы установить его в Visual Studio Code.

1. Запустите Visual Studio Code и перейдите на боковую панель "Расширения".

1. Откройте контекстное меню `…` в верхней части боковой панели и выберите пункт `Install from vsix`.

   ![Установка VSIX](media/vs-extension/install_vsix.png)

1. Найдите скачанный файл `sqlservbdc-app-deploy.vsix` и выберите его для установки.

После установки расширения "Развертывание приложения" для кластера больших данных SQL Server будет предложено перезагрузить Visual Studio Code. Теперь на боковой панели Visual Studio Code должен появиться обозреватель приложений кластера больших данных SQL Server.

### <a name="app-explorer"></a>Обозреватель приложений

Щелкните расширение на боковой панели, чтобы загрузить боковую панель с обозревателем приложений. На снимке экрана ниже показан обозреватель приложений, в котором нет доступных приложений или спецификаций приложений.

![Обозреватель приложений](media/vs-extension/app_explorer.png)

#### <a name="connect-to-cluster"></a>Подключение к кластеру

Подключиться к конечной точке кластера можно одним из описанных ниже способов.

- Щелкните строку состояния внизу с сообщением `SQL Server BDC Disconnected`.
- Вы также можете нажать вверху кнопку `Connect to Cluster` со стрелкой, указывающей не дверь.

В Visual Studio Code появится запрос на указание конечной точки, имени пользователя и пароля.

В качестве конечной точки для подключения используется конечная точка `Cluster Management Service` с портом 30080.

Эту конечную точку можно также найти из командной строки с помощью команды 

```
azdata bdc endpoint list
```

Доступен еще один способ получения этой информации: щелкните правой кнопкой мыши элемент **Управление**на сервере в Azure Data Studio, где будут перечислены конечные точки служб.

![Конечная точка ADS](media/vs-extension/ads_end_point.png)

После того как вы найдете нужную конечную точку, установите подключение к кластеру.

![Новое подключение](media/vs-extension/connect_to_cluster.png)

 Если были предоставлены правильные учетные данные и конечная точка приложения, Visual Studio Code уведомит о том, что подключение к кластеру установлено. На боковой панели появятся все развернутые приложения. После успешного подключения конечная точка и имя пользователя сохранятся в вашем профиле пользователя в `./sqldbc`. Пароль или токены не сохраняются. При повторном входе в систему в запросе уже будут заполнены узел и имя пользователя, но пароль нужно вводить всегда. Чтобы подключиться к другой конечной точке кластера, просто щелкните `New Connection` еще раз. Подключение автоматически закрывается при закрытии Visual Studio Code или при открытии другой рабочей области. После этого потребуется подключиться повторно.

### <a name="app-template"></a>Шаблон приложения

В Visual Studio Code необходимо *открыть рабочую область*, в которой будут сохраняться артефакты приложения.

Чтобы развернуть новое приложение на основе одного из наших шаблонов, нажмите кнопку `New App Template` в области `App Specifications`. Вам будет предложено указать имя, среду выполнения и расположение, где необходимо разместить новое приложение на локальном компьютере. В качестве имени и версии необходимо предоставить метку в формате DNS-1035, которая должна состоять из строчных букв и цифр или дефисов "-", начинаться с буквы и заканчиваться буквой или цифрой.

Чтобы можно было использовать все функциональные возможности расширения, рекомендуется поместить приложение в текущую рабочую область Visual Studio Code. Однако вы можете поместить его в любое место в локальной файловой системе.

![Шаблон нового приложения](media/vs-extension/new_app_template.png)

По завершении новый шаблон приложения формируется в указанном расположении, и файл `spec.yaml` развертывания открывается в вашей рабочей области. Если выбранный каталог находится в вашей рабочей области, он также должен отобразиться в списке в области `App Specifications`.

![Загруженный шаблон приложения](media/vs-extension/loading_app_template.png)

Шаблон — это простое приложение `helloworld`, которое имеет следующую структуру в области спецификаций приложения:

- **spec.yaml**
   - Предоставляет кластеру сведения о том, как должно развертываться приложение.
- **run-spec.yaml**
   - Предоставляет кластеру сведения о том, как должно вызываться приложение.

Исходный код приложения будет находиться в папке рабочей области.

- **Имя исходного файла**
   - Это файл исходного кода, указанный в элементе `src` в файле `spec.yaml`.
   - В нем имеется одна функция `handler`, которая считается `entrypoint` приложения согласно `spec.yaml`. Она принимает входную строку `msg` и возвращает выходную строку `out`. Эти строки определяются в элементах `inputs` и `outputs` в файле `spec.yaml`.

Если сформированный шаблон не нужен и вы просто хотите использовать файл `spec.yaml` для развертывания уже созданного приложения, нажмите кнопку `New Deploy Spec` рядом с кнопкой `New App Template` и выполните тот же процесс, но вы получите только файл `spec.yaml`, который можно изменить так, как вам нужно.

### <a name="deploy-app"></a>Развертывание приложения

Вы можете мгновенно развернуть это приложение посредством CodeLens `Deploy App` в файле `spec.yaml` или нажать кнопку с молнией поверх папки рядом с файлом `spec.yaml` в меню "Спецификации приложений". Расширение запакует все файлы в каталоге, в котором находится файл `spec.yaml`, и развернет приложение в кластере. 

>[!NOTE]
>Все файлы приложения должны находиться в том же каталоге, что и файл `spec.yaml`. Файл `spec.yaml` должен находиться на корневом уровне в каталоге с исходным кодом приложения. 

![Кнопка развертывания приложения](media/vs-extension/deploy_app_lightning.png)

![CodeLens развертывания приложения](media/vs-extension/deploy_app_codelens.png)

Определить готовность приложения к использованию можно по его состоянию на боковой панели.

![Приложение развернуто](media/vs-extension/app_deploy.png)

![Сообщение о готовности приложения на боковой панели](media/vs-extension/app_ready_side_bar.png)

![Уведомление о готовности приложения](media/vs-extension/app_ready_notification.png)

На боковой панели доступны указанные ниже сведения.

Вы можете просмотреть список всех развернутых приложений на боковой панели со следующими сведениями:

- state
- version
- входные параметры;
- выходные параметры;
- ссылки
  - Swagger;
  - подробности

Если щелкнуть `Links`, можно получить доступ к файлу `swagger.json` развернутого приложения. Это позволяет создавать собственные клиенты, вызывающие приложение:

![Swagger](media/vs-extension/swagger.png)

Дополнительные сведения см. в статье [Использование приложений в кластерах больших данных](app-consume.md).

### <a name="app-run"></a>Запуск приложения

Когда приложение будет готово, вызовите его с помощью файла `run-spec.yaml`, который был предоставлен в составе шаблона приложения.

![Спецификация запуска](media/vs-extension/run_spec.png)

Укажите любую строку вместо `hello`, а затем снова запустите приложение с помощью ссылки CodeLens или кнопки с молнией на боковой панели рядом с файлом `run-spec.yaml`. Если у вас по какой-либо причине нет спецификации запуска, создайте ее на основе приложения, развернутого в кластере.

![Получение спецификации запуска](media/vs-extension/get_run_spec.png)

Когда вы получите спецификацию и измените ее требуемым образом, запустите ее. Когда выполнение приложения завершится, Visual Studio Code вернет соответствующие выходные данные:

![Выходные данные приложения](media/vs-extension/app_output.png)

Как видно на снимке экрана выше, выходные данные содержатся во временном файле `.json` в вашей рабочей области. Если нужно, их можно сохранить. В противном случае они будут удалены при закрытии программы. Если приложение не имеет выходных данных для вывода в файл, внизу просто появится уведомление `Successful App Run`. Если выполнение не было завершено успешно, вы получите соответствующее сообщение об ошибке, которое поможет определить причину проблемы.

При запуске приложения передавать параметры можно различными способами.

Все необходимые входные данные можно указать в файле `.json`:

- `inputs: ./example.json`

Если при вызове развернутого приложения какие-либо входные параметры являются внутренними или задаются пользователем и если определенный входной параметр не является примитивом, то есть массивом, вектором, кадром данных, сложной структурой JSON и т. д., укажите тип параметра непосредственно в коде при вызове приложения:

- Вектор
    - `inputs:`
        - `x: [1, 2, 3]`
- Матрица
    - `inputs:`
        - `x: [[A,B,C],[1,2,3]]`
- Объект
    - `inputs:`
        - `x: {A: 1, B: 2, C: 3}`

Либо предоставьте строку относительного или абсолютного пути к файлу `.txt`, `.json` или `.csv`, который содержит необходимые входные данные в требуемом формате. Файл анализируется с помощью `Node.js Path library`, причем путь к файлу определяется как `string that contains a / or \ character`.

Если входной параметр не предоставлен требуемым образом, выводится соответствующее сообщение либо о неверном пути к файлу, если была указана строка пути к файлу, либо о недопустимом параметре. Вся ответственность за определение параметров возлагается на создателя приложения.

Чтобы удалить приложение, просто нажмите кнопку корзины рядом с ним на боковой панели `Deployed Apps`.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о том, как интегрировать приложения, развернутые в [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)], в собственные приложения, см. в статье [Использование приложений в кластерах больших данных](app-consume.md). Вы также можете ознакомиться с дополнительными примерами использования расширения в наборе [примеров развертывания приложений](https://aka.ms/sql-app-deploy).

Дополнительные сведения о [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ss-nover.md)] см. в статье [Что такое [!INCLUDE[big-data-clusters-2019](../includes/ssbigdataclusters-ver15.md)]?](big-data-cluster-overview.md).


Наша цель — сделать это расширение полезным для вас, поэтому мы будем рады получить ваши отзывы. Отправляйте их [разработчикам [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]](https://aka.ms/sqlfeedback).
