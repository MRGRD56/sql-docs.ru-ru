---
title: Свойства инициализации и авторизации (драйвер OLE DB)| Документация Майкрософт
description: Узнайте, как OLE DB Driver for SQL Server интерпретирует свойства инициализации и авторизации OLE DB.
ms.custom: ''
ms.date: 01/02/2020
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- authorization [OLE DB]
- properties [OLE DB]
- OLE DB Driver for SQL Server, initialization properties
- OLE DB Driver for SQL Server, authorization properties
- initialization properties [OLE DB]
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 702b6058e09a49528f96184d8591a0b6c97b3f86
ms.sourcegitcommit: c95f3ef5734dec753de09e07752a5d15884125e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88862078"
---
# <a name="initialization-and-authorization-properties"></a>Свойства инициализации и авторизации
[!INCLUDE [SQL Server](../../../includes/applies-to-version/sql-asdb-asdbmi-asa-pdw.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  OLE DB Driver for SQL Server интерпретирует свойства инициализации и авторизации OLE DB следующим образом:  
  
|Идентификатор свойства|Описание|  
|-----------------|-----------------|  
|DBPROP_AUTH_CACHE_AUTHINFO|OLE DB Driver for SQL Server не кэширует сведения о проверке подлинности.<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_ENCRYPT_PASSWORD|OLE DB Driver for SQL Server использует стандартный механизм безопасности [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для скрытия паролей.<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_INTEGRATED|Если DBPROP_AUTH_INTEGRATED имеет значение NULL, значение в виде пустой строки или значение "SSPI" типа VT_BSTR, то драйвер OLE DB для SQL Server использует для авторизации доступа пользователя к базе данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], указанной в свойствах DBPROP_INIT_DATASOURCE и DBPROP_INIT_CATALOG, механизм проверки подлинности Windows.<br /><br /> Если задано значение VT_EMPTY (по умолчанию), то используется безопасность [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Имя входа в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и пароль указываются в свойствах DBPROP_AUTH_USERID и DBPROP_AUTH_PASSWORD.|  
|DBPROP_AUTH_MASK_PASSWORD|OLE DB Driver for SQL Server использует стандартный механизм безопасности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для скрытия паролей.<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_PASSWORD|Пароль назначается для имени входа в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Когда выбрана проверка подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], это свойство используется для авторизации доступа к базе данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].|  
|DBPROP_AUTH_PERSIST_ENCRYPTED|OLE DB Driver for SQL Server не шифрует данные проверки подлинности при сохранении.<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO|Драйвер OLE DB для SQL Server сохраняет значения для проверки подлинности, включая образ пароля (если указано). Шифрование не предусмотрено.|  
|DBPROP_AUTH_USERID|Имя входа в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Когда выбрана проверка подлинности [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], это свойство используется для авторизации доступа к базе данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].|  
|DBPROP_INIT_ASYNCH|OLE DB Driver for SQL Server поддерживает асинхронную инициализацию.<br /><br /> При установке разряда DBPROPVAL_ASYNCH_INITIALIZE в свойстве DBPROP_INIT_ASYNCH метод **IDBInitialize::Initialize** становится неблокирующим вызовом. Дополнительные сведения о выполнении асинхронных операций см. в [этой статье](../../oledb/features/performing-asynchronous-operations.md).|  
|DBPROP_INIT_CATALOG|Имя существующей базы данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], к которой выполняется подключение.|  
|DBPROP_INIT_DATASOURCE|Сетевое имя сервера, на котором запущен экземпляр [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Если на компьютере запущено несколько экземпляров [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], то для подключения к определенному экземпляру [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] значение DBPROP_INIT_DATASOURCE указывается в формате *\\\имя_сервера\имя_экземпляра*. Вместо обратной косой черты используется escape-последовательность (\\\).|  
|DBPROP_INIT_GENERALTIMEOUT|Указывает количество секунд до истечения времени запроса, кроме инициализации источника данных и выполнения команды. Значение 0 указывает на бесконечное время ожидания. Поставщики, работающие через сетевые подключения в распределенных сценариях или сценариях на основе транзакций, могут реализовать поддержку этого свойства, чтобы принудительно сократить время ожидания задействованного компонента в случае длительного выполнения запроса. Временем ожидания для инициализации источника данных или выполнения команд по-прежнему управляют свойства DBPROP_INIT_TIMEOUT и DBPROP_COMMANDTIMEOUT, соответственно.<br /><br /> Свойство DBPROP_INIT_GENERALTIMEOUT доступно только для чтения, и при попытке присвоить ему значение в *dwstatus* возвращается ошибка DBPROPSTATUS_NOTSETTABLE.|  
|DBPROP_INIT_HWND|Дескриптор Windows из вызывающего приложения. Действительный дескриптор окна необходим для инициализации диалогового окна, если разрешен запрос свойств инициализации.|  
|DBPROP_INIT_IMPERSONATION_LEVEL|OLE DB Driver for SQL Server не поддерживает корректировку уровня олицетворения.<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_LCID|Драйвер OLE DB для SQL Server проверяет код языка и возвращает ошибку, если код языка не поддерживается или не установлен в клиенте.|  
|DBPROP_INIT_LOCATION|При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_MODE|При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_PROMPT|OLE DB Driver for SQL Server поддерживает все режимы запросов на инициализацию источника данных. OLE DB Driver for SQL Server по умолчанию использует для этого свойства значение DBPROMPT_NOPROMPT.|  
|DBPROP_INIT_PROTECTION_LEVEL|OLE DB Driver for SQL Server не поддерживает уровень защиты для подключений к экземплярам [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].<br /><br /> При попытке задать значение этого свойства OLE DB Driver for SQL Server возвращает значение DB_S_ERRORSOCCURRED. Элемент *dwStatus* структуры DBPROP указывает DBPROPSTATUS_NOTSUPPORTED.|  
|DBPROP_INIT_PROVIDERSTRING|Ознакомьтесь с разделом "Строка OLE DB Driver for SQL Server" далее в этой статье.|  
|DBPROP_INIT_TIMEOUT|Драйвер OLE DB для SQL Server возвращает ошибку при инициализации, если в течение указанного количества секунд не удалось установить соединение с экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].|  
  
 В определяемом поставщиком наборе свойств DBPROPSET_SQLSERVERDBINIT драйвер OLE DB для SQL Server определяет указанные ниже дополнительные свойства инициализации.  
  
|Идентификатор свойства|Описание|  
|-----------------|-----------------|  
|SSPROP_AUTH_ACCESS_TOKEN<a href="#table1_1"><sup>**1**</sup></a>|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VT_EMPTY<br /><br /> Описание. Маркер доступа, который используется для выполнения проверки подлинности в Azure Active Directory. <br/><br/>**ПРИМЕЧАНИЕ.** При указании этого свойства, ключевых слов строк подключения `UID`, `PWD`, `Trusted_Connection` и `Authentication` или их соответствующих свойств или ключевых слов возникает ошибка.|
|SSPROP_AUTH_MODE<a href="#table1_1"><sup>**1**</sup></a>|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VT_EMPTY<br /><br /> Описание. Указывает используемый метод проверки подлинности SQL или Active Directory. Допустимые значения:<br/><ul><li>`(not set)`: режим проверки подлинности определяется другими ключевыми словами.</li><li>`(empty string)`: отменяет заданный ранее режим проверки подлинности.</li><li>`ActiveDirectoryPassword:` проверка подлинности по идентификатору и паролю пользователя с использованием идентификатора Azure Active Directory.</li><li>`ActiveDirectoryIntegrated:` встроенная проверка подлинности с помощью идентификатора Azure Active Directory.</li><br/>**ПРИМЕЧАНИЕ.** Ключевое слово `ActiveDirectoryIntegrated` можно также использовать для проверки подлинности Windows в SQL Server. Оно заменяет ключевые слова проверки подлинности `Integrated Security` или `Trusted_Connection`. **Рекомендуется** присвоить ключевому слову `Authentication` (или его соответствующему свойству) значение `ActiveDirectoryIntegrated` в приложениях, использующих ключевые слова `Integrated Security` или `Trusted_Connection` (или их соответствующие свойства). Это позволит активировать новое поведение проверки сертификата и шифрования.<br/><br/><li>`ActiveDirectoryInteractive:` встроенная проверка подлинности с использованием идентификатора Azure Active Directory. Этот метод поддерживает многофакторную проверку подлинности Azure (MFA). </li><li>`ActiveDirectoryMSI:` проверка подлинности [управляемого удостоверения (MSI)](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview). Для назначенного пользователем удостоверения в качестве идентификатора пользователя задается идентификатор объекта удостоверения пользователя.</li><li>`SqlPassword:` проверка подлинности с помощью идентификатора пользователя и пароля.</li><br/>**ПРИМЕЧАНИЕ.** Мы **рекомендуем** присвоить ключевому слову `Authentication` (или его соответствующему свойству) значение `SqlPassword` в приложениях, использующих проверку подлинности `SQL Server`. Это позволит активировать [новое поведение проверки сертификата и шифрования](../features/using-azure-active-directory.md#encryption-and-certificate-validation).</ul>|
|SSPROP_AUTH_OLD_PASSWORD|Тип: VT_BSTR<br /><br /> Ч/З запись<br /><br /> Значение по умолчанию: VT_EMPTY<br /><br /> Описание. Текущий пароль или пароль с истекшим сроком действия. Дополнительные сведения см. в статье [Смена пароля программным способом](../../oledb/features/changing-passwords-programmatically.md).|  
|SSPROP_INIT_APPNAME|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Имя клиентского приложения.|  
|SSPROP_INIT_AUTOTRANSLATE|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VARIANT_TRUE<br /><br /> Описание. Преобразование символов OEM/ANSI.<br /><br /> VARIANT_TRUE: OLE DB Driver for SQL Server преобразует символьные строки ANSI, отправляемые с клиента на сервер и обратно (через Юникод), чтобы свести к минимуму проблемы сопоставления символов национального алфавита в кодовых страницах на клиенте и сервере.<br /><br /> Данные типа DBTYPE_STR, передаваемые в переменную, параметр или столбец в экземпляре переменной [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], имеющем тип **char**, **varchar** или **text**, преобразуются в Юникод с использованием кодовой страницы ANSI (ACP) клиента, а затем преобразуются из Юникода в символьную строку с использованием ACP сервера.<br /><br /> Данные [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типа **char**, **varchar** или **text**, передаваемые в переменную DBTYPE_STR в клиенте, преобразуются в Юникод с использованием ACP сервера, а затем из Юникода — в символьную строку с использованием ACP клиента.<br /><br /> Эти преобразования выполняются на клиенте драйвером OLE DB Driver for SQL Server. Для этого на клиенте должна быть доступна та же кодовая страница, что используется на сервере.<br /><br /> Следующие параметры не влияют на преобразования, выполняемые для этих передач.<br /><br /> Данные переменной типа DBTYPE_WSTR в Юникоде передаются из клиента на сервер в объекты типа **char**, **varchar** или **text**.<br /><br /> Данные типов **char**, **varchar** или **text** передаются с сервера в клиент в переменные типа DBTYPE_WSTR в Юникоде.<br /><br /> Данные переменных типа DBTYPE_WSTR в кодировке ANSI передаются из клиента на сервер в Юникоде в переменные типа **nchar**, **nvarchar** или **ntext**.<br /><br /> Данные в Юникоде типов **char**, **varchar** или **text** передаются с сервера в клиент в переменные типа DBTYPE_WSTR в кодировке ANSI.<br /><br /> VARIANT_FALSE: OLE DB Driver for SQL Server не выполняет преобразование символов.<br /><br /> Драйвер OLE DB для SQL Server не выполняет преобразование клиентских данных из переменных типа DBTYPE_STR в кодировке ANSI при передаче в переменные, параметры или столбцы типов **char**, **varchar** или **text** на сервере. Преобразование данных типов **char**, **varchar** или **text** при передаче с сервера в клиент в переменные DBTYPE_STR не выполняется.<br /><br /> Если на клиенте и на экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] используются разные ACP, то символы национальных алфавитов могут быть преобразованы неправильно.|  
|SSPROP_INIT_CURRENTLANGUAGE|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Название языка [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Указывает язык, используемый для выбора и форматирования системных сообщений. Язык должен быть установлен на компьютере, на котором запущен экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], в противном случае инициализация источника данных не будет выполнена.|  
|SSPROP_INIT_DATATYPECOMPATIBILITY|Тип: VT_UI2<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: 0<br /><br /> Описание. Обеспечивает совместимость типов данных между [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] и приложениями ActiveX Data Objects (ADO). Если установлено значение 0 (по умолчанию), то используется та же обработка типов данных, которая применяется поставщиком. Если установлено значение 80, то для обработки типов данных используются только типы данных [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]. Пример использования объектов ADO с OLE DB Driver for SQL Server см. в [этой статье](../../oledb/applications/using-ado-with-oledb-driver-for-sql-server.md).|  
|SSPROP_INIT_ENCRYPT<a href="#table1_1"><sup>**1**</sup></a>|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VARIANT_FALSE<br /><br /> Описание. Чтобы включить шифрование передаваемых по сети данных, необходимо присвоить свойству SSPROP_INIT_ENCRYPT значение VARIANT_TRUE.<br /><br /> Если включено принудительное шифрование протокола, то шифрование данных производится всегда, независимо от значения SSPROP_INIT_ENCRYPT. Если оно отключено, а для свойства SSPROP_INIT_ENCRYPT задано значение VARIANT_TRUE, то шифрование будет выполняться.<br /><br /> Если принудительное шифрование протокола отключено, а для свойства SSPROP_INIT_ENCRYPT задано значение VARIANT_FALSE, то шифрование не будет выполняться.|  
|SSPROP_INIT_FAILOVERPARTNER|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Указывает имя партнера по обеспечению отработки отказа для зеркального отображения базы данных. Является свойством инициализации и может быть задано только перед инициализацией. После инициализации оно будет возвращать имя партнера по обеспечению отработки отказа (если есть), возвращенное сервером-источником.<br /><br /> Это позволяет смарт-приложениям кэшировать последний определенный сервер резервного копирования, однако они должны учитывать, что данные обновляются только при первом установлении соединения (или при возобновлении, при наличии пула) и могут устареть в случае длительных соединений.<br /><br /> После установления соединения приложение может запросить этот атрибут, чтобы идентифицировать партнера по обеспечению отработки отказа. Если сервер-источник не имеет партнера по обеспечению отработки отказа, то это свойство вернет пустую строку. Дополнительные сведения см. в статье [Зеркальное отображение базы данных](../../oledb/features/using-database-mirroring.md).|  
|SSPROP_INIT_FILENAME|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Указывает имя первичного файла присоединяемой базы данных. Эта база данных присоединяется и становится для соединения базой данных по умолчанию. Перед использованием свойства SSPROP_INIT_FILENAME необходимо указать имя базы данных в свойстве инициализации DBPROP_INIT_CATALOG. Если имя базы данных не существует, то выполняется поиск имени первичного файла, указанного в свойстве SSPROP_INIT_FILENAME, и присоединяется база данных с именем, указанным в свойстве DBPROP_INIT_CATALOG. Если база данных уже была присоединена, то [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ее снова не присоединяет.|  
|SSPROP_INIT_MARSCONNECTION|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VARIANT_FALSE<br /><br /> Описание. Указывает, включен ли для подключения множественный активный результирующий набор. Перед установлением соединения с базой данных этот параметр должен быть установлен в значение true. Дополнительные сведения см. в статье [Использование множественных активных результирующих наборов &#40;MARS&#41;](../../oledb/features/using-multiple-active-result-sets-mars.md).|  
|SSPROP_INIT_MULTISUBNETFAILOVER|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br/>Значение по умолчанию: VARIANT_FALSE<br /><br />Описание. MultiSubnetFailover позволяет группам доступности AlwaysOn и экземплярам отказоустойчивого кластера в SQL Server быстрее выполнить отработку отказа, а также значительно сократить время перехода на другой ресурс для топологий Always On с одной подсетью или несколькими. При отработке отказа с в нескольких подсетях клиент будет выполнять попытки соединения параллельно. Дополнительные сведения см. в статье [Поддержка высокой доступности и аварийного восстановления в драйвере OLE DB Driver for SQL Server](../../oledb/features/oledb-driver-for-sql-server-support-for-high-availability-disaster-recovery.md).|  
|SSPROP_INIT_NETWORKADDRESS|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Сетевой адрес сервера, на котором запущен экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], указанный в свойстве DBPROP_INIT_DATASOURCE.|  
|SSPROP_INIT_NETWORKLIBRARY|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Имя сетевой библиотеки (DLL), используемой для связи с экземпляром [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Не должно включать путь или расширение DLL.<br /><br /> Значение по умолчанию можно настроить с помощью средства настройки клиента [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].<br /><br /> Примечание. Это свойство поддерживает только TCP и именованные каналы. Если указан префикс, то это приведет к образованию двойного префикса и вызовет ошибку, поскольку это свойство создает префиксы внутри себя.|  
|SSPROP_INIT_PACKETSIZE|Тип: VT_I4<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. Размер пакета потока табличных данных (TDS) в байтах. Значение свойства размера пакета должно быть равно нулю или находиться в диапазоне от 512 до 32 767. Значение по умолчанию равно нулю, то есть фактический размер пакета будет определяться сервером.|  
|SSPROP_INIT_TAGCOLUMNCOLLATION|Тип: BOOL<br /><br /> Ч/З запись<br /><br /> Значение по умолчанию: FALSE<br /><br /> Описание. Используется при обновлении базы данных, если применяются курсоры на стороне сервера. Это свойство добавляет к данным сведения о параметрах сортировки, полученные с сервера, а не кодовую страницу клиента. В настоящее время это свойство используется только процессом обработки распределенных запросов, поскольку он знает параметры сортировки данных назначения и может правильно их преобразовать.|  
|SSPROP_INIT_TNIR|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br/>Значение по умолчанию: VARIANT_TRUE<br /><br />Описание. Если с именем узла связано несколько IP-адресов, TNIR влияет на последовательность подключений, когда первый разрешенный IP-адрес имени узла не отвечает. TNIR взаимодействует с MultiSubnetFailover и поддерживает различные варианты последовательности подключений. Дополнительные сведения см. в статье [Использование разрешения IP-адресов прозрачной сети](../../oledb/features/using-transparent-network-ip-resolution.md).|  
|SSPROP_INIT_TRUST_SERVER_CERTIFICATE<a href="#table1_1"><sup>**1**</sup></a>|Тип: VT_BOOL.<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: VARIANT_FALSE<br /><br /> Описание. Используется для включения и отключения проверки сертификата сервера. Это свойство доступно для чтения и записи, но попытка его установки после установления соединения приведет к ошибке.<br /><br /> Это свойство не используется, если на клиенте настроен запрос проверки сертификата. Однако приложение может использовать его вместе со свойством SSPROP_INIT_ENCRYPT, чтобы обеспечить шифрование соединения с сервером, даже если на клиенте не установлен сертификат и не настроен запрос проверки сертификата.<br /><br /> Клиентские приложения могут запрашивать это свойство после открытия соединения для получения используемых параметров шифрования и проверки.<br /><br /> Примечание. Использование шифрования без проверки сертификата обеспечивает частичную защиту от перехвата пакетов, однако не защищает от атак типа "злоумышленник в середине". Оно лишь позволяет шифровать имя входа и данные, передаваемые на сервер, без проверки сертификата сервера.<br /><br /> Дополнительные сведения см. в статье [Использование шифрования без проверки](../../oledb/features/using-encryption-without-validation.md).|  
|SSPROP_INIT_USEPROCFORPREP|Тип: VT_I4<br /><br /> Ч/З Чтение/запись<br /><br /> Значение по умолчанию: SSPROPVAL_USEPROCFORPREP_ON<br /><br /> Описание. Использование хранимой процедуры [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Определяет использование временных хранимых процедур [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для поддержки интерфейса **ICommandPrepare**. Это свойство имело значение только при соединении с сервером SQL Server 6.5. Для более поздних версий это свойство не используется.<br /><br /> SSPROPVAL_USEPROCFORPREP_OFF: временная хранимая процедура не создается при подготовке команды.<br /><br /> SSPROPVAL_USEPROCFORPREP_ON: временная хранимая процедура создается при подготовке команды. Временные хранимые процедуры удаляются при освобождении сеанса.<br /><br /> SSPROPVAL_USEPROCFORPREP_ON_DROP: временная хранимая процедура создается при подготовке команды. Процедура удаляется при отмене подготовки команды методом **ICommandPrepare::Unprepare**, при определении новой команды для объекта команды методом **ICommandText::SetCommandText** или при освобождении приложением всех ссылок на команду.|  
|SSPROP_INIT_WSID|Тип: VT_BSTR<br /><br /> Ч/З Чтение/запись<br /><br /> Описание. строка, идентифицирующая рабочую станцию.|  
  

<b id="table1_1">[1].</b> Для повышения безопасности поведение шифрования и проверки сертификатов изменяется при использовании свойств инициализации маркера доступа и проверки подлинности или их соответствующих ключевых слов строки подключения. Дополнительные сведения см. в разделе о [шифровании и проверке сертификатов](../features/using-azure-active-directory.md#encryption-and-certificate-validation).

 В специфичном для каждого поставщика множестве свойств DBPROPSET_SQLSERVERDATASOURCEINFO драйвер OLE DB Driver for SQL Server определяет дополнительные свойства. Дополнительные сведения см. в статье [Свойства сведений об источнике данных](../../oledb/ole-db-data-source-objects/data-source-information-properties.md).  
  
## <a name="the-ole-db-driver-for-sql-server-string"></a>Строка "Драйвер OLE DB для SQL Server"  
 OLE DB Driver for SQL Server распознает синтаксис ODBC в значениях свойств строки поставщика. Свойство строки поставщика задается как значение свойства инициализации DBPROP_INIT_PROVIDERSTRING при установлении соединения с источником данных OLE DB. Это свойство содержит данные для подключения, определяемые поставщиком OLE DB и необходимые для установления соединения с источником данных OLE DB. В этой строке элементы разделяются точкой с запятой. За последним элементом в строке также должна стоять точка с запятой. Каждый элемент состоит из ключевого слова, символа «=» и значения, переданного при инициализации. Пример:  
  
```  
Server=MyServer;UID=MyUserName;  
```  
  
 Потребитель не должен использовать свойство строки поставщика с OLE DB Driver for SQL Server. Потребитель может задать любое свойство инициализации, отраженное в строке поставщика, с помощью свойств инициализации, определяемых OLE DB или драйвером OLE DB для SQL Server.  
  
 Список ключевых слов строки подключения, доступных в OLE DB Driver for SQL Server, см. в [этой статье](../../oledb/applications/using-connection-string-keywords-with-oledb-driver-for-sql-server.md).  
  
## <a name="see-also"></a>См. также:  
 [Объекты источников данных (OLE DB)](../../oledb/ole-db-data-source-objects/data-source-objects-ole-db.md)  
  
  
