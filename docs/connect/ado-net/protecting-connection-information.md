---
title: Защита сведений о подключении
description: Сведения об уязвимостях безопасности в строках подключений, которые могут возникнуть из-за особенностей их создания и сохранения, а также о типах аутентификации.
ms.date: 11/13/2020
ms.assetid: 1471f580-bcd4-4046-bdaf-d2541ecda2f4
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.topic: conceptual
author: David-Engel
ms.author: v-daenge
ms.reviewer: v-chmalh
ms.openlocfilehash: 146063d665b89a8541c34d9cc3b0b6da3939d801
ms.sourcegitcommit: 7a3fdd3f282f634f7382790841d2c2a06c917011
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2020
ms.locfileid: "96563100"
---
# <a name="protecting-connection-information"></a>Защита сведений о подключении

[!INCLUDE[appliesto-netfx-netcore-netst-md](../../includes/appliesto-netfx-netcore-netst-md.md)]

[!INCLUDE[Driver_ADONET_Download](../../includes/driver_adonet_download.md)]

Защита доступа к источникам данным - одна из важнейших целей защиты приложения. Строка соединения представляет собой потенциальную уязвимость, если она не защищена. Сохранение сведений о соединении в виде простого текста или сохранение их в памяти представляет угрозу безопасности всей системы. Строки подключений, внедренные в исходный код, можно прочитать с помощью программы [Ildasm.exe (дизассемблер IL)](/dotnet/framework/tools/ildasm-exe-il-disassembler) при просмотре промежуточного языка корпорации Майкрософт (MSIL) в скомпилированной сборке.

Уязвимые места системы безопасности, связанные со строками соединения, могут возникать в зависимости от используемого типа проверки подлинности, способа сохранения строк соединения в памяти или на диске, и методов, используемых для их конструирования 

## <a name="use-windows-authentication"></a>Использовать проверку подлинности Windows

Чтобы ограничить доступ к источнику данных, необходимо защитить сведения о безопасном соединении, например, идентификатор пользователя, пароль и имя источника данных. Чтобы не показывать сведения о пользователе, рекомендуется использовать аутентификацию Windows (которую иногда называют *встроенной безопасностью*) всегда, когда это возможно. Проверка подлинности Windows указывается в строке соединения с помощью ключевых слов `Integrated Security` или `Trusted_Connection`, что исключает необходимость указывать идентификатор пользователя и пароль. Когда используется проверка подлинности Windows, пользователей проверяет операционная система Windows, а доступ к ресурсам сервера и базы данных определяется предоставлением разрешений пользователям и группам Windows.

В ситуациях, когда невозможно использовать проверку подлинности Windows, необходимо проявлять дополнительную осторожность, так как учетные данные пользователя представлены в строке соединения. В приложении ASP.NET можно настроить учетную запись Windows как фиксированное удостоверение, которое используется для подключения к базам данных и другим сетевым ресурсам. Олицетворение включается в элементе-идентификаторе в файле **web.config**, при этом указываются имя пользователя и пароль.

```xml  
<identity impersonate="true"
        userName="MyDomain\UserAccount"
        password="*****" />  
```  

Фиксированная учетная запись идентификации должна быть учетной записью с ограниченными правами, которой предоставлены только необходимые разрешения в базе данных. Кроме того, нужно зашифровать файл конфигурации, чтобы имя пользователя и пароль не были представлены в виде открытого текста.

## <a name="avoid-injection-attacks-with-connection-string-builders"></a>Защититесь от атак путем внедрения кода SQL с помощью построителей строк подключения

Атака путем внедрения кода в строку соединения может произойти, когда для построения строк соединения на основе ввода пользователя используется динамическое объединение строк. Если входные данные пользователя не проверяются и опасный текст или символы не экранированы, то злоумышленник может получить доступ к конфиденциальным данным или другим ресурсам на сервере. Чтобы устранить эту проблему, в поставщик данных Microsoft SqlClient для SQL Server добавлен новый класс построителя строк подключений, позволяющий проверить синтаксис строки подключения и убедиться, что в нее не введены дополнительные параметры. Дополнительные сведения см. в статье [Connection String Builders](connection-string-builders.md) (Построители строк подключения).

## <a name="use-persist-security-infofalse"></a>Используйте значение False параметра Persist Security Info

По умолчанию параметр `Persist Security Info` имеет значение false. Рекомендуется использовать это значение по умолчанию во всех строках соединения. Присвоение параметру `Persist Security Info` значения `true` или `yes` позволяет получить конфиденциальные сведения, в том числе идентификатор пользователя и пароль, из соединения после того, как оно будет открыто. Если параметру `Persist Security Info` присвоено значение `false` или `no`, то сведения безопасности отбрасываются после того, как они используются для открытия соединения. Таким образом, ненадежный источник не получает доступа к конфиденциальным данным.

## <a name="encrypt-configuration-files"></a>Шифрование файлов конфигурации

[!INCLUDE[appliesto-netfx-netcore-xxxx-md](../../includes/appliesto-netfx-netcore-xxxx-md.md)]

Строки соединения можно сохранить в файлах конфигурации, что исключает необходимость внедрять их в код приложения. Файлы конфигурации представляют собой стандартные XML-файлы, для которых в платформе .NET Framework определен типовой набор элементов. Строки подключений в файлах конфигурации обычно хранятся в элементе **\<connectionStrings>** в **app.config** для приложения Windows, либо в файле **web.config** для приложения ASP.NET. Дополнительные сведения об основах хранения, извлечения и шифрования строк подключений в файлах конфигурации см. в статье [Строки подключений и файлы конфигурации](connection-strings-and-configuration-files.md).

## <a name="see-also"></a>См. также

- [Шифрование сведений о конфигурации с помощью функции защищенной конфигурации](/previous-versions/aspnet/53tyfkaw(v=vs.100))
