---
title: Извлечение двоичных данных
description: Описание извлечения двоичных данных или крупных структур данных с помощью метода `CommandBehavior`.`SequentialAccess` для изменения поведения по умолчанию объекта `DataReader`.
ms.date: 12/04/2020
dev_langs:
- csharp
ms.assetid: 56c5a9e3-31f1-482f-bce0-ff1c41a658d0
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.topic: conceptual
author: David-Engel
ms.author: v-daenge
ms.reviewer: v-chmalh
ms.openlocfilehash: 1033a6b5394d92a45cd19d70f4dd6c250ec37b62
ms.sourcegitcommit: 4419e99d77ee2c73f9da1559c7944f7702f2de30
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/23/2020
ms.locfileid: "97744430"
---
# <a name="retrieve-binary-data"></a>Извлечение двоичных данных

[!INCLUDE[appliesto-netfx-netcore-netst-md](../../includes/appliesto-netfx-netcore-netst-md.md)]

[!INCLUDE[Driver_ADONET_Download](../../includes/driver_adonet_download.md)]

По умолчанию объект **DataReader** загружает входящие данные в виде строки, как только вся строка данных будет в наличии. Однако для больших двоичных объектов (BLOB) требуется другая процедура, поскольку они могут содержать гигабайты данных, которые невозможно уместить в одной строке. Метод **Command.ExecuteReader** имеет перегрузку, которая принимает аргумент <xref:System.Data.CommandBehavior>, чтобы изменять характер действий объекта **DataReader** по умолчанию. Аргумент <xref:System.Data.CommandBehavior.SequentialAccess> можно передать методу **ExecuteReader** для изменения характера действий объекта **DataReader** по умолчанию, чтобы он загружал не строки данных, а последовательно сами данные по мере их поступления. Это идеально подходит для загрузки больших двоичных объектов или других больших структур данных.

> [!NOTE]
> При указании объекту **DataReader** использовать метод **SequentialAccess** важно отметить последовательность, в которой должны открываться возвращенные поля. При характере действий объекта **DataReader** по умолчанию, когда загружается вся строка целиком, как только она есть в наличии, пока не будет считана следующая строка, доступ к возвращенным полям можно получить в любом порядке. Однако при использовании метода **SequentialAccess** открывать поля, возвращенные объектом **DataReader**, необходимо по порядку. Например, если запрос возвращает три столбца и третий из них - это большой двоичный объект, необходимо возвратить значение первого и второго поля перед тем, как открыть данные большого двоичного объекта в третьем поле. Если открыть третье поле сначала, то значения первого и второго полей будут недоступны. Произойдет это потому, что метод **SequentialAccess** внес изменение в объект **DataReader**, согласно которому данные должны возвращаться последовательно. Поэтому, если объект **DataReader** считал последующие данные раньше предыдущих, предыдущие данные будут недоступны.

При доступе к данным в поле большого двоичного объекта используйте типизированные методы доступа **GetBytes** или **GetChars** объекта **DataReader**, которые заполняют массив данными. Также можно использовать метод **GetString** для символьных данных, однако для сохранения ресурсов системы лучше не загружать все значение большого двоичного объекта в одну строковую переменную. Вместо этого можно указать определенный размер буфера данных, которые должны быть возвращены, а также начальное положение для первого байта или символа, читаемого из возвращенных данных. Методы **GetBytes** и **GetChars** возвращают значение `long`, которое представляет число возвращенных байт или символов. Если методу **GetBytes** или **GetChars** передать пустой массив, то возвращенное длинное значение будет общим числом байт или символов в большом двоичном объекте. При необходимости можно в массиве указать индекс в качестве начальной позиции для читаемых данных.

## <a name="example"></a>Пример

В следующем примере из [образца базы данных **pubs**](https://github.com/Microsoft/sql-server-samples/tree/master/samples/databases/northwind-pubs) возвращаются идентификатор и логотип издателя. Идентификатор издателя - символьное поле `pub_id`, а эмблема - изображение, которое является большим двоичным объектом. Так как поле **logo** является битовой картой, двоичные данные в этом примере возвращаются при помощи метода **GetBytes**. Обратите внимание, что в текущей строке данных идентификатор издателя читается до эмблемы, поскольку доступ к полям должен осуществляться последовательно.

[!code-csharp[SqlCommand_ExecuteReader_SequentialAccess#1](~/../sqlclient/doc/samples/SqlCommand_ExecuteReader_SequentialAccess.cs#1)]

## <a name="see-also"></a>См. также раздел

- [Двоичные данные и данные больших значений SQL Server](./sql/sql-server-binary-large-value-data.md)
- [Microsoft ADO.NET для SQL Server](microsoft-ado-net-sql-server.md)
