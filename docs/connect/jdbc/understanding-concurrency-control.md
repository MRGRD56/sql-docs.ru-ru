---
title: Основные сведения об управлении параллелизмом
description: Сведения об управлении параллелизмом и сохранении целостности базы данных при разработке многопользовательского приложения с использованием OLE DB Driver for SQL Server.
ms.custom: ''
ms.date: 08/12/2019
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 98b7dabe-9b12-4e1d-adeb-e5b5cb0c96f3
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 9350c62c29acce5e56d60cfcd1fa854a7e2414cd
ms.sourcegitcommit: 129f8574eba201eb6ade1f1620c6b80dfe63b331
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/30/2020
ms.locfileid: "87435305"
---
# <a name="understanding-concurrency-control"></a>Основные сведения об управлении параллелизмом
[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

  Под управлением параллелизмом подразумевают различные техники, которые используются для сохранения целостности базы данных, когда несколько пользователей обновляют строки одновременно. Неверный параллелизм может привести к проблемам, таким как чтение фантомных данных, чтение недействительных данных и неповторяемые чтения. Драйвер [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] реализует интерфейсы всех механизмов параллелизма, используемых [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для разрешения этих проблем.  
  
> [!NOTE]  
>  Дополнительные сведения о параллелизме [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] см. в разделе "Управление параллельным доступом к данным" электронной документации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
## <a name="remarks"></a>Remarks  
 Драйвер JDBC поддерживает следующие типы параллелизма.  
  
|Тип параллелизма|Характеристики|Блокировки строк|Описание|  
|----------------------|---------------------|---------------|-----------------|  
|CONCUR_READ_ONLY|Только для чтения|нет|Обновление посредством курсора не разрешается, недопустима блокировка в отношении строк, входящих в результирующий набор.|  
|CONCUR_UPDATABLE|Оптимистическая, чтение-запись|нет|База данных считает состязание строк нежелательными, но возможными. Целостность строк проверяется сравнением отметки времени.|  
|CONCUR_SS_SCROLL_LOCKS|Пессимистическая, чтение-запись|Да|База данных считает состязание строк вероятным. Целостность строк обеспечивается блокировкой строк.|  
|CONCUR_SS_OPTIMISTIC_CC|Оптимистическая, чтение-запись|нет|База данных считает состязание строк нежелательными, но возможными. Целостность строк проверяется сравнением отметки времени.<br /><br /> Для [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздних версий сервер заменяет это значение на CONCUR_SS_OPTIMISTIC_CCVAL, если таблица не содержит столбец меток времени.<br /><br /> Для версии [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)], если базовая таблица содержит столбец меток времени, используется параметр OPTIMISTIC WITH ROW VERSIONING, даже если указан параметр OPTIMISTIC WITH VALUES. Если указан параметр OPTIMISTIC WITH ROW VERSIONING, и таблица не содержит отметок времени, используется параметр OPTIMISTIC WITH VALUES.|  
|CONCUR_SS_OPTIMISTIC_CCVAL|Оптимистическая, чтение-запись|нет|База данных считает состязание строк нежелательными, но возможными. Целостность строк проверяется сравнением данных строк.|  
  
## <a name="result-sets-that-are-not-updateable"></a>Результирующие наборы не обновляются  
 Обновляемый результирующий набор ― это результирующий набор, в котором строки могут быть вставлены, обновлены и удалены. В следующих случаях служба [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не может создать обновляемый курсор и формирует исключение "Результирующий набор не является обновляемым".  
  
|Причина|Описание|Средство|  
|-----------|-----------------|------------|  
|Инструкция не создается при использовании синтаксиса JDBC 2.0 (или более поздней версии)|В JDBC 2.0 введены новые способы создания инструкций. Если используется синтаксис JDBC 1.0, результирующий набор по умолчанию доступен только для чтения.|Укажите тип результирующего набора и параллелизм при создании инструкции.|  
|Инструкция создается при помощи TYPE_SCROLL_INSENSITIVE|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] создает статический курсор моментального снимка. Курсор отключается от строк базовой таблицы, чтобы защитить курсор от обновления строк другими пользователями.|Используйте TYPE_SCROLL_SENSITIVE, TYPE_SS_SCROLL_KEYSET, TYPE_SS_SCROLL_DYNAMIC или TYPE_FORWARD_ONLY с CONCUR_UPDATABLE, чтобы не создавать статического курсора.|  
|Конструкция таблицы исключает курсор KEYSET или DYNAMIC|Базовая таблица не содержит уникальных ключей, позволяющих [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] уникально идентифицировать строки.|Добавьте уникальные ключи к таблице, чтобы обеспечить уникальную идентификацию каждой строки.|  
  
## <a name="see-also"></a>См. также раздел  
 [Управление результирующими наборами с помощью JDBC Driver](../../connect/jdbc/managing-result-sets-with-the-jdbc-driver.md)  
  
  
