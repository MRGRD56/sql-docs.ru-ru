---
description: Источник Excel
title: Источник Excel | Документы Майкрософт
ms.custom: ''
ms.date: 05/15/2018
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.excelsource.f1
- sql13.dts.designer.excelsourceadapter.connection.f1
- sql13.dts.designer.excelsourceadapter.columns.f1
- sql13.dts.designer.excelsourceadapter.erroroutput.f1
helpviewer_keywords:
- Excel [Integration Services]
- sources [Integration Services], Excel
ms.assetid: e66349f3-b1b8-4763-89b7-7803541a4d62
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e00a786dfb9d9ffe55274822b276a2d2497efd82
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92192770"
---
# <a name="excel-source"></a>Источник Excel

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Источник Excel извлекает данные из листов или диапазонов в книгах [!INCLUDE[msCoName](../../includes/msconame-md.md)] Excel.  

> [!IMPORTANT]
> Дополнительные сведения о подключении к файлам Excel, а также об ограничениях и известных проблемах, связанных с загрузкой данных в файлы этого приложения и из них, см. в разделе [Загрузка данных в приложение Excel или из него с помощью служб SQL Server Integration Services (SSIS)](../load-data-to-from-excel-with-ssis.md).

## <a name="access-modes"></a>Режимы доступа
 Источник Excel предоставляет четыре различных режима доступа к данным для их извлечения:  
  
-   Таблица или представление.  
  
-   Таблица или представление, указанные в переменной.  
  
-   Результат выполнения инструкции SQL. Может использоваться параметризированный запрос.  
  
-   Результат выполнения инструкции SQL хранится в переменной.  
  
 Источник Excel для подключения к источнику данных использует диспетчер соединений Excel, и диспетчер соединений определяет исходный файл книги. Дополнительные сведения см. в статье [Excel Connection Manager](../../integration-services/connection-manager/excel-connection-manager.md).  
  
 Источник Excel имеет один обычный выход и один выход ошибок.  
  
## <a name="excel-source-configuration"></a>Настройка источника Excel  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.  
  
 Диалоговое окно **Расширенный редактор** содержит все свойства, которые могут устанавливаться программными средствами. Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне **Расширенный редактор** или программными средствами, см. в следующих разделах.  
  
-   [Общие свойства](./set-the-properties-of-a-data-flow-component.md)  
  
-   [Пользовательские свойства Excel](../../integration-services/data-flow/excel-custom-properties.md)  
  
 Дополнительные сведения о переходе между файлами в группе файлов Excel см. в разделе [Просмотр файлов и таблиц Excel с помощью контейнера "Цикл по каждому элементу"](../../integration-services/control-flow/loop-through-excel-files-and-tables-by-using-a-foreach-loop-container.md).  
  
## <a name="excel-source-editor-connection-manager-page"></a>Редактор источника Excel (страница «Диспетчер соединений»)
  Используйте раздел **Диспетчер соединений** диалогового окна **Редактор источника «Excel»** , чтобы выбрать используемую рабочую книгу [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] . Источник Excel считывает данные из рабочего листа или из именованного диапазона в существующей рабочей книге.  
  
> [!NOTE]  
>  Свойство **CommandTimeout** источника Excel недоступно в диалоговом окне **Редактор источника «Excel»**, но может быть задано с помощью диалогового окна **Расширенный редактор**. Дополнительные сведения о данном свойстве см. в подразделе «Источник Excel» раздела [Excel Custom Properties](../../integration-services/data-flow/excel-custom-properties.md).  
  
### <a name="static-options"></a>Статические параметры  
 **Диспетчер соединений OLE DB**  
 Выберите из списка существующий диспетчер подключений к Excel или создайте новое соединение, нажав кнопку **Создать**.  
  
 **Создать**  
 Создайте новый диспетчер подключений с помощью диалогового окна **Диспетчер подключений Excel** .  
  
 **Режим доступа к данным**  
 Укажите метод выбора данных из источника.  
  
|Значение|Описание|  
|-----------|-----------------|  
|Таблица или представление|Получение данных из электронной таблицы или именованного диапазона файла Excel.|  
|Переменная, содержащая имя таблицы или представления|Укажите переменную, содержащую имя листа или диапазона.<br /><br /> **Дополнительные сведения.** [Использование переменных в пакетах](../integration-services-ssis-variables.md)|  
|Команда SQL|Получение данных из файла Excel с использованием SQL-запроса. |  
|Команда SQL из переменной|Задайте текст SQL-запроса в переменную.|  
  
 **Предварительный просмотр**  
 Осуществляйте предварительный просмотр результатов в диалоговом окне **Просмотр данных** . В окне «Предварительный просмотр» может отображаться до 200 строк.  
  
### <a name="data-access-mode-dynamic-options"></a>Динамические параметры режима доступа к данным  
  
#### <a name="data-access-mode--table-or-view"></a>Режим доступа к данным = Таблица или представление  
 **Имя листа Excel**  
 Выберите в книге Excel из списка имя листа или именованного диапазона.  
  
#### <a name="data-access-mode--table-name-or-view-name-variable"></a>Режим доступа к данным — переменная, содержащая имя таблицы или представления  
 **Имя переменной**  
 Укажите переменную, содержащую имя листа или именованного диапазона.  
  
#### <a name="data-access-mode--sql-command"></a>Режим доступа к данным — команда SQL  
 **Текст команды SQL**  
 Введите текст SQL-запроса, создайте запрос, нажав кнопку **Создать запрос**, или выберите файл, содержащий текст запроса, нажав кнопку **Обзор**.  
  
 **Параметры**  
 Если введен параметризованный запрос, где в тексте запроса в качестве заполнителя параметра использовался знак ?, воспользуйтесь диалоговым окном **Установка параметров запроса** для сопоставления входных параметров запроса и переменных пакета.  
  
 **Создать запрос**  
 Воспользуйтесь диалоговым окном **Построитель запросов** для визуального конструирования SQL-запроса.  
  
 **Обзор**  
 Воспользуйтесь диалоговым окном **Открыть** для выбора файла, содержащего текст SQL-запроса.  
  
 **Анализ запроса**  
 Проверить синтаксис текста запроса.  
  
#### <a name="data-access-mode--sql-command-from-variable"></a>Режим доступа к данным = Команда SQL из переменной  
 **Имя переменной**  
 Выберите переменную, содержащую текст SQL-запроса.  
  
## <a name="excel-source-editor-columns-page"></a>Редактор источника Excel (страница «Столбцы»)
  Страница **Столбцы** в диалоговом окне **Редактор источника "Excel"** предназначена для сопоставления выходного столбца с каждым внешним (исходным) столбцом.  
  
### <a name="options"></a>Параметры  
 **Доступные внешние столбцы**  
 Просмотр списка доступных внешних столбцов источника данных. В этой таблице нельзя добавлять или удалять столбцы.  
  
 **Внешний столбец**  
 Просмотр внешних (исходных) столбцов в том порядке, в котором их будет считывать задача. Этот порядок можно изменить, вначале очистив выделенные столбцы в таблице, а затем выбрав в списке внешние столбцы, идущие в другом порядке.  
  
 **Выходной столбец**  
 Введите уникальное имя для каждого выходного столбца. По умолчанию используется имя выбранного внешнего (исходного) столбца, однако можно выбрать любое уникальное описательное имя. Выбранное имя будет отображаться в конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .  
  
## <a name="excel-source-editor-error-output-page"></a>Редактор источника Excel (страница «Вывод ошибок»)
  Страница **Вывод ошибок** диалогового окна **Редактор источника «Excel»** используется для выбора параметров обработки ошибок, а также для установки свойств выходных столбцов ошибок.  
  
### <a name="options"></a>Параметры  
 **Вход или выход**  
 Просмотр имени источника данных.  
  
 **Столбец**  
 Позволяет просмотреть внешние (исходные) столбцы, выбранные на странице **Диспетчер соединений** диалогового окна **Редактор источника "Excel"**.  
  
 **Error**  
 Задайте действие, которое необходимо выполнить при возникновении ошибки: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **См. также:** [Обработка ошибок в данных](../../integration-services/data-flow/error-handling-in-data.md)  
  
 **Усечение**  
 Укажите, что нужно сделать при усечении: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Описание**  
 Просмотреть описание ошибки.  
  
 **Присвоить указанное значение выбранным ячейкам**  
 Укажите действие, которое необходимо применить ко всем выбранным ячейкам при возникновении ошибки или усечения: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Применить**  
 Применить параметр обработки ошибок к выбранным ячейкам.  
  
## <a name="related-content"></a>См. также  
[Загрузка данных в приложение Excel или из него с помощью служб SQL Server Integration Services (SSIS)](../load-data-to-from-excel-with-ssis.md)  
[Назначение «Excel»](excel-destination.md)  
[Диспетчер подключений Excel](../connection-manager/excel-connection-manager.md)