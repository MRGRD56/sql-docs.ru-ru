---
description: ODBC-источник
title: Источник ODBC | Документы Майкрософт
ms.custom: ''
ms.date: 03/01/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.ssis.designer.odbcsource.f1
- sql13.ssis.designer.odbcsource.connection.f1
- sql13.ssis.designer.odbcsource.columns.f1
- sql13.ssis.designer.odbcsource.errorhandling.f1
ms.assetid: abcf34eb-9140-4100-82e6-b85bccd22abe
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 12d70dc722250d33de52bf8d1f13d1ab06083108
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92194785"
---
# <a name="odbc-source"></a>ODBC-источник

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Источник ODBC извлекает данные из базы данных с поддержкой ODBC с использованием таблицы базы данных, представления или инструкции SQL.  
  
 В источнике ODBC предусмотрены следующие режимы доступа к данным для извлечения данных.  
  
-   Таблица или представление.  
  
-   Результат выполнения инструкции SQL.  
  
 В источнике используется диспетчер соединений ODBC, который указывает применяемого поставщика.  
  
 Источник ODBC включает выходные столбцы исходных данных. При сопоставлении в назначении ODBC выходных столбцов со столбцами назначения могут возникнуть ошибки, если не задано сопоставление выходных столбцов с целевыми столбцами. Сопоставлены могут быть столбцы различных типов, однако если выходные данные несовместимы с назначением, то во время выполнения возникает ошибка. В зависимости от настройки поведения в случае ошибки, ошибка может быть пропущена, может быть вызван сбой, или строка может быть отправлена в вывод ошибок.  
  
 Источник ODBC имеет один обычный вывод и один вывод ошибок.  
  
## <a name="error-handling"></a>Обработка ошибок  
 Источник ODBC имеет вывод ошибок. Вывод ошибок компонента включает следующие выходные столбцы.  
  
-   **Код ошибки**. Номер, который соответствует текущей ошибке. См. документацию для базы данных с поддержкой ODBC, которая используется для получения списка ошибок. Список кодов ошибок служб SSIS см. в «Справочнике по кодам ошибок и сообщениям служб SIS».  
  
-   **Столбец с ошибкой**. Входной столбец, вызывающий ошибку (это относится к ошибкам преобразования).  
  
-   Стандартные устройства вывода столбцов данных.  
  
 В зависимости от настройки поведения в случае ошибки, источник ODBC поддерживает возврат ошибок (преобразование данных, усечение), которые обнаруживаются в процессе извлечения в выводе ошибок. Дополнительные сведения см. в статье [Редактор назначения ODBC (страница "Диспетчер соединений")](./odbc-destination.md).  
  
## <a name="data-type-support"></a>Поддержка типов данных  
 Сведения о типах данных, поддерживаемых источником ODBC, см. в информации о компоненте "Соединитель для ODBC".  
  
## <a name="extract-options"></a>Параметры извлечения  
 Источник ODBC работает в пакетном ( **Batch** ) или построчном ( **Row-by-Row** ) режиме. Используемый режим определяется свойством **FetchMethod** . Описания режимов приведены в следующем списке.  
  
-   **Batch**: компонент предпринимает попытку использовать наиболее эффективный метод выборки на основе предполагаемых возможностей поставщика ODBC. Для наиболее современных поставщиков ODBC этим методом является SQLFetchScroll с привязкой массива (где размер массива определяется свойством **BatchSize** ). Если выбран режим **Batch** , а поставщик не поддерживает этот способ выборки, назначение ODBC автоматически переключается на режим **Row-by-row** .  
  
-   **Row-by Row**: компонент использует метод SQLFetch для получения строк друг за другом.  
  
 Дополнительные сведения о свойстве **FetchMethod** см. в разделе [ODBC Source Custom Properties](../../integration-services/data-flow/odbc-source-custom-properties.md).  
  
## <a name="parallelism"></a>Parallelism  
 Какие-либо ограничения на количество исходных компонентов ODBC, которые могут запускаться параллельно по отношению к одной и той же таблице или к разным таблицам, на одном и том же компьютере или на разных компьютерах (кроме обычных глобальных предельных параметров сеанса), отсутствуют.  
  
 Однако количество параллельных соединений через поставщика может быть ограничено в используемом поставщике ODBC. Эти ограничения задают количество параллельных экземпляров, которые могут поддерживаться для источника ODBC. Разработчик служб SSIS должен знать ограничения всех используемых поставщиков ODBC и учитывать их при построении пакетов служб SSIS.  
  
## <a name="troubleshooting-the-odbc-source"></a>Устранение нарушений в работе источника ODBC  
 Предусмотрена возможность вести журнал вызовов к внешним поставщикам данных, выполняемых источником ODBC. Эту возможность ведения журнала можно использовать для устранения нарушений, связанных с загрузкой данных из внешних источников данных, выполняемой источником ODBC. Для ведения журнала вызовов к внешним поставщикам данных, выполняемых источником ODBC, включите трассировку диспетчера драйвера ODBC. Дополнительные сведения см. в документации Майкрософт по теме *Как формировать трассировку ODBC с помощью администратора источника данных ODBC*.  
  
## <a name="configuring-the-odbc-source"></a>Настройка ODBC-источника  
 Источник ODBC вы можете настраивать программным путем или с помощью конструктора SSIS.  
  
 Диалоговое окно **Расширенный редактор** содержит свойства, которые могут быть заданы программным путем.  
  
 Открытие диалогового окна **Расширенный редактор** .  
  
-   На экране **Поток данных** конкретного проекта [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] щелкните правой кнопкой мыши источник ODBC и выберите пункт **Показать расширенный редактор**.  
  
 Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне «Расширенный редактор», см. в разделе [ODBC Source Custom Properties](../../integration-services/data-flow/odbc-source-custom-properties.md).  
  
## <a name="in-this-section"></a>в этом разделе  
  
-   [Извлечение данных с помощью источника ODBC](../../integration-services/data-flow/extract-data-by-using-the-odbc-source.md)  
  
-   [Пользовательские свойства источника «ODBC»](../../integration-services/data-flow/odbc-source-custom-properties.md)  
  
## <a name="odbc-source-editor-connection-manager-page"></a>Редактор источника «ODBC» (страница «Диспетчер соединений»)
  Используйте страницу **Диспетчер соединений** диалогового окна **Редактор источника ODBC** , чтобы выбрать диспетчер соединений ODBC для источника. На этой странице также можно выбрать таблицу или представление базы данных.  
  
### <a name="task-list"></a>Список задач  
 **Открытие страницы диспетчера соединений в редакторе источника ODBC**  
  
-   В среде [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]откройте пакет служб [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] , содержащий источник ODBC.  
  
-   На вкладке **Поток данных** дважды щелкните источник ODBC.  
  
### <a name="options"></a>Параметры  
  
#### <a name="connection-manager"></a>Диспетчер соединений  
 Выберите из списка существующий диспетчер соединений ODBC или нажмите кнопку **Создать** , чтобы создать новое соединение. Соединение может устанавливаться с любой базой данных, поддерживающей ODBC.  
  
#### <a name="new"></a>Создать  
 Нажмите кнопку **Создать**. Откроется диалоговое окно **Настройка редактора диспетчера соединений ODBC** , где можно создать новый диспетчер соединений ODBC.  
  
#### <a name="data-access-mode"></a>Режим доступа к данным  
 Выберите метод выбора данных из источника. Доступные параметры показаны в следующей таблице.  
  
|Параметр|Описание|  
|------------|-----------------|  
|Имя таблицы|Получение данных из таблицы или представления в источнике данных ODBC. Если выбран этот параметр, выберите значение из следующего списка.|  
||**Имя таблицы или представления**. Выберите доступную таблицу или представление из списка или введите регулярное выражение, определяющее таблицу.|  
||Этот список содержит только первые 1000 таблиц. Если база данных содержит больше 1000 таблиц, можно ввести начальную часть имени таблицы или воспользоваться символом-шаблоном (*), чтобы ввести любую часть имени для вывода нужных таблиц.|  
|Команда SQL|Получение данных из источника данных ODBC с помощью SQL-запроса. Запрос следует писать с соблюдением синтаксиса исходной базы данных, в которой будет работать запрос. Если выбран этот параметр, введите запрос одним из следующих способов.|  
||Введите текст SQL-запроса в поле **Текст команды SQL** .|  
||Нажмите кнопку **Обзор** , чтобы загрузить SQL-запрос из текстового файла.|  
||Чтобы проверить синтаксис текста запроса, нажмите кнопку **Анализ запроса** .|  
  
#### <a name="preview"></a>Предварительный просмотр  
 Нажмите кнопку **Просмотр** , чтобы просмотреть первые 200 строк данных, извлеченных из выбранной таблицы или представления.  
  
## <a name="odbc-source-editor-columns-page"></a>Редактор источника «ODBC» (страница «Столбцы»)
  Страница **Столбцы** диалогового окна **Редактор источника ODBC** используется для сопоставления выходного столбца с каждым внешним (исходным) столбцом.  
  
### <a name="task-list"></a>Список задач  
 **Открытие страницы «Столбцы» редактора источника ODBC**  
  
1.  В среде [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]откройте пакет служб [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] , содержащий источник ODBC.  
  
2.  На вкладке **Поток данных** дважды щелкните источник ODBC.  
  
3.  В окне **Редактор источника ODBC**нажмите кнопку **Столбцы**.  
  
### <a name="options"></a>Параметры  
  
#### <a name="available-external-columns"></a>Доступные внешние столбцы  
 Список доступных внешних столбцов источника данных. В этой таблице нельзя добавлять или удалять столбцы. Выберите используемые столбцы источника. Выбранные столбцы добавляются в список **Внешний столбец** в порядке выбора.  
  
 Чтобы выбрать все столбцы, установите флажок **Выделить все** .  
  
#### <a name="external-column"></a>Внешний столбец  
 Представление внешних (исходных) столбцов в порядке, заданном при настройке компонентов, которые обрабатывают данные из источника ODBC.  
  
#### <a name="output-column"></a>Выходной столбец  
 Введите уникальное имя для каждого выходного столбца. По умолчанию используется имя выбранного внешнего (исходного) столбца, однако можно выбрать любое уникальное описательное имя. Введенное имя отображается в конструкторе служб SSIS.  
  
## <a name="odbc-source-editor-error-output-page"></a>Редактор источника «ODBC» (страница «Вывод ошибок»)
  Страница **Вывод ошибок** диалогового окна **Редактор источника ODBC** используется для выбора параметров обработки ошибок.  
  
### <a name="task-list"></a>Список задач  
 **Открытие страницы «Вывод ошибок» редактора источника ODBC**  
  
-   В среде [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]откройте пакет служб [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] , содержащий источник ODBC.  
  
-   На вкладке **Поток данных** дважды щелкните источник ODBC.  
  
-   В окне **Редактор источника ODBC**нажмите кнопку **Вывод ошибок**.  
  
### <a name="options"></a>Параметры  
  
#### <a name="inputoutput"></a>Ввод-вывод  
 Просмотр имени источника данных.  
  
#### <a name="column"></a>Столбец  
 Не используется.  
  
#### <a name="error"></a>Ошибка  
 Выберите порядок обработки ошибок в потоке источником ODBC: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
#### <a name="truncation"></a>Усечение  
 Выберите порядок обработки усечений в потоке источником ODBC: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
#### <a name="description"></a>Описание  
 Не используется.  
  
#### <a name="set-this-value-to-selected-cells"></a>Присвоить указанное значение выбранным ячейкам  
 Выберите, как источник ODBC обрабатывает все выбранные ячейки при возникновении ошибки или усечения: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
#### <a name="apply"></a>Применить  
 Примените параметры обработки ошибок к выбранным ячейкам.  
  
### <a name="error-handling-options"></a>Параметры обработки ошибок  
 Следующие параметры позволяют настроить обработку ошибок и усечений источником ODBC.  
  
#### <a name="fail-component"></a>Компонент, завершившийся сбоем  
 Задача потока данных заканчивается сбоем, если возникли ошибка или усечение. Это поведение по умолчанию.  
  
#### <a name="ignore-failure"></a>Пропуск неудачи  
 Ошибка или усечение пропускается.  
  
#### <a name="redirect-flow"></a>Перенаправление потока  
 Строка, вызывающая ошибку или усечение, направляется на вывод ошибок источника ODBC.  
  
