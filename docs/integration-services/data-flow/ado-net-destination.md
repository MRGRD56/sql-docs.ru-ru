---
description: Назначение «ADO.NET»
title: Назначение "ADO.NET" | Документы Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.adonetdest.f1
- sql13.dts.designer.adonetdest.connection.f1
- sql13.dts.designer.adonetdest.mappings.f1
- sql13.dts.designer.adonetdest.erroroutput.f1
helpviewer_keywords:
- destinations [Integration Services], ADO.NET
- ADO.NET destination
ms.assetid: cb883990-d875-4d8b-b868-45f9f15ebeae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 146a75e907131d5faae03da46419b3b4137c01ca
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92194879"
---
# <a name="ado-net-destination"></a>Назначение «ADO.NET»

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Назначение ADO NET загружает данные в различные базы данных, совместимые с [!INCLUDE[vstecado](../../includes/vstecado-md.md)], которые используют таблицу или представление базы данных. Можно загрузить эти данные в существующую таблицу или представление либо создать новую таблицу и загрузить в нее данные.  
  
 Вы можете использовать назначение "ADO.NET" для соединения с [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssSDSFull](../../includes/sssdsfull-md.md)]. Соединение с базой данных [!INCLUDE[ssSDS](../../includes/sssds-md.md)] с помощью OLE DB не поддерживается. Дополнительные сведения о [!INCLUDE[ssSDS](../../includes/sssds-md.md)] см. в статье об [общих рекомендациях и ограничениях Базы данных SQL Azure](/previous-versions/azure/ee336245(v=azure.100)).  
  
## <a name="troubleshooting-the-ado-net-destination"></a>Устранение неполадок, связанных с назначением «ADO.NET»  
 Вы можете протоколировать вызовы, сделанные назначением «ADO.NET» к внешним поставщикам данных. Эти функции ведения журналов можно использовать для устранения неполадок при сохранении данных во внешних источниках данных, выполняемых назначением ADO NET. Чтобы протоколировать вызовы, выполненные назначением ADO NET к внешнему поставщику данных, необходимо разрешить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета. Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../../integration-services/troubleshooting/troubleshooting-tools-for-package-execution.md).  
  
## <a name="configuring-the-ado-net-destination"></a>Настройка назначения «ADO.NET»  
 Чтобы подключиться к источнику данных, назначение использует диспетчер соединений [!INCLUDE[vstecado](../../includes/vstecado-md.md)] . Диспетчером соединений указывается поставщик [!INCLUDE[vstecado](../../includes/vstecado-md.md)] для использования. Дополнительные сведения см. в статье [ADO.NET Connection Manager](../../integration-services/connection-manager/ado-net-connection-manager.md).  
  
 Назначение ADO NET содержит сопоставления между входными столбцами и столбцами в источнике данных назначения. Не обязательно сопоставлять входные столбцы всем целевым столбцам. Однако свойства некоторых целевых столбцов могут требовать сопоставления с входными столбцами. В противном случае могут происходить ошибки. Например, если целевой столбец не допускает значений NULL, ему должен быть сопоставлен входной столбец. Кроме того, типы данных сопоставленных столбцов должны быть совместимыми. Например, нельзя сопоставить входной столбец строкового типа с целевым столбцом числового типа данных, если поставщик [!INCLUDE[vstecado](../../includes/vstecado-md.md)] не поддерживает такое сопоставление.  
  
> [!NOTE]  
>  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не поддерживает вставку текста в столбцы, для которых установлен тип данных image. Дополнительные сведения о типах значений [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] см. в разделе [Типы данных (Transact-SQL)](../../t-sql/data-types/data-types-transact-sql.md).  
  
> [!NOTE]  
>  Назначение ADO NET не поддерживает сопоставление входного столбца типа DT_DBTIME столбцу базы данных типа datetime. Дополнительные сведения о типах данных [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] см. в разделе [Типы данных служб Integration Services](../../integration-services/data-flow/integration-services-data-types.md).  
  
 Назначение «ADO.NET» имеет один обычный вход и один вывод ошибок на выходе.  
  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.  
  
 Диалоговое окно **Расширенный редактор** содержит свойства, которые можно установить с помощью программных средств. Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне **Расширенный редактор** или программными средствами, см. в следующих разделах.  
  
-   [Общие свойства](./set-the-properties-of-a-data-flow-component.md)  
  
-   [Пользовательские свойства ADO NET](../../integration-services/data-flow/ado-net-custom-properties.md)  
  
 Дополнительные сведения о настройке свойств см. в разделе [Установление свойств компонента потока данных](../../integration-services/data-flow/set-the-properties-of-a-data-flow-component.md).  
  
## <a name="ado-net-destination-editor-connection-manager-page"></a>Редактор назначения «ADO.NET» (страница «Диспетчер соединений»)
  Используйте страницу **Диспетчер соединений** диалогового окна **Редактор назначения «ADO.NET»** , чтобы выбрать соединение [!INCLUDE[vstecado](../../includes/vstecado-md.md)] для назначения. На этой странице также можно выбрать таблицу или представление базы данных.  
  
 **Открытие страницы «Диспетчер соединений»**  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте пакет [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , содержащий назначение «ADO.NET».  
  
2.  На вкладке **Поток данных** дважды щелкните назначение "ADO.NET".  
  
3.  В окне **Редактор назначения «ADO.NET»** нажмите кнопку **Диспетчер соединений**.  
  
### <a name="static-options"></a>Статические параметры  
 **Connection manager**  
 Выберите из списка существующий диспетчер соединений или создайте новое соединение, нажав кнопку **Создать**.  
  
 **Создать**  
 Создайте новый диспетчер соединений с помощью диалогового окна **Настройка диспетчера соединений ADO.NET** .  
  
 **Использовать таблицу или представление**  
 Выберите существующую таблицу или представление из списка или создайте новую таблицу, выбрав пункт **Создать**.  
  
 **Создать**  
 Создайте новую таблицу, используя диалоговое окно **Создание таблицы** .  
  
> [!NOTE]  
>  При нажатии кнопки **Создать**службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] по умолчанию формируют инструкцию CREATE TABLE на основе подключенного источника данных. Эта инструкция CREATE TABLE не включает атрибут FILESTREAM, даже если исходная таблица содержит столбец, для которого объявлен атрибут FILESTREAM. Чтобы запустить компонент служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] с атрибутом FILESTREAM, сначала следует создать хранилище FILESTREAM в целевой базе данных. Затем добавьте атрибут FILESTREAM к инструкции CREATE TABLE в диалоговом окне **Создание таблицы** . Дополнительные сведения см. в разделе [Данные большого двоичного объекта (SQL Server)](../../relational-databases/blob/binary-large-object-blob-data-sql-server.md).  
  
 **Предварительный просмотр**  
 Просмотрите предварительные результаты, используя диалоговое окно **Предварительный просмотр результатов запроса** . В окне «Предварительный просмотр» может отображаться до 200 строк.  
  
 **По возможности следует использовать массовую вставку**  
 Укажите, следует ли использовать интерфейс <xref:System.Data.SqlClient.SqlBulkCopy> для улучшения производительности операций массовой вставки.  
  
 Только поставщики ADO.NET, возвращающие объект <xref:System.Data.SqlClient.SqlConnection> , поддерживают использование интерфейса <xref:System.Data.SqlClient.SqlBulkCopy> . Поставщик данных .NET для SQL Server (SqlClient) возвращает объект <xref:System.Data.SqlClient.SqlConnection> , а настраиваемый поставщик может возвращать объект <xref:System.Data.SqlClient.SqlConnection> .  
  
 Вы можете использовать поставщик данных .NET для SQL Server (SqlClient), чтобы подключаться к [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssSDSFull](../../includes/sssdsfull-md.md)].  
  
 Если был выбран параметр **По возможности использовать массовую вставку**, а для параметра **Ошибка** задано значение **Перенаправить строку**, то в пакет данных, перенаправляемый объектом назначения в вывод ошибок, могут попасть и строки, не содержащие ошибок. Дополнительные сведения об обработке ошибок в массовых операциях см. в разделе [Обработка ошибок в данных](../../integration-services/data-flow/error-handling-in-data.md). Дополнительные сведения о параметре **Ошибка** см. в разделе [Редактор назначения ADO.NET (страница "Вывод ошибок")]().  
  
> [!NOTE]
>  Если исходная таблица SQL Server или Sybase включает столбец идентификаторов, то необходимо использовать задачи "Выполнение SQL" для включения инструкции IDENTITY_INSERT до доступа к назначению "ADO.NET" и ее отключение после доступа. (Это свойство столбца идентификаторов указывает значение приращения для столбца. Инструкция SET IDENTITY_INSERT позволяет вставлять явные значения из таблицы источника в столбец идентификаторов таблицы назначения.)  
> 
>   Чтобы выполнить инструкции SET IDENTITY_INSERT и успешно загрузить данные, необходимо сделать следующее.  
>       1. Используйте один и тот же диспетчер соединений ADO.NET для задач "Выполнение SQL" и назначения "ADO NET".  
>       2. В диспетчере соединений присвойте свойствам **RetainSameConnection** и **MultipleActiveResultSets** значение True.  
>       3. В назначении "ADO.NET" присвойте свойству **UseBulkInsertWhenPossible** значение False.   
> 
>  Дополнительные сведения см. в разделе [SET IDENTITY_INSERT (Transact-SQL)](../../t-sql/statements/set-identity-insert-transact-sql.md) и [IDENTITY (свойство) (Transact-SQL)](../../t-sql/statements/create-table-transact-sql-identity-property.md).  
  
## <a name="external-resources"></a>Внешние ресурсы  
 Техническая статья о [быстром способе загрузки данных в Базу данных SQL Azure](https://go.microsoft.com/fwlink/?LinkId=244333) на сайте sqlcat.com  
  
## <a name="ado-net-destination-editor-mappings-page"></a>Редактор назначения «ADO.NET» (страница «Сопоставления»)
  Страница **Сопоставления** диалогового окна **Редактор назначения «ADO.NET»** используется для сопоставления входных столбцов с целевыми.  
  
 **Открытие страницы «Сопоставления»**  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте пакет [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , содержащий назначение «ADO.NET».  
  
2.  На вкладке **Поток данных** дважды щелкните назначение "ADO.NET".  
  
3.  В окне **Редактор назначения «ADO.NET»** нажмите кнопку **Сопоставления**.  
  
### <a name="options"></a>Параметры  
 **Доступные входные столбцы**  
 Просмотрите список доступных входных столбцов. Для сопоставления доступных входных столбцов с целевыми столбцами используется операция перетаскивания.  
  
 **Доступные целевые столбцы**  
 Просмотрите список доступных целевых столбцов. Чтобы сопоставить доступные целевые столбцы с входными столбцами, воспользуйтесь операцией перетаскивания.  
  
 **Входной столбец**  
 Позволяет просматривать выбранные входные столбцы. Сопоставления можно удалить, выбрав вариант **\<ignore>** , чтобы исключить столбцы из выходных данных.  
  
 **Целевой столбец**  
 Позволяет просмотреть каждый из доступных целевых столбцов без учета наличия или отсутствия сопоставления.  
  
## <a name="ado-net-destination-editor-error-output-page"></a>Редактор назначения «ADO.NET» (страница «Вывод ошибок»)
  Страница **Вывод ошибок** диалогового окна **Редактор назначения «ADO.NET»** используется для задания параметров обработки ошибок.  
  
 **Открытие страницы «Вывод ошибок»**  
  
1.  В среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]откройте пакет [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , содержащий назначение «ADO.NET».  
  
2.  На вкладке **Поток данных** дважды щелкните назначение "ADO.NET".  
  
3.  В окне **Редактор назначения «ADO.NET»** нажмите кнопку **Вывод ошибок**.  
  
### <a name="options"></a>Параметры  
 **Вход или выход**  
 Просмотрите имя входных данных.  
  
 **Столбец**  
 Не используется.  
  
 **Error**  
 Задайте действие, которое необходимо выполнить при возникновении ошибки: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **См. также:** [Обработка ошибок в данных](../../integration-services/data-flow/error-handling-in-data.md)  
  
 **Усечение**  
 Не используется.  
  
 **Описание**  
 Просмотрите описание операции.  
  
 **Присвоить указанное значение выбранным ячейкам**  
 Укажите действие, которое необходимо применить ко всем выбранным ячейкам при возникновении ошибки или усечения: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Применить**  
 Применить параметр обработки ошибок к выбранным ячейкам.  
  
