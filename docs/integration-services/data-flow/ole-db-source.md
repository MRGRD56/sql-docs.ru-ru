---
description: Источник OLE DB
title: Источник OLE DB | Документы Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.oledbsource.f1
- sql13.dts.designer.oledbsourceadapter.connection.f1
- sql13.dts.designer.oledbsourceadapter.columns.f1
- sql13.dts.designer.oledbsourceadapter.errorhandling.f1
helpviewer_keywords:
- sources [Integration Services], OLE DB
- OLE DB source [Integration Services]
ms.assetid: f87cc5f6-b078-40f3-9d87-7a65e13e4c86
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a61d85e961b2572ce60d9766e7df0c83d042e84e
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92195376"
---
# <a name="ole-db-source"></a>Источник OLE DB

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Источник OLE DB извлекает сведения из множества поддерживающих технологию OLE DB реляционных баз данных с помощью таблицы базы данных, представления или команды SQL. Например, источник OLE DB может извлекать данные из таблиц [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office Access или [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
> [!NOTE]  
>  Для источника данных [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office Excel 2007 потребуется поставщик данных, отличный от того, который использовался в предыдущих версиях Excel. Дополнительные сведения см. в разделе [Подключение к книге Excel](../load-data-to-from-excel-with-ssis.md).  
  
 Источник OLE DB предоставляет четыре различных режима доступа к данным, используемые при извлечении данных:  
  
-   Таблица или представление.  
  
-   Таблица или представление, указанные в переменной.  
  
-   Результат выполнения инструкции SQL. Может использоваться параметризированный запрос.  
  
-   Результат выполнения инструкции SQL хранится в переменной.  
  
> [!NOTE]  
>  Когда инструкция SQL используется для вызова хранимой процедуры, возвращающей результаты из временной таблицы, используйте параметр WITH RESULT SETS для определения метаданных набора результатов.  
  
 При использовании параметризированного запроса можно сопоставить переменные с параметрами, чтобы задать значения для отдельных параметров в инструкциях SQL.  
  
 Данный источник для подключения к источнику данных использует диспетчер соединений OLE DB, в котором задается используемый поставщик OLE DB. Дополнительные сведения см. в разделе [Диспетчер соединений OLE DB](../../integration-services/connection-manager/ole-db-connection-manager.md).  
  
 Проект служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] также предоставляет объект источника данных, из которого можно создать диспетчер соединений OLE DB, делая источники данных и представления источников данных доступными для источника OLE DB.  
  
 Некоторые поставщики OLE DB накладывают определенные ограничения на источник OLE DB.  
  
-   Поставщик [!INCLUDE[msCoName](../../includes/msconame-md.md)] OLE DB для Oracle не поддерживает типы данных Oracle BLOB, CLOB, NCLOB, BFILE или UROWID, так что источник OLE DB не может извлекать данные из таблиц, содержащих столбцы с этими типами данных.  
  
-   Поставщики IBM OLE DB DB2 и [!INCLUDE[msCoName](../../includes/msconame-md.md)] OLE DB DB2 не поддерживают команду SQL, вызывающую хранимую процедуру. Если такая команда использована, источник OLE DB не может создать метаданные столбца. В результате этого отсутствуют доступные столбцы данных для компонентов потоков данных, которые располагаются следом за источником OLE DB в потоке данных, что приводит к сбою потокового выполнения.  
  
 Источник OLE DB имеет один обычный выход и один выход ошибок.  
  
## <a name="using-parameterized-sql-statements"></a>Использование параметризованных инструкций SQL  
 Источник OLE DB может использовать инструкцию SQL для извлечения данных. Это может быть инструкция SELECT или EXEC.  
  
 Источник OLE DB использует диспетчер соединений OLE DB для соединения с источником данных, из которого происходит извлечение данных. В зависимости от поставщика, используемого диспетчером соединений OLE DB, и СУРБД, с которой он соединяется, имена и списки параметров подчиняются разным правилам. Если имена параметров возвращаются из СУРБД, их можно использовать для сопоставления параметров из списка с параметрами из инструкции SQL, в противном случае параметры сопоставляются с параметрами в инструкции SQL в соответствии с их порядковым положением в списке параметров. Типы поддерживаемых имен параметров зависят от поставщика. Например, одни поставщики требуют, чтобы использовались имена переменных или столбцов, а другие требуют, чтобы использовались символьные имена, например, 0 или Param0. Правила именования параметров в инструкциях SQL см. в документации к поставщику.  
  
 Если используется диспетчер соединений OLE DB, нельзя использовать параметризованные вложенные запросы, поскольку источник OLE DB не сможет получить сведения о параметрах через поставщик OLE DB. Однако можно использовать выражение, чтобы объединить значения параметров в строку запроса и задать свойство SqlCommand источника. В конструкторе служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] можно настроить источник OLE DB с помощью диалогового окна **Редактор источника "OLE DB"** , а также сопоставить переменные с параметрами в диалоговом окне **Установка параметров запроса** .  
  
### <a name="specifying-parameters-by-using-ordinal-positions"></a>Задание параметров с помощью порядкового положения  
 Если имена параметров не возвращаются, то, с какими создателями параметров они сопоставляются во время выполнения, определяет порядок следования параметров в списке **Параметры** в диалоговом окне **Установка параметров запроса** . Первый параметр в списке сопоставляется с первым символом «?» в инструкции SQL, второй параметр сопоставляется со вторым символом «?», и т. д.  
  
 Следующая инструкция SQL выбирает строки из таблицы **Product** в базе данных [!INCLUDE[ssSampleDBUserInputNonLocal](../../includes/sssampledbuserinputnonlocal-md.md)] . Первый параметр в списке **Сопоставления** сопоставляется с первым параметром, со столбцом **Color** , второй параметр сопоставляется со столбцом **Size** .  
  
 `SELECT * FROM Production.Product WHERE Color = ? AND Size = ?`  
  
 Имена параметров значения не имеют. Например, если у параметра такое же имя, как и у столбца, с которым он сопоставляется, но он не стоит в правильном положении по порядку в списке **Параметры** , то сопоставление параметра во время выполнения будет основано на порядковом положении параметра, а не на его имени.  
  
 В команде EXEC обычно требуется, чтобы в качестве имен параметров использовались имена переменных, предоставляющие значения параметров в процедуре.  
  
### <a name="specifying-parameters-by-using-names"></a>Задание параметров с помощью имен  
 Если из СУРБД возвращаются действительные имена параметров RDBMS, то параметры, используемые в инструкциях SELECT и EXEC, сопоставляются по имени. Имена параметров должны совпадать с именами, ожидаемыми хранимой процедурой, которая запускается инструкцией SELECT или EXEC.  
  
 Следующая инструкция SQL запускает хранимую процедуру **uspGetWhereUsedProductID** , доступную в базе данных [!INCLUDE[ssSampleDBUserInputNonLocal](../../includes/sssampledbuserinputnonlocal-md.md)] .  
  
 `EXEC uspGetWhereUsedProductID ?, ?`  
  
 Хранимая процедура ожидает, что в переменных `@StartProductID` и `@CheckDate`будут содержаться значения параметров. Порядок следования параметров в списке **Сопоставления** неважен. Единственное требование состоит в том, что имена параметров должны совпадать с именами переменных в хранимой процедуре вплоть до символа \@.  
  
### <a name="mapping-parameters-to-variables"></a>Сопоставление параметров и переменных  
 Параметры сопоставляются с переменными, которые во время выполнения предоставляют значения параметров. Переменные обычно являются определяемыми пользователем переменными, хотя также можно использовать системные переменные, предоставляемые службами [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] . При использовании определяемых пользователем переменных убедитесь, что тип их данных совместим с типом данных столбца, на который ссылается сопоставляемый параметр. Дополнительные сведения см. в разделе [Переменные служб Integration Services (SSIS)](../../integration-services/integration-services-ssis-variables.md).  
  
## <a name="troubleshooting-the-ole-db-source"></a>Устранение неполадок, связанных с источником OLE DB  
 Можно вести журнал вызовов, сделанных источником OLE DB к внешним источникам данных. Эта возможность ведения журнала может быть использована для устранения неполадок загрузки данных из внешнего источника данных, выполняемой источником OLE DB. Чтобы вести журнал вызовов, которые источник OLE DB совершает к внешним поставщикам данных, необходимо включить ведение журнала пакета и выбрать событие **Диагностика** на уровне пакета. Дополнительные сведения см. в разделе [Инструменты устранения неполадок при выполнении пакетов](../../integration-services/troubleshooting/troubleshooting-tools-for-package-execution.md).  
  
## <a name="configuring-the-ole-db-source"></a>Настройка источника OLE DB  
 Свойства задаются программно или через конструктор служб [!INCLUDE[ssIS](../../includes/ssis-md.md)] .  
  
 Диалоговое окно **Расширенный редактор** содержит свойства, которые можно установить с помощью программных средств. Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне **Расширенный редактор** или программными средствами, см. в следующих разделах.  
  
-   [Общие свойства](./set-the-properties-of-a-data-flow-component.md)  
  
-   [Пользовательские свойства OLE DB](../../integration-services/data-flow/ole-db-custom-properties.md)  
  
## <a name="related-tasks"></a>Связанные задачи  
  
-   [Извлечение данных с помощью источника «OLE DB»](../../integration-services/data-flow/extract-data-by-using-the-ole-db-source.md)  
  
-   [Сопоставления параметров запросов с переменными в компонентах потока данных](../../integration-services/data-flow/map-query-parameters-to-variables-in-a-data-flow-component.md)  
  
-   [Установление свойств компонента потока данных](../../integration-services/data-flow/set-the-properties-of-a-data-flow-component.md)  
  
-   [Сортировка данных для преобразований "Слияние" и "Соединение слиянием"](../../integration-services/data-flow/transformations/sort-data-for-the-merge-and-merge-join-transformations.md)  
  
## <a name="related-content"></a>См. также  
 Статья Wiki [Соединители служб SSIS с Oracle](https://go.microsoft.com/fwlink/?LinkId=220670)на сайте social.technet.microsoft.com.  
  
## <a name="ole-db-source-editor-connection-manager-page"></a>Редактор источника OLE DB (страница «Диспетчер соединений»)
  Используйте страницу **Диспетчер соединений** диалогового окна **Редактор источника OLE DB** для выбора диспетчера соединений OLE DB для источника. На этой странице также можно выбрать таблицу или представление базы данных.  
  
> [!NOTE]  
>  Чтобы загрузить данные из источника данных, использующего [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office Excel 2007, используйте источник OLE DB. Нельзя использовать источник Excel для загрузки данных из источника данных Excel 2007. Дополнительные сведения см. в разделе [Configure OLE DB Connection Manager](../connection-manager/ole-db-connection-manager.md).  
>   
>  Чтобы загрузить данные из источника данных, использующего [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office Excel 2003 или более раннюю версию, используйте источник Excel. Дополнительные сведения см. в разделе [Редактор источника Excel (страница "Диспетчер соединений")](./excel-source.md).  
  
> [!NOTE]  
>  Свойство **CommandTimeout** источника OLE DB недоступно в диалоговом окне **Редактор источника OLE DB**, но может быть установлено с помощью **расширенного редактора**. Дополнительные сведения о данном свойстве см. в подразделе «Источник Excel» раздела [OLE DB Custom Properties](../../integration-services/data-flow/ole-db-custom-properties.md).  
  
### <a name="open-the-ole-db-source-editor-connection-manager-page"></a>Откройте редактор источника OLE DB (страницу диспетчера соединений)  
  
1.  Добавьте источник OLE DB к пакету служб [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] в среде [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].  
  
2.  Щелкните правой кнопкой мыши компонент источника, а затем выберите пункт **Изменить**.  
  
3.  Щелкните **Диспетчер соединений**.  
  
### <a name="static-options"></a>Статические параметры  
 **Диспетчер соединений OLE DB**  
 Выберите из списка существующий диспетчер соединений или создайте новое соединение, нажав кнопку **Создать**.  
  
 **Создать**  
 Создайте новый диспетчер соединений с помощью диалогового окна **Настройка диспетчера соединений OLE DB** .  
  
 **Режим доступа к данным**  
 Укажите метод выбора данных из источника.  
  
|Параметр|Описание|  
|------------|-----------------|  
|Таблица или представление|Получение данных из таблицы или представления в источнике данных OLE DB.|  
|Переменная, содержащая имя таблицы или представления|Задайте переменную, содержащую имя таблицы или представления.<br /><br /> **Дополнительные сведения.** [Использование переменных в пакетах](../integration-services-ssis-variables.md)|  
|Команда SQL|Получение данных из источника данных OLE DB с использованием SQL-запроса.|  
|Команда SQL из переменной|Задайте текст SQL-запроса в переменную.|  
  
 **Предварительный просмотр**  
 Осуществляйте предварительный просмотр результатов в диалоговом окне **Просмотр данных** . В окне**Предварительный просмотр** может отображаться до 200 строк.  
  
> [!NOTE]  
>  При предварительном просмотре столбцы с определяемым пользователем типом данных CLR не содержат данных. Вместо этого отображаются значения \<value too big to display> или System.Byte[]. Первое отображается при доступе к источнику данных с помощью поставщика SQL OLE DB, второе — с помощью поставщика собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
### <a name="data-access-mode-dynamic-options"></a>Динамические параметры режима доступа к данным  
  
#### <a name="data-access-mode--table-or-view"></a>Режим доступа к данным = Таблица или представление  
 **Имя таблицы или представления**  
 Выберите имя таблицы или представления из списка доступных в источнике данных.  
  
#### <a name="data-access-mode--table-name-or-view-name-variable"></a>Режим доступа к данным — переменная, содержащая имя таблицы или представления  
 **Имя переменной**  
 Выберите переменную, содержащую имя таблицы или представления.  
  
#### <a name="data-access-mode--sql-command"></a>Режим доступа к данным — команда SQL  
 **Текст команды SQL**  
 Введите текст SQL-запроса, постройте запрос, нажав кнопку **Создать запрос**, или выберите файл, содержащий текст запроса, нажав кнопку **Обзор**.  
  
 **Параметры**  
 Если введен параметризованный запрос, где в тексте запроса в качестве заполнителя параметра использовался знак ?, воспользуйтесь диалоговым окном **Установка параметров запроса** для сопоставления входных параметров запроса и переменных пакета.  
  
 **Создать запрос**  
 Воспользуйтесь диалоговым окном **Построитель запросов** для визуального конструирования SQL-запроса.  
  
 **Обзор**  
 Воспользуйтесь диалоговым окном **Открыть** для выбора файла, содержащего текст SQL-запроса.  
  
 **Анализ запроса**  
 Проверить синтаксис текста запроса.  
  
#### <a name="data-access-mode--sql-command-from-variable"></a>Режим доступа к данным = Команда SQL из переменной  
 **Имя переменной**  
 Выберите переменную, содержащую текст SQL-запроса.  
  
## <a name="ole-db-source-editor-columns-page"></a>Редактор источника «OLE DB» (страница «Столбцы»)
  Страница **Столбцы** диалогового окна **Редактор источника "OLE DB"** используется для сопоставления выходного столбца с каждым внешним столбцом (источником).  
  
### <a name="options"></a>Параметры  
 **Доступные внешние столбцы**  
 Просмотр списка доступных внешних столбцов источника данных. В этой таблице нельзя добавлять или удалять столбцы.  
  
 **Внешний столбец**  
 Просмотрите внешние столбцы (столбцы в источнике) в том порядке, в котором они отображаются при настройке компонентов, получающих данные из этого источника. Этот порядок можно изменить, вначале очистив выделенные столбцы в таблице, а затем выбрав в списке внешние столбцы в другом порядке.  
  
 **Выходной столбец**  
 Введите уникальное имя для каждого выходного столбца. По умолчанию используется имя выбранного внешнего (исходного) столбца, однако можно выбрать любое уникальное описательное имя. Указанное имя будет отображено в конструкторе служб SSIS.  
  
## <a name="ole-db-source-editor-error-output-page"></a>Редактор источника «OLE DB» (страница «Вывод ошибок»)
  Используйте страницу **Вывод ошибок** диалогового окна **Редактор источника «OLE DB»** , чтобы выбрать параметры обработки ошибок и установить свойства столбцов вывода ошибок.  
  
### <a name="options"></a>Параметры  
 **Ввод-вывод**  
 Просмотр имени источника данных.  
  
 **Столбец**  
 Просмотрите внешние (исходные) столбцы, выбранные на странице **Диспетчер соединений** диалогового окна **Редактор источника "OLE DB"** .  
  
 **Error**  
 Задайте действие, которое необходимо выполнить при возникновении ошибки: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **См. также:** [Обработка ошибок в данных](../../integration-services/data-flow/error-handling-in-data.md)  
  
 **Усечение**  
 Укажите, что нужно сделать при усечении: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Описание**  
 Просмотреть описание ошибки.  
  
 **Присвоить указанное значение выбранным ячейкам**  
 Укажите действие, которое необходимо применить ко всем выбранным ячейкам при возникновении ошибки или усечения: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Применить**  
 Применить параметр обработки ошибок к выбранным ячейкам.  
  
## <a name="see-also"></a>См. также:  
 [Назначение OLE DB](../../integration-services/data-flow/ole-db-destination.md)   
 [Переменные в службах Integration Services (SSIS)](../../integration-services/integration-services-ssis-variables.md)   
 [Поток данных](../../integration-services/data-flow/data-flow.md)  
  
