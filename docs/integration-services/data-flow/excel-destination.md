---
description: Назначение Excel
title: Назначение Excel | Документы Майкрософт
ms.custom: ''
ms.date: 04/02/2018
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.exceldest.f1
- sql13.dts.designer.exceldestadapter.connection.f1
- sql13.dts.designer.exceldestadapter.mappings.f1
- sql13.dts.designer.exceldestadapter.erroroutput.f1
helpviewer_keywords:
- destinations [Integration Services], Excel
- Excel [Integration Services]
ms.assetid: 37c07446-1264-4814-b4f5-9c66d333bb24
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 85b62ff41c9b413c49ff6312e918f648fba430cd
ms.sourcegitcommit: 192f6a99e19e66f0f817fdb1977f564b2aaa133b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96127290"
---
# <a name="excel-destination"></a>Назначение Excel

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


  Назначение «Excel» загружает данные в листы или диапазоны в книгах [!INCLUDE[msCoName](../../includes/msconame-md.md)] Excel.  

> [!IMPORTANT]
> Дополнительные сведения о подключении к файлам Excel, а также об ограничениях и известных проблемах, связанных с загрузкой данных в файлы этого приложения и из них, см. в разделе [Загрузка данных в приложение Excel или из него с помощью служб SQL Server Integration Services (SSIS)](../load-data-to-from-excel-with-ssis.md).
  
## <a name="access-modes"></a>Режимы доступа  
 Назначение «Excel» предоставляет три различных режима доступа к данным для загрузки:  
  
-   Таблица или представление.  
  
-   Таблица или представление, указанные в переменной.  
  
-   Результат выполнения инструкции SQL. Может использоваться параметризированный запрос.  
  
## <a name="configure-the-excel-destination"></a>Настройка назначения "Excel"  
 Назначение «Excel» использует диспетчер соединений Excel для подключения к источнику данных, а диспетчер соединений определяет файл книги для использования. Дополнительные сведения см. в статье [Excel Connection Manager](../../integration-services/connection-manager/excel-connection-manager.md).  
  
 Назначение «Excel» имеет один обычный вход и один вывод ошибок.  
  
 Значения свойств можно задавать с помощью конструктора [!INCLUDE[ssIS](../../includes/ssis-md.md)] или программными средствами.  
  
 Диалоговое окно **Расширенный редактор** содержит все свойства, которые могут устанавливаться программными средствами. Дополнительные сведения о свойствах, которые вы можете задать в диалоговом окне **Расширенный редактор** или программными средствами, см. в следующих разделах.  
  
-   [Общие свойства](./set-the-properties-of-a-data-flow-component.md)  
  
-   [Пользовательские свойства Excel](../../integration-services/data-flow/excel-custom-properties.md)  
  
 Дополнительные сведения о настройке свойств см. в разделе [Установление свойств компонента потока данных](../../integration-services/data-flow/set-the-properties-of-a-data-flow-component.md).  
  
## <a name="excel-destination-editor-connection-manager-page"></a>Редактор назначения «Excel» (страница «Диспетчер соединений»)
  Используйте страницу **Диспетчер соединений** в диалоговом окне **Редактор назначения «Excel»** , чтобы задать сведения об источнике данных и просмотреть результаты. Назначение «Excel» загружает данные в лист или именованный диапазон в книге [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] .  
  
> [!NOTE]  
>  Свойство **CommandTimeout** назначения Excel недоступно в **Редакторе назначения «Excel»**, однако его можно установить с помощью **Расширенного редактора**. Кроме того, некоторые параметры быстрой загрузки доступны только в **Расширенном редакторе**. Дополнительные сведения об этих свойствах см. в подразделе «Назначение "Excel"» раздела [Excel Custom Properties](../../integration-services/data-flow/excel-custom-properties.md).  
  
### <a name="static-options"></a>Статические параметры  
 **Диспетчер соединений с Excel**  
 Выберите из списка существующий диспетчер подключений к Excel или создайте новое соединение, нажав кнопку **Создать**.  
  
 **Создать**  
 Создайте новый диспетчер подключений с помощью диалогового окна **Диспетчер подключений Excel** .  
  
 **Режим доступа к данным**  
 Укажите метод выбора данных из источника.  
  
|Параметр|Описание|  
|------------|-----------------|  
|Таблица или представление|Загружает данные в лист или именованный диапазон источника данных Excel.|  
|Переменная, содержащая имя таблицы или представления|Укажите переменную, содержащую имя листа или диапазона.<br /><br /> **Дополнительные сведения** [Использование переменных в пакетах](../integration-services-ssis-variables.md)|  
|Команда SQL|Загрузка данных в назначение «Excel» с помощью SQL-запроса.|  
  
 **Имя листа Excel**  
 Выберите назначение Excel из раскрывающегося списка. Если этот список пустой, выберите **Создать**.  
  
 **Создать**  
 Выберите **Создать** для открытия диалогового окна **Создание таблицы** . После нажатия кнопки **OK** создается файл Excel, на который указывает **Диспетчер соединений с Excel** .  
  
 **Просмотр существующих данных**  
 Просмотрите предварительные результаты, используя диалоговое окно **Предварительный просмотр результатов запроса** . В окне «Предварительный просмотр» может отображаться до 200 строк.  
  
### <a name="data-access-mode-dynamic-options"></a>Динамические параметры режима доступа к данным  
  
#### <a name="data-access-mode--table-or-view"></a>Режим доступа к данным = Таблица или представление  
 **Имя листа Excel**  
 Выберите имя листа или именованного диапазона из списка доступных в источнике данных.  
  
#### <a name="data-access-mode--table-name-or-view-name-variable"></a>Режим доступа к данным — переменная, содержащая имя таблицы или представления  
 **Имя переменной**  
 Укажите переменную, содержащую имя листа или именованного диапазона.  
  
#### <a name="data-access-mode--sql-command"></a>Режим доступа к данным — команда SQL  
 **Текст команды SQL**  
 Введите текст SQL-запроса, создайте запрос, нажав кнопку **Создать запрос**, или выберите файл, содержащий текст запроса, нажав кнопку **Обзор**.  
  
 **Создать запрос**  
 Воспользуйтесь диалоговым окном **Построитель запросов** для визуального конструирования SQL-запроса.  
  
 **Обзор**  
 Воспользуйтесь диалоговым окном **Открыть** для выбора файла, содержащего текст SQL-запроса.  
  
 **Анализ запроса**  
 Проверить синтаксис текста запроса.  
  
## <a name="excel-destination-editor-mappings-page"></a>Редактор назначения «Excel» (страница «Сопоставления»)
  Страница **Сопоставления** диалогового окна **Редактор назначения «Excel»** используется для сопоставления входных столбцов с целевыми.  
  
### <a name="options"></a>Параметры  
 **Доступные входные столбцы**  
 Просмотрите список доступных входных столбцов. Для сопоставления доступных входных столбцов с целевыми столбцами используется операция перетаскивания.  
  
 **Доступные целевые столбцы**  
 Просмотрите список доступных целевых столбцов. Чтобы сопоставить доступные целевые столбцы с входными столбцами, воспользуйтесь операцией перетаскивания.  
  
 **Входной столбец**  
 Просмотрите выбранные входные столбцы из вышеприведенной таблицы. Сопоставления можно изменить с помощью списка **Доступные входные столбцы**.  
  
 **Целевой столбец**  
 Просмотреть все доступные целевые столбцы независимо от того, сопоставлены они с входными столбцами или нет.  
  
## <a name="excel-destination-editor-error-output-page"></a>Редактор назначения «Excel» (страница «Вывод ошибок»)
  Используйте страницу **Дополнительно** диалогового окна **Редактор назначения «Excel»** , чтобы указать параметры обработки ошибок.  
  
### <a name="options"></a>Параметры  
 **Вход или выход**  
 Просмотр имени источника данных.  
  
 **Столбец**  
 Просмотрите внешние (исходные) столбцы, выбранные в разделе **Диспетчер соединений** диалогового окна **Редактор источника "Excel"**.  
  
 **Error**  
 Задайте действие, которое необходимо выполнить при возникновении ошибки: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **См. также:** [Обработка ошибок в данных](../../integration-services/data-flow/error-handling-in-data.md)  
  
 **Усечение**  
 Укажите, что нужно сделать при усечении: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Описание**  
 Просмотреть описание ошибки.  
  
 **Присвоить указанное значение выбранным ячейкам**  
 Укажите действие, которое необходимо применить ко всем выбранным ячейкам при возникновении ошибки или усечения: пропустить ошибку, перенаправить строку или вызвать сбой компонента.  
  
 **Применить**  
 Применить параметр обработки ошибок к выбранным ячейкам.  
  
## <a name="see-also"></a>См. также:  
 [Загрузка данных в приложение Excel или из него с помощью служб SQL Server Integration Services (SSIS)](../load-data-to-from-excel-with-ssis.md)  
 [Источник Excel](../../integration-services/data-flow/excel-source.md)   
[Диспетчер подключений Excel](../connection-manager/excel-connection-manager.md)