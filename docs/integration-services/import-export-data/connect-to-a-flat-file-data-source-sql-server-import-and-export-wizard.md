---
description: Подключение к источнику данных "Неструктурированный файл" (мастер импорта и экспорта SQL Server)
title: Подключение к источнику данных "Неструктурированный файл" (мастер импорта и экспорта SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 02/17/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: d7e7067b-f5a5-482f-b97e-9d82fe8e9f76
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cbbd57a1f195b3e2363357e653ff77129bb9f224
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92195198"
---
# <a name="connect-to-a-flat-file-data-source-sql-server-import-and-export-wizard"></a>Подключение к источнику данных "Неструктурированный файл" (мастер импорта и экспорта SQL Server)

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


В этом разделе показано, как подключаться к источникам данных **"Неструктурированный файл"** (текстовый файл) со страницы **Выбор источника данных** или **Выбор назначения** в мастере импорта и экспорта SQL Server. Для неструктурированных файлов эти две страницы мастера содержат разные наборы параметров, поэтому в этом разделе источник "Неструктурированный файл" и назначение "Неструктурированный файл" рассматриваются отдельно.

## <a name="an-alternative-for-simple-text-import"></a>Альтернатива для импорта простого текста
Если вы хотите импортировать текстовый файл в SQL Server и не нуждаетесь во всех параметрах конфигурации, доступных в мастере экспорта и импорта, рекомендуется использовать **мастер импорта неструктурированных файлов** в SQL Server Management Studio (SSMS). Дополнительные сведения см. в следующих статьях:
- [Новые возможности SQL Server Management Studio 17.3](https://blogs.technet.microsoft.com/dataplatforminsider/2017/10/10/whats-new-in-sql-server-management-studio-17-3/)
- [Общие сведения о новом мастере импорта неструктурированных файлов в SSMS 17.3](https://channel9.msdn.com/Shows/Data-Exposed/Introducing-the-new-Import-Flat-File-Wizard-in-SSMS-173)

## <a name="connect-to-a-flat-file-source"></a>Подключение к источнику "Неструктурированный файл"
 
 Параметры для источников данных типа "Неструктурированный файл" занимают четыре страницы. Это довольно много. Однако вам не придется тратить свое время, изучая их все. Ниже перечислены задачи, которые следует принять во внимание.
 
Page|Рекомендация  |Тип  
----|---------|---------
**Общие сведения**|Обязательно обновите параметры в разделе **Формат**.|Рекомендуемая    
**Столбцы**|Не забудьте установить разделители столбцов и строк (для файла с разделителями) или пометить столбцы (для файла с полями фиксированного размера).|Рекомендуемая
**Дополнительно**|При необходимости проверьте типы данных и другие свойства, по умолчанию назначенные для столбцов.|Необязательно
**Предварительный просмотр**|При необходимости просмотрите образец данных, используя заданные вами параметры.|Необязательно

## <a name="general-page-source"></a>Страница "Общие" (источник)
 На странице **Общие** найдите и выберите файл, а затем проверьте параметры в разделе **Формат**.
 
 ![Подключение через неструктурированный файл: "Общие"](../../integration-services/import-export-data/media/flat-file-connection-general.png)  

### <a name="options-to-specify-general-page"></a>Задаваемые параметры (страница **Общие**)

 **Имя файла**  
 Введите путь и имя для неструктурированного файла.  
  
 **Обзор**  
 Найдите неструктурированный файл.  
  
 **Локаль**  
 Укажите языковой стандарт, чтобы предоставить определяемые языком правила для сортировки данных и формата даты и времени.  
  
 **Юникод**  
 Укажите, использует ли файл Юникод. При использовании Юникода невозможно указать кодовую страницу.  
  
 **Кодовая страница**  
 Укажите кодовую страницу для текста не в Юникоде.  
  
 **Формат**  
 Укажите, используется ли в файле форматирование с разделителями, с полями фиксированного размера или форматирование с неровным правым краем.  
  
|Значение|Описание|  
|-----------|-----------------|  
|С разделителями|Столбцы разделяются разделителями. Укажите разделитель на странице **Столбцы**.|  
|Фиксированная ширина|Столбцы имеют фиксированную ширину.|  
|Переменная ширина|В файлах с текстом без выключки вправо каждый столбец имеет фиксированную ширину, за исключением последнего столбца, разделенного разделителем строк.|  
  
 **Ограничитель текста**  
 Укажите ограничитель текста, который следует использовать (если он есть). Например, можно указать, что текстовые поля должны быть заключены в кавычки. (Это свойство применяется только к файлам с разделителями.) 
  
> [!NOTE]
> После выбора ограничителя текста невозможно повторно выбрать параметр **None**. Тип **None** предназначен для отмены выбора ограничителя текста.  
  
 **Разделитель строки заголовка**  
 Выберите разделитель из списка разделителей строк заголовка или введите текст разделителя.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**{CR}{LF}**|В качестве разделителей для строки заголовка используются сочетания символов возврата каретки и перевода строки.|  
|**{CR}**|В качестве разделителей для строки заголовка используются символы возврата каретки.|  
|**{LF}**|В качестве разделителей для строки заголовка используются символы перевода строки.|  
|**Точка с запятой {;}**|В качестве разделителя для строки заголовка используется точка с запятой.|  
|**Двоеточие {:}**|В качестве разделителя для строки заголовка используется двоеточие.|  
|**Запятая {,}**|В качестве разделителя для строки заголовка используется запятая.|  
|**Табуляция {t}**|В качестве разделителя для строки заголовка используется символ табуляции.|  
|**Вертикальная черта {&#124;}**|В качестве разделителя для строки заголовка используется вертикальная черта.|  
  
 **Пропускаемые строки заголовка**  
 Укажите число строк с начала файла, которые нужно пропустить (если такие есть).  
  
 **Имена столбцов в первой строке данных**  
 Укажите, содержит ли первая строка (после всех пропущенных) имена столбцов.

## <a name="columns-page---format--delimited-source"></a>Страница "Столбцы" – "Формат" = "С разделителями" (источник)
 На странице **Столбцы** проверьте список обнаруженных мастером столбцов и разделителей. На следующем снимке экрана страница показана так, как если бы вы выбрали для неструктурированного файла формат **С разделителями**.
 
![Неструктурированный файл, с разделителями, страница "Столбцы"](../../integration-services/import-export-data/media/flat-file-delimited-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--delimited"></a>Указываемые параметры (страница **Столбцы** – "Формат" = "С разделителями")

 **Разделитель строк**  
 Выберите из списка доступных разделителей строк или введите текст разделителя.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**{CR}{LF}**|Строки разделяются сочетанием символов возврата каретки и перевода строки.|  
|**{CR}**|Строки разделяются символом возврата каретки.|  
|**{LF}**|Строки разделяются символом перевода строки.|  
|**Точка с запятой {;}**|Строки разделяются точкой с запятой.|  
|**Двоеточие {:}**|Строки разделяются двоеточием.|  
|**Запятая {,}**|Строки разделяются запятой.|  
|**Табуляция {t}**|Строки разделяются символом табуляции.|  
|**Вертикальная черта {&#124;}**|Строки разделяются вертикальной чертой.|  
  
 **Разделитель столбцов**  
 Выберите из списка доступных разделителей столбцов или введите текст разделителя.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**{CR}{LF}**|Столбцы разделяются парой символов возврата каретки и перевода строки.|  
|**{CR}**|Столбцы разделяются символом возврата каретки.|  
|**{LF}**|Столбцы разделяются символом перевода строки.|  
|**Точка с запятой {;}**|Столбцы разделяются символом точки с запятой.|  
|**Двоеточие {:}**|Столбцы разделяются символом двоеточия.|  
|**Запятая {,}**|Столбцы разделяются символом запятой.|  
|**Табуляция {t}**|Столбцы разделяются символом табуляции.|  
|**Вертикальная черта {&#124;}**|Столбцы разделяются символом вертикальной черты.|  
  
 **Предварительный просмотр строк**  
 Просмотр образца данных в неструктурированном файле, разделенном на столбцы и строки с помощью выбранных параметров.  
 
 **Обновить**  
 Просмотрите результаты изменения разделителей, нажав кнопку **Обновить**. Эта кнопка становится видимой только после изменения других параметров соединения.  
  
 **Сбросить столбцы**  
 Восстановление исходных столбцов.  

## <a name="columns-page---format--fixed-width-source"></a>Страница "Столбцы" – "Формат" = "Фиксированная ширина" (источник)
На странице **Столбцы** проверьте список обнаруженных мастером столбцов и разделителей. На следующем снимке экрана страница показана так, как если бы вы выбрали для неструктурированного файла формат **Фиксированная ширина**.
  
![Неструктурированный файл, фиксированная ширина, страница "Столбцы"](../../integration-services/import-export-data/media/flat-file-fixed-width-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--fixed-width"></a>Указываемые параметры (страница **Столбцы** – "Формат" = "Фиксированная ширина")

 **Шрифт**  
 Выбор шрифта для предварительного просмотра данных.  
  
 **Столбцы источника данных**  
 Настройте ширину строк, перемещая красный вертикальный маркер, а также ширину столбцов, щелкнув линейку в верхней части окна предварительного просмотра  
  
 **Ширина строки**  
 Задайте длину строки перед добавлением разделителей для отдельных столбцов. Или переместите красный вертикальный маркер в окне предварительного просмотра, чтобы отметить конец строки. Значение ширины строки автоматически обновляется.  
  
 **Сбросить столбцы**  
 Восстановление исходных столбцов.  
  
## <a name="columns-page---format--ragged-right-source"></a>Страница "Столбцы" – "Формат" = "Без выравнивания по правому краю" (источник)
На странице **Столбцы** проверьте список обнаруженных мастером столбцов и разделителей. На следующем снимке экрана страница показана так, как если бы вы выбрали для неструктурированного файла формат **Без выравнивания по правому краю**.

> [!NOTE]
> В файлах с текстом без выключки вправо каждый столбец имеет фиксированную ширину, за исключением последнего столбца, разделенного разделителем строк.  
 
![Неструктурированный файл, без выравнивания по правому краю, страница "Столбцы"](../../integration-services/import-export-data/media/flat-file-ragged-right-columns-page.jpg)

### <a name="options-to-specify-columns-page---format--ragged-right"></a>Указываемые параметры (страница **Столбцы** – "Формат" = "Без выравнивания по правому краю")
   
 **Шрифт**  
 Выбор шрифта для предварительного просмотра данных.  
  
 **Столбцы источника данных**  
 Настройте ширину строк, перемещая красный вертикальный маркер, а также ширину столбцов, щелкнув линейку в верхней части окна предварительного просмотра  
  
 **Разделитель строк**  
 Выберите из списка доступных разделителей строк или введите текст разделителя.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**{CR}{LF}**|Строки разделяются сочетанием символов возврата каретки и перевода строки.|  
|**{CR}**|Строки разделяются символом возврата каретки.|  
|**{LF}**|Строки разделяются символом перевода строки.|  
|**Точка с запятой {;}**|Строки разделяются точкой с запятой.|  
|**Двоеточие {:}**|Строки разделяются двоеточием.|  
|**Запятая {,}**|Строки разделяются запятой.|  
|**Табуляция {t}**|Строки разделяются символом табуляции.|  
|**Вертикальная черта {&#124;}**|Строки разделяются вертикальной чертой.|  
  
 **Сбросить столбцы**  
 Восстановление исходных столбцов.  

## <a name="advanced-page-source"></a>Страница "Дополнительно" (источник)
На странице **Дополнительно** отображаются подробные сведения о каждом столбце в источнике данных, включая тип данных и размер. На следующем снимке экрана показана страница **Дополнительно** с первым столбцом из неструктурированного файла с разделителями.

![Неструктурированный файл, с разделителями, страница "Дополнительно"](../../integration-services/import-export-data/media/flat-file-delimited-advanced-page.jpg)

Обратите внимание, что на этом снимке экрана столбец **идентификатор**, содержащий числа, изначально имеет тип данных "Строка".

### <a name="options-to-specify-advanced-page"></a>Задаваемые параметры (страница **Дополнительно**)

 **Задать параметры каждого столбца**  
 Выберите столбец в левой панели для просмотра его свойств в правой панели. В следующей таблице приведены описания свойств столбцов. Некоторые перечисленные свойства можно настраивать только для определенных форматов неструктурированного файла и столбцов с данными определенных типов.  
  
|Свойство|Описание|  
|--------------|-----------------|  
|**имя**;|Введите описательное имя столбца. Если не вводить имя, службы [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] автоматически создадут его в формате "Столбец 0", "Столбец 1" и так далее.|
|**ColumnDelimiter**|Выберите из списка допустимых разделителей столбцов. Выберите разделители, которые не могут встретиться в тексте. Это значение пропускается для столбцов фиксированной ширины.<br /><br /> **{CR}{LF}** . Столбцы разделяются парой символов возврата каретки и перевода строки.<br /><br /> **{CR}** . Столбцы разделяются символом возврата каретки.<br /><br /> **{LF}** . Столбцы разделяются символом перевода строки.<br /><br /> **Точка с запятой {;}** . Столбцы разделяются символом точки с запятой.<br /><br /> **Двоеточие {:}** . Столбцы разделяются символом двоеточия.<br /><br /> **Запятая {,}** . Столбцы разделяются символом запятой.<br /><br /> **Табуляция {t}** . Столбцы разделяются символом табуляции.<br /><br /> **Вертикальная черта {&#124;}** . Столбцы разделяются символом вертикальной черты.|
|**ColumnType**|Указывает, ограничен ли столбец специальным символом, фиксированной шириной или оборван по правому краю. Это свойство доступно только для чтения. В файлах с текстом без выравнивания вправо каждый столбец имеет фиксированную ширину, за исключением последнего столбца. Он отделяется разделителем строк.|  
|**InputColumnWidth**|Укажите значение, которое будет храниться как количество байтов. Для файлов в кодировке Юникод это соответствует количеству символов. Это значение пропускается для столбцов, ограниченных разделителями.<br /><br /> **Примечание** . В объектной модели это свойство имеет имя ColumnWidth.|
|**DataPrecision**|Укажите точность числовых данных. Точность представляет собой число разрядов.|
|**DataScale**|Укажите масштаб числовых данных. Масштаб представляет собой количество разрядов в числе.|
|**DataType**|Выберите из списка доступных типов данных.<br/>Дополнительные сведения см. в разделе [Integration Services Data Types](../../integration-services/data-flow/integration-services-data-types.md).|
|**OutputColumnWidth**|Укажите значение, которое будет храниться как количество байтов. Для файлов в кодировке Юникод это будет соответствовать количеству символов. В задаче потока данных это значение используется для задания ширины выходных столбцов для источника неструктурированного файла. В объектной модели это свойство имеет имя MaximumWidth.|  
|**TextQualified**|Указывает, окружены ли текстовые данные символами-квалификаторами текста, например кавычками.<br /><br /> True: текстовые данные в неструктурированном файле обработаны квалификатором. False: текстовые данные в неструктурированном файле НЕ обработаны квалификатором.|  
  
**Создать**  
 Добавьте новый столбец, нажав кнопку **Создать**. По умолчанию, кнопка **Создать** добавляет новый столбец в конец списка. Эта кнопка также имеет следующие параметры, доступные в раскрывающемся списке.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Добавить столбец**|Добавить новый столбец в конец списка.|  
|**Вставить до**|Вставить новый столбец перед выделенным столбцом.|  
|**Вставить после**|Вставить новый столбец после выделенного столбца.|  
  
 **Удаление**  
 Выберите столбец и затем удалите его, нажав кнопку **Удалить**.  
  
 **Предложить типы...**  
 Используйте диалоговое окно **Предлагаемые типы столбцов** , чтобы оценить образец данных в файле и получить предложения для типа данных и длины каждого столбца.  
 
Щелкните **Предложить типы...**, чтобы открыть окно **Предположение типов столбцов**. 

![Диалоговое окно с предложениями о типах при подключении к неструктурированному файлу](../../integration-services/import-export-data/media/flat-file-connection-suggest.png)

После того как вы выберете параметры в диалоговом окне **Предлагаемые типы столбцов** и нажмете кнопку **ОК**, мастер может изменить типы данных в некоторых столбцах.

На следующем снимке экрана после нажатия вами кнопки **Предложить типы** мастер определил, что столбец **id** в источнике данных фактически представляет собой число, а не текстовую строку, и изменит тип данных со строки на целое число.

![Подключение через неструктурированный файл: "Дополнительно" (после)](../../integration-services/import-export-data/media/flat-file-connection-advanced-after.png)

Дополнительные сведения см. в разделе [Справочник по пользовательскому интерфейсу: диалоговое окно "Предлагаемые типы столбцов"](../../integration-services/connection-manager/suggest-column-types-dialog-box-ui-reference.md).

## <a name="preview-page-source"></a>Страница "Предварительный просмотр" (источник)

На странице **Предварительный просмотр** убедитесь, что список столбцов и образец данных соответствуют вашим ожиданиям.

![Неструктурированный файл, страница "Предварительный просмотр"](../../integration-services/import-export-data/media/flat-file-preview-page.jpg)

### <a name="options-to-specify-preview-page"></a>Задаваемые параметры (страница **Предварительный просмотр**)

 **Количество пропускаемых строк данных**  
 Укажите, сколько строк необходимо пропустить в начале неструктурированного файла.  
  
 **Предварительный просмотр строк**  
 Просмотр данных выборки в неструктурированном файле, разделенном на столбцы и строки согласно выбранным параметрам.
 
 **Обновить**  
 Просмотрите эффект от изменения числа пропускаемых строк, нажав кнопку **Обновить**. Эта кнопка становится видимой только после изменения других параметров соединения.  
 
Дополнительные сведения о странице **Предварительный просмотр** см. на следующей странице справочника по службам Integration Services: [Редактор диспетчера соединений с неструктурированными файлами (страница "Предварительный просмотр")](../connection-manager/flat-file-connection-manager.md).

## <a name="connect-to-a-flat-file-destination"></a>Подключение к назначению "Неструктурированный файл"
Для назначения неструктурированного файла доступна всего одна страница с параметрами, как показано на следующем снимке экрана. Найдите и выберите файл, а затем проверьте параметры в разделе **Формат**.

![Подключение к назначению "Неструктурированный файл"](../../integration-services/import-export-data/media/connect-to-flat-file-destination.jpg)

### <a name="options-to-specify-choose-a-destination-page"></a>Задаваемые параметры (страница **Выбор назначения**)

 **Имя файла**  
 Введите путь и имя для неструктурированного файла.  
  
 **Обзор**  
 Найдите неструктурированный файл.  
  
 **Локаль**  
 Укажите языковой стандарт, чтобы предоставить определяемые языком правила для сортировки данных и формата даты и времени.  
  
 **Юникод**  
 Укажите, использует ли файл Юникод. При использовании Юникода невозможно указать кодовую страницу.  
  
 **Кодовая страница**  
 Укажите кодовую страницу для текста не в Юникоде.  
  
 **Формат**  
 Укажите, используется ли в файле форматирование с разделителями, с полями фиксированного размера или форматирование с неровным правым краем.  
  
|Значение|Описание|  
|-----------|-----------------|  
|С разделителями|Столбцы разделяются разделителями. Укажите разделитель на странице **Столбцы**.|  
|Фиксированная ширина|Столбцы имеют фиксированную ширину.|  
|Переменная ширина|В файлах с текстом без выключки вправо каждый столбец имеет фиксированную ширину, за исключением последнего столбца, разделенного разделителем строк.|  
  
 **Ограничитель текста**  
 Укажите ограничитель текста, который следует использовать (если он есть). Например, можно указать, что текстовые поля должны быть заключены в кавычки. (Это свойство применяется только к файлам с разделителями.) 
  
> [!NOTE] 
> После выбора ограничителя текста невозможно повторно выбрать параметр **None**. Тип **None** предназначен для отмены выбора ограничителя текста.  

## <a name="see-also"></a>См. также раздел
[Выбор источника данных](../../integration-services/import-export-data/choose-a-data-source-sql-server-import-and-export-wizard.md)  
[Выбор назначения](../../integration-services/import-export-data/choose-a-destination-sql-server-import-and-export-wizard.md)