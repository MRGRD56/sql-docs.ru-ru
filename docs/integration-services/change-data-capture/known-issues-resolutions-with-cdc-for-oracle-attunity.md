---
description: Известные ошибки и способы их устранения в Change Data Capture для Oracle от Attunity
title: Известные ошибки и способы их устранения в Change Data Capture для Oracle от Attunity | Документация Майкрософт
ms.date: 07/23/2019
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ad867768d72d9e03b7d76761bd371dd369c7161b
ms.sourcegitcommit: 49ee3d388ddb52ed9cf78d42cff7797ad6d668f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2020
ms.locfileid: "94384735"
---
# <a name="known-errors-and-resolutions-with-change-data-capture-for-oracle-by-attunity"></a>Известные ошибки и способы их устранения в Change Data Capture для Oracle от Attunity
[!INCLUDE[tsql-appliesto-ss2008-asdbmi-xxxx-xxx-md](../../includes/tsql-appliesto-ss2012-asdbmi-xxxx-xxx-md.md)]

В этом разделе перечислены основные проблемы и известные способы их устранения при просмотре экземпляра системы отслеживания измененных данных (CDC) в средстве настройки Oracle CDC Designer. Это средство является частью системы отслеживания измененных данных для Oracle от Attunity, которая включена в состав SQL Server 2012. 

## <a name="bug-fixes"></a>Исправления ошибок
Прежде чем тратить время на устранение неполадок, важно использовать последние сборки CDC для Oracle от Attunity, чтобы избежать известных проблем:

### <a name="sql-server-2017"></a>SQL Server 2017

**Версия 5.0.0.111** содержит следующие исправления:
- Исправление ошибки. При добавлении таблицы Oracle программа CDC Designer Oracle завершает работу с ошибкой "Неверный синтаксис около ключевого слова KEY". 
- Улучшение. Улучшена поддержка RAC, включая обработку перезапуска узла RAC. 
- Исправление ошибки. CDC не работает с Oracle 10.2 из-за запроса NEXT_CHANGE# из v$log. 


**Версия 5.0.0.93** содержит следующие исправления: 
- При добавлении таблицы Oracle в конструкторе Microsoft CDC для Oracle от Attunity возникает ошибка "Неверный синтаксис около ключевого слова KEY". 

 
### <a name="sql-server-2016"></a>SQL Server 2016

**Версия 4.0.107** содержит следующие исправления:
- Исправление ошибки. При добавлении таблицы Oracle программа CDC Designer Oracle завершает работу с ошибкой "Неверный синтаксис около ключевого слова KEY".
- Улучшение. Улучшена поддержка RAC, включая обработку перезапуска узла RAC.
- Исправления ошибок. CDC не работает с Oracle 10.2 из-за запроса NEXT_CHANGE# из v$log.

**Версия 4.0.0.95** содержит следующие исправления: 
- Исправление ошибки. При добавлении таблицы Oracle программа CDC Designer Oracle завершает работу с ошибкой "Неверный синтаксис около ключевого слова KEY".

**Версия 4.0.0.88** содержит следующие исправления:
-  Свойства, добавленные в дополнительных параметрах экземпляра Attunity CDC, удаляются при добавлении или удалении таблицы из CDC. 
- Attunity CDC перестает работать после применения исправления SQL, добавляющего столбец __$command_id.

### <a name="sql-server-2014"></a>SQL Server 2014 

**Версия 2.0.0.114** содержит следующие исправления:
- Исправление ошибки. При добавлении таблицы Oracle программа CDC Designer Oracle завершает работу с ошибкой "Неверный синтаксис около ключевого слова KEY".
- Улучшение. Улучшена поддержка RAC, включая обработку перезапуска узла RAC.
- Исправления ошибок. CDC не работает с Oracle 10.2 из-за запроса NEXT_CHANGE# из v$log.

**Версия 2.0.0.92** содержит следующие исправления: 
- Свойства, добавленные в дополнительных параметрах экземпляра Attunity CDC, удаляются при добавлении или удалении таблицы из CDC. Attunity CDC перестает работать после применения исправления SQL, добавляющего столбец __$command_id.
- Ошибка проверки метаданных для таблицы Oracle cdc.table_name. Индекс столбца column_name выходит за пределы допустимого диапазона.  И эта проблема: Служба Oracle CDC Service отображает состояние "Прервано" при использовании CDC для Oracle от Attunity
    - Исправлено в _накопительном обновлении 1 для SQL Server 2014 RTM_ , как описано в статье KB [2894025](https://support.microsoft.com/kb/2894025).
- Некоторые изменения пропускаются и не реплицируются в базу данных SQL Server. Эта проблема возникает, если таблица содержит более одного символьного большого двоичного объекта (CLOB) и один из объектов имеет большое значение. 
    - Исправлено в _накопительном обновлении 1 для SQL Server 2014 SP1_ и _накопительном обновлении 8 для SQL Server 2014 RTM_ , как описано в статье KB [3029096](https://support.microsoft.com/kb/3029096). 
- Отслеживание измененных данных для Oracle с помощью Attunity перестает работать, если таблицы Oracle имеют столбец с типом данных Long.
    - Исправлено в _накопительном обновлении 5 для SQL Server 2014 SP1_ и _накопительном обновлении 12 для SQL Server 2014 RTM_ , как описано в статье KB [3145983](https://support.microsoft.com/kb/3145983).

### <a name="sql-server-2012"></a>SQL Server 2012

**Версия 1.1.0.102** содержит следующие исправления: 
 
- Свойства, добавленные в дополнительных параметрах экземпляра Attunity CDC, удаляются при добавлении или удалении таблицы из CDC. Attunity CDC перестает работать после применения исправления SQL, добавляющего столбец __$command_id.
- CDC для экземпляра Oracle зависает при запуске и не фиксирует изменения. Память сервера Oracle может увеличиться вплоть до исчерпания памяти или сбоя.
- [2672759](https://support.microsoft.com/kb/2672759): сообщение об ошибке при использовании службы Change Data Capture Service для Oracle от Attunity: "ORA-00600: код внутренней ошибки". Добавьте трассировку на уровне SOURCE и проверьте, возникает ли та же ошибка ORA-00600. Исправляется при скачивании обновления Oracle.
- Несколько секций
    - При использовании более 10 разделов в таблице Oracle экземпляр CDC не может записать все изменения для таблицы. Если таблица Oracle определена более чем с 10 разделами, фиксируются изменения только из последних 10 разделов. Исправлено в выпуске _пакет обновления 1 для SQL Server 2012_. См. раздел [SP1 на странице загрузки пакета дополнительных компонентов](https://www.microsoft.com/download/details.aspx?id=35575). 
- Изменения теряются
    - Захват событий может попасть в бесконечный цикл и прекратить запись новых изменений данных (связано с ошибкой Oracle 5623813). Если в среде Oracle RAC идет завершение или возобновление экземпляра CDC, то изменения могут быть пропущены или утеряны. Это означает, что в системе отслеживания измененных данных SQL Server будут отсутствовать важные строки и, таким образом, произойдет потеря данных в хранилище данных или системе-подписчике. Исправлено в выпуске _пакет обновления 1 для SQL Server 2012_. См. раздел [SP1 на странице загрузки пакета дополнительных компонентов](https://www.microsoft.com/download/details.aspx?id=35575).
- Двойная ширина столбцов в SQL
    - При создании CDC для экземпляра Oracle в скриптах, выполняемых на SQL Server, длина столбца типа данных переменной ширины удваивается в таблицах SQL Server, созданных в скрипте. Например, при попытке отслеживания изменений столбца VARCHAR2(10) в таблице Oracle соответствующий столбец в таблице SQL Server имеет тип NVARCHAR(20) в скрипте развертывания. Исправлено в _накопительном обновлении 2 для SQL Server 2012 SP1_ и _накопительном обновлении 5 для SQL Server 2012_ , как описано в статье KB [2769673](https://support.microsoft.com/kb/2769673). 
- Данные DDL усечены
    - При запуске инструкции языка описания данных DDL, размер которой превышает 4000 байт, для базы данных Oracle, содержащей символы, отличные от латинских, CDC для Oracle от Attunity завершается с ошибкой. Кроме того, отображается сообщение об ошибке `ORA-01406: fetched column value was truncated.`. Исправлено в _накопительном обновлении 4 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2839806](https://support.microsoft.com/kb/2839806). 
- Изменения в последних двух столбцах теряются
    - Исправлено в _накопительном обновлении 6 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2874879](https://support.microsoft.com/kb/2874879). 
- При использовании CDC для Oracle увеличивается размер журнала транзакций SQL
     - Если настроена система отслеживания измененных данных для экземпляров Oracle, то база данных SQL, которая получает измененные данные, будет содержать зеркальные таблицы с транзакциями, помеченными для репликации. Это происходит из-за того, что CDC для Oracle использует базовые системные хранимые процедуры, аналогичные используемым в CDC для SQL Server. Однако поскольку репликация SQL CDC не используется при автономном использовании CDC для Oracle, не существует средства чтения журнала для очистки транзакций, помеченных для репликации. Поскольку транзакция не должна реплицироваться в SQL Server, можно вручную пометить транзакцию как распределенную, используя обходной путь, описанный далее в этой статье. Дополнительные сведения можно найти в статье KB [2871474](https://support.microsoft.com/kb/2871474). 
- Ошибка `ORACDC000T: Error encountered at position to change event - SCN not found - EOF simulated`. Исправлена в _накопительном обновлении 7 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2883524](https://support.microsoft.com/kb/2883524). 
- Ошибка проверки метаданных для таблицы Oracle cdc.table_name. Индекс столбца column_name выходит за пределы допустимого диапазона. Исправлена в _накопительном обновлении 7 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2883524](https://support.microsoft.com/kb/2883524).
- Служба Oracle CDC Service отображает состояние "Прервано" при использовании CDC для Oracle от Attunity в SQL Server 2012. Исправлена в _накопительном обновлении 8 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2923839](https://support.microsoft.com/kb/2923839).  
- Некоторые изменения пропускаются и не реплицируются в базы данных SQL Server. Эта проблема возникает, если таблица содержит более одного символьного большого двоичного объекта (CLOB) и один из объектов имеет большое значение. Исправлена в _накопительном обновлении 8 для SQL Server 2012 с пакетом обновления 1 (SP1)_ , как описано в статье KB [2923839](https://support.microsoft.com/kb/2923839).   
- Отслеживание измененных данных для Oracle с помощью Attunity перестает работать, если таблицы Oracle имеют столбец с типом данных Long. Исправлено в _накопительном обновлении 2 для SQL Server 2012 SP3_ и _накопительном обновлении 11 для SQL 2012 SP2_ , как описано в статье KB [3145983](https://support.microsoft.com/kb/3145983). 

## <a name="collect-detailed-logs"></a>Сбор подробных журналов 

В этом разделе объясняется, как производится получение ошибок и событий из экземпляра CDC. 

### <a name="management-console"></a>Консоль управления

Ошибки в сообщениях **Состояние** отображаются в консоли управления конструктора отслеживания измененных данных Oracle, если экземпляр CDC выделен в левой области. 

### <a name="query-trace-table"></a>Запрос таблицы трассировки

Можно выполнить запрос к таблице трассировки в базе данных CDC в SQL Server, чтобы просмотреть записанные в журнал ошибки. 

### <a name="save-output-from-basic-logging"></a>Сохранение выходных данных из базового журнала 

Чтобы записать диагностику, выберите **Собрать диагностические сведения** на вкладке состояния в консоли управления системы отслеживания измененных данных Oracle. 

![Снимок экрана: вкладка состояния в консоли управления системы Change Data Capture для Oracle с выделенной командой "Собрать диагностические сведения".](media/known-issues-resolutions-with-cdc-for-oracle-attunity/collect-diagnostics.png)

Выберите время начала и укажите расположение файла журнала. Затем выберите **Создать** , чтобы запустить сбор диагностических сведений. 

![Снимок экрана: диалоговое окно "Сбор данных диагностики для testTA".](media/known-issues-resolutions-with-cdc-for-oracle-attunity/start-diagnostics.png)

### <a name="detailed-errors"></a>Подробности об ошибках

Можно увеличить уровень трассировки, собираемый экземпляром, и повторить сценарий для сбора более подробных данных из журнала. Для этого выберите **Свойства** в разделе **Действия** , а затем добавьте новое свойство в сетке **Дополнительные параметры** на вкладке **Дополнительно**. Присвойте свойству имя `trace`, а затем задайте значение `SOURCE`. 

![Снимок экрана: пункт "Свойства" в разделе "Действия".](media/known-issues-resolutions-with-cdc-for-oracle-attunity/properties.png)

Воспроизведите ошибку, а затем выберите параметр **Собрать диагностические сведения** для сбора журналов. 

![Еще один снимок экрана вкладки состояния в консоли управления системы Change Data Capture для Oracle с выделенной командой "Собрать диагностические сведения".](media/known-issues-resolutions-with-cdc-for-oracle-attunity/collect-diagnostics.png)

## <a name="ora-00942-table-of-view-does-not-exist"></a>ORA-00942: таблица представления не существует 

Это распространенная ошибка, отображаемая в поле сообщения **Состояние** экземпляра CDC. Экземпляр повторяет попытку несколько раз, поэтому значок состояния изменится на зеленый на время, но при этом произойдет сбой с красным восклицательным знаком и непредвиденным состоянием. 

![Снимок экрана: распространенная ошибка, отображаемая в поле сообщения "Состояние" экземпляра CDC.](media/known-issues-resolutions-with-cdc-for-oracle-attunity/oracle-error.png)

```
"ERROR","computername","ERROR","UNEXPECTED",
"ORACDC508E:Oracle method OCIStmtExecute failed with error: ORA-00942: table or view does not exist ","source","",""

"ERROR","computername","RUNNING","IDLE",
"ORACDC518E:Failed to verify archive log mode.","source","",""

"ERROR","computername","ERROR","UNEXPECTED",
"ORACDC517E:Oracle Call Interface (OCI) method failed: ORA-00942: table or view does not exist .","source","",""

"ERROR","computername","ERROR","UNEXPECTED",
"ORACDC414E:The Engine component failed with return code 1.","engine","",""
```

Это происходит, когда учетная запись Oracle, соединяющаяся с экземпляра CDC с сервером Oracle, не имеет разрешения на просмотр системных представлений журнала. 

### <a name="resolution"></a>Решение

Чтобы устранить эту ошибку, предоставьте для настроенного в текущий момент пользователя надлежащие разрешения в системе базы данных Oracle или измените учетную запись, используемую для подключения к серверу Oracle с экземпляра CDC. 

Список всех обязательных разрешений подробно описан в файле справки, включенном в папку файлов программы установки `C:\Program Files\Change Data Capture for Oracle by Attunity\Attunity.SqlServer.XdbCdcDesigner.chm`.  Полный список см. на странице "Подключение к базе данных-источнику Oracle" в CHM-файле.

Вы можете задать учетную запись пользователя, выбрав CDCInstance в левой области и нажав кнопку "Свойства" на правой панели действия в окне **конструктора CDC**. Учетную запись проверки подлинности для интеллектуального анализа журналов Oracle можно изменить на странице диалогового окна "Свойства".

![Снимок экрана: вкладка Oracle в диалоговом окне "Свойства testTA".](media/known-issues-resolutions-with-cdc-for-oracle-attunity/oracle-connection.png)


  
## <a name="see-also"></a>См. также  
 [Отслеживание измененных данных (SQL Server)](../../relational-databases/track-changes/track-data-changes-sql-server.md)   
 [О фиксации измененных данных (SQL Server)](../../relational-databases/track-changes/about-change-data-capture-sql-server.md)   
 [Работа с информацией об изменениях (SQL Server)](../../relational-databases/track-changes/work-with-change-data-sql-server.md)   
 [Администрирование и наблюдение за отслеживанием измененных данных (SQL Server)](../../relational-databases/track-changes/administer-and-monitor-change-data-capture-sql-server.md)  
  
  
