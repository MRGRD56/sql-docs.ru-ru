---
description: Запросы в службах Integration Services (SSIS)
title: Запросы в службах Integration Services (SSIS) | Документы Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 54a577a2a94c64eafe3817ccd9a041125629f846
ms.sourcegitcommit: cfa04a73b26312bf18d8f6296891679166e2754d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92193849"
---
# <a name="integration-services-ssis-queries"></a>Запросы в службах Integration Services (SSIS)

[!INCLUDE[sqlserver-ssis](../includes/applies-to-version/sqlserver-ssis.md)]


  Задача «Выполнение SQL», источник OLE DB, назначение «OLE DB» и преобразование «Уточняющий запрос» могут использовать SQL-запросы. В задаче «Выполнение SQL» инструкции SQL могут создавать, обновлять и удалять объекты базы данных и данные, запускать хранимые процедуры, выполнять инструкции SELECT. В источнике OLE DB и преобразовании «Уточняющий запрос» обычно содержатся SQL инструкции SELECT или EXEC. Последние наиболее часто выполняются хранимыми процедурами, возвращающими результирующие наборы.  
  
 Запрос может быть проанализирован для проверки его правильности. При анализе запроса, использующего соединение с [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], запрос анализируется, выполняется и результат выполнения (успешный или неуспешный) назначается результату анализа. Если запрос использует соединение с источником данных, который не является источником [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], инструкция только анализируется.  
  
Вы можете предоставить инструкцию SQL следующими способами:
1.   Ввести инструкцию непосредственно в конструкторе.
2.   Указать соединение с файлом, который содержит инструкцию.
3.   Указать переменную, которая содержит инструкцию.  
  
## <a name="direct-input-sql"></a>Прямой ввод SQL  
 Построитель запросов доступен в пользовательском интерфейсе для задачи «Выполнение SQL», источника OLE DB, назначения OLE DB и преобразования «Уточняющий запрос». Построитель запросов дает следующие преимущества.  
  
-   Визуальная работа с командами SQL.  
  
     Построитель запросов содержит графические панели для наглядного построения запроса и текстовую панель, в котором отображается SQL-текст запроса. Можно работать в графических или текстовых панелях. Построитель запросов синхронизирует представления, поэтому текст запроса и графическое представление всегда совпадают.  
  
-   Соединение связанных таблиц.  
  
     Если к запросу добавляется более одной таблицы, построитель запросов автоматически определяет, как взаимосвязаны таблицы, и создает подходящую команду соединения.  
  
-   Запрос или обновление баз данных.  
  
     Можно использовать построитель запросов для получения данных при помощи инструкций Transact-SQL SELECT или для создания запросов, которые обновляют, добавляют или удаляют записи в базе данных.  
  
-   Просмотр и немедленное изменение результатов.  
  
     Можно выполнить запрос и работать с набором записей в сетке, которая позволяет прокручивать и изменять записи в базе данных.  
  
 Построитель запросов позволяет наглядно создавать только запросы SELECT, но можно ввести код SQL на текстовой панели для других типов инструкций, таких как DELETE и UPDATE. Графическая панель автоматически обновляется для отражения набранной инструкции SQL.  
  
 Можно также использовать прямой ввод посредством ввода запроса в диалоговом окне задачи или компонента потока данных или окне «Свойства».  
  
 Дополнительные сведения см. в статье [Query Builder]().  
  
## <a name="sql-in-files"></a>SQL в файлах  
 Инструкция SQL для задачи «Выполнение SQL» может также находиться в отдельном файле. Например, можно написать запрос при помощи средств, таких как редактор запросов в [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], сохранить запрос в файл и затем прочитать запрос из файла при запущенном пакете. Файл может содержать только SQL инструкции для выполнения и примечания. Чтобы использовать инструкцию SQL, содержащуюся в файле, необходимо указать соединение файла, определяющее имя файла и расположение. Дополнительные сведения см. в статье [File Connection Manager](../integration-services/connection-manager/file-connection-manager.md).  
  
## <a name="sql-in-variables"></a>SQL в переменных  
 Если источник инструкции SQL в задаче «Выполнение SQL» является переменной, указывается имя переменной, содержащей запрос. Свойство Value переменной содержит текст запроса. Свойство ValueType переменной устанавливается в строковый тип данных, и затем вводится или копируется инструкция SQL в свойство Value. Дополнительные сведения см. в разделах [Переменные в службах Integration Services (SSIS)](../integration-services/integration-services-ssis-variables.md) и [Использование переменных в пакетах](./integration-services-ssis-variables.md).  

## <a name="query-builder-dialog-box"></a>диалоговое окно «Построитель запросов»
Используйте диалоговое окно **Построитель запросов** , чтобы создать запрос для использования в задаче «Выполнение SQL», в источнике и цели OLE DB, а также в преобразовании «Уточняющий запрос».  
  
 Построитель запросов можно использовать для выполнения следующих задач.  
  
-   **Работа с графическим представлением запроса или с командами SQL** Построитель запросов располагает панелью, которая отображает запрос в графическом виде, и панелью, которая содержит текст SQL-запроса. Можно работать либо в графической, либо в текстовой панели. Построитель запросов синхронизирует представления, так что они всегда отражают текущее состояние.  
  
-   **Соединение связанных таблиц** Если к запросу добавляется более одной таблицы, построитель запросов автоматически определяет взаимосвязь таблиц и создает подходящую команду соединения.  
  
-   **Выполнение запроса и обновление баз данных** Построитель запросов можно использовать для возврата данных с помощью инструкции SELECT языка Transact-SQL, а также для создания запросов, которые обновляют, добавляют или удаляют записи в базе данных.  
  
-   **Просмотр и немедленное редактирование результатов** Можно запустить запрос и работать с набором записей в сетке, позволяющей просматривать и редактировать записи в базе данных.  
  
 Графические средства в диалоговом окне **Построитель запросов** позволяют создавать запросы с помощью операций перетаскивания. По умолчанию в диалоговом окне построителя запросов строятся запросы SELECT, также можно строить запросы INSERT, UPDATE или DELETE. Все типы инструкций SQL также могут быть проанализированы и выполнены в диалоговом окне **Построитель запросов** . Дополнительные сведения об инструкциях SQL в пакетах см. в разделе [Запросы в службах Integration Services (SSIS)](../integration-services/integration-services-ssis-queries.md).  
  
 Для более подробного знакомства с языком Transact-SQL и его синтаксисом см. раздел [Справочник по Transact-SQL (компонент Database Engine)](../t-sql/language-reference.md).  
  
 Кроме того, в запросе можно использовать переменные для предоставления значений входному параметру, для сбора значений выходных параметров и хранения кодов возврата. Дополнительные сведения об использовании переменных в запросах пакетов см. в разделах [Задача "Выполнение SQL"](../integration-services/control-flow/execute-sql-task.md), [Источник OLE DB](../integration-services/data-flow/ole-db-source.md)и [Integration Services &#40;SSIS&#41; Queries](../integration-services/integration-services-ssis-queries.md). Дополнительные сведения об использовании переменных в задаче "Выполнение SQL" см. в разделах [Параметры и коды возврата в задаче "Выполнение SQL"](./control-flow/execute-sql-task.md) и [Результирующие наборы в задаче "Выполнение SQL"](./control-flow/execute-sql-task.md).  
  
 Переменные с параметрами и кодами возврата используются в преобразованиях «Уточняющий запрос» и «Нечеткий уточняющий запрос». Сведения об источнике OLE DB применимы к этим двум преобразованиям.  
  
### <a name="options"></a>Параметры  
 **Панель инструментов**  
 Используйте панель инструментов для управления наборами данных, для выбора отображаемых областей, а также для управления функциями запросов.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Показать/скрыть панель диаграмм**|Показывает или скрывает панель **диаграмм** .|  
|**Показать/скрыть панель сетки**|Показывает или скрывает панель **сетки** .|  
|**Показать/скрыть панель SQL**|Показывает или скрывает панель **SQL** .|  
|**Показать/скрыть панель результатов**|Показывает или скрывает панель **Результаты** .|  
|**Выполнить**|Выполняет запрос. Результаты отображаются на панели результатов.|  
|**Проверить SQL**|Осуществляет проверку допустимости инструкции SQL.|  
|**Сортировка по возрастанию**|Сортирует по возрастанию выходные строки в выбранном столбце на панели сетки.|  
|**Сортировка по убыванию**|Сортирует по убыванию выходные строки в выбранном столбце на панели сетки.|  
|**Удалить фильтр**|Выберите имя столбца на панели сетки, а затем нажмите кнопку **Удалить фильтр** , чтобы удалить критерии сортировки для столбца.|  
|**Использовать Group By**|Добавляет к запросу функцию GROUP BY.|  
|**Добавить таблицу**|Добавляет новую таблицу в запрос.|  
  
 **Определение запроса**  
 Определение запроса предлагает панель инструментов и набор других областей, при помощи которых можно определить и проверить запрос.  
  
|Панель|Описание|  
|----------|-----------------|  
|Панель**диаграмм**|Отображает запрос в виде диаграммы. Диаграмма показывает включенные в запрос таблицы, а также способы их соединения. Установите или снимите флажок рядом со столбцом в таблице, чтобы добавить или исключить его из результатов запроса.<br /><br /> При добавлении таблиц в запрос построитель запросов создает соединения между таблицами на основе ключей в таблице. Чтобы добавить соединение, перетащите поле одной таблицы на поле другой таблицы. Для управления соединением щелкните его правой кнопкой мыши, а затем выберите пункт в меню.<br /><br /> Щелкните правой кнопкой мыши **Панель диаграмм** , чтобы добавить или удалить таблицы, выбрать все таблицы и отобразить или скрыть области.|  
|Панель**Сетка**|Отображает запрос в виде сетки. Можно использовать эту панель, чтобы добавить или удалить столбцы из запроса и изменить настройки для каждого столбца.|  
|Панель**SQL**|Отображает запрос в виде текста SQL. Изменения, совершенные на панели **Диаграмма** и на панели **Сетка** отобразятся здесь, а изменения, совершенные здесь, будут отображены на панели **Диаграмма** и на панели **Сетка** .|  
|Панель**результатов**|Отображает результаты запроса после нажатия кнопки **Выполнить** на панели инструментов.| 

