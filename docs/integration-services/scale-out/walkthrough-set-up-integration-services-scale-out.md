---
title: Пошаговое руководство. Настройка развертывания SSIS с горизонтальным увеличением масштаба | Документация Майкрософт
description: Подробные сведения о настройке и конфигурации SQL Server Integration Services (SSIS) Scale Out Master.
ms.custom: performance
ms.date: 12/13/2017
ms.prod: sql
ms.prod_service: integration-services
ms.technology: integration-services
ms.topic: conceptual
author: HaoQian-MS
ms.author: haoqian
ms.reviewer: maghan
ms.openlocfilehash: d25471ef16b88ee0280ecb7dd349762b72e35312
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100337541"
---
# <a name="walkthrough-set-up-integration-services-ssis-scale-out"></a>Пошаговое руководство. Настройка развертывания служб Integration Services (SSIS) с горизонтальным увеличением масштаба

[!INCLUDE[sqlserver-ssis](../../includes/applies-to-version/sqlserver-ssis.md)]


Чтобы настроить развертывание [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] (SSIS) с горизонтальным увеличением масштаба, выполните указанные ниже задачи. 

> [!TIP]
> При установке горизонтального увеличения масштаба на одном компьютере следует устанавливать мастер горизонтального увеличения масштаба и рабочую роль горизонтального увеличения масштаба одновременно. При одновременной установке компонентов автоматически создается конечная точка для подключения к главной роли горизонтального увеличения масштаба. 

* [Установка мастера горизонтального увеличения масштаба](#InstallMaster)

* [Установка рабочей роли горизонтального увеличения масштаба](#InstallWorker)

* [Установка сертификата клиента рабочей роли горизонтального увеличения масштаба](#InstallCert)

* [Открытие порта брандмауэра](#Firewall)

* [Запуск службы мастера и рабочей роли горизонтального увеличения масштаба SQL Server](#Start)

* [Включение мастера горизонтального увеличения масштаба](#EnableMaster)

* [Включите режим аутентификации SQL Server](#EnableAuth)

* [Включение рабочей роли горизонтального увеличения масштаба](#EnableWorker)

## <a name="install-scale-out-master"></a><a name="InstallMaster"></a> Установка мастера горизонтального увеличения масштаба

Чтобы настроить мастер горизонтального увеличения масштаба, необходимо установить службы ядра СУБД, [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] и компонент мастера горизонтального увеличения масштаба служб SSIS при настройке [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)]. 

Сведения о настройке ядра СУБД и [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] см. в разделах [Установка ядра СУБД SQL Server](../../database-engine/install-windows/install-sql-server-database-engine.md) и [Установка служб Integration Services](../install-windows/install-integration-services.md).

> [!NOTE]
> Чтобы использовать учетную запись для проверки подлинности SQL Server по умолчанию для ведения журналов развертывания с горизонтальным увеличением масштаба, выберите смешанный режим проверки подлинности на странице **Настройка ядра СУБД** во время установки ядра СУБД. Дополнительные сведения см. в разделе [Изменение учетной записи для ведения журнала развертывания с горизонтальным увеличением масштаба](change-logdb-account.md).

Чтобы установить компонент мастера горизонтального увеличения масштаба, используйте мастер установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] или командную строку.

### <a name="install-scale-out-master-with-the-sql-server-installation-wizard"></a>Установка мастера горизонтального увеличения масштаба с помощью мастера установки SQL Server
1.  На странице **Выбор компонентов** выберите элемент **Мастер горизонтального увеличения масштаба** в категории [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].   
  
    ![Выбор главной роли](media/feature-select-master.PNG)
  
2.  На странице **Конфигурация сервера** выберите учетную запись для запуска **службы мастера горизонтального увеличения масштаба SQL Server Integration Services** и **Тип запуска**.  
    ![Конфигурация сервера](media/server-config.PNG)

3.  На странице **Настройка мастера горизонтального увеличения масштаба служб Integration Services** укажите номер порта, который мастер горизонтального увеличения масштаба использует для связи с рабочей ролью. По умолчанию номер порта равен 8391.  

    ![Конфигурация мастера](media/master-config.PNG "Конфигурация мастера")

4.  Укажите TLS/SSL-сертификат, используемый для защиты связи между главной и рабочей ролями горизонтального увеличения масштаба, выполнив одно из указанных ниже действий.
    * Позвольте процессу установки создать самозаверяющий TLS/SSL-сертификат по умолчанию, выбрав **Создать SSL-сертификат**.  Сертификат по умолчанию устанавливается в доверенных корневых центрах сертификации на локальном компьютере. Можно указать CN в этом сертификате. В список CN необходимо включить имя узла для конечной точки мастера. По умолчанию включаются имя компьютера и IP-адрес узла мастера.
    * Выберите существующий TLS/SSL-сертификат на локальном компьютере, щелкнув **Использовать существующий SSL-сертификат** и нажав кнопку **Обзор**. Отпечаток сертификата отображается в текстовом поле. При нажатии кнопки **Обзор** отображаются сертификаты, хранящиеся в доверенных корневых центрах сертификации на локальном компьютере. Выбранный вами сертификат должен храниться здесь.       

    ![Конфигурация мастера 2](media/master-config-2.PNG "Конфигурация мастера 2")
  
5.  Завершите работу мастера установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] .

### <a name="install-scale-out-master-from-the-command-prompt"></a>Установка мастера горизонтального увеличения масштаба из командной строки

Следуйте инструкциям в разделе [Установка SQL Server из командной строки](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md). Задайте параметры для мастера горизонтального увеличения масштаба, выполнив указанные ниже действия.
 
1.  Добавьте `IS_Master` в параметр `/FEATURES`.

2.  Настройте мастер горизонтального увеличения масштаба, указав следующие параметры и их значения:
    -   `/ISMASTERSVCACCOUNT`
    -   `/ISMASTERSVCPASSWORD`
    -   `/ISMASTERSVCSTARTUPTYPE`
    -   `/ISMASTERSVCPORT`
    -   Среда `/ISMasterSVCSSLCertCN` (необязательно)
    -   Среда `/ISMASTERSVCTHUMBPRINT` (необязательно)

    > [!NOTE]
    > Если мастер Scale Out не устанавливается вместе с ядром СУБД и экземпляр ядра СУБД является именованным, после установки необходимо настроить `SqlServerName` в файле конфигурации службы мастера горизонтального увеличения масштаба. Дополнительные сведения см. в разделе [Мастер горизонтального увеличения масштаба](integration-services-ssis-scale-out-master.md).

## <a name="install-scale-out-worker"></a><a name="InstallWorker"></a> Установка рабочей роли горизонтального увеличения масштаба
 
Чтобы настроить рабочую роль горизонтального увеличения масштаба, следует установить [!INCLUDE[ssISnoversion_md](../../includes/ssisnoversion-md.md)] и компонент рабочей роли горизонтального увеличения масштаба в программе установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)].

Чтобы установить рабочую роль горизонтального увеличения масштаба, используйте мастер установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] или командную строку.

### <a name="install-scale-out-worker-with-the-sql-server-installation-wizard"></a>Установка рабочей роли горизонтального увеличения масштаба с помощью мастера установки SQL Server

1.  На странице **Выбор компонентов** выберите элемент **Рабочая роль горизонтального увеличения масштаба** в категории [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].

    ![Выбор рабочей роли](media/feature-select-worker.PNG)

2.  На странице **Конфигурация сервера** выберите учетную запись для запуска **службы рабочей роли горизонтального увеличения масштаба SQL Server Integration Services** и выберите **Тип запуска**.

    ![Конфигурация сервера 2](media/server-config-2.PNG "Конфигурация сервера 2")

3.  На странице **Настройка рабочей роли горизонтального увеличения масштаба служб Integration Services** укажите конечную точку для связи с мастером горизонтального увеличения масштаба. 

    - Для среды **с одним компьютером** конечная точка создается автоматически при одновременной установке мастера и рабочей роли горизонтального увеличения масштаба. 

    - Для среды с **несколькими компьютерами** конечная точка состоит из имени или IP-адреса компьютера с мастером горизонтального увеличения масштаба, а также номера порта, указанного во время установки мастера горизонтального увеличения масштаба.
   
    ![Конфигурация рабочей роли 1](media/worker-config.PNG "Конфигурация рабочей роли 1")    

    > [!NOTE]
    > Вы также можете пропустить настройку рабочей роли на этом этапе и связать рабочую роль горизонтального увеличения масштаба с мастером горизонтального увеличения масштаба после установки, используя [диспетчер горизонтального увеличения масштаба](integration-services-ssis-scale-out-manager.md).

4. Для среды с **несколькими компьютерами** укажите TLS/SSL-сертификат клиента, используемый для проверки мастера горизонтального увеличения масштаба. Для среды с **одним компьютером** указывать TLS/SSL-сертификат клиента не требуется. 
  
    Нажмите кнопку **Обзор** , чтобы найти файл сертификата (CER). Чтобы использовать TLS/SSL-сертификат по умолчанию, выберите файл `SSISScaleOutMaster.cer`, находящийся в папке `\<drive\>:\Program Files\Microsoft SQL Server\140\DTS\Binn` на компьютере, на котором установлен мастер горизонтального увеличения масштаба.   

    ![Конфигурация рабочей роли 2](media/worker-config-2.PNG "Конфигурация рабочей роли 2")

    > [!NOTE]
    > Если TLS/SSL-сертификат, используемый мастером горизонтального увеличения масштаба, является самозаверяющим, соответствующий TLS/SSL-сертификат клиента требуется установить на компьютере с рабочей ролью горизонтального увеличения масштаба. Если указать путь к файлу TLS/SSL-сертификата клиента на странице **Настройка рабочей роли горизонтального увеличения масштаба служб Integration Services**, он будет установлен автоматически; в противном случае требуется установить этот сертификат вручную позже. 
     
5. Завершите работу мастера установки [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] .

### <a name="install-scale-out-worker-from-the-command-prompt"></a>Установка рабочей роли горизонтального увеличения масштаба из командной строки

Следуйте инструкциям в разделе [Установка SQL Server из командной строки](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md). Задайте параметры для рабочей роли горизонтального увеличения масштаба, выполнив указанные ниже действия.

1.  Добавьте IS_Worker в параметр `/FEATURES`.

2. Настройте рабочую роль горизонтального увеличения масштаба, указав следующие параметры и их значения:
    -   `/ISWORKERSVCACCOUNT`
    -   `/ISWORKERSVCPASSWORD`
    -   `/ISWORKERSVCSTARTUPTYPE`
    -   Среда `/ISWORKERSVCMASTER` (необязательно)
    -   Среда `/ISWORKERSVCCERT` (необязательно)
 
## <a name="install-scale-out-worker-client-certificate"></a><a name="InstallCert"></a> Установка сертификата клиента рабочей роли горизонтального увеличения масштаба

Во время установки рабочей роли горизонтального увеличения масштаба сертификат рабочей роли создается и устанавливается на компьютере автоматически. Кроме того, соответствующий сертификат клиента SSISScaleOutWorker.cer устанавливается в папку `\<drive\>:\Program Files\Microsoft SQL Server\140\DTS\Binn`. Чтобы мастер горизонтального увеличения масштаба проверял подлинность рабочей роли, следует добавить этот сертификат клиента в корневое хранилище локального компьютера, где находится мастер горизонтального увеличения масштаба.
  
Чтобы добавить сертификат клиента в корневое хранилище, дважды щелкните файл CER и нажмите кнопку **Установить сертификат** в диалоговом окне сертификата. Откроется **мастер импорта сертификатов**.  

## <a name="open-firewall-port"></a><a name="Firewall"></a> Открытие порта брандмауэра

На компьютере с мастером горизонтального увеличения масштаба откройте порт, указанный во время установки мастера горизонтального увеличения масштаба, и порт SQL Server (по умолчанию 1433) в брандмауэре Windows.

> [!Note]
> После открытия порта в брандмауэре требуется перезапустить службу рабочей роли горизонтального увеличения масштаба.
    
## <a name="start-sql-server-scale-out-master-and-worker-services"></a><a name="Start"></a> Запуск службы мастера и рабочей роли горизонтального увеличения масштаба SQL Server

Если во время установки для служб не был задан тип запуска **Автоматически**, запустите следующие службы:

-   Главная роль горизонтального увеличения масштаба SQL Server Integration Services 14.0 (SSISScaleOutMaster140)

-   Рабочая роль горизонтального увеличения масштаба SQL Server Integration Services 14.0 (SSISScaleOutWorker140)

## <a name="enable-scale-out-master"></a><a name="EnableMaster"></a> Включение мастера горизонтального увеличения масштаба

При создании каталога SSISDB в [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)][!INCLUDE[ssManStudio_md](../../includes/ssmanstudio-md.md)] выберите параметр **Включить этот сервер в качестве мастера горизонтального увеличения масштаба SSIS** в диалоговом окне **Создать каталог**.

После создания каталога вы можете включить мастер горизонтального увеличения масштаба с помощью [диспетчера горизонтального увеличения масштаба](integration-services-ssis-scale-out-manager.md).

## <a name="enable-sql-server-authentication-mode"></a><a name="EnableAuth"></a> Включение режима проверки подлинности SQL Server
Если проверка подлинности [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] не была включена во время установки ядра СУБД, включите режим проверки подлинности SQL Server в экземпляре [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)], в котором находится каталог SSISDB. 

При отключенной проверке подлинности SQL Server выполнение пакетов не блокируется. Однако журнал выполнения не может записываться в базу данных SSISDB.

## <a name="enable-scale-out-worker"></a><a name="EnableWorker"></a> Включение рабочей роли горизонтального увеличения масштаба

Рабочую роль горизонтального увеличения масштаба можно включить с помощью [диспетчера горизонтального увеличения масштаба](integration-services-ssis-scale-out-manager.md), предоставляющего графический пользовательский интерфейс, или с помощью хранимой процедуры.

Чтобы включить рабочую роль горизонтального увеличения масштаба, выполните хранимую процедуру `[catalog].[enable_worker_agent]`, используя **WorkerAgentId** в качестве параметра. 

После регистрации рабочей роли горизонтального увеличения масштаба в мастере горизонтального увеличения масштаба вы получаете значение **WorkerAgentId** из представления `[catalog].[worker_agents]` в SSISDB. Регистрация занимает несколько минут после запуска служб мастера и рабочей роли горизонтального увеличения масштаба.

#### <a name="example"></a>Пример
В приведенном ниже примере рабочая роль горизонтального увеличения масштаба включается на компьютере `computerA`.

```sql
SELECT WorkerAgentId, MachineName FROM [catalog].[worker_agents]
GO
-- Result: --
-- WorkerAgentId                           MachineName  --
-- 6583054A-E915-4C2A-80E4-C765E79EF61D    computerA    --

EXEC [catalog].[enable_worker_agent] '6583054A-E915-4C2A-80E4-C765E79EF61D'
GO 
```

## <a name="next-steps"></a>Дальнейшие действия
-   [Выполнение пакетов в развертывании служб Integration Services (SSIS) с горизонтальным увеличением масштаба](run-packages-in-integration-services-ssis-scale-out.md)