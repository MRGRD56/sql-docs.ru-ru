---
title: Загрузка данных в SQL Server или базу данных SQL Azure с помощью SQL Server Integration Services (SSIS) | Документация Майкрософт
description: Демонстрация создания пакета SQL Server Integration Services (SSIS) для перемещения данных из разнообразных источников в SQL Server или базу данных SQL Azure.
documentationcenter: NA
ms.prod: sql
ms.prod_service: integration-services
ms.technology: integration-services
ms.topic: conceptual
ms.custom: loading
ms.date: 08/20/2018
ms.author: chugu
author: chugugrace
ms.openlocfilehash: 4bdd992e4cea1f2c869f3669905709f91727c874
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100074193"
---
# <a name="load-data-into-sql-server-or-azure-sql-database-with-sql-server-integration-services-ssis"></a>Загрузка данных в SQL Server или базу данных SQL Azure с помощью SQL Server Integration Services (SSIS)

[!INCLUDE[sqlserver-ssis](../includes/ssis-appliesto-ssvrpluslinux-asdb-xxxx-xxx.md)]

Вы можете создать пакет служб SQL Server Integration Services (SSIS) для загрузки данных в SQL Server или [базу данных SQL Azure](/azure/sql-database/). При необходимости можно реструктуризировать, преобразовать и очистить данные по мере их прохождения через поток данных SSIS.

В этой статье показано следующее:

* Создание проекта служб Integration Services в Visual Studio.
* Создание пакета служб SSIS, который загружает данные из источника в назначение.
* Запуск пакета служб SSIS для загрузки данных.

## <a name="basic-concepts"></a>Основные понятия

Пакет — это базовая единица работы в службах SSIS. Связанные пакеты группируются в проекты. Для создания проектов и пакетов разработки в Visual Studio используется SQL Server Data Tools. Процесс разработки — это визуальный процесс, в котором вы перетаскиваете компоненты с панели элементов в область конструктора, соединяете их и задаете их свойства. Завершив создание пакета, вы можете запустить его и при необходимости развернуть в SQL Server или Базе данных SQL, чтобы получить комплексные возможности управления, мониторинга и защиты.

В рамках этой статьи службы SSIS не будут разбираться подробно. Дополнительные сведения см. в следующих статьях:

- [SQL Server Integration Services](sql-server-integration-services.md)

- [Создание пакета ETL](ssis-how-to-create-an-etl-package.md)

## <a name="about-the-solution"></a>Сведения о решении

Решение представляет собой обычный пакет с задачей потока данных, содержащей источник и получатель. Этот подход поддерживает обширный ряд источников данных, включая SQL Server и Базу данных SQL Azure.

В этом учебнике в качестве источника данных используется SQL Server. SQL Server запускается на локальном компьютере или в виртуальной машине Azure.

Чтобы подключиться к SQL Server и Базе данных SQL, используйте диспетчер подключений ADO.NET с источником и получателем или диспетчер подключений OLE DB с источником и получателем. В этом руководстве используется платформа ADO.NET, так как в ней меньше всего параметров конфигурации. OLE DB может обеспечить немного большую производительность по сравнению с ADO.NET.

Чтобы быстро создать базовый пакет, вы можете использовать Мастер импорта и экспорта SQL Server. Затем сохраните пакет и откройте его в Visual Studio или SSDT для просмотра и настройки. Дополнительные сведения см. в разделе [Импорт и экспорт данных с помощью мастера импорта и экспорта SQL Server](import-export-data/import-and-export-data-with-the-sql-server-import-and-export-wizard.md).

## <a name="prerequisites"></a>предварительные требования
Для прохождения этого руководства потребуется следующее.

1. **SQL Server Integration Services (SSIS)** . Службы SSIS — это компонент SQL Server, которому для работы нужна лицензионная версия, версия для разработчиков или ознакомительная версия SQL Server. [Получить ознакомительную версию SQL Server](https://www.microsoft.com/evalcenter/evaluate-sql-server-2017-rtm).
2. **Visual Studio** (необязательно). Для получения бесплатного выпуска Visual Studio Community см. раздел [Visual Studio Community][Visual Studio Community]. Если вы не хотите устанавливать Visual Studio, вы можете установить только SQL Server Data Tools (SSDT). Установка SSDT включает версию Visual Studio с ограниченной функциональностью.
3. **SQL Server Data Tools для Visual Studio (SSDT)** . Чтобы получить SQL Server Data Tools для Visual Studio, см. раздел [Скачивание SQL Server Data Tools (SSDT)][Download SQL Server Data Tools (SSDT)].
4. В этом руководстве выполняется подключение к экземпляру SQL Server или базы данных SQL и загрузка данных в него. У вас должны быть разрешения на подключение, создание таблицы и загрузку данных для одного из следующих объектов.
   - **База данных SQL Azure**. Дополнительные сведения см. в разделе [База данных SQL Azure](/azure/sql-database/).  
      или диспетчер конфигурации служб
   - **Экземпляр SQL Server**. SQL Server запускается на локальном компьютере или в виртуальной машине Azure. Чтобы скачать бесплатный выпуск SQL Server Evaluation или Developer, см. раздел [Скачиваемые файлы SQL Server](https://www.microsoft.com/sql-server/sql-server-downloads).

5. **Образец данных**. В качестве исходных данных руководство использует образцы, хранимые в SQL Server в примере базы данных AdventureWorks. Чтобы получить образец базы данных AdventureWorks, см. раздел [Образцы баз данных AdventureWorks][AdventureWorks 2014 Sample Databases].
6. **Правило брандмауэра** в случае загрузки данных в базу данных SQL. Перед загрузкой в Базу данных SQL вам нужно создать для нее правило брандмауэра с IP-адресом локального компьютера.

## <a name="create-a-new-integration-services-project"></a>Создание нового проекта служб Integration Services
1. Запустите Visual Studio.
2. В меню **Файл** выберите **Создать | Проект**.
3. Перейдите к типам проектов **Установленные | Шаблоны | Бизнес-аналитика | Integration Services**.
4. Выберите **Проект служб SSIS**. Укажите значения для параметров **Имя** и **Расположение**, а затем нажмите кнопку **ОК**.

Visual Studio открывает и создает проект служб Integration Services (SSIS). Затем Visual Studio открывает конструктор для отдельного нового пакета служб SSIS (Package.dtsx) в проекте. Видны следующие области экрана:

* В левой части **панель элементов** для компонентов служб SSIS.
* В центре область конструктора с несколькими вкладками. Как правило, используются по меньшей мере вкладки **Поток управления** и **Поток данных**.
* В правой части — области **Обозреватель решений** и **Свойства**.
  
    ![Снимок экрана Visual Studio: панель элементов, область конструктора, панель обозревателя решений и панель свойств.][01]

## <a name="create-the-basic-data-flow"></a>Создание простого потока данных
1. Перетащите задачу потока данных с панели элементов в центр области конструктора (на вкладке **Поток управления**).
   
    ![Снимок экрана Visual Studio: задача потока данных, перетаскиваемая на вкладку "Поток управления" области конструктора.][02]
2. Дважды щелкните элемент "Задача потока данных", чтобы перейти на вкладку "Поток данных".
3. В списке "Другие источники" на панели элементов перетащите источник ADO.NET в область конструктора. Выбрав адаптер источника данных, измените его имя на **SQL Server source** (Источник SQL Server) в области **Свойства**.
4. В списке "Другие назначения" на панели элементов перетащите назначение ADO.NET в область конструктора под источником ADO.NET. Выбрав адаптер загрузки данных, измените его имя на **SQL destination** (Назначение SQL) в области **Свойства**.
   
    ![Снимок экрана: адаптер загрузки данных, перетаскиваемый в расположение непосредственно под адаптером источника данных.][09]

## <a name="configure-the-source-adapter"></a>Настройка адаптера источника данных
1. Дважды щелкните адаптер источника данных, чтобы открыть **Редактор источника ADO.NET**.
   
    ![Снимок экрана: редактор источника ADO.NET. Вкладка "Диспетчер подключений" видима, а элементы управления доступны для настройки свойств потока данных.][03]
2. На вкладке **Диспетчер соединений** окна **Редактор источника ADO.NET** нажмите кнопку **Создать** рядом со списком **Диспетчер соединений ADO.NET**, чтобы открыть диалоговое окно **Настройка диспетчера соединений ADO.NET** и создать параметры подключения для базы данных SQL Server, откуда этот учебник загружает данные.
   
    ![Снимок экрана: диалоговое окно "Настройка диспетчера соединений ADO.NET". Элементы управления доступны для настройки диспетчеров подключений.][04]
3. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **Создать**, чтобы открыть диалоговое окно **Диспетчер соединений** и создать подключение к данным.
   
    ![Снимок экрана: диалоговое окно "Диспетчер подключений". Элементы управления доступны для настройки подключения к данным.][05]
4. В диалоговом окне **Диспетчер соединений** сделайте следующее:
   
   1. В поле **Поставщик** выберите поставщик данных SqlClient.
   2. В поле **Имя сервера** введите имя SQL Server.
   3. В разделе **Вход на сервер** выберите или введите сведения для проверки подлинности.
   4. В разделе **Соединение с базой данных** выберите образец базы данных AdventureWorks.
   5. Нажмите кнопку **Проверить соединение**.
      
       ![Снимок экрана: диалоговое окно с кнопкой "ОК" и текстом, указывающим, что проверка соединения прошла успешно.][06]
   6. В диалоговом окне, сообщающем результаты проверки соединения, нажмите кнопку **ОК**, чтобы вернуться в диалоговое окно **Диспетчер соединений**.
   7. В диалоговом окне **Диспетчер соединений** нажмите кнопку **ОК** для возврата в диалоговое окно **Настройка диспетчера соединений ADO.NET**.
5. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **ОК** для возврата в **Редактор источника ADO.NET**.
6. В окне **Редактор источника ADO.NET** в списке **Имя таблицы или представления** выберите таблицу **Sales.SalesOrderDetail**.
   
    ![Снимок экрана: редактор источника ADO.NET. В списке "Имя таблицы или представления" выбрана таблица Sales.SalesOrderDetail.][07]
7. Нажмите кнопку **Предварительный просмотр**, чтобы просмотреть первые 200 строк данных исходной таблицы в диалоговом окне **Предварительный просмотр результатов запроса**.
   
    ![Снимок экрана: диалоговое окно "Предварительный просмотр результатов запроса". Видны несколько строк данных о продажах из исходной таблицы.][08]
8. В диалоговом окне **Предварительный просмотр результатов запроса** нажмите кнопку **Закрыть** для возврата в **Редактор источника ADO.NET**.
9. В окне **Редактор источника ADO.NET** нажмите кнопку **ОК**, чтобы завершить настройку источника данных.

## <a name="connect-the-source-adapter-to-the-destination-adapter"></a>Подключение адаптера источника данных к адаптеру загрузки данных
1. Выберите адаптер источника данных в области конструктора.
2. Выберите синюю стрелку, отходящую от адаптера источника данных, и перетащите к редактору назначения до ее фиксации.
   
    ![Снимок экрана: адаптер источника данных и адаптер загрузки данных. Синяя стрелка указывает от адаптера источника данных к адаптеру загрузки данных.][10]
   
    В типичном пакете служб SSIS между источником и назначением используется несколько других компонентов из панели элементов SSIS для реструктуризации, преобразования и очистки данных по мере их прохождения через поток данных SSIS. Чтобы сделать этот пример как можно более простым, мы подключаем источник непосредственно к назначению.

## <a name="configure-the-destination-adapter"></a>Настройка адаптера загрузки данных
1. Дважды щелкните адаптер загрузки данных, чтобы открыть **Редактор назначения ADO.NET**.
   
    ![Снимок экрана: редактор назначения ADO.NET. Вкладка "Диспетчер подключений" видима и содержит элементы управления для настройки свойств потока данных.][11]
2. На вкладке **Диспетчер соединений** окна **Редактор назначения ADO.NET** нажмите кнопку **Создать** рядом со списком **Диспетчер соединений**, чтобы открыть диалоговое окно **Настройка диспетчера соединений ADO.NET** и создать параметры подключения для базы данных, куда в этом руководстве будут загружены данные.
3. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **Создать**, чтобы открыть диалоговое окно **Диспетчер соединений** и создать подключение к данным.
4. В диалоговом окне **Диспетчер соединений** сделайте следующее:
   1. В поле **Поставщик** выберите поставщик данных SqlClient.
   2. В поле **Имя сервера** введите имя сервера SQL Server или сервера базы данных SQL.
   3. В разделе **Вход на сервер** выберите **Использовать проверку подлинности SQL Server** и введите сведения для проверки подлинности.
   4. В разделе **Соединение с базой данных** выберите существующую базу данных.
    а. Нажмите кнопку **Проверить соединение**.
    b. В диалоговом окне, сообщающем результаты проверки соединения, нажмите кнопку **ОК**, чтобы вернуться в диалоговое окно **Диспетчер соединений**.
    c. В диалоговом окне **Диспетчер соединений** нажмите кнопку **ОК** для возврата в диалоговое окно **Настройка диспетчера соединений ADO.NET**.
5. В диалоговом окне **Настройка диспетчера соединений ADO.NET** нажмите кнопку **ОК** для возврата в **Редактор назначения ADO.NET**.
6. В окне **Редактор назначения ADO.NET** нажмите кнопку **Создать** рядом со списком **Использовать таблицу или представление**, чтобы открыть диалоговое окно **Создание таблицы** для создания целевой таблицы со списком столбцов, соответствующим исходной таблице.
   
    ![Снимок экрана: диалоговое окно "Создание таблицы". Код SQL для создания целевой таблицы виден.][12a]
7. В диалоговом окне **Создание таблицы** сделайте следующее:
   
   1. Измените имя целевой таблицы на **SalesOrderDetail**.
      
       ![Снимок экрана: диалоговое окно "Создание таблицы". Виден код SQL для создания таблицы SalesOrderDetail.][12b]

   2. Нажмите кнопку **ОК**, чтобы создать таблицу и вернуться в **Редактор назначения ADO.NET**.
8. В окне **Редактор назначения ADO.NET** откройте вкладку **Сопоставления**, чтобы просмотреть, как столбцы в источнике сопоставляются со столбцами в назначении.
   
    ![Снимок экрана: вкладка "Сопоставления" редактора назначения ADO.NET. Линии соединяют столбцы с одинаковыми именами в исходной и целевой таблицах.][13]
9. Нажмите кнопку **ОК**, чтобы завершить настройку назначения.

## <a name="run-the-package-to-load-the-data"></a>Запуск пакета для загрузки данных
Запустите пакет, нажав кнопку **Пуск** на панели инструментов или выбрав один из параметров **запуска** в меню **Отладка**.

Ниже описано, что происходит при создании пакета по второму варианту из этой статьи, то есть, с потоком данных, содержащим источник и получатель.

Как только начнется выполнение пакета, вы увидите желтые вращающиеся колеса, обозначающие активность, а также количество обработанных строк.

![Снимок экрана: адаптер источника данных и адаптер загрузки данных. На каждом адаптере находятся желтые вращающиеся колеса, а между ними находится текст "89748 rows" (89748 строк).][14]

После завершения выполнения пакета появляются зеленые галочки, указывающие успешность операции, а также общее число строк данных, загруженных из источника в назначение.

![Снимок экрана: адаптер источника данных и адаптер загрузки данных. На каждом адаптере стоят зеленые галочки, а между ними находится текст "121317 rows" (121317 строк).][15]

Поздравляем! Вы успешно загрузили данные в SQL Server или базу данных SQL Azure, используя службы SQL Server Integration Services.

## <a name="next-steps"></a>Дальнейшие действия

- Сведения об отладке пакетов и устранении их неполадок прямо в среде разработки. Начните здесь: [Инструменты устранения неполадок при разработке пакета][Troubleshooting Tools for Package Development].

- Сведения о развертывании пакетов и проектов служб SSIS на сервере служб Integration Services или в другом хранилище. Начните здесь: [Развертывание проектов и пакетов][Deployment of Projects and Packages].

<!-- Image references -->
[01]:  ./media/load-data-to-sql-database-with-ssis/ssis-designer-01.png
[02]:  ./media/load-data-to-sql-database-with-ssis/ssis-data-flow-task-02.png
[03]:  ./media/load-data-to-sql-database-with-ssis/ado-net-source-03.png
[04]:  ./media/load-data-to-sql-database-with-ssis/ado-net-connection-manager-04.png
[05]:  ./media/load-data-to-sql-database-with-ssis/ado-net-connection-05.png
[06]:  ./media/load-data-to-sql-database-with-ssis/test-connection-06.png
[07]:  ./media/load-data-to-sql-database-with-ssis/ado-net-source-07.png
[08]:  ./media/load-data-to-sql-database-with-ssis/preview-data-08.png
[09]:  ./media/load-data-to-sql-database-with-ssis/source-destination-09.png
[10]:  ./media/load-data-to-sql-database-with-ssis/connect-source-destination-10.png
[11]:  ./media/load-data-to-sql-database-with-ssis/ado-net-destination-11.png
[12a]: ./media/load-data-to-sql-database-with-ssis/destination-query-before-12a.png
[12b]: ./media/load-data-to-sql-database-with-ssis/destination-query-after-12b.png
[13]:  ./media/load-data-to-sql-database-with-ssis/column-mapping-13.png
[14]:  ./media/load-data-to-sql-database-with-ssis/package-running-14.png
[15]:  ./media/load-data-to-sql-database-with-ssis/package-success-15.png

<!-- Article references -->

<!-- MSDN references -->
[Download SQL Server Data Tools (SSDT)]: ../ssdt/download-sql-server-data-tools-ssdt.md
[Data Flow]: ./data-flow/data-flow.md
[Troubleshooting Tools for Package Development]: ./troubleshooting/troubleshooting-tools-for-package-development.md
[Deployment of Projects and Packages]: ./packages/deploy-integration-services-ssis-projects-and-packages.md

<!--Other Web references-->
[Microsoft SQL Server 2017 Integration Services Feature Pack for Azure]: https://www.microsoft.com/download/details.aspx?id=54798
[SQL Server Evaluations]: https://www.microsoft.com/evalcenter/evaluate-sql-server-2017
[Visual Studio Community]: https://www.visualstudio.com/products/visual-studio-community-vs.aspx
[AdventureWorks 2014 Sample Databases]: https://github.com/Microsoft/sql-server-samples/releases/tag/adventureworks
