---
description: Занятие 4-2. Создание поврежденного файла
title: Шаг 2. Создание поврежденного файла | Документация Майкрософт
ms.custom: ''
ms.date: 01/07/2019
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: tutorial
ms.assetid: cd0b18dc-66c3-4d88-86ef-8e40cb660fae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81bee95c84aabe02f2964f41849051a7c8c7052a
ms.sourcegitcommit: c5078791a07330a87a92abb19b791e950672e198
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "88449649"
---
# <a name="lesson-4-2-create-a-corrupted-file"></a>Занятие 4-2. Создание поврежденного файла

[!INCLUDE[sqlserver-ssis](../includes/applies-to-version/sqlserver-ssis.md)]



Для демонстрации настройки и обработки ошибок преобразования необходим образец неструктурированного файла, который при обработке вызовет сбой в работе компонента.  
  
В этой задаче создается копия существующего образца неструктурированного файла. Затем файл открывается в Блокноте, и в столбце **CurrencyID** значение заменяется на ошибочное, чтобы при поиске произошел сбой. При обработке поврежденного файла происходит сбой в преобразовании "Поиск ключа валюты", что приводит к ошибке в работе всего пакета. После создания поврежденного образца файла предстоит выполнить пакет, чтобы просмотреть его поведение при сбое.  
  
## <a name="create-a-corrupted-sample-flat-file"></a>Создание поврежденного образца неструктурированного файла  
  
1.  В Блокноте или другом текстовом редакторе откройте файл **Currency_VEB.txt**.  
  
2.  Используя функции текстового редактора для поиска и замены, замените все вхождения строки **VEB** на **BAD**.  
  
3.  Сохраните измененный файл в той же папке, где находятся остальные файлы образцов данных, с именем **Currency_BAD.txt**.  
  
    > [!NOTE]  
    > Убедитесь в том, что файл **Currency_BAD.txt** сохранен в той же папке, что и другие файлы образцов данных.  
  
4.  Закройте текстовый редактор.  
  
## <a name="verify-that-an-error-occurs-during-run-time"></a>Проверка факта возникновения ошибки во время выполнения  
  
1.  В меню **Отладка** выберите пункт **Начать отладку**.  
  
    При третьем проходе потока данных в преобразовании "Поиск ключа валюты" предпринимается попытка обработать файл **Currency_BAD.txt**, и происходит ошибка преобразования. Ошибка преобразования вызывает отказ работы всего пакета.  
  
2.  В меню **Отладка** выберите команду **Остановить отладку**.  
  
3.  В области конструктора откройте вкладку **Результаты выполнения**.  
  
4.  Просмотрите журнал и убедитесь, что произошла следующая необработанная ошибка:  
  
    ```
    [Lookup Currency Key[27]] Error: Row yielded no match during lookup.
    ```
  
    > [!NOTE]  
    > Число 27 представляет собой идентификатор компонента. Это значение присваивается при создании потока данных, так что в пакете оно может отличаться от приведенного в учебнике.  
  
## <a name="go-to-next-task"></a>Переход к следующей задаче  
[Шаг 3. Добавление перенаправления потока ошибок](../integration-services/lesson-4-3-adding-error-flow-redirection.md)  
  
  
  
