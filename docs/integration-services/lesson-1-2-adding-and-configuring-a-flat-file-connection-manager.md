---
description: Занятие 1-2. Добавление и настройка диспетчера подключений к неструктурированным файлам
title: Шаг 2. Добавление и настройка диспетчера подключений к неструктурированным файлам | Документация Майкрософт
ms.custom: ''
ms.date: 01/03/2019
ms.prod: sql
ms.prod_service: integration-services
ms.reviewer: ''
ms.technology: integration-services
ms.topic: tutorial
ms.assetid: 9a77dd32-d8c2-4961-ad37-2a971f9d6043
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d83b2c6a19b7a73be4293dcb66edc6cbc22909d9
ms.sourcegitcommit: c5078791a07330a87a92abb19b791e950672e198
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "88449740"
---
# <a name="lesson-1-2-add-and-configure-a-flat-file-connection-manager"></a>Занятие 1-2. Добавление и настройка диспетчера подключений к неструктурированным файлам

[!INCLUDE[sqlserver-ssis](../includes/applies-to-version/sqlserver-ssis.md)]



В этом задании к только что созданному пакету будет добавлен диспетчер соединений с неструктурированными файлами. Диспетчер соединений с неструктурированными файлами позволяет пакету извлекать данные из неструктурированных файлов. С помощью диспетчера соединений с неструктурированными файлами можно указать имя и расположение файла, локали и кодовую страницу, а также формат файла, включая разделители столбцов. Эти данные будут использованы при извлечении пакета из неструктурированного файла. Кроме того, можно вручную указать тип данных для каждого столбца или в диалоговом окне **Предлагаемые типы столбцов** указать автоматическое сопоставление столбцов извлекаемых данных с типами данных в службах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] .  
  
Для каждого используемого формата файла необходимо создать отдельный диспетчер подключений к неструктурированным файлам. Так как в данном учебнике данные извлекаются из неструктурированных файлов одинакового формата, в пример пакета необходимо добавить и настроить только один диспетчер подключений к неструктурированным файлам.  
  
На этом занятии предстоит настроить указанные ниже свойства диспетчера подключений к неструктурированным файлам.  
  
-   **Имена столбцов**. Так как в неструктурированном файле не указаны имена столбцов, диспетчер подключений к неструктурированным файлам создает имена столбцов по умолчанию. Указанные имена по умолчанию не дают представления о содержащихся в столбцах данных. Замените имена по умолчанию именами, взятыми из таблицы фактов, в которую будут загружаться данные из неструктурированных файлов.  
  
-   **Сопоставление данных**. Сопоставления типов данных, указанные для диспетчера подключений к неструктурированным файлам, используются всеми компонентами источника данных "неструктурированный файл", которые обращаются к диспетчеру подключений. Можно сопоставить типы данных вручную с помощью диспетчера соединений с неструктурированными файлами или использовать диалоговое окно **Предлагаемые типы столбцов** . В этой задаче предстоит просмотреть сопоставления, предложенные в диалоговом окне **Предлагаемые типы столбцов**, а затем вручную создать необходимые сопоставления в диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами**.  
  
> [!NOTE]
> Диспетчер соединений с неструктурированными файлами предоставляет сведения о локали файла данных. Если на компьютере не настроены региональные параметры **Русский (Россия)**, нужно установить дополнительные свойства в диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами**.  
  
## <a name="add-a-flat-file-connection-manager-to-the-ssis-package"></a>Добавление диспетчера подключений к неструктурированным файлам в пакет служб SSIS  
  
1.  В области **Обозреватель решений** щелкните правой кнопкой мыши папку **Диспетчеры подключений** и выберите команду **Создать диспетчер подключений**.
1. В диалоговом окне **Добавление диспетчера соединений со службами SSIS** выберите **FLATFILE** и нажмите кнопку **Добавить**.
  
2.  В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** в поле **Имя диспетчера соединений** введите **Образец источника данных "неструктурированный файл"**.  
  
3.  Нажмите кнопку **Обзор**.  
  
4.  В диалоговом окне **Открыть** найдите файл **SampleCurrencyData.txt** на компьютере.  
  
5.  Снимите флажок "Имена столбцов в первой строке данных".  
  
### <a name="set-locale-sensitive-properties"></a>Настройка свойств,зависящих от языкового стандарта  
  
1.  В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** перейдите на вкладку **Общие**.  
  
2.  Установите свойство **Локаль** в значение **Русский (Россия)**, а свойство **Кодовая страница** — в значение **1252**.  
  
### <a name="rename-columns-in-the-flat-file-connection-manager"></a>Переименование столбцов в диспетчере подключений к неструктурированным файлам  
  
1.  В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** перейдите на вкладку **Дополнительно**.  
  
2.  На панели свойств сделайте следующие изменения.  
  
    -   Измените имя **Column 0** на **AverageRate**.  
  
    -   Измените имя **Column 1** на **CurrencyID**.  
  
    -   Измените имя **Column 2** на **CurrencyDate**.  
  
    -   Измените имя **Column 3** на **EndOfDayRate**.  
  
### <a name="remap-column-data-types"></a>Сопоставление типов данных столбцов  
  
По умолчанию для всех четырех столбцов указан строковый тип данных [DT_STR] со значением параметра **OutputColumnWidth** , равным 50.  

1.  В диалоговом окне **Редактор диспетчера соединений с неструктурированными файлами** нажмите кнопку **Предложить типы**.  
  
    Службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] автоматически предлагают подходящие типы данных на основании первых 200 строк. Можно изменить параметры предложения по большему или меньшему количеству данных, чтобы указать тип данных по умолчанию для целочисленных и логических данных или чтобы добавить пробелы в дополнение к строковым столбцам.  
  
    На данный момент не изменяйте значения параметров в диалоговом окне **Предлагаемые типы столбцов** и нажмите кнопку **ОК**, чтобы службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предложили типы данных для столбцов. Вы вернетесь на панель **Дополнительно** диалогового окна **Редактор диспетчера соединений с неструктурированными файлами**, где можно просмотреть типы данных столбцов, предложенные службами [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)]. Если нажать кнопку **Отмена**, предложения в отношении метаданных столбца и типа данных строки по умолчанию (DT_STR) сделаны не будут.  
  
    В этом учебнике для данных из файла SampleCurrencyData.txt в службах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предлагаются типы данных, приведенные во втором столбце следующей ниже таблицы. В четвертом столбце приведены типы данных, требуемые для столбцов назначения, которые будут определены позже.  
  
    |Столбец неструктурированных файлов|Предложенный тип|Столбец назначения|Тип назначения|  
    |--------------------|------------------|----------------------|--------------------|  
    |AverageRate|float [DT_R4]|FactCurrencyRate.AverageRate|FLOAT|  
    |CurrencyID|string [DT_STR]|DimCurrency.CurrencyAlternateKey|nchar(3)|  
    |CurrencyDate|date [DT_DATE]|DimDate.FullDateAlternateKey|Дата|  
    |EndOfDayRate|float [DT_R4]|FactCurrencyRate.EndOfDayRate|FLOAT|  
  
    Тип данных, предложенный для столбца **CurrencyID** , несовместим с типом данных поля целевой таблицы. Так как типом данных `DimCurrency.CurrencyAlternateKey` является nchar(3), значение **CurrencyID** нужно изменить со строки [DT_STR] на строку Юникода [DT_WSTR]. Кроме того, поле `DimDate.FullDateAlternateKey` определяется как имеющее тип данных date, поэтому необходимо изменить тип столбца **CurrencyDate** с типа даты [DT_Date] на тип даты базы данных [DT_DBDATE].  
  
2.  Выберите в списке столбец **CurrencyID**, после чего на панели свойств измените тип данных столбца **CurrencyID** со строкового [DT_STR] на тип строки Юникода [DT_WSTR].  
  
3.  На панели свойств измените тип данных столбца **CurrencyDate** с типа даты [DT_DATE] на тип даты базы данных [DT_DBDATE].  
  
4.  Щелкните **ОК**.  
  
## <a name="go-to-next-task"></a>Переход к следующей задаче
[Шаг 3. Добавление и настройка диспетчера подключений OLE DB](../integration-services/lesson-1-3-adding-and-configuring-an-ole-db-connection-manager.md)  
  
## <a name="see-also"></a>См. также  
[диспетчер соединений с неструктурированными файлами](../integration-services/connection-manager/flat-file-connection-manager.md)  
[Типы данных служб Integration Services](../integration-services/data-flow/integration-services-data-types.md)  
  
  
  
