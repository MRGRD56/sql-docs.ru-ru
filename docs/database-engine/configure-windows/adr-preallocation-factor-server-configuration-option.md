---
title: Параметр конфигурации "Коэффициент предварительного выделения ADR" | Документация Майкрософт
description: Описывает параметр конфигурации экземпляра SQL Server для коэффициента предварительного выделения ADR.
ms.custom: ''
ms.date: 06/01/2020
ms.prod: sql
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- ADR Preallocation Factor
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 9469b5de278c01b7b256ee348380ebd1ae19cde4
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100347464"
---
# <a name="adr-preallocation-factor-configuration-option"></a>Параметр конфигурации "Коэффициент предварительного выделения ADR"

 [!INCLUDE [SQL Server](../../includes/applies-to-version/sqlserver.md)]

Впервые представлен в SQL Server 2019.

Этот параметр конфигурации необходим для [ускоренного восстановления баз данных](../../relational-databases/accelerated-database-recovery-concepts.md).

Ускоренное восстановление базы данных (ADR) хранит версии данных в целях восстановления. Эти версии создаются в рамках различных операций языка обработки данных (DML). Версии хранятся во внутренней таблице, именуемой постоянным хранилищем версий. 

## <a name="remarks"></a>Remarks  

Производительность может снизиться, если страницы выделены для таблицы постоянного хранилища версий в рамках операций пользователя на языке DML. Для решения этой проблемы существует фоновый поток, который предварительно выделяет страницы и обеспечивает их доступность для транзакций DML. Производительность лучше в том случае, когда фоновый поток предварительно выделяет достаточно страниц и процент выделений постоянного хранилища версий на переднем плане близок к 0. Журнал ошибок содержит записи с тегом `PreallocatePVS`, если процентное значение велико и влияет на производительность.

Количество страниц, предварительно распределенных фоновым потоком, основано на различных эвристиках нагрузки, но в основном выделяет страницы как фрагменты по 512 страниц. Коэффициент предварительного выделения ADR является кратным фрагменту. Коэффициент по умолчанию — 4. Это означает, что при необходимости предварительно выделяется 2048 страниц. 

Хотя в фоновом потоке учитываются шаблоны рабочей нагрузки, этот фактор может быть при необходимости увеличен для повышения производительности.

> [!CAUTION]
> Если предварительное выделение постоянного хранилища версий слишком велико, оно будет конкурировать с другими выделениями в системе и может даже снизить общую производительность.
>
> Перед изменением этого параметра следует проверить общую производительность системы.

## <a name="examples"></a>Примеры  

В следующем примере для коэффициента предварительного выделения устанавливается значение 4.

```tsql
sp_configure 'show advanced options', 1;
RECONFIGURE;
GO 
sp_configure 'ADR Preallocation Factor', 4;
RECONFIGURE;
GO
```

## <a name="see-also"></a>См. также:  

- [Параметры конфигурации сервера (SQL Server)](../../database-engine/configure-windows/server-configuration-options-sql-server.md)
- [Ускоренное восстановление баз данных](../../relational-databases/accelerated-database-recovery-concepts.md)
- [Управление ускоренным восстановлением баз данных](../../relational-databases/accelerated-database-recovery-management.md)