---
title: SQL Server Express LocalDB | Документация Майкрософт
description: Знакомство с LocalDB в SQL Server Express. Разработчики могут использовать это упрощенное ядро СУБД для написания и тестирования кода Transact-SQL.
ms.custom: ''
ms.date: 04/17/2019
ms.prod: sql
ms.prod_service: high-availability
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- user instances
- LocalDB, described
- local database runtime
- file database
- LocalDB
ms.assetid: 5a641a46-7cfb-4d7b-a90d-6e4625719d74
author: markingmyname
ms.author: maghan
ms.openlocfilehash: 1b0fea6ec995f383cd290ebbee786e31623b25f1
ms.sourcegitcommit: 2f868a77903c1f1c4cecf4ea1c181deee12d5b15
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2020
ms.locfileid: "91669723"
---
# <a name="sql-server-express-localdb"></a>SQL Server Express LocalDB

 [!INCLUDE [SQL Server](../../includes/applies-to-version/sqlserver.md)]

LocalDB в Microsoft SQL Server Express — это компонент [SQL Server Express](../../sql-server/editions-and-components-of-sql-server-version-15.md), ориентированный на разработчиков. Он доступен в SQL Server Express с дополнительными службами.

При установке LocalDB выполняется копирование минимального набора файлов, необходимых для запуска компонента [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)]. После установки LocalDB вы можете установить соединение с помощью специальной строки подключения. При соединении необходимая инфраструктура [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] создается и запускается автоматически, что позволяет приложению использовать базу данных без выполнения сложной настройки. Средства разработчика позволяют использовать [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] для написания и проверки кода [!INCLUDE[tsql](../../includes/tsql-md.md)] без необходимости управления полным экземпляром сервера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. 

## <a name="installation-media"></a>Установочный носитель 

LocalDB — это компонент, выбираемый во время установки SQL Server Express и доступный при загрузке с носителя. Если вы скачиваете мультимедиа, выберите **Express Advanced** или пакет LocalDB. 

- [SQL Server Express 2019](https://go.microsoft.com/fwlink/?LinkID=866658)
- [SQL Server Express 2017](https://go.microsoft.com/fwlink/?LinkID=853017)
- [SQL Server Express 2016](https://go.microsoft.com/fwlink/?LinkID=799012)

Кроме того, LocalDB можно установить с помощью [Visual Studio Installer](https://visualstudio.microsoft.com/downloads/) как часть рабочей нагрузки **Хранение и обработка данных**, рабочей нагрузки **ASP.NET и веб-разработка** или как отдельный компонент.


## <a name="install-localdb"></a>Установка LocalDB

Установите LocalDB с помощью мастера установки или программы SqlLocalDB.msi. LocalDB подходит при установке SQL Server Express LocalDB. 
 
Выберите LocalDB на странице **Выбор компонентов** или "Общие компоненты" во время установки. Двоичные файлы LocalDB можно устанавливать лишь по одному разу для каждой основной версии [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)]. Можно запускать несколько процессов [!INCLUDE[ssDE](../../includes/ssde-md.md)] , которые будут использовать одни и те же двоичные файлы. Экземпляр [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)], запущенный как LocalDB, имеет те же ограничения, что и [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)].

Управление экземпляром [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] LocalDB осуществляется с помощью служебной программы `SqlLocalDB.exe`. [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] LocalDB следует использовать вместо устаревшей функции пользовательского экземпляра [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)].

## <a name="description"></a>Описание

Программа установки LocalDB использует программу `SqlLocalDB.msi` для установки необходимых файлов на компьютере. После установки LocalDB становится экземпляром [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)], который способен создавать и открывать базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Файлы системной базы данных, как правило, хранятся в каталоге AppData, который обычно скрыт. Например, `C:\Users\<user>\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\LocalDBApp1\`. Файлы пользовательской базы данных хранятся в месте, указанном пользователем, как правило, в папке `C:\Users\<user>\Documents\`.

Дополнительные сведения о включении LocalDB в приложении см. в статье с [общими сведениями о локальных данных](/previous-versions/visualstudio/visual-studio-2012/ms233817(v=vs.110)) в [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] и статье о [создании базы данных и добавлении таблиц в Visual Studio](/visualstudio/data-tools/create-a-sql-database-by-using-a-designer).

Дополнительные сведения об API LocalDB см. в разделе [Справочник по SQL Server Express LocalDB](../../relational-databases/sql-server-express-localdb-reference.md).

Служебная программа `SqlLocalDb` позволяет создавать, запускать и останавливать экземпляры LocalDB, а также включает параметры для управления LocalDB. Дополнительные сведения о служебной программе `SqlLocalDb` см. в статье о [SqlLocalDB](../../tools/sqllocaldb-utility.md).

Параметры сортировки для LocalDB заданы в `SQL_Latin1_General_CP1_CI_AS` и не могут быть изменены. Параметры сортировки на уровне базы данных, на уровне столбца и на уровне выражения поддерживаются обычным образом. Автономные базы данных следуют правилам метаданных и параметрам сортировки `tempdb`, определенным [Contained Database Collations](../../relational-databases/databases/contained-database-collations.md).

### <a name="restrictions"></a>Ограничения

- LocalDB не может быть подписчиком в репликации слиянием.

- LocalDB не поддерживает FILESTREAM.

- Для LocalDB разрешены только локальные очереди компонента Service Broker.

- Экземпляр LocalDB, принадлежащий встроенным учетным записям, например `NT AUTHORITY\SYSTEM`, может иметь проблемы с управляемостью из-за перенаправления файловой системы Windows. Вместо этого следует использовать обычную учетную запись Windows в качестве владельца.

### <a name="automatic-and-named-instances"></a>Автоматические и именованные экземпляры

LocalDB поддерживает два типа экземпляров: автоматические и именованные.

- Автоматические экземпляры LocalDB являются общедоступными. Они создаются и обслуживаются автоматически и могут использоваться любым приложением. Для каждой версии LocalDB, установленной на компьютере пользователя, существует один автоматический экземпляр LocalDB. Автоматические экземпляры LocalDB обеспечивают удобное управление экземплярами. Нет необходимости создавать экземпляр. Он просто работает. Эта функция упрощает установку приложения и его перенос на другой компьютер. Если на целевом компьютере установлена указанная версия LocalDB, то там также будет доступен автоматический экземпляр LocalDB для этой версии. Автоматические экземпляры LocalDB именуются по специальному шаблону, принадлежащему зарезервированному пространству имен. Это позволяет избежать конфликтов имен с именованными экземплярами LocalDB. Автоматический экземпляр имеет имя **MSSQLLocalDB**.

- Именованные экземпляры LocalDB являются закрытыми. Они принадлежат одному приложению, которое отвечает за создание экземпляра и управление им. Именованные экземпляры обеспечивают изоляцию от других экземпляров и способствуют повышению производительности за счет снижения уровня конфликта за ресурсы с другими пользователями базы данных. Пользователь должен создавать именованные экземпляры явным образом с помощью API управления LocalDB или неявным образом через файл app.config управляемого приложения (при необходимости управляемое приложение также может использовать API). Каждый именованный экземпляр LocalDB имеет связанную с ним версию LocalDB, которая указывает на соответствующий набор двоичных файлов LocalDB. Имя экземпляра LocalDB имеет тип данных **sysname** и может содержать до 128 символов. (в отличие от обычных именованных экземпляров [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], где допускается использование только обычных имен NetBIOS из 16 символов ASCII). Имя экземпляра LocalDB может содержать любые символы Юникода, допустимые в имени файла. Именованный экземпляр, который использует имя автоматического экземпляра, становится автоматическим экземпляром.

Разные пользователи одного и того же компьютера могут иметь экземпляры с одинаковыми именами. Каждый экземпляр является отдельным процессом, который запускается от разных пользователей.

## <a name="shared-instances-of-localdb"></a>Общие экземпляры LocalDB

В LocalDB поддерживается общий доступ к экземплярам, если нескольким пользователям компьютера требуется доступ к одному экземпляру LocalDB. Владелец экземпляра может разрешить другим пользователям компьютера подключаться к своему экземпляру. Общими могут быть как автоматические, так и именованные экземпляры LocalDB. Для организации общего доступа к экземпляру LocalDB пользователь должен указать его общее имя (псевдоним). Поскольку общее имя видно всем пользователям компьютера, то оно должно быть уникальным на этом компьютере. Общее имя экземпляра LocalDB имеет тот же формат, что и именованный экземпляр LocalDB.

Только администратор компьютера может создавать общие экземпляры LocalDB. Администратор или владелец общего экземпляра LocalDB может отменить общий доступ к экземпляру LocalDB. Предоставление и отмена общего доступа к экземпляру LocalDB выполняется с помощью методов `LocalDBShareInstance` и `LocalDBUnShareInstance` API LocalDB либо с помощью соответствующих параметров служебной программы `SqlLocalDb`.

## <a name="start-localdb-and-connect-to-localdb"></a>Запуск LocalDB и подключение к LocalDB

### <a name="connect-to-the-automatic-instance"></a>Подключение к автоматическому экземпляру

Самым простым способом использования LocalDB является подключение к автоматическому экземпляру, владельцем которого является текущий пользователь, с использованием строки подключения `Server=(localdb)\MSSQLLocalDB;Integrated Security=true`. Для подключения к определенной базе данных. используя имя файла, подключитесь с помощью строки подключения, аналогичной `Server=(LocalDB)\MSSQLLocalDB;Integrated Security=true;AttachDbFileName=D:\Data\MyDB1.mdf`.

Соглашение об именовании и строка подключения для формата LocalDB изменились в SQL Server 2014. Ранее именем экземпляра был один символ v, за которым следует LocalDB и номер версии. Начиная с SQL Server 2014, этот формат имени экземпляра больше не поддерживается. Вместо него следует использовать строку подключения, упомянутую ранее.  

>[!NOTE]
> - При первом подключении пользователя компьютера к LocalDB необходимо создать и запустить автоматический экземпляр. Дополнительное время, необходимое для создания экземпляра, может стать причиной того, что попытка соединения завершится с ошибкой истечения времени ожидания. В этом случае подождите несколько секунд до завершения процесса создания экземпляра, а затем подключитесь снова.


### <a name="create-and-connect-to-a-named-instance"></a>Создание именованного экземпляра и подключение к нему

Помимо автоматических экземпляров, LocalDB также поддерживает именованные экземпляры. Используйте программу SqlLocalDB.exe для создания, запуска и остановки именованного экземпляра LocalDB. Дополнительные сведения об SqlLocalDB.exe см. в разделе [Программа SqlLocalDB](../../tools/sqllocaldb-utility.md).

```console
REM Create an instance of LocalDB
"C:\Program Files\Microsoft SQL Server\130\Tools\Binn\SqlLocalDB.exe" create LocalDBApp1
REM Start the instance of LocalDB
"C:\Program Files\Microsoft SQL Server\130\Tools\Binn\SqlLocalDB.exe" start LocalDBApp1
REM Gather information about the instance of LocalDB
"C:\Program Files\Microsoft SQL Server\130\Tools\Binn\SqlLocalDB.exe" info LocalDBApp1
```

 Вышеуказанная последняя строка возвращает информацию, аналогичную следующей.

|Категория|Значение|
|-|-|
|Имя|`LocalDBApp1`|
|Версия|\<Current Version>|
|Общее имя|""|
|Владелец|"\<Your Windows User>"|
|Автоматическое создание|Нет|
|Состояние|запуск|
|Время последнего запуска|\<Date and Time>|
|Имя канала экземпляра|np:\\\\.\pipe\LOCALDB#F365A78E\tsql\query|

>[!NOTE]
>Если приложение использует версию .NET, предшествующую 4.0.2, необходимо устанавливать подключение непосредственно с именованным каналом LocalDB. Значение "Имя канала экземпляра" — это именованный канал, который прослушивает экземпляр LocalDB. Часть имени канала экземпляра, следующая после LOCALDB#, будет изменяться при каждом запуске экземпляра LocalDB. Для подключения к экземпляру LocalDB с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] введите имя канала экземпляра в поле **Имя сервера** диалогового окна **Соединение с [!INCLUDE[ssDE](../../includes/ssde-md.md)]** . Можно установить соединение с экземпляром LocalDB из пользовательской программы с использованием строки подключения, аналогичной `SqlConnection conn = new SqlConnection(@"Server=np:\\.\pipe\LOCALDB#F365A78E\tsql\query");`.

### <a name="connect-to-a-shared-instance-of-localdb"></a>Подключение к общему экземпляру LocalDB

Чтобы подключиться к общему экземпляру LocalDB, добавьте в строку подключения сочетание `\.\` (обратная косая черта + точка + обратная косая черта) для указания пространства имен, зарезервированного для общих экземпляров. Например, чтобы подключиться к общему экземпляру LocalDB с именем `AppData`, укажите `(localdb)\.\AppData` в строке подключения. У пользователя, подключающегося к общему экземпляру LocalDB, который ему не принадлежит, должны быть учетные данные для проверки подлинности Windows или [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].

## <a name="troubleshooting"></a>Устранение неполадок

Способы устранения неполадок в работе LocalDB см. в статье [Troubleshoot SQL Server 2012 Express LocalDB](https://social.technet.microsoft.com/wiki/contents/articles/4609.aspx) (Устранение неполадок в работе SQL Server 2012 Express LocalDB).

## <a name="permissions"></a>Разрешения

SQL Server Express LocalDB — это экземпляр, созданный пользователем для самостоятельного использования. Любой пользователь компьютера может создать базу данных с помощью экземпляра LocalDB, сохранив файлы в своем пользовательском профиле и запустив процесс со своими учетными данными. По умолчанию доступ к экземпляру LocalDB имеет только его владелец. Данные, содержащиеся в LocalDB, защищены средствами файловой системы. Если файлы пользовательской базы данных хранятся в общей папке, то базу данных может открыть любой пользователь, имеющий доступ к этой папке, с помощью собственного экземпляра LocalDB. Если файлы базы данных хранятся в защищенном месте, например в папке пользовательских данных, то базу данных может открыть только сам пользователь, а также администратор, обладающий правами доступа к данной папке. Файлы LocalDB могут быть одновременно открыты только одним экземпляром LocalDB.

>[!NOTE]
>LocalDB всегда запускается в контексте безопасности пользователя. Это означает, что LocalDB никогда не будет запускаться с учетными данными группы локальных администраторов. То есть доступ ко всем файлам базы данных, используемыми экземпляром LocalDB, возможен по учетной записи их владельца-пользователя Windows, не учитывая принадлежности к группе локальных администраторов.

## <a name="see-also"></a>См. также:

[Программа SqlLocalDB](../../tools/sqllocaldb-utility.md)