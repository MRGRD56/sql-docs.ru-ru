---
title: Добавление реплики в группу доступности (SSMS)
description: Добавьте реплику в группу доступности Always On с помощью мастера в SQL Server Management Studio.
ms.custom: seo-lt-2019
ms.date: 05/17/2016
ms.prod: sql
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
f1_keywords:
- sql13.swb.addreplicawizard.f1
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], wizards
ms.assetid: 60d962b6-2af4-4394-9190-61939a102bc0
author: cawrites
ms.author: chadam
ms.openlocfilehash: 99cfe654cf9540d2b031353f0487d783045dd0c9
ms.sourcegitcommit: 54cd97a33f417432aa26b948b3fc4b71a5e9162b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2020
ms.locfileid: "94583676"
---
# <a name="add-a-replica-to-your-always-on-availability-group-using-the-availability-group-wizard-in-sql-server-management"></a>Добавление реплики в группу доступности Always On с помощью мастера создания групп доступности в SQL Server Management Studio
[!INCLUDE [SQL Server](../../../includes/applies-to-version/sqlserver.md)]
  Используйте **мастер добавления реплики в группу доступности** для того, чтобы добавить новую вторичную реплику в существующую группу доступности AlwaysOn.  
  
> [!NOTE]  
>  Дополнительные сведения о добавлении вторичной реплики в группу доступности с помощью [!INCLUDE[tsql](../../../includes/tsql-md.md)] или PowerShell см. в статье [Добавление вторичной реплики к группе доступности (SQL Server)](../../../database-engine/availability-groups/windows/add-a-secondary-replica-to-an-availability-group-sql-server.md).  
    
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> Перед началом  
 Если вам еще не приходилось добавлять реплики доступности в группу доступности, см. подразделы "Экземпляры сервера" и "Группы доступности и реплики" в разделе [Предварительные требования, ограничения и рекомендации для групп доступности AlwaysOn (SQL Server)](../../../database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability.md).  
  
##  <a name="prerequisites"></a><a name="Prerequisites"></a> Предварительные требования  
  
-   Необходимо подключиться к экземпляру сервера, на котором размещена текущая первичная реплика.  
  
-   Для добавления вторичной реплики экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], на котором размещаются реплики доступности, должен находиться в том же отказоустойчивом кластере Windows Server (WSFC), что и существующие реплики, но в другом узле кластера. Кроме того, убедитесь, что этот экземпляр сервера соответствует всем другим обязательным условиям [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] . Дополнительные сведения см. в разделе [Предварительные требования, ограничения и рекомендации для групп доступности AlwaysOn (SQL Server)](../../../database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability.md).  
  
-   Если экземпляр сервера, который выбран для размещения реплики доступности, запускается из-под учетной записи службы домена и не содержит конечной точки зеркального отображения базы данных, то мастер может создать конечную точку и предоставить учетной записи службы экземпляра сервера разрешение CONNECT. Но если служба [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] запущена от имени встроенной учетной записи, такой как «Локальная система», «Локальная служба» или «Сетевая служба», или от имени учетной записи, не входящей в домен, то для проверки подлинности конечных точек необходимо пользоваться сертификатами, а мастер не сможет создать точку зеркального отображения базы данных на этом экземпляре сервера. В этом случае перед запуском мастера добавления реплики в группу доступности рекомендуется создать конечные точки зеркального отображения базы данных вручную.  
  
     **Использование сертификатов для конечной точки зеркального отображения базы данных**  
  
     [CREATE ENDPOINT (Transact-SQL)](../../../t-sql/statements/create-endpoint-transact-sql.md)  
  
     [Использование сертификатов для конечной точки зеркального отображения базы данных (Transact-SQL)](../../../database-engine/database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)  
  
-   **Предварительные условия для использования полной начальной синхронизации данных**  
  
    -   Все пути к файлам базы данных должны быть одинаковыми на всех экземплярах сервера, на которых размещены реплики группы доступности.  
  
    -   На экземпляре сервера, содержащем вторичную реплику, не может существовать имя базы данных-источника. Это означает, что еще не может существовать ни одна из новых баз данных-получателей.  
  
    -   Чтобы при помощи мастера можно было создавать резервные копии и обращаться к ним, необходимо будет указать общую сетевую папку. Для каждой первичной реплики учетная запись, используемая для запуска [!INCLUDE[ssDE](../../../includes/ssde-md.md)] , должна иметь разрешения в файловой системе на чтение и запись в общей сетевой папке. Для вторичных реплик учетная запись должна иметь разрешение на чтение в сетевой папке.  
  
     Если нет возможности воспользоваться мастером для выполнения полной первоначальной синхронизации данных, то базы данных-получатели нужно подготовить вручную. Это можно сделать до или после запуска мастера. Дополнительные сведения см. в статье [Ручная подготовка базы данных-получателя для присоединения к группе доступности (SQL Server)](../../../database-engine/availability-groups/windows/manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md).  
   
## <a name="permissions"></a><a name="Permissions"></a> Permissions  
 Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER.  
  
 Кроме того, требуется разрешение CONTROL ON ENDPOINT, если мастер добавления реплики в группу доступности должен иметь возможность управлять конечной точкой зеркального отображения базы данных.  
  
##  <a name="using-the-add-replica-to-availability-group-wizard-sql-server-management-studio"></a><a name="SSMSProcedure"></a> Использование мастера добавления реплики в группу доступности (среда SQL Server Management Studio)  
 **Использование мастера добавления реплики в группу доступности**  
  
1.  В обозревателе объектов подключитесь к экземпляру сервера, на котором размещена первичная реплика группы доступности, и разверните дерево сервера.  
  
2.  Разверните узел **Высокий уровень доступности AlwaysOn** и узел **Группы доступности** .  
  
3.  Щелкните правой кнопкой мыши группу доступности, куда добавляется вторичная реплика, а затем выберите команду **Добавить реплику** . Будет запущен мастер добавления реплики в группу доступности.  
  
4.  На странице **Подключение к существующим вторичным репликам** установите соединение со всеми вторичными репликами в группе доступности. Дополнительные сведения см. в статье [Подключение к странице существующих вторичных реплик (мастер добавления реплики: мастер добавления баз данных)](../../../database-engine/availability-groups/windows/connect-to-existing-secondary-replicas-page.md).  
  
5.  На странице **Выбор реплик** укажите и настройте одну или несколько новых вторичных реплик для группы доступности. На этой странице имеется три вкладки. Эти вкладки представлены в следующей таблице. Дополнительные сведения см. в статье [Страница "Указание реплик" (мастер создания группы доступности: мастер добавления реплики)](../../../database-engine/availability-groups/windows/specify-replicas-page-new-availability-group-wizard-add-replica-wizard.md).  
  
    |Вкладка|Краткое описание|  
    |---------|-----------------------|  
    |**Реплики**|На этой вкладке можно задать все экземпляры [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , где будет размещена новая вторичная реплика.|  
    |**Конечные точки**|Эта вкладка служит для проверки существующей конечной точки зеркального отображения базы данных, если таковые имеются, для каждой новой вторичной реплики. Если эта конечная точка отсутствует на экземпляре сервера, служба которого использует проверку подлинности Windows, то мастер попытается создать конечную точку автоматически.<br /><br /> <br /><br /> Примечание. Если какой-либо экземпляр сервера работает под учетной записью пользователя домена, необходимо вручную переключиться на свой экземпляр сервера, прежде чем перейти на следующий шаг в мастере. Дополнительные сведения см. в подразделе [Предварительные условия](#Prerequisites)ранее в этом разделе.|  
    |**Параметры резервного копирования**|Эта вкладка служит для задания настроек резервного копирования для группы доступности в целом (если нужно изменить текущие параметры), а также для задания приоритетов резервного копирования для отдельных реплик доступности.|  
  
6.  Если выбранные реплики содержат базы данных с главным ключом, вводите пароли для этих ключей в столбце **Пароль**. В столбце **Состояние** отображается состояние **Требуется пароль** для баз данных с главным ключом. Кнопка **Далее** будет неактивна, пока вы не укажете верный пароль в столбце **Пароль**. После ввода паролей нажмите кнопку **Обновить**. Если пароли введены правильно, в столбце "Состояние" будет указано **Пароль введен**, а кнопка **Далее** станет активной.  
  
7.  На странице **Выбор начальной синхронизации данных** выберите, как именно необходимо создать новые базы данных-получатели и присоединить их к группе доступности. Выберите один из следующих параметров.  
  
    -   **Полное**  
  
         Выберите этот режим, если ваша среда удовлетворяет требованиям для автоматического запуска начальной синхронизации данных (дополнительные сведения см. в подразделе [Предварительные условия, ограничения и рекомендации](#Prerequisites)ранее в этом разделе).  
  
         Если выбран режим **Полная**, то после создания группы доступности мастер выполнит резервное копирование всех баз данных-источников и их журналов транзакций в сетевую папку и восстановит резервные копии на всех экземплярах серверов, на которых размещена новая вторичная реплика. После этого мастер выполнит присоединение всех новых баз данных-получателей к группе доступности.  
  
         В поле **Выберите сетевую папку, доступную для всех реплик:** укажите общую папку резервной копии, к которой имеют доступ на чтение и запись все экземпляры серверов, на которых размещаются реплики. Резервные копии журналов будут входить в цепочку резервных копий журналов. Храните файлы резервных копий журналов надлежащим образом.  
  
        > [!IMPORTANT]  
        >  Дополнительные сведения о требуемых разрешениях файловой системы см. в подразделе [Предварительные требования](#Prerequisites)выше в этом разделе.  
  
    -   **Только присоединение**  
  
         Если базы данных-получатели на экземплярах серверов, где будут размещены новые вторичные реплики, были подготовлены вручную, то можно выбрать этот режим. Мастер выполнит присоединение этих новых баз данных-получателей к группе доступности.  
  
    -   **Пропустить начальную синхронизацию данных**  
  
         Выберите этот параметр, если вы хотите использовать собственные резервные копии баз данных-источников и их журналов. Дополнительные сведения см. в статье [Запуск перемещения данных для базы данных-получателя AlwaysOn (SQL Server)](../../../database-engine/availability-groups/windows/start-data-movement-on-an-always-on-secondary-database-sql-server.md).  
  
8.  На странице **Проверка** производится проверка, удовлетворяют ли значения, заданные в мастере, требованиям мастера добавления реплики в группу доступности. Чтобы внести изменения, нажмите кнопку **Назад** , вернитесь к предыдущей странице мастера и измените одно или несколько значений. Нажмите кнопку **Далее** , чтобы вернуться на страницу **Проверка** , а затем кнопку **Повторить проверку**.  
  
9. На странице **Сводка** проверьте параметры, выбранные для новой группы доступности. Чтобы внести изменения, щелкните **Назад** , чтобы вернуться на нужную страницу. После внесения изменений нажмите кнопку **Далее** , чтобы вернуться на страницу **Сводка** .  
  
     Если вы удовлетворены заданными значениями, можно нажать кнопку «Скрипт», чтобы создать скрипт с действиями, которые будет выполнять мастер. Теперь нажмите кнопку **Готово**, чтобы создать и настроить новую группу доступности.  
  
10. На странице **Выполнение установки** отображается ход выполнения этапов создания группы доступности (настройка конечных точек, создание группы доступности и присоединение к группе вторичной реплики).  
  
11. После завершения выполнения этих шагов на странице **Результаты** отображаются результаты выполнения каждого шага. Если эти шаги завершатся успешно, новая группа доступности будет полностью настроена. Если один из шагов завершится ошибкой, то, возможно, настройку необходимо будет завершить вручную. Сведения о причинах данной ошибки можно отобразить, перейдя по соответствующей ссылке «Ошибка» в столбце **Результат** .  
  
     По завершении работы мастера нажмите кнопку **Закрыть** , чтобы выйти из него.  
  
> [!IMPORTANT]  
>  После добавления реплики см. раздел "Дальнейшие действия. После добавления реплики" в статье [Добавление вторичной реплики в группу доступности (SQL Server)](../../../database-engine/availability-groups/windows/add-a-secondary-replica-to-an-availability-group-sql-server.md).  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> Связанные задачи  
  
-   [Добавление вторичной реплики к группе доступности (SQL Server)](../../../database-engine/availability-groups/windows/add-a-secondary-replica-to-an-availability-group-sql-server.md)  
  
## <a name="see-also"></a>См. также:  
 [Обзор групп доступности AlwaysOn (SQL Server)](../../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md)   
 [Предварительные требования, ограничения и рекомендации для групп доступности AlwaysOn (SQL Server)](../../../database-engine/availability-groups/windows/prereqs-restrictions-recommendations-always-on-availability.md)   
 [Добавление вторичной реплики к группе доступности (SQL Server)](../../../database-engine/availability-groups/windows/add-a-secondary-replica-to-an-availability-group-sql-server.md)  
  
  
