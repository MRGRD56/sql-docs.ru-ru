---
title: Руководство по миграции из Access в SQL Server
description: 'Из этого руководства вы узнаете, как перенести базы данных Microsoft Access в Microsoft SQL Server с использованием Помощника по миграции SQL Server для Access (SSMA для Access). '
ms.prod: sql
ms.reviewer: ''
ms.technology: migration-guide
ms.custom: ''
ms.devlang: ''
ms.topic: how-to
author: MashaMSFT
ms.author: mathoma
ms.date: 03/19/2021
ms.openlocfilehash: 723fb62f82f61d92aa5dba07dc1af7dd245f20c0
ms.sourcegitcommit: 17f05be5c08cf9a503a72b739da5ad8be15baea5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "105103791"
---
# <a name="migration-guide-access-to-sql-server"></a>Руководство по миграции. Перенос баз данных Access в SQL Server
[!INCLUDE[sqlserver](../../../includes/applies-to-version/sqlserver.md)]

Из этого руководства по миграции вы узнаете, как перенести базы данных Microsoft Access в Microsoft SQL Server с использованием Помощника по миграции SQL Server для Access (SSMA для Access). 

Другие руководства по миграции см. в разделе [Перенос базы данных](https://datamigration.microsoft.com/). 

## <a name="prerequisites"></a>Предварительные требования 

Чтобы перенести базу данных Access в SQL Server, необходимо:

- проверить, поддерживается ли исходная среда; 
- установить [Помощник по миграции SQL Server для Access](https://www.microsoft.com/download/details.aspx?id=54255). 
- иметь возможность подключения и требуемые разрешения для доступа к исходному и целевому объекту. 


## <a name="pre-migration"></a>Подготовка к миграции 


После выполнения необходимых условий можно приступать к поиску топологии среды и оценить возможность миграции.


### <a name="assess"></a>Оценка

Используйте Помощник по миграции SQL Server для Access, чтобы просмотреть объекты и данные баз данных, а также оценить возможности переноса баз данных. Дополнительные сведения об этом средстве см. в статье [Помощник по миграции SQL Server для Access](/sql/ssma/access/sql-server-migration-assistant-for-access-accesstosql). 

Чтобы создать оценку, выполните следующие действия.

1. Откройте [Помощник по миграции SQL Server для Access](https://www.microsoft.com/download/details.aspx?id=54255). 
1. Выберите **Файл**, а затем пункт **Новый проект**. 
1. Укажите имя проекта, расположение для сохранения проекта, а затем выберите из раскрывающегося списка целевой объект миграции SQL Server. Нажмите кнопку **ОК**.

   ![Создать проект](./media/access-to-sql-server/new-project.png)

1. Щелкните **Add Databases** (Добавить базы данных) и выберите базы данных для добавления в проект.

   ![Добавить базы данных](./media/access-to-sql-server/add-databases.png)

1. В **обозревателе метаданных Access** щелкните правой кнопкой мыши базу данных, которую необходимо оценить, и выберите команду **Создать отчет**. Вместо этого можно нажать кнопку **Create report** (Создать отчет) на панели навигации после выбора схемы.

   ![Создавать отчет](./media/access-to-sql-server/create-report.png)

1. Ознакомьтесь с HTML-отчетом, чтобы получить сведения о статистике преобразований и любых ошибках или предупреждениях. Также можно открыть отчет в Excel, чтобы получить список объектов Access и действий, необходимых для выполнения преобразований схемы. Расположение отчета по умолчанию находится в папке "report" в каталоге SSMAProjects.

   Например: `drive:\<username>\Documents\SSMAProjects\MyAccessMigration\report\report_2020_11_12T02_47_55\`

   ![Пример отчета](./media/access-to-sql-server/sample-report.png)

### <a name="validate-data-types"></a>Обновление типов данных

Проверьте сопоставления типов данных по умолчанию и измените их в зависимости от требований, если это необходимо. Для этого выполните следующие действия. 

1. В главном меню выберите **Сервис**. 
1. Выберите **Параметры проекта**. 
1. Перейдите на вкладку **Type mappings** (Сопоставления типов).

   ![Сопоставление типов](./media/access-to-sql-server/type-mappings.png)

1. Сопоставление типов для каждой таблицы можно изменить, выбрав таблицу в **обозревателе метаданных Oracle**. 


### <a name="convert"></a>Convert 

Для преобразования объектов баз данных выполните указанные ниже действия. 

1. Выберите **Connect to SQL Server** (Подключиться к SQL Server) и укажите сведения о подключении.

   ![Подключение к SQL Server](./media/access-to-sql-server/connect-to-sql-server.png)

1. Щелкните правой кнопкой мыши базу данных в **обозревателе метаданных Access** и выберите команду **Преобразовать схему**. Вместо этого можно выбрать элемент **Convert schema** (Преобразовать схему) на верхней панели навигации после выбора базы данных.

   ![Преобразование схемы](./media/access-to-sql-server/convert-schema.png)

1. После завершения преобразования сравните преобразованные объекты с исходными, чтобы определить возможные проблемы и устранить их в соответствии с рекомендациями.

   ![Сравнение преобразованных запросов ](./media/access-to-sql-server/query-comparison.png)

   Сравните преобразованный текст Transact-SQL с исходным кодом и просмотрите рекомендации:

   ![Проверка преобразованных объектов](./media/access-to-sql-server/table-comparison.png)

1. (Необязательно) Чтобы преобразовать отдельный объект, щелкните его правой кнопкой мыши и выберите команду **Преобразовать схему**. Преобразованный объект выделяется в **обозревателе метаданных Access** полужирным шрифтом: 

   ![Объекты, выделенные жирным шрифтом в обозревателе метаданных, преобразованы](./media/access-to-sql-server/converted-items-bold.png)
 
1. В области вывода выберите элемент **Просмотр результатов** и проверьте ошибки в области **Список ошибок**. 
1. Сохраните проект локально для исправления схемы в автономном режиме. В меню **Файл** выберите команду **Сохранить проект**. Таким образом можно оценить исходную и целевую схемы в автономном режиме и исправить проблемы перед публикацией схемы в SQL Server.


## <a name="migrate"></a>Миграция

После того как вы завершите оценку баз данных и устраните несоответствия, следующим шагом является выполнение процесса миграции. Перенос данных — это операция массовой загрузки, которая перемещает строки данных в SQL Server транзакциями. Число строк, загружаемых в SQL Server в рамках каждой транзакции, настраивается в параметрах проекта.

Чтобы опубликовать схему и перенести данные с помощью SSMA для Access, выполните следующие действия: 

1. Если вы этого еще не сделали, выберите элемент **Подключение к SQL Server** и укажите сведения о подключении. 

1. Опубликуйте схему. Для этого щелкните правой кнопкой мыши базу данных в разделе **SQL Server Metadata Explorer** (Обозреватель метаданных SQL Server) и выберите пункт **Synchronize with Database** (Синхронизировать с базой данных). В результате схема MySQL будет опубликована в SQL Server.

   ![Синхронизация с базой данных](./media/access-to-sql-server/synchronize-with-database.png)

   Проверьте результаты сопоставления исходного и целевого проектов.

   ![Проверка синхронизации с базой данных](./media/access-to-sql-server/synchronize-with-database-review.png)

1. Перенесите данные. Для этого щелкните правой кнопкой мыши базу данных или объект, которые требуется перенести, в разделе **Access Metadata Explorer** (Обозреватель метаданных Access) и выберите пункт **Migrate data** (Перенести данные). Кроме того, команду **Перенос данных** можно выбрать на верхней панели навигации. Чтобы перенести данные всей базы данных, установите флажок рядом с ее именем. Чтобы перенести данные из отдельной таблицы, разверните базу данных, разверните узел "Таблицы" и установите флажок рядом с таблицей. Чтобы не переносить данные из определенной таблицы, снимите флажок.

   ![Перенос данных](./media/access-to-sql-server/migrate-data.png)

1. После завершения миграции просмотрите **отчет о переносе данных**:  

   ![Проверка перенесенных данных](./media/access-to-sql-server/migrate-data-review.png)

1. Подключитесь к экземпляру SQL Server с помощью [SQL Server Management Studio](/sql/ssms/download-sql-server-management-studio-ssms) и проверьте результаты миграции, просмотрев данные и схему. 

   ![Проверка в SSMA](./media/access-to-sql-server/validate-in-ssms.png)



## <a name="post-migration"></a>После миграции 

После успешного завершения этапа **миграции** необходимо выполнить ряд задач, чтобы обеспечить бесперебойную и эффективную работу всех компонентов.

### <a name="remediate-applications"></a>Исправление приложений

После переноса данных в целевую среду все приложения, которые раньше использовали источник, должны приступить к приему целевого объекта. Для этого в некоторых случаях потребуется внести изменения в приложения.

### <a name="perform-tests"></a>Выполнение тестов

Тестирование переноса базы данных включает указанные ниже действия.

1. **Разработка проверочных тестов**. Чтобы протестировать перенос базы данных, необходимо использовать SQL-запросы. Необходимо создать запросы проверки, которые будут выполняться как в исходной, так и в целевой базах данных. Запросы на проверку должны охватывать определенную область.

2. **Настройка тестовой среды**. Тестовая среда должна содержать копию исходной и целевой баз данных. Не забудьте изолировать тестовую среду.

3. **Выполнение проверочных тестов**. Выполните проверочные тесты для источника и целевого объекта, а затем проанализируйте результаты.

4. **Выполнение тестов производительности**. Запустите тест производительности для источника и целевого объекта, а затем проанализируйте и сравните результаты.


### <a name="optimize"></a>Оптимизация

Проверка после миграции — очень важный шаг, позволяющий добиться точности и полноты данных, а также выявить проблемы с производительностью рабочей нагрузки.

> [!Note]
> Дополнительные сведения об этих проблемах и мерах по их устранению см. в [руководстве по проверке и оптимизации после миграции](../../../relational-databases/post-migration-validation-and-optimization-guide.md).

## <a name="migration-assets"></a>Ресурсы, посвященные миграции 

Дополнительные сведения о выполнении сценария миграции см. на следующих ресурсах, которые были разработаны с учетом поддержки реального проекта миграции.

| **Название со ссылкой** | **Описание** |
| -------------- | --------------- |
| [Модель и средство оценки рабочей нагрузки данных](https://github.com/Microsoft/DataMigrationTeam/tree/master/Data%20Workload%20Assessment%20Model%20and%20Tool) | Это средство предоставляет предлагаемые "оптимальные" целевые платформы, готовность к переходу в облако и уровень исправления приложения/базы данных для конкретной рабочей нагрузки. Оно обеспечивает простое и быстрое вычисление и создание отчетов, которое помогает ускорить оценку больших объемов, предоставляя, автоматизируя и унифицируя процесс принятия решения относительно целевой платформы. |

Эти ресурсы были разработаны в рамках программы Data SQL Ninja, которая спонсируется группой разработчиков Azure Data Group. Основная часть программы Data SQL Ninja заключается в разрешении и ускорении сложной модернизации и реализация перехода на платформу данных Microsoft Azure. Если вы считаете, что ваша организация заинтересована в участии в программе Data SQL Ninja, обратитесь в службу поддержки своей учетной записи и попросите отправить заявку.

## <a name="next-steps"></a>Дальнейшие действия

После миграции ознакомьтесь с [руководством по проверке и оптимизации после миграции](/sql/relational-databases/post-migration-validation-and-optimization-guide). 

Матрица Майкрософт, а также сторонние службы и средства, доступные для помощи в различных сценариях перемещения баз данных и данных, а также специальных задачах см. в разделе [Службы и инструменты для переноса данных](/azure/dms/dms-tools-matrix).

Другие руководства по миграции см. в разделе [Перенос базы данных](https://datamigration.microsoft.com/). 

Видеоматериалы см. в следующих статьях:
- [Обзор процесса миграции](https://azure.microsoft.com/resources/videos/overview-of-migration-and-recommended-tools-services/)
