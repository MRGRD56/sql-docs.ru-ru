---
description: Метод Execute (служба удаленных рабочих столов)
title: Метод Execute (RDS) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: reference
apitype: COM
helpviewer_keywords:
- Execute method [ADO]
ms.assetid: 2d9c30e9-ab5b-4920-91b8-48454c2fb5d8
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e5ad157ffccc07ba0b64064122f7f0e55ccd422
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99163812"
---
# <a name="execute-method-rds"></a>Метод Execute (служба удаленных рабочих столов)
Выполняет запрос и создает набор записей ADO для использования в ADO 2,5 и более поздних версиях.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, компоненты RDS больше не включены в операционную систему Windows (Дополнительные сведения см. в статье о совместимости Windows 8 и [Windows server 2012 Cookbook](https://www.microsoft.com/download/details.aspx?id=27416) ). Клиентские компоненты RDS будут удалены в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие RDS, должны переноситься в [службу данных WCF](/dotnet/framework/wcf/).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Execute(ConnectionString As String, HandlerString As String, QueryString As String, lFetchOptions As Long, Properties, TableId, lExecuteOptions As Long, pParameters, [lcid As Long], [pInformation])  
```  
  
#### <a name="parameters"></a>Параметры  
 *ConnectionString*  
 Строка, используемая для подключения к поставщику OLE DB, в котором запрос будет отправлен для выполнения. Если обработчик указан с помощью *хандлерстринг* , он может изменить или заменить строку подключения.  
  
 *хандлерстринг*  
 Строка из двух частей, определяющая обработчик, который будет использоваться с этим выполнением. Строка содержит две части. Первая часть содержит имя (ProgID) используемого обработчика. Вторая часть содержит аргументы, передаваемые в обработчик. Сведения о том, как интерпретируется строка аргументов, относятся к каждому обработчику. Две части разделяются первым экземпляром запятой в строке. Строка arguments может содержать дополнительные запятые. Аргументы являются необязательными.  
  
 *Строку*  
 Команда на языке команд, поддерживаемая поставщиком OLE DB, указанным в строке подключения. Для поставщиков на основе SQL *строка запроса* может содержать инструкцию TRANSACT-SQL, но для поставщиков, отличных от SQL (например, мсдаташапе), это может быть не [!INCLUDE[tsql](../../../includes/tsql-md.md)] Инструкция запроса.  
  
 Если используется обработчик, обработчик может изменить или заменить указанное здесь значение. Например, обработчик обычно заменяет *QueryString* строкой запроса из ini-файла. По умолчанию используется файл Msdfmap.ini.  
  
 *лфетчоптионс*  
 Указывает тип асинхронной выборки.  
  
 Дополнительные сведения см. в разделе [свойство FetchOptions (RDS)](./fetchoptions-property-rds.md).  
  
 *TableID*  
 **Вариант** типа либо VT_EMPTY, либо VT_BSTR. Если это значение имеет тип VT_EMPTY, оно игнорируется. Если он имеет тип VT_BSTR, набор записей создается с помощью **адкмдтабледирект** , а значение, указанное здесь, и параметр *QueryString* игнорируется.  
  
 *лексекутеоптионс*  
 Битовая маска параметров выполнения:  
  
 1 =*только для чтения* , набор записей будет открыт с помощью **адлоккреадонли**.  
  
 2 =*Непакетированный* набор записей будет открыт с помощью **adLockOptimistic**.  
  
 4 =*аллпараминфосупплиед* . вызывающий объект гарантирует, что сведения о параметрах для всех параметров передаются в *ппараметерс*.  
  
 8 =*сведения о* параметрах для запроса будут получены от поставщика OLE DB и возвращены в параметре *ппараметерс* . Запрос не выполняется, и набор записей не возвращается.  
  
 16 =*жесидденколумнс* набор записей будет открыт с помощью **адлоккбатчоптимистик** , а все скрытые столбцы будут включаться в набор записей.  
  
 *ReadOnly*, *unbatch* и *жесидденколумнс* являются взаимоисключающими параметрами; Однако он не создает ошибку для установки более чем одного из них. Если задано несколько параметров, *жесидденколумнс* имеет приоритет над всеми остальными, за которым следует *только ReadOnly*. Если параметры не указаны, по умолчанию набор записей открывается с помощью **адлоккбатчоптимистик** , а скрытые столбцы не включаются в набор записей.  
  
 *ппараметерс*  
 **Значение типа Variant** , содержащее надежный массив определений параметров. Если параметр " *info* " был указан в *лексекутеоптионс*, этот параметр используется для возврата определений параметров, полученных от поставщика OLE DB. В противном случае этот параметр может быть пустым.  
  
 *lcid*  
 КОД языка, используемый для создания любых ошибок, возвращаемых в *пинформатион*.  
  
 *пинформатион*  
 Указатель на информационную ошибку, возвращенную инструкцией EXECUTE. Если значение равно NULL, сведения об ошибке не возвращаются.  
  
## <a name="remarks"></a>Замечания  
 Параметр *хандлерстринг* может иметь значение null. Что происходит в этом случае, зависит от настройки сервера RDS. Строка обработчика "МСДФМАП. Handler" указывает, что следует использовать предоставляемый корпорацией Майкрософт обработчик (Msdfmap.dll). Строка обработчика "МАСДФМАП. Handler sample.ini" указывает, что следует использовать обработчик Msdfmap.dll и что аргумент "sample.ini" должен передаваться в обработчик. MSDFMAP.dll будет интерпретировать аргумент как направление использования sample.ini для проверки соединения и строк запроса.  
  
## <a name="applies-to"></a>Применение  
 [Объект DataFactory (RDSServer)](./datafactory-object-rdsserver.md)