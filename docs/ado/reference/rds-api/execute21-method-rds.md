---
description: Метод Execute21 (служба удаленных рабочих столов)
title: Метод Execute21 (RDS) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: reference
apitype: COM
helpviewer_keywords:
- Execute21 method [RDS]
ms.assetid: 9f131c8d-1497-416d-8209-abb481c38f7b
author: rothja
ms.author: jroth
ms.openlocfilehash: 8bd48d561f9b21997df0f7a77a993f95900e8cdb
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100053225"
---
# <a name="execute21-method-rds"></a>Метод Execute21 (служба удаленных рабочих столов)
Выполняет запрос и создает набор записей ADO для использования в ADO 2,1.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, компоненты RDS больше не включены в операционную систему Windows (Дополнительные сведения см. в статье о совместимости Windows 8 и [Windows server 2012 Cookbook](https://www.microsoft.com/download/details.aspx?id=27416) ). Клиентские компоненты RDS будут удалены в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие RDS, должны переноситься в [службу данных WCF](/dotnet/framework/wcf/).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Execute21(ConnectionString As String, HandlerString As String, QueryString As String, lMarshalOptions As Long, Properties, TableId, lExecuteOptions As Long, pParameters)  
```  
  
#### <a name="parameters"></a>Параметры  
 *ConnectionString*  
 Строка, используемая для подключения к поставщику OLE DB, в котором запрос будет отправлен для выполнения. Если обработчик указан с помощью *хандлерстринг*, он может изменить или заменить строку подключения.  
  
 *хандлерстринг*  
 Строка определяет обработчик, который будет использоваться с этим выполнением. Строка содержит две части. Первая часть содержит имя (ProgID) используемого обработчика. Вторая часть строки содержит аргументы, передаваемые в обработчик. Как интерпретируется строка аргументов, зависит от обработчика. Две части разделяются первым экземпляром запятой в строке (хотя строка arguments может содержать дополнительные запятые). Аргументы являются необязательными.  
  
 *Строку*  
 Команда на языке команд, поддерживаемая поставщиком OLE DB, указанным в строке подключения. Для поставщиков на основе SQL он может содержать [!INCLUDE[tsql](../../../includes/tsql-md.md)] инструкцию Command, но для поставщиков, отличных от SQL (например, мсдаташапе), это может быть не [!INCLUDE[tsql](../../../includes/tsql-md.md)] Инструкция запроса.  
  
 Кроме того, если используется обработчик (и настоятельно рекомендуется использовать обработчик), обработчик может изменить или заменить указанное здесь значение. Например, обработчик обычно заменяет *QueryString* строкой запроса из ini-файла. По умолчанию используется файл Msdfmap.ini.  
  
 *лмаршалоптионс*  
 Используется для задания параметров маршалирования для возвращаемого набора строк или набора записей.  
  
 *TableID*  
 Вариант типа либо VT_EMPTY, либо VT_BSTR. Если это значение имеет тип VT_EMPTY, оно игнорируется. Если он имеет тип VT_BSTR, набор записей создается с помощью **адкмдтабледирект** с использованием значения, указанного здесь, а параметр *QueryString* игнорируется.  
  
 *лексекутеоптионс*  
 Битовая маска параметров выполнения:  
  
 1 =*только для чтения* , набор записей будет открыт с помощью **адлоккреадонли**.  
  
 2 =*Непакетированный* набор записей будет открыт с помощью **adLockOptimistic**.  
  
 4 =*аллпараминфосупплиед* . вызывающий объект гарантирует, что сведения о параметрах для всех параметров передаются в *ппараметерс*.  
  
 8 =*сведения о* параметрах для запроса будут получены от поставщика OLE DB и возвращены в параметре *ппараметерс* . Запрос не выполняется, и набор записей не возвращается.  
  
 16 = Жесидденколумнс набор записей будет открыт с помощью **адлоккбатчоптимистик** , а все скрытые столбцы будут включаться в набор записей.  
  
 Несмотря на то что *ReadOnly*, *unbatch* и *жесидденколумнс* являются взаимоисключающими параметрами, не является ошибкой устанавливать более одного из них. Если задано несколько параметров, *жесидденколумнс* имеет приоритет над всеми другими параметрами, за которыми следует *только ReadOnly*. Если параметры не указаны, по умолчанию набор записей открывается с помощью **адлоккбатчоптимистик** , но скрытые столбцы не включаются в набор записей.  
  
 *ппараметерс*  
 Значение типа Variant, содержащее надежный массив определений параметров. Если параметр " *info* " был указан в *лексекутеоптионс*, этот параметр используется для возврата определений параметров, полученных от поставщика OLE DB. В противном случае этот параметр может быть пустым.  
  
## <a name="remarks"></a>Remarks  
 Параметр *хандлерстринг* может иметь значение null. Что происходит в этом случае, зависит от настройки сервера RDS. Строка обработчика "МСДФМАП. Handler" указывает, что следует использовать предоставляемый корпорацией Майкрософт обработчик (Msdfmap.dll). Строка обработчика "МАСДФМАП. Handler sample.ini" указывает, что следует использовать обработчик Msdfmap.dll и что аргумент "sample.ini" должен передаваться в обработчик. MSDFMAP.dll будет интерпретировать аргумент как направление использования sample.ini для проверки соединения и строк запроса.  
  
> [!NOTE]
>  Метод **Execute21** является версией [метода Execute (RDS)](./execute-method-rds.md). Когда необходимо использовать метод **EXECUTE** для взаимодействия с ADO 2,1, вместо него можно вызвать метод **Execute21** . Возможности метода **EXECUTE** в ADO 2,5 и более поздних версий представляют собой надмножество возможностей, предоставляемых для того же метода в ADO 2,1.  
  
## <a name="applies-to"></a>Применение  
 [Объект DataFactory (RDSServer)](./datafactory-object-rdsserver.md)