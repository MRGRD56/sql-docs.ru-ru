---
description: Метод Save
title: Метод Save | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- _Recordset::Save
- _Recordset::raw_Save
helpviewer_keywords:
- Save method [ADO]
ms.assetid: ed3d9678-5c28-4e61-8bb3-7dfb66d99cf5
author: rothja
ms.author: jroth
ms.openlocfilehash: a32419db6e4dd04cc57b31b1d9267e80a30db41d
ms.sourcegitcommit: 370cab80fba17c15fb0bceed9f80cb099017e000
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/17/2020
ms.locfileid: "97638134"
---
# <a name="save-method"></a>Метод Save
Сохраняет [набор записей](./recordset-object-ado.md) в объекте File или [Stream](./stream-object-ado.md) .  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
recordset.Save Destination, PersistFormat  
```  
  
#### <a name="parameters"></a>Параметры  
 *Назначение*  
 Необязательный параметр. **Вариант** , представляющий полное имя пути к файлу, в котором сохраняется **набор записей** , или ссылку на объект **потока** .  
  
 *персистформат*  
 Необязательный параметр. Значение [персистформатенум](./persistformatenum.md) , указывающее формат, в котором сохраняется **набор записей** (XML или адтг). Значение по умолчанию — **адперсистадтг**.  
  
## <a name="remarks"></a>Комментарии  
 Метод **Save** можно вызвать только для открытого **набора записей**. Используйте метод [Open Method (ADO Recordset)](./open-method-ado-recordset.md) для последующего восстановления **набора записей** из *места назначения*.  
  
 Если свойство [фильтра](./filter-property.md) для **набора записей** действует, сохраняются только те строки, которые доступны в фильтре. Если **набор записей** является иерархическим, текущий дочерний **набор записей** и его дочерние элементы сохраняются, включая родительский **набор записей**. Если вызывается метод Save дочернего **набора записей** , дочерний элемент и все его дочерние элементы сохраняются, но родительский элемент не является.  
  
 При первом сохранении **набора записей** необязательно указывать *назначение*. Если опустить *назначение*, будет создан новый файл с именем, равным значению свойства Source **набора записей**.  
  
 Опустить *назначение* при последующем вызове **Save** после первого сохранения или при возникновении ошибки времени выполнения. При последующем вызове метода **Save** с *новым назначением* **набор записей** сохраняется в новом месте назначения. Однако новое назначение и исходное место назначения будут открыты.  
  
 При **сохранении** не закрывается **набор записей** или *назначение*, поэтому можно продолжить работу с **набором записей** и сохранить последние изменения. *Назначение* остается открытым до закрытия **набора записей** .  
  
 По соображениям безопасности метод **Save** позволяет использовать только низкий и пользовательский параметры безопасности из сценария, выполняемого Microsoft Internet Explorer.  
  
 Если метод **Save** вызывается во время выполнения асинхронной операции выборки, выполнения или обновления **набора записей** , **Сохраните** ожидание до завершения асинхронной операции.  
  
 Записи сохраняются, начиная с первой строки **набора записей**. По завершении метода **Save** текущее расположение строки перемещается в первую строку **набора записей**.  
  
 Для получения наилучших результатов задайте для свойства [CursorLocation (ADO)](./cursorlocation-property-ado.md) значение **адусеклиент** с параметром **Save**. Если поставщик не поддерживает все функции, необходимые для сохранения объектов **набора записей** , Служба курсора предоставит эту функцию.  
  
 Если **набор записей** сохраняется с помощью свойства **CursorLocation** , установленного в значение **Адусесервер**, возможность обновления для **набора записей** ограничена. Как правило, разрешены только обновления, вставки и удаления в одной таблице (зависит от функциональности поставщика). Метод повторной [синхронизации](./resync-method.md) также недоступен в этой конфигурации.  
  
> [!NOTE]
>  Сохранение **набора записей** с **полями** типа **адвариант**, **адидиспатч** или **адиункновн** не поддерживается ADO и может привести к непредсказуемым результатам.  
  
 Только фильтры в форме строк критериев (например, OrderDate > "12/31/1999") влияют на содержимое сохраненного **набора записей**. Фильтры, созданные с помощью массива **закладок** или значения из [филтерграупенум](./filtergroupenum.md) , не влияют на содержимое сохраненного **набора записей**. Эти правила применяются к **наборам записей**, созданным с помощью курсоров на стороне клиента или на стороне сервера.  
  
 Так как параметр *назначения* может принимать любой объект, поддерживающий интерфейс OLE DB IStream, **набор записей** можно сохранить непосредственно в объекте ответа ASP. Дополнительные сведения см. в описании **сценария сохраняемости XML-записей**.  
  
 Можно также сохранить **набор записей** в формате XML в экземпляре объекта DOM MSXML, как показано в следующем Visual Basic коде:  
  
```  
Dim xDOM As New MSXML.DOMDocument  
Dim rsXML As New ADODB.Recordset  
Dim sSQL As String, sConn As String  
  
sSQL = "SELECT customerid, companyname, contactname FROM customers"  
sConn="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=Northwind.mdb"  
rsXML.Open sSQL, sConn  
rsXML.Save xDOM, adPersistXML   'Save Recordset directly into a DOM tree.  
...  
```  
  
> [!NOTE]
>  При сохранении иерархических наборов записей (фигур данных) в формате XML применяются два ограничения. Нельзя сохранить в XML, если иерархический **набор записей** содержит ожидающие обновления, и нельзя сохранить параметризованный иерархический **набор записей**.  
  
 **Набор записей** , сохраненный в формате XML, сохраняется в формате UTF-8. Когда такой файл загружается в поток ADO, объект Stream не будет пытаться открыть **набор записей** из потока, пока для свойства charset потока не будет задано соответствующее значение для формата UTF-8.  
  
## <a name="applies-to"></a>Применение  

:::row:::
    :::column:::
        [Объект Recordset (ADO)](./recordset-object-ado.md)  
    :::column-end:::
    :::column:::
        [Объект Stream (ADO)](./stream-object-ado.md)  
    :::column-end:::
:::row-end:::

## <a name="see-also"></a>См. также:  
 [Пример методов Save и Open (Visual Basic)](./save-and-open-methods-example-vb.md)   
 [Пример методов Save и Open (Visual c++)](./save-and-open-methods-example-vc.md)   
 [Метод Open (набор записей ADO)](./open-method-ado-recordset.md)   
 [Метод Open (поток ADO)](./open-method-ado-stream.md)   
 [Метод SaveToFile](./savetofile-method.md)