---
description: Свойство Filter
title: Свойство Filter | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 03/20/2018
ms.reviewer: ''
ms.topic: reference
apitype: COM
f1_keywords:
- Recordset15::Filter
helpviewer_keywords:
- Filter property
ms.assetid: 80263a7a-5d21-45d1-84fc-34b7a9be4c22
author: rothja
ms.author: jroth
ms.openlocfilehash: 7366ba67d36049f1c5df701bc633d76f56bb9af5
ms.sourcegitcommit: 33f0f190f962059826e002be165a2bef4f9e350c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2021
ms.locfileid: "99167328"
---
# <a name="filter-property"></a>Свойство Filter
Указывает фильтр для данных в [наборе записей](./recordset-object-ado.md).  
  
## <a name="settings-and-return-values"></a>Параметры и возвращаемые значения

Задает или возвращает значение **типа Variant** , которое может содержать один из следующих элементов:  
  
-   **Строка условий:** Строка, состоящие из одного или нескольких отдельных предложений, Объединенных с операторами **and** или **or** .  
  
-   **Массив закладок:** Массив уникальных значений закладок, указывающих на записи в объекте **Recordset** .  
  
-   Значение [филтерграупенум](./filtergroupenum.md) .  
  
## <a name="remarks"></a>Замечания

Используйте свойство **Filter** для выборочного отображения записей в объекте **набора записей** . Отфильтрованный **набор записей** станет текущим курсором. Затрагиваются другие свойства, возвращающие значения, основанные на текущем **курсоре** , такие как [свойство примеры AbsolutePosition (ADO)](./absoluteposition-property-ado.md), [свойство примеры absolutepage (ADO)](./absolutepage-property-ado.md), [свойство RecordCount (ADO)](./recordcount-property-ado.md)и [свойство PageCount (ADO)](./pagecount-property-ado.md). Если задать для свойства **фильтра** определенное новое значение, текущая запись перемещается в первую запись, удовлетворяющую новому значению.
  
Строка критериев состоит из предложений в формате « *fieldname-operator-значение* » (например, `"LastName = 'Smith'"` ). Составные предложения можно создавать путем сцепления отдельных предложений с **and** (например, `"LastName = 'Smith' AND FirstName = 'John'"` ) или **or** (например, `"LastName = 'Smith' OR LastName = 'Jones'"` ). Для строк критериев используйте следующие рекомендации.

-   *Fieldname* должно быть допустимым именем поля из **набора записей**. Если имя поля содержит пробелы, имя необходимо заключить в квадратные скобки.  
  
-   Оператор должен быть одним из следующих: \<, > , \<=, > =,  <>, = или **Like**.  
  
-   Значение — это значение, с помощью которого сравниваются значения полей (например, "Smith", #8/24/95 #, 12,345 или $50,00). Используйте одинарные кавычки со строками и знаками решетки (#) с датами. Для чисел можно использовать десятичные разделители, знаки доллара и экспоненциальное представление. Оператор If имеет значение **Like** и может использовать подстановочные знаки. Только звездочка (*) и знак процента (%) подстановочные знаки допускаются и должны быть последними символами в строке. значение не может быть равно NULL.  
  
> [!NOTE]
>  Чтобы включить одинарные кавычки (') в значении фильтра, используйте две одинарные кавычки для представления одного. Например, для фильтрации по O'Malley) строка критериев должна иметь значение `"col1 = 'O''Malley'"` . Чтобы включить одинарные кавычки как в начале, так и в конце значения фильтра, заключите строку в знаки фунта (#). Например, для фильтрации по "1" строка критериев должна иметь значение `"col1 = #'1'#"` .  
  
-   Приоритет между AND и OR не существует. Предложения могут быть сгруппированы в круглые скобки. Однако нельзя сгруппировать предложения, Соединенные или, а затем объединить группу с другим предложением с оператором AND, как в следующем фрагменте кода:  
 `(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'`  
  
-   Вместо этого этот фильтр следует создать так:  
 `(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')`  
  
-   В предложении **Like** можно использовать подстановочный знак в начале и в конце шаблона. Например, можно использовать `LastName Like '*mit*'`. Или, **как** и, можно использовать подстановочный знак только в конце шаблона. Например, `LastName Like 'Smit*'`.  
  
 Константы фильтра упрощают устранение конфликтов отдельных записей в режиме пакетного обновления, позволяя просматривать, например, только те записи, которые были затронуты во время последнего вызова метода [метода UpdateBatch](./updatebatch-method.md) .  
  
Установка свойства **фильтра** может завершиться ошибкой из-за конфликта с базовыми данными. Например, эта ошибка может произойти, если запись уже была удалена другим пользователем. В этом случае поставщик возвращает предупреждения в коллекцию [Errors Collection (ADO)](./errors-collection-ado.md) , но не останавливает выполнение программы. Ошибка во время выполнения возникает только в случае возникновения конфликтов во всех запрошенных записях. Свойство [Status (набор записей ADO)](./status-property-ado-recordset.md) используется для обнаружения записей с конфликтами.  
  
Установка свойства **фильтра** в виде строки нулевой длины ("") оказывает тот же результат, что и при использовании константы **адфилтерноне** .
  
Если задано свойство **Filter** , текущее расположение записи перемещается к первой записи в отфильтрованном подмножестве записей в **наборе** записей. Аналогично, если свойство **Filter** сброшено, текущее расположение записи перемещается к первой записи в **наборе записей**.

Предположим, что **набор записей** фильтруется на основе поля некоторого типа Variant, например типа sql_variant. Ошибка (DISP_E_TYPEMISMATCH или 80020005) возникает, когда подтипы поля и значения фильтра, используемые в строке критериев, не совпадают. Например, предположим, что:

- Объект **Recordset** (RS) содержит столбец (C) типа sql_variant.
- И полю этого столбца было присвоено значение 1 типа i4. Строка условий имеет значение `rs.Filter = "C='A'"` в поле.

Эта конфигурация выдает ошибку во время выполнения. Однако `rs.Filter = "C=2"` при применении к тому же полю не будет возникать никаких ошибок. И поле отфильтровано из текущего набора записей.

Описание значений закладок, из которых можно создать массив для использования со свойством Filter, см. в свойстве [Bookmark свойство (ADO)](./bookmark-property-ado.md) .

Только фильтры в форме строк критериев влияют на содержимое сохраненного **набора записей**. Пример строки условий: `OrderDate > '12/31/1999'` . Фильтры, созданные с помощью массива закладок или значения из **филтерграупенум**, не влияют на содержимое сохраненного **набора записей**. Эти правила применяются к наборам записей, созданным с помощью курсоров на стороне клиента или на стороне сервера.
  
> [!NOTE]
>  При применении флага Адфилтерпендингрекордс к отфильтрованному и измененному **набору записей** в режиме пакетного обновления результирующий **набор записей** пуст, если фильтрация основывается на ключевом поле таблицы с одним ключом, а изменения были сделаны в значениях ключевых полей. Результирующий **набор записей** не будет пустым, если выполняется одно из следующих условий:  
  
-   Фильтрация основана на неключевых полях в таблице с одним ключом.  
  
-   Фильтрация основана на полях в таблице с несколькими ключами.  
  
-   Внесены изменения в неключевые поля в таблице с одним ключом.  
  
-   Были внесены изменения в любые поля в таблице с несколькими ключами.  
  
В следующей таблице приводится сводка эффектов **адфилтерпендингрекордс** в различных сочетаниях фильтров и изменений. В левом столбце показаны возможные изменения. Изменения могут выполняться в любом из полей без ключей, в поле ключа в таблице с одним ключом или в любом из ключевых полей в таблице с несколькими ключами. В верхней строке показан критерий фильтрации. Фильтрация может основываться на любом из полей, не являющихся ключами, ключевое поле в таблице с одним ключом или на любом из ключевых полей в таблице с несколькими ключами. В пересекающихся ячейках отображаются результаты. **+** Знак «плюс» означает, что применение **адфилтерпендингрекордс** приводит к непустому **набору записей**. **-** Знак «минус» означает пустой **набор записей**.  
  
|Позволяющ|Не ключи|Один ключ|Несколько ключей|
|-|--------------|----------------|-------------------|
|**Не ключи**|+|+|+|
|**Один ключ**|+|-|Недоступно|
|**Несколько ключей**|+|Недоступно|+|
|||||
  
## <a name="applies-to"></a>Применение

[Объект Recordset (ADO)](./recordset-object-ado.md)  
  
## <a name="see-also"></a>См. также:

[Пример свойств Filter и RecordCount (Visual Basic)](./filter-and-recordcount-properties-example-vb.md) 
 [Пример свойств Filter и RecordCount (Visual c++)](./filter-and-recordcount-properties-example-vc.md) 
 [Метод Clear (ADO)](./clear-method-ado.md) 
 [Оптимизация Property-Dynamic (ADO)](./optimize-property-dynamic-ado.md)