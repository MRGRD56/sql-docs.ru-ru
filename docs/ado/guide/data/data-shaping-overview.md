---
description: Общие сведения о формировании данных
title: Общие сведения о формировании данных | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], overview
ms.assetid: 4cb5fd29-4e56-46ac-ae48-a6771c321c0c
author: rothja
ms.author: jroth
ms.openlocfilehash: dbe025e38960b458c2ad5a224bad44c37868d51f
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100037654"
---
# <a name="data-shaping-overview"></a>Общие сведения о формировании данных
*Формирование данных* означает создание иерархических связей между двумя или более логическими сущностями в запросе. Иерархия может быть видна в отношениях "родители-потомки" между записями одного [набора записей](../../reference/ado-api/recordset-object-ado.md)и одной или несколькими записями (также называемыми главой) другого **набора записей**. В связи типа «родители-потомки» родительский **набор записей** содержит дочерний **набор записей**. Примером такой иерархической связи являются клиенты и заказы. Для каждого клиента в базе данных может быть не менее одного заказа. Иерархическая связь может быть рекурсивной, что означает, что записи внучатый могут быть вложены в дочернюю запись. В принципе, иерархическая запись может быть вложена в любую глубину. На практике, ADO ограничивает рекурсию до 512 **наборов записей**.  
  
 Как правило, столбцы в форме **набора записей** могут содержать данные от поставщика данных, например Microsoft® SQL Server, ссылки на другой **набор записей**, значения, производные от вычисления в одной строке **набора записей**, или значения, производные от операции над столбцом всего **набора записей**. Кроме того, столбец может быть создан и пустым.  
  
 При извлечении значения столбца, содержащего ссылку на другой **набор записей**, ADO автоматически возвращает фактический **набор записей** , представленный ссылкой. Ссылка на **набор записей** фактически является ссылкой на подмножество дочернего элемента, называемое *главой*. Один родительский элемент может ссылаться на более чем один дочерний **набор записей**.  
  
 Поддержка ADO для формирования данных позволяет запрашивать источник данных и возвращать **набор записей** , в котором (родительская) запись представляет (дочерний) **набор записей**. В сценарии заказа клиентов можно использовать формирование данных для получения сведений о клиентах, а также заказов, размещенных каждым клиентом в одном запросе. Результирующий **набор записей** также известен как **набор записей** в форме формы.  
  
 Кроме того, формирование данных в ADO позволяет создавать новые объекты **набора записей** без базового источника данных с помощью ключевого слова **New** для описания полей родительских и дочерних **наборов записей**. Затем новый объект **набора записей** может быть заполнен данными и сохранен в сохраняемом виде. Разработчики также могут выполнять различные вычисления или агрегаты (например, **Sum**, **AVG** и **Max**) для дочерних полей. Формирование данных также может создать родительский **набор записей** из дочернего набора записей, группируя записи в дочернем объекте и помещая одну строку в родительской группе для каждой группы в дочернем **наборе** .  
  
 Обычный SQL позволяет получать данные с помощью синтаксиса **Join** , но это может оказаться неэффективным и неудобным, так как избыточные родительские данные повторяются в каждой записи, возвращенной для данной связи типа «родители-потомки». Формирование данных может связать одну родительскую запись в родительском **наборе** записей с несколькими дочерними записями в дочернем **наборе** записей, избегая избыточности **объединения**. Большинство пользователей находят модель программирования "родители-потомки" с множеством **наборов записей** более естественным и проще в работе, чем единственная модель **объединения набора записей** .