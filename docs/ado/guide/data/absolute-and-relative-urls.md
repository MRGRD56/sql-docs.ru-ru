---
description: Абсолютные и относительные URL-адреса
title: Абсолютные и относительные URL-адреса | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- relative URLs [ADO]
- absolute URLs [ADO]
- URLs [ADO]
ms.assetid: 6a34a7ef-50cc-4c3d-82f7-106b9a8f3caf
author: rothja
ms.author: jroth
ms.openlocfilehash: 50535a71c1062bc04aa009bea1aab08d3cf1faf0
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100028699"
---
# <a name="absolute-and-relative-urls"></a>Абсолютные и относительные URL-адреса
URL-адрес указывает расположение целевого объекта, хранящегося на локальном или сетевом компьютере. Целевым объектом может быть файл, каталог, HTML-страница, изображение, программа и т. д.  
  
 *Абсолютный URL-адрес* содержит все сведения, необходимые для размещения ресурса.  
  
 *Относительный URL-адрес* находит ресурс, используя абсолютный URL-адрес в качестве отправной точки. Фактически "полный URL-адрес" целевого объекта указывается путем сцепления абсолютных и относительных URL-адресов.  
  
 *Абсолютный URL-адрес* использует следующий формат: *Scheme://Server/Path/Resource*  
  
 Относительный URL-адрес обычно состоит только из *пути* и (необязательно) *ресурса*, но не имеет *схемы* или *сервера*. В следующих таблицах определяются отдельные части полного формата URL-адреса.  
  
 *scheme*  
 Указывает, каким способом будет осуществляться доступ к *ресурсу* .  
  
 *server*  
 Указывает имя компьютера, на котором расположен *ресурс* .  
  
 *path*  
 Указывает последовательность каталогов, ведущих к целевому объекту. Если *ресурс* не указан, целевой объект является последним каталогом в *пути*.  
  
 *ресурсов*  
 Если параметр включен, *ресурс* является целевым, а обычно — именем файла. Это может быть *простой файл,* содержащий один двоичный поток байтов, или *структурированный документ,* содержащий одно или несколько хранилищ и двоичных потоков байтов.  
  
## <a name="url-scheme-registration"></a>Регистрация схемы URL-адресов  
 Если поставщик поддерживает URL-адреса, поставщик будет регистрировать одну или несколько схем URL-адресов. Регистрация означает, что любые URL-адреса, использующие схему, будут автоматически вызывать зарегистрированного поставщика. Например, схема *http* регистрируется в [поставщике OLE DB Майкрософт для публикации в Интернете](../appendixes/microsoft-ole-db-provider-for-internet-publishing.md). В ADO предполагается, что все URL-адреса с префиксом "http" представляют собой веб-папки или файлы, которые будут использоваться поставщиком публикации в Интернете. Сведения о схемах, зарегистрированных поставщиком, см. в документации поставщика.  
  
## <a name="defining-context-with-a-url"></a>Определение контекста с URL-адресом  
 Одной из функций открытого соединения, представленного объектом [Connection](../../reference/ado-api/connection-object-ado.md) , является ограничение последующих операций для источника данных, представленного этим соединением. Это означает, что соединение определяет контекст для последующих операций.  
  
 При использовании ADO 2,7 или более поздней версии абсолютный URL-адрес также может определять контекст. Например, при открытии объекта [записи](../../reference/ado-api/record-object-ado.md) с абсолютным URL-адресом объект **соединения** неявно создается для представления ресурса, указанного URL-адресом.  
  
 Абсолютный URL-адрес, определяющий контекст, можно указать в параметре *ActiveConnection* метода [Open](../../reference/ado-api/open-method-ado-record.md) объекта **Record** . Абсолютный URL-адрес также может быть указан в качестве значения ключевого слова "URL =" в параметре метода *ConnectionString* [объекта](../../reference/ado-api/open-method-ado-recordset.md) **Connection** и параметра *ActiveConnection* [объекта](../../reference/ado-api/open-method-ado-connection.md) [Recordset](../../reference/ado-api/recordset-object-ado.md) .  
  
 Контекст можно также определить, открыв **запись** или объект **набора записей** , представляющий каталог, так как у этих объектов уже есть неявно или явно объявленный объект **соединения** , указывающий контекст.  
  
## <a name="scoped-operations"></a>Операции с областью действия  
 Контекст также определяет область, то есть каталог и его подкаталоги, которые могут участвовать в последующих операциях. Объект **Record** имеет несколько методов с областью действия, которые работают с каталогом и всеми его подкаталогами. К этим методам относятся [копирекорд](../../reference/ado-api/copyrecord-method-ado.md), [MoveRecord](../../reference/ado-api/moverecord-method-ado.md)и [делетерекорд](../../reference/ado-api/deleterecord-method-ado.md).  
  
## <a name="relative-urls-as-command-text"></a>Относительные URL-адреса в качестве текста команды  
 Можно указать команду для выполнения в источнике данных, введя строку в параметре *CommandText* метода [EXECUTE](../../reference/ado-api/execute-method-ado-connection.md) объекта **Connection** и в параметре *Source* метода [Open](../../reference/ado-api/open-method-ado-recordset.md) объекта **Recordset** .  
  
 Относительный URL-адрес можно указать в параметре *CommandText* или *Source* . Относительный URL-адрес фактически не представляет команду, например команду SQL; Он просто задает параметры. Контекст активного соединения должен быть абсолютным URL-адресом, а параметр *Option* должен иметь значение **адкмдтабледирект**.  
  
 Например, в следующем примере кода показано, как открыть **набор записей** в Readme25.txtном файле каталога winnt/system32:  
  
```  
recordset.Open "system32/Readme25.txt", "URL=https://YourServer/Winnt/",,,adCmdTableDirect  
```  
  
 Абсолютный URL-адрес в строке подключения указывает сервер ( `YourServer` ) и путь ( `Winnt` ). Этот URL-адрес также определяет контекст.  
  
 Относительный URL-адрес в тексте команды использует абсолютный URL-адрес в качестве отправной точки и указывает оставшуюся часть пути ( `system32` ) и открываемый файл ( `Readme25.txt` ).  
  
 Поле параметров ( `adCmdTableDirect` ) указывает, что тип команды является относительным URL-адресом.  
  
 В качестве другого примера следующий код откроет **набор записей** по содержимому `Winnt` каталога:  
  
```  
recordset.Open "", "URL=https://YourServer/Winnt/",,,adCmdTableDirect  
```  
  
## <a name="ole-db-provider-supplied-url-schemes"></a>Схемы URL-адресов OLE DB Provider-Supplied  
 Начальная часть полного URL-адреса — это *схема* , используемая для доступа к ресурсу, определяемому оставшейся частью URL-адреса. Примеры: HTTP (протокол гипертекста) и FTP (протокол FTP).  
  
 ADO поддерживает поставщики OLE DB, которые распознают собственные схемы URL-адресов. Например, [поставщик Microsoft OLE DB для публикации в Интернете](../appendixes/microsoft-ole-db-provider-for-internet-publishing.md)*,* который обращается к опубликованным файлам Windows 2000, распознает существующую схему HTTP.  
  
## <a name="see-also"></a>См. также:  
 [Объект Connection (ADO)](../../reference/ado-api/connection-object-ado.md)   
 [Объект Record (ADO)](../../reference/ado-api/record-object-ado.md)   
 [Объект Recordset (ADO)](../../reference/ado-api/recordset-object-ado.md)