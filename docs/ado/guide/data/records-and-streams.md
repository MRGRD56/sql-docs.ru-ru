---
description: Записи и потоки
title: Записи и потоки | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- streams [ADO]
- streams [ADO], about streams
- records [ADO]
ms.assetid: 4d68868e-2611-4b5c-9a89-7caa5f753151
author: rothja
ms.author: jroth
ms.openlocfilehash: 2de6347377cbdeb464941d766d732c23443efa2a
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100032566"
---
# <a name="records-and-streams"></a>Записи и потоки
В настоящее время ADO предоставляет объект [Recordset](../../../ado/reference/ado-api/recordset-object-ado.md) в качестве основного средства доступа к данным в источниках данных, таким как реляционные базы данных. Однако некоторые поставщики поддерживают объекты [записи](../../../ado/reference/ado-api/record-object-ado.md) и [потока](../../../ado/reference/ado-api/stream-object-ado.md) в качестве альтернативных или дополнительных объектов, с которыми можно манипулировать данными из поставщиков. Дополнительные сведения о поведении **записей** см. в документации поставщика.  
  
## <a name="records"></a>Записи  
 Объекты **записи** , по сути, работают как однострочные **наборы записей**. Однако **записи** имеют ограниченную функциональность по сравнению с **наборами записей** и имеют различные свойства и методы. Источником данных в объекте **Record** может быть команда, возвращающая одну строку данных от поставщика. Использование объектов **записей** вместо объектов **Recordset** для получения результатов из запроса, возвращающего одну строку данных, устраняет издержки, обусловленные созданием более сложного объекта **набора записей** .  
  
 Объекты **записи** могут служить другой целью, особенно с поставщиками для источников данных, отличных от традиционных реляционных баз данных, таких как [поставщик OLE DB Майкрософт для публикации в Интернете](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-internet-publishing.md). Большая часть информации, которая должна быть обработана, не в виде таблиц в базах данных, но как сообщения в системах электронной почты и файлах в современных файловых системах. Объекты **Record** и **Stream** упрощают доступ к информации, хранящейся в источниках, отличных от реляционных баз данных.  
  
 Объект **Record** может представлять и управлять данными, такими как каталоги и файлы в файловой системе, папках и сообщениях в системе электронной почты. В этих целях источником **записи** может быть текущая строка открытого **набора записей**, абсолютный URL-адрес или относительный URL-адрес в сочетании с открытым объектом [соединения](../../../ado/reference/ado-api/connection-object-ado.md) .  
  
 Как правило, **набор записей** можно использовать для представления контейнера или родителя в иерархии, такой как папка или каталог. **Запись** можно использовать для возврата конкретных сведений об одном узле в родительском контейнере, например в файле или документе. **Записи** основной причины используются для представления информации такого типа, так как эти источники данных являются разнородными. Это означает, что каждая **запись** может иметь разные наборы полей и их количество. Традиционные **наборы записей** , содержащие строки из базы данных, являются однородными, то есть каждая строка имеет одинаковое число и тип полей.  
  
 Дополнительные сведения об использовании объекта **Record** для обработки разнородных данных от поставщиков, таких как поставщик публикации в Интернете, см. в разделе [Использование ADO для публикации в Интернете](../../../ado/guide/data/using-ado-for-internet-publishing.md).  
  
## <a name="streams"></a>Потоки  
 Объект **Stream** предоставляет средства для чтения, записи и управления потоком байтов. Этот поток байтов может быть текстовым или двоичным и ограничен размером только системными ресурсами. Как правило, объекты **потока** ADO используются в следующих целях:  
  
-   Для хранения данных **набора записей** , сохраненного в формате XML. Эти XML-потоки из сохраненных **наборов записей** можно использовать в качестве источника при открытии нового **набора записей**. Дополнительные сведения см. в разделе [потоки и сохраняемость](../../../ado/guide/data/streams-and-persistence.md).  
  
-   Значение, чтобы содержать [коммандстреамс](../../../ado/reference/ado-api/commandstream-property-ado.md) для выполнения с поставщиком в качестве альтернативы [CommandText](../../../ado/reference/ado-api/commandtext-property-ado.md). Например, диаграмм обновления XML можно использовать в качестве источника команды для поставщика OLE DB Майкрософт для SQL Server.  
  
-   Для получения результатов от поставщика в формате, отличном от **набора записей**, например XML-результатов от поставщика Microsoft OLE DB для SQL Server. Дополнительные сведения см. [в разделе Извлечение результирующих наборов в потоки](../../../ado/guide/data/retrieving-resultsets-into-streams.md).  
  
-   Значение, которое содержит текст или байты, составляющие файл или сообщение, которые обычно используются с такими поставщиками, как поставщик OLE DB Майкрософт для публикации в Интернете. Дополнительные сведения об использовании объектов **Stream** см. [в разделе Использование ADO для публикации в Интернете](../../../ado/guide/data/using-ado-for-internet-publishing.md).  
  
 Объект **потока** можно открыть в:  
  
-   Простой файл, указанный с URL-адресом.  
  
-   Поле **записи** или **набора записей** , содержащего объект **потока** .  
  
-   Поток по умолчанию для **записи** или объекта **набора записей** , представляющего каталог или составной файл.  
  
-   Поле ресурса, содержащее URL-адрес простого файла.  
  
-   Нет определенного источника. В этом случае объект **потока** открывается в памяти. Данные можно записать в него, а затем сохранить в другом **потоке** или файле.  
  
-   Поле BLOB-объекта в **наборе записей**.  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Потоки и сохраняемость](../../../ado/guide/data/streams-and-persistence.md)  
  
-   [Потоки команд](../../../ado/guide/data/command-streams.md)  
  
-   [Извлечение результирующих наборов в потоки](../../../ado/guide/data/retrieving-resultsets-into-streams.md)  
  
-   [Использование ADO для публикации в Интернете](../../../ado/guide/data/using-ado-for-internet-publishing.md)
