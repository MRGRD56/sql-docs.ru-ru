---
description: 'Создание экземпляра события ADO: ADO и WFC'
title: 'Создание экземпляра события ADO: ADO и WFC | Документация Майкрософт'
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 02/15/2017
ms.reviewer: ''
ms.topic: conceptual
ms.assetid: 9ee4be21-657b-407a-afa4-0b27a6b096ce
author: rothja
ms.author: jroth
ms.openlocfilehash: b7ed585adcfc9542e3d396f2b0fd1a82d65cdcf4
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100028356"
---
# <a name="ado-event-instantiation-ado-and-wfc"></a>Создание экземпляра события ADO: ADO и WFC
Объекты ADO для классов Windows Foundation (ADO/WFC) построены на модели событий ADO и представляют упрощенный прикладной программный интерфейс. Как правило, ADO/WFC перехватывает события ADO, объединяет параметры событий в один класс событий, а затем вызывает обработчик событий.  
  
### <a name="to-use-ado-events-in-adowfc"></a>Использование событий ADO в ADO/WFC  
  
1.  Определите собственный обработчик событий для обработки события. Например, если вы хотите обработать событие **коннекткомплете** в семействе **коннектионевент** , вы можете использовать следующий код:  
  
    ```  
    public void onConnectComplete(Object sender,ConnectionEvent e)  
    {  
        System.out.println("onConnectComplete:" + e);  
    }  
    ```  
  
2.  Определите объект обработчика для представления обработчика событий. Объект обработчика должен иметь тип данных **коннектевенсандлер** для события типа **коннектионевент** или **рекордсетевенсандлер** типа данных для события типа **рекордсетевент**. Например, для обработчика событий **коннекткомплете** необходимо запрограммировать следующий код:  
  
    ```  
    ConnectionEventHandler handler =   
        new ConnectionEventHandler(this, "onConnectComplete");  
    ```  
  
     Первый аргумент конструктора **коннектионевенсандлер** является ссылкой на класс, который содержит обработчик событий, названный во втором аргументе.  
  
3.  Добавьте обработчик событий в список обработчиков, предназначенных для обработки определенного типа события. Используйте метод с именем, например " **надстройка**_EventName_(*обработчик*)".  
  
4.  ADO/WFC внутренне реализует все обработчики событий ADO. Таким образом, событие, вызванное **соединением** или операцией с **набором записей** , перехватывается обработчиком событий ADO/WFC.  
  
     Обработчик событий ADO/WFC передает параметры ADO **коннектионевент** в экземпляре класса ADO/WFC **КОННЕКТИОНЕВЕНТ** или параметры ADO **РЕКОРДСЕТЕВЕНТ** в экземпляре класса ADO/WFC **рекордсетевент** . Эти классы ADO/WFC объединяют параметры событий ADO. то есть каждый класс ADO/WFC содержит один элемент данных для каждого уникального параметра во всех методах ADO **коннектионевент** или **рекордсетевент** .  
  
5.  Затем ADO/WFC вызывает обработчик событий с помощью объекта события ADO/WFC. Например, обработчик **онконнекткомплете** имеет сигнатуру следующего вида:  
  
    ```  
    public void onConnectComplete(Object sender,ConnectionEvent e)  
    ```  
  
     Первый аргумент — это тип объекта, который отправил событие ([соединение](../../reference/ado-api/connection-object-ado.md) или [набор записей](../../reference/ado-api/recordset-object-ado.md)), а второй аргумент — объект события ADO/WFC (**коннектионевент** или **рекордсетевент**).  
  
     Сигнатура обработчика событий проще, чем событие ADO. Тем не менее необходимо понимать модель событий ADO, чтобы узнать, какие параметры применяются к событию, и как реагировать на него.  
  
6.  Вернитесь от обработчика событий к обработчику ADO/WFC для события ADO. ADO/WFC копирует соответствующие элементы данных событий ADO/WFC обратно в параметры события ADO, а затем обработчик событий ADO возвращает.  
  
7.  После завершения обработки удалите обработчик из списка обработчиков событий ADO/WFC. Используйте метод с именем, например **removeOn**_EventName_(*handler*).  
  
## <a name="see-also"></a>См. также:  
 [Сводка по обработчику событий ADO](./ado-event-handler-summary.md)   
 [ADO — индекс синтаксиса WFC](../../reference/ado-api/ado-wfc-syntax-index.md)   
 [Параметры события](./event-parameters.md)   
 [Совместная работа обработчиков событий](./how-event-handlers-work-together.md)   
 [Типы событий](./types-of-events.md)