---
description: Дополнительные способы перемещения в наборе записей
title: Другие способы перемещения в наборе записей | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- MoveNext method [ADO]
- MoveLast method [ADO]
- MoveFirst method [ADO]
- Recordset object [ADO], moving
- MovePrevious method [ADO]
ms.assetid: 9f8cf1b2-3def-453f-a0ff-4646c5f15262
author: rothja
ms.author: jroth
ms.openlocfilehash: 78acb389a38896d05a684b0dbd940942a026655e
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100032716"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения в наборе записей
Следующие четыре метода используются для перемещения или прокрутки в **наборе записей**: [MoveFirst, MoveLast, MoveNext и MovePrevious](../../reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Некоторые из этих методов недоступны для однопроходных курсоров.)  
  
 **MoveFirst** изменяет текущее расположение записи до первой записи в **наборе записей**. **MoveLast** изменяет текущее расположение записи до последней записи в **наборе записей**. Чтобы использовать **MoveFirst** или **MoveLast**, объект **Recordset** должен поддерживать закладки или обратное перемещение курсора; в противном случае вызов метода выдаст ошибку.  
  
 **MoveNext** перемещает текущую позицию текущей записи в одну точку вперед. Если вы используете последнюю запись при вызове **MoveNext**, то **EOF** будет иметь значение **true**. **MovePrevious** перемещает текущую запись в одну позицию назад. Если вы используете первую запись при вызове **MovePrevious**, **BOF** будет иметь значение **true**. При использовании этих методов разумно проверить свойства **EOF** и **BOF** и переместить курсор обратно на допустимую текущую позицию текущей записи, если вы перейдете из конца **набора записей**, как показано ниже:  
  
```  
. . .  
oRs.MoveNext  
If oRs.EOF Then oRs.MoveLast  
. . .   
```  
  
 Или, в случае с методом **MovePrevious** :  
  
```  
. . .   
oRs.MovePrevious  
If oRs.BOF Then oRs.MoveFirst  
. . .  
```  
  
 В случаях, когда **набор записей** фильтруется или сортируется и изменяются данные текущей записи, она также может измениться. В таких случаях метод **MoveNext** работает нормально, но следует иметь в виду, что расположение перемещено на одну запись вперед от новой, а не от старой. Например, изменение данных в текущей записи, при котором запись перемещается в конец отсортированного **набора записей**, означает, что при вызове **MoveNext** в ADO задается текущая запись после последней записи в **наборе записей** (**EOF**  =  **true**).  
  
 Поведение различных методов перемещения объекта **Recordset** в некоторой степени зависит от данных в **наборе записей**. Новые записи, добавленные в **набор записей** , изначально добавляются в определенном порядке, который определяется источником данных и может быть зависимым неявно или явно для данных в новой записи. Например, если в запросе, заполняющем **набор записей**, выполняется сортировка или соединение, Новая запись будет вставлена в соответствующее место в **наборе записей**. Если при создании **набора записей** явно не указать порядок, изменения в реализации источника данных могут привести к непреднамеренному изменению порядка возвращаемых строк. Кроме того, функции сортировки, фильтрации и редактирования **набора записей** могут повлиять на порядок и, возможно, какие строки в наборе записей будут видимы.  
  
 Таким образом, методы **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast** и **Move** чувствительны к другим операциям, выполняемым в том же **наборе записей**. ADO всегда пытается сохранить текущую точку до тех пор, пока вы явно не перемещаете ее, но иногда изменения не позволяют понять последствия последующего перемещения. Например, при вызове функции **MoveFirst** для размещения в первой строке отсортированного **набора записей** и изменении сортировки по возрастанию на убывающий, то все равно будет находиться в той же строке, но теперь это последняя строка в **наборе записей**. **MoveFirst** перейдет к другой строке (новой первой строки).  
  
 Другой пример: Если вы располагаете в определенной строке в середине **набора записей** **и вызываете метод** **MoveNext**, то теперь сразу после удаленной записи выполняется запись. Но вызов **MovePrevious** делает запись, предшествующую той, что удалила текущую запись, так как удаленная запись больше не учитывается в активном членстве **набора записей**.  
  
 Особенно сложно определить согласованную семантику перемещения во всех поставщиках для методов, которые перемещаются относительно текущей записи — **MovePrevious**, **MoveNext** и **перемещать** , изменяя данные в текущей записи. Например, если вы работаете с отсортированным отфильтрованным **набором записей** и измените данные в текущей записи так, чтобы они предшествовали всем остальным записям, но измененные данные больше не соответствуют фильтру, не ясно, где должна быть выполнена операция **MoveNext** . Самое надежное заключение заключается в том, что относительное перемещение внутри **набора записей** сложнейшую, чем абсолютное перемещение (например, использование **MoveFirst** или **MoveLast**) при изменении данных во время изменения, добавления или удаления записей. Сортировка и фильтрация должна основываться на первичном ключе или ИДЕНТИФИКАТОРе, так как этот тип значения не должен изменяться.