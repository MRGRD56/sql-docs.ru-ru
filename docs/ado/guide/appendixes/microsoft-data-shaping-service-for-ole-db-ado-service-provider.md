---
description: Служба формирования данных Майкрософт для OLE DB (поставщик служб ADO)
title: Служба формирования данных (Майкрософт) для OLE DB (поставщик служб ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 11/08/2018
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- providers [ADO], data shaping service for OLE DB
- data shaping service for OLE DB [ADO]
ms.assetid: 523009ce-e01b-4e2d-a7df-816d7688aff0
author: rothja
ms.author: jroth
ms.openlocfilehash: a83d37c301d34c273514e4d6eb0551bc86429bd4
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100029378"
---
# <a name="microsoft-data-shaping-service-for-ole-db-overview"></a>Обзор службы формирования данных Майкрософт для OLE DB
> [!IMPORTANT]
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Вместо этого приложения должны использовать XML.

 Служба формирования данных Майкрософт для поставщика служб OLE DB поддерживает создание иерархических объектов [набора записей](../../reference/ado-api/recordset-object-ado.md) от поставщика данных.

## <a name="provider-keyword"></a>Ключевое слово Provider
 Чтобы вызвать службу формирования данных для OLE DB, укажите в строке подключения следующее ключевое слово и значение.

```vb
"Provider=MSDataShape"
```

## <a name="dynamic-properties"></a>Динамические свойства
 При вызове этого поставщика услуг в коллекцию [свойств](../../reference/ado-api/properties-collection-ado.md) объекта[Connection](../../reference/ado-api/connection-object-ado.md) добавляются следующие динамические свойства.

|Имя динамического свойства|Описание|
|---------------------------|-----------------|
|**Уникальные имена перерисовок**|Указывает, допускаются ли объекты **набора записей** с повторяющимися значениями для их свойств **имени перерисовки** . Если это динамическое свойство имеет **значение true** и создается новый **набор записей** с тем же именем пользовательской формы, что и у существующего **набора записей**, то имя изменения формы нового объекта **набора записей** изменяется, чтобы сделать его уникальным. Если это свойство имеет **значение false** и создается новый **набор записей** с тем же именем пользовательской формы, что и у существующего **набора записей**, то оба объекта **набора записей** будут иметь одинаковое имя формы. Таким образом, ни один из **наборов записей** нельзя изменить, пока существуют оба набора записей.<br /><br /> Значение свойства по умолчанию — **false**.|
|**Поставщик данных**|Указывает имя поставщика, который будет предоставлять строки для формирования формы. Это значение может быть равно NONE, если поставщик не будет использоваться для предоставления строк.|

 Можно также задать динамические свойства, доступные для записи, указав их имена в качестве ключевых слов в строке подключения. Например, в Microsoft Visual Basic задайте для динамического свойства **поставщика данных** значение "MSDASQL", указав:

```vb
Dim cn as New ADODB.Connection
cn.Open "Provider=MSDataShape;Data Provider=MSDASQL"
```

 Можно также задать или получить динамическое свойство, указав его имя в качестве индекса для свойства [Properties](../../reference/ado-api/properties-collection-ado.md) . Например, следующий пример кода возвращает и выводит текущее значение динамического свойства **поставщика данных** , а затем задает новое значение, если CN. Для передачи данных задано значение "Мсдаташапе" (прямо или косвенно через строку подключения), а соединение не было открыто:

```vb
Debug.Print cn.Properties("Data Provider")
cn.Properties("Data Provider") = "MSDASQL"
```

> [!NOTE]
>  Динамическое свойство, **поставщик данных**, может быть задано только для неоткрытого объекта **соединения** . После открытия соединения свойство **поставщика данных** становится доступно только для чтения.

 Дополнительные сведения о формировании данных см. в разделе [формирование данных](../data/data-shaping-overview.md).

## <a name="see-also"></a>См. также:
 [Приложение А. Поставщики](./appendix-a-providers.md)