---
description: Подробные сведения о модели программирования RDS
title: Подробное описание модели программирования RDS | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: ado
ms.custom: ''
ms.date: 11/09/2018
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- RDS programming model [ADO], details
ms.assetid: 3e57af8d-519b-4467-a0bd-af468534cefd
author: rothja
ms.author: jroth
ms.openlocfilehash: a2b307c89d5e4a25d6963ef100083015ffe6ce74
ms.sourcegitcommit: c7f40918dc3ecdb0ed2ef5c237a3996cb4cd268d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/05/2020
ms.locfileid: "91724925"
---
# <a name="rds-programming-model-in-detail"></a>Подробные сведения о модели программирования RDS
Ниже приведены ключевые элементы модели программирования RDS.  
  
-   Клиент. Пространство данных  
  
-   RDSServer. факт.  
  
-   Клиент. DataControl  
  
-   Событие  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, компоненты RDS больше не включены в операционную систему Windows (Дополнительные сведения см. в статье о совместимости Windows 8 и [Windows server 2012 Cookbook](https://www.microsoft.com/download/details.aspx?id=27416) ). Клиентские компоненты RDS будут удалены в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие RDS, должны переноситься в [службу данных WCF](/dotnet/framework/wcf/).  
  
## <a name="rdsdataspace"></a>Клиент. Пространство данных  
 Клиентское приложение должно указать сервер и серверную программу для вызова. В случае возврата приложение получает ссылку на серверную программу и может считать ссылку, как если бы она была самой программой сервера.  
  
 Объектная модель RDS воплощены эту функциональность с помощью [RDS. Объект Space](../../reference/rds-api/dataspace-object-rds.md) .  
  
 Серверная программа указывается с помощью идентификатора программы или *ProgID*. Сервер использует *идентификатор ProgID* и реестр компьютера сервера для обнаружения сведений о реальной программе для инициации.  
  
 Службы удаленных рабочих столов делают внутреннее различие в зависимости от того, находится ли серверная программа на удаленном сервере через Интернет или интрасеть. сервер в локальной сети; или не на сервере, а в локальной библиотеке динамической компоновки (DLL). Это различие определяет способ обмена данными между клиентом и сервером, а также делает нематериальное различие в типе ссылок, возвращаемых клиентскому приложению. Однако с точки зрения это различие не имеет особого смысла. Все, что важно, — получить используемую ссылку на программу.  
  
## <a name="rdsserverdatafactory"></a>RDSServer. факт.  
 RDS предоставляет серверную программу по умолчанию, которая может либо выполнить SQL-запрос к источнику данных, либо **получить объект** [набора](../../reference/ado-api/recordset-object-ado.md) записей, а затем обновить источник данных.  
  
 Объектная модель RDS воплощены эту функцию с объектом [факта RDSServer.](../../reference/rds-api/datafactory-object-rdsserver.md) DataObject.  
  
 Кроме того, этот объект имеет метод для создания пустого объекта **Recordset** , который можно заполнять программно ([CreateRecordset](../../reference/rds-api/createrecordset-method-rds.md)), и другой метод преобразования объекта **набора записей** в текстовую строку для создания веб-страницы ([ConvertToString](../../reference/rds-api/converttostring-method-rds.md)).  
  
 С помощью ADO можно переопределить некоторые стандартные подключения и поведение команд для **RDSServer.** данных, с помощью обработчика **фактов** и файла настройки, который содержит параметры соединения, команды и безопасности.  
  
 Серверная программа иногда называется *бизнес-объектом*. Можно написать собственный настраиваемый бизнес-объект, который может выполнять сложные действия по доступу к данным, проверкам достоверности и т. д. Даже при написании пользовательского бизнес-объекта можно создать экземпляр объекта **RDSServer.** DataObject и использовать некоторые его методы для выполнения собственных задач.  
  
## <a name="rdsdatacontrol"></a>Клиент. DataControl  
 RDS предоставляет средства для объединения функций **RDS. Пространства** данных и **RDSServer.** DataObject, а также позволяют визуальным элементам управления легко использовать объект **Recordset** , возвращенный запросом из источника. Попытки RDS, как правило, попытаются автоматически получить доступ к информации на сервере и отображать их в визуальном элементе управления.  
  
 Объектная модель RDS воплощены эту функциональность с помощью [RDS. Объект элемента управления](../../reference/rds-api/datacontrol-object-rds.md) .  
  
 **RDS. Элемент управления** "функция" имеет два аспекта. Один аспект относится к источнику данных. Если команда и сведения о соединении заданы с помощью свойств **Connect** и **SQL** **RDS. Элемент управления**, он будет автоматически использовать **RDS. Пространство** для создания ссылки на объект **RDSServer.** DataObject по умолчанию. Затем **RDSServer.** DataObject будет использовать значение свойства **Connect** для подключения к источнику данных, использовать значение свойства **SQL** для получения **набора записей** из источника данных и возвращения объекта **набора записей** в **RDS. Элемент управления**.  
  
 Второй аспект относится к отображению возвращаемых данных **набора записей** в визуальном элементе управления. Визуальный элемент управления можно связать с **RDS. Элемент управления** данными (в процессе с именем Binding) и получение доступа к информации в связанном объекте **набора записей** , отображая результаты запроса на веб-странице в Microsoft® Internet Explorer. Каждая **RDS. Объект «элемент управления** данным» привязывает один объект **Recordset** , представляющий результаты одного запроса, к одному или нескольким визуальным элементам управления (например, текстовому полю, полю со списком, элементу управления Grid и т. д.). Может существовать несколько **RDS. Объект элемента управления** на каждой странице. Каждая **RDS. Объект элемента управления** данными может быть подключен к другому источнику данных и содержать результаты отдельного запроса.  
  
 **RDS. Объект «элемент управления** данных» также имеет собственные методы для перемещения, сортировки и фильтрации строк связанного объекта **Recordset** . Эти методы похожи, но не совпадают с методами объекта **набора записей** ADO.  
  
## <a name="events"></a>События  
 RDS поддерживает два собственных события, которые не зависят от модели событий ADO. Событие [onReadyStateChange](../../reference/rds-api/onreadystatechange-event-rds.md) вызывается при каждом вызове **RDS. **Изменилось свойство свойства [ReadyState](../../reference/rds-api/readystate-property-rds.md) , уведомляя вас о том, что асинхронная операция успешно завершена, прервана или произошла ошибка. Событие [OnError](../../reference/rds-api/onerror-event-rds.md) вызывается при возникновении ошибки, даже если эта ошибка возникает во время асинхронной операции.  
  
> [!NOTE]
>  Microsoft Internet Explorer предоставляет два дополнительных события для RDS: **ондатасетчанжед**, которые указывают, что **набор записей** является функциональным, но все еще получает строки, и **ондатасеткомплете**, который указывает, что **набор записей** завершил извлечение строк.  
  
## <a name="see-also"></a>См. также  
 [Модель программирования RDS с объектами](./rds-programming-model-with-objects.md)   
 [Объект элемента управления (RDS)](../../reference/rds-api/datacontrol-object-rds.md)   
 [Объект фактического объекта (RDSServer)](../../reference/rds-api/datafactory-object-rdsserver.md)   
 [Объект Space (RDS)](../../reference/rds-api/dataspace-object-rds.md)   
 [Сценарий RDS](./rds-scenario.md)   
 [Руководство по RDS](./rds-tutorial.md)   
 [Использование RDS и безопасность](./rds-usage-and-security.md)