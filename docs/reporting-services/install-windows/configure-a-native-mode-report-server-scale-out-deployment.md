---
description: Настройка масштабного развертывания сервера отчетов, работающего в собственном режиме
title: Настройка масштабного развертывания сервера отчетов, работающего в собственном режиме | Документы Майкрософт
ms.date: 11/29/2018
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- report servers [Reporting Services], deployments
- deploying [Reporting Services], scale-out deployment model
- scale-out deployments [Reporting Services]
ms.assetid: b30d0308-4d9b-4f85-9f83-dece4dcb2775
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: a8e9e8fab90a0c2f21ae29d113ea896b471177f2
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88460006"
---
# <a name="configure-a-native-mode-report-server-scale-out-deployment"></a>Настройка масштабного развертывания сервера отчетов, работающего в собственном режиме

[!INCLUDE [ssrs-appliesto](../../includes/ssrs-appliesto.md)] [!INCLUDE [ssrs-appliesto-2016-and-later](../../includes/ssrs-appliesto-2016-and-later.md)] [!INCLUDE [ssrs-appliesto-pbirs](../../includes/ssrs-appliesto-pbirs.md)]

Службы Reporting Services в собственном режиме поддерживают модель масштабного развертывания, которая позволяет запускать несколько экземпляров сервера отчетов, совместно использующих одну базу данных сервера отчетов. Масштабное развертывание позволяет увеличить масштабируемость сервера отчетов, чтобы обслуживать одновременно больше пользователей и повысить нагрузочную способность сервера отчетов. Масштабное развертывание также может быть использовано для выделения отдельных серверов для обработки интерактивных или запланированных отчетов.

Для оптимизации производительности любой масштабируемой среды на сервере отчетов Power BI необходимо настроить сходство клиента (иногда называемое прикрепленными сеансами) в подсистеме балансировки нагрузки.  
  
В случае служб SQL Server 2016 Reporting Services и более ранних версий серверы отчетов в режиме интеграции с SharePoint для масштабного развертывания используют инфраструктуру продуктов SharePoint. Масштабное развертывание в режиме интеграции с SharePoint выполняется за счет добавления новых серверов отчетов в режиме интеграции с SharePoint в ферму SharePoint. Сведения о масштабном развертывании в режиме интеграции с SharePoint см. в статье [Добавление дополнительного сервера отчетов в ферму (горизонтально масштабируемые службы SSRS)](../../reporting-services/install-windows/add-an-additional-report-server-to-a-farm-ssrs-scale-out.md).  

> [!NOTE]
> Интеграция служб Reporting Services с SharePoint больше не доступна после выхода SQL Server 2016.
 
  *Масштабное развертывание* используется в следующих ситуациях:  
  
-   Как предварительное условие для балансировки загрузки между несколькими серверами отчетов в кластере. Перед началом балансировки нагрузки серверы отчетов необходимо настроить для совместного использования одной и той же базы данных.  
  
-   Для сегментирования приложений сервера отчетов на различные компьютеры, где первый сервер используется для интерактивной обработки отчетов, а второй — для обработки отчетов по расписанию. В таком сценарии каждый экземпляр сервера обрабатывает разные типы запросов к одному и тому же содержимому сервера отчетов, хранящегося в общей базе данных.  
  
 **Масштабное развертывание включает в себя следующие компоненты.**  
  
-   Два или более экземпляра сервера отчетов, совместно использующие общую базу данных сервера отчетов.  
  
-   Кроме того, может присутствовать кластер с распределенной сетевой нагрузкой (NLB), который распределяет интерактивных пользователей по экземплярам сервера отчетов.  
  
 Во время развертывания служб Reporting Services на кластере с распределенной сетевой нагрузкой (NLB) следует убедиться, что имя виртуального сервера NLB используется в настройке URL-адресов сервера отчетов, а серверы настроены для совместного использования общего состояния представления.  
  
 Службы Reporting Services не присутствуют в кластерах службы кластеров (Майкрософт). Однако можно создать базу данных сервера отчетов на экземпляре компонента Database Engine, который является частью отказоустойчивого кластера.  
  
 **Чтобы произвести планирование, установку и настройку масштабного развертывания, выполните следующие шаги.**  
  
-   Инструкции по установке экземпляров сервера отчетов см. в статье [Установка SQL Server с помощью мастера установки (программа установки)](../../database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup.md).  
  
-   Если планируется выполнить масштабное развертывание на NLB-кластере, следует настроить NLB-кластер перед настройкой масштабного развертывания. Дополнительные сведения см. в статье [настроить сервер отчетов в кластере с балансированием сетевой нагрузки](../../reporting-services/report-server/configure-a-report-server-on-a-network-load-balancing-cluster.md).  
  
-   Просмотрите процедуры этого раздела с инструкциями по организации общего доступа к базе данных сервера отчетов и присоединению серверов отчетов к масштабному развертыванию.  
  
     Эти процедуры иллюстрируют порядок настройки масштабного развертывания для сервера отчетов, состоящего из двух узлов. Чтобы добавить к развертыванию дополнительные узлы сервера отчетов, нужно будет повторить описанные в данном разделе действия.  
  
    -   Программа установки позволяет установить все экземпляры сервера отчетов, которые будут объединены в масштабное развертывание.  
  
         Чтобы избежать проблем совместимости баз данных при подключении экземпляров сервера к совместно используемой базе данных, следует убедиться, что все экземпляры имеют одну и ту же версию. Например, если база данных сервера отчетов создается с помощью экземпляра сервера отчетов SQL Server 2016, все остальные экземпляры, входящие в это развертывание, также должны иметь версию SQL Server 2016.  
  
    -   Диспетчер конфигурации служб Reporting Services позволяет подключить каждый сервер отчетов к общей базе данных. Подключаться к серверам и выполнять настройку можно только единожды за один раз.  
  
    -   Программа настройки служб Reporting Services используется для завершения масштабного развертывания посредством объединения новых экземпляров сервера отчетов с первым экземпляром сервера отчетов, уже подключенным к базе данных сервера отчетов.  
  
## <a name="to-install-a-sql-server-instance-to-host-the-report-server-databases"></a>Установка экземпляра SQL Server для размещения баз данных сервера отчетов  
  
1.  Установите экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на компьютер, на котором будут расположены базы данных сервера отчетов. Как минимум, следует установить компонент [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] и службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].  
  
2.  При необходимости активируйте сервер отчетов для удаленных соединений. В некоторых версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] удаленные соединения TCP/IP и именованные каналы по умолчанию не разрешены. Чтобы проверить, разрешены ли удаленные соединения, запустите средство диспетчера конфигурации [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и выясните значение параметров конфигурации сети для целевого экземпляра. Если удаленный экземпляр является именованным, убедитесь в том, что на целевом сервере включена и запущена служба браузера [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] сообщает номер порта, используемый для подключения к именованному экземпляру. 

## <a name="service-accounts"></a>учетные записи служб;

Учетные записи службы, используемые для экземпляра служб Reporting Services, важны при работе с масштабным развертыванием. При развертывании экземпляров служб Reporting Services необходимо выполнить одно из следующих действий.

**Вариант 1.** Все экземпляры служб Reporting Services следует настроить с одной и той же учетной записью домена для учетной записи службы.

**Вариант 2.** Каждой отдельной учетной записи службы, учетная это запись домена или нет, должны быть предоставлены разрешения dbadmin в экземпляре базы данных SQL Server, на котором размещается база данных каталога сервера отчетов.

Если вы настроили другую конфигурацию, отличную от перечисленных выше, при изменении задач с помощью агента SQL могут возникать временные сбои. Они будут отображаться как ошибки в журнале служб Reporting Services и на веб-портале при редактировании подписки на отчет.

```
An error occurred within the report server database.  This may be due to a connection failure, timeout or low disk condition within the database.
``` 

Проблема будет возникать периодически, поскольку только сервер, создавший задачу агента SQL, будет иметь права на просмотр, удаление или изменение элемента. Если не выполнить ни одно из перечисленных выше действий, операция будет выполняться успешно только тогда, когда подсистема балансировки нагрузки отправит все запросы для этой подписки на сервер, который создал задачу агента SQL Server. 
  
## <a name="to-install-the-first-report-server-instance"></a>Установка первого экземпляра сервера отчетов  
  
1.  Установите первый экземпляр сервера отчетов, входящий в развертывание. При установке служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]на странице параметров установки сервера отчетов выберите **Установить, но не настраивать сервер** .  
  
2.  Запустите программу настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .  
  
3.  Настройте URL-адрес веб-службы сервера отчетов, URL-адрес веб-портала и базу данных сервера отчетов. Дополнительные сведения см. в статье [Настройка сервера отчетов &#40;службы Reporting Services в собственном режиме&#41;](../../reporting-services/report-server/configure-a-report-server-reporting-services-native-mode.md).
  
4.  Убедитесь, что сервер отчетов находится в рабочем состоянии. Дополнительные сведения см. в разделе [Verify a Reporting Services Installation](../../reporting-services/install-windows/verify-a-reporting-services-installation.md).  
  
## <a name="to-install-and-configure-the-second-report-server-instance"></a>Установка и настройка второго экземпляра сервера отчетов  
  
1.  Запустите программу установки, чтобы установить второй экземпляр служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] на другом компьютере или в качестве именованного экземпляра на том же компьютере. При установке служб Reporting Services на странице параметров установки сервера отчетов выберите **Установить, но не настраивать сервер** .  
  
2.  Запустите программу настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и подключитесь к только что установленному экземпляру серверу отчетов.  
  
3.  Подключите сервер отчетов к той же базе данных, что была использована для первого экземпляра сервера отчетов.  
  
    1.  Нажмите кнопку **База данных** , чтобы открыть страницу базы данных.  
  
    2.  Нажмите кнопку **Изменить базу данных**.  
  
    3.  Нажмите кнопку **Выбрать существующую базу данных сервера отчетов**.  
  
    4.  Введите имя сервера для экземпляра компонента SQL Server Database Engine, на котором расположена необходимая база данных сервера отчетов. Это должен быть тот же сервер, к которому производилось подключение в предыдущем наборе инструкций.  
  
    5.  Нажмите кнопку **Проверить соединение**, а затем **Далее**.  
  
    6.  В поле **База данных сервера отчетов**выберите базу данных, созданную для первого сервера отчетов, и нажмите кнопку **Далее**. По умолчанию это база данных с именем ReportServer. Не выбирайте ReportServerTempDB. Эта база данных используется только для хранения временных данных при обработке отчетов. Если список баз данных пуст, повторите предыдущие четыре шага, чтобы установить соединение с сервером.  
  
    7.  На странице учетных данных выберите тип учетной записи и укажите учетные данные, которые сервер отчетов будет использовать для подключения к базе данных сервера отчетов. Можно использовать те же учетные данные, что и для первого экземпляра сервера отчета, или задать новые. Выберите **Далее**.  
  
    8.  Выберите **Сводка** , а затем **Готово**.  
  
4.  Настройте **URL-адрес веб-службы**сервера отчетов. На данном этапе не выполняйте проверку URL-адреса. URL-адрес не сработает, пока сервер отчетов не будет объединен в масштабное развертывание.  
  
5.  Настройка **URL-адрес веб-портала**. На данном этапе не выполняйте проверку URL-адреса и не пытайтесь проверить развертывание. До присоединения к масштабному развертыванию сервер отчетов будет оставаться недоступным.  
  
## <a name="to-join-the-second-report-server-instance-to-the-scale-out-deployment"></a>Включение в масштабное развертывание второго экземпляра сервера отчетов  
  
1.  Запустите программу настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и повторно подключитесь к первому экземпляру сервера отчетов. Поскольку этот экземпляр уже инициализирован для операций обратимого шифрования, с его помощью к масштабному развертыванию будут присоединяться дополнительные экземпляры сервера отчетов.  
  
2.  Выберите пункт **Масштабное развертывание** , чтобы открыть страницу "Масштабное развертывание". Здесь должны отображаться две записи: по одной для каждого экземпляра сервера отчетов, подключенного к базе данных сервера отчетов. Первый экземпляр сервера отчетов должен быть присоединен. Второй экземпляр сервера отчетов должен быть в состоянии «Ожидание соединения». Если в развертывании подобные записи не отображаются, проверьте соединение с первым сервером отчетов, который должен быть настроен и инициализирован для использования базы данных сервера отчетов.  
  
     ![Частичный снимок экрана страницы "Масштабное развертывание"](../../reporting-services/install-windows/media/scaloutscreen.gif "Частичный снимок экрана страницы "Масштабное развертывание"")  
  
3.  На странице "Масштабное развертывание" выберите экземпляр сервера отчетов, ожидающий соединения с развертыванием, и выберите пункт **Добавить сервер**.  
  
    > [!NOTE]  
    >  **Проблема**. При попытке присоединить экземпляр сервера отчетов Reporting Services к масштабируемому развертыванию могут возникать сообщения об ошибках вида "Отказано в доступе".  
    >   
    >  **Обходное решение.** Создайте резервную копию ключа шифрования [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] из первого экземпляра [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и восстановите его на второй сервер отчетов [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Затем попытайтесь включить в масштабное развертывание [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] второй экземпляр сервера отчетов.  
  
4.  Теперь оба экземпляра сервера отчетов можно проверить, чтобы убедиться в их рабочем состоянии. Чтобы проверить второй экземпляр, можно при помощи программы настройки служб Reporting Services подключиться к серверу отчетов и щелкнуть **URL-адрес веб-службы** или **URL-адрес диспетчера отчетов**.  
  
 Если серверы отчетов планируется запускать в кластере со сбалансированной нагрузкой, необходима дополнительная настройка. Дополнительные сведения см. в статье [настроить сервер отчетов в кластере с балансированием сетевой нагрузки](../../reporting-services/report-server/configure-a-report-server-on-a-network-load-balancing-cluster.md).  

## <a name="next-steps"></a>Дальнейшие шаги

[Настройка учетной записи службы](configure-the-report-server-service-account-ssrs-configuration-manager.md)
[Настройка URL-адреса](../../reporting-services/install-windows/configure-a-url-ssrs-configuration-manager.md)   
[Создание базы данных сервера отчетов, работающего в собственном режиме](../../reporting-services/install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md)   
[Настройка URL-адресов сервера отчетов](../../reporting-services/install-windows/configure-report-server-urls-ssrs-configuration-manager.md)   
[Настройка подключения к базе данных сервера отчетов](../../reporting-services/install-windows/configure-a-report-server-database-connection-ssrs-configuration-manager.md)   
[Добавление и удаление ключей шифрования для масштабного развертывания](../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md)   
[Управление сервером отчетов Reporting Services в собственном режиме](../../reporting-services/report-server/manage-a-reporting-services-native-mode-report-server.md)  

Остались вопросы? [Посетите форум служб Reporting Services](https://go.microsoft.com/fwlink/?LinkId=620231).
