---
title: Параметры электронной почты — собственный режим SSRS (диспетчер конфигураций) | Документация Майкрософт
description: Службы SQL Server Reporting Services включают модуль доставки по электронной почте, позволяющий распространять отчеты с помощью электронной почты.
ms.date: 12/04/2019
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.custom: seo-lt-2019, seo-mmd-2019
ms.topic: conceptual
f1_keywords:
- SQL13.rsconfigtool.emailsettings.F1
helpviewer_keywords:
- SQL11.rsconfigtool.emailsettings.F1
ms.assetid: cdad1529-bfa6-41fb-9863-d9ff1b802577
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 71c58ed673834c0226f9998b80fa4b12f14538e0
ms.sourcegitcommit: 783b35f6478006d654491cb52f6edf108acf2482
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91892084"
---
# <a name="e-mail-settings---reporting-services-native-mode-configuration-manager"></a>Настройки электронной почты — основной режим служб Reporting Services (диспетчер конфигураций)
Службы SQL Server Reporting Services включают модуль доставки по электронной почте, позволяющий распространять отчеты с помощью электронной почты. В зависимости от того, каким образом определена электронная подписка, рассылка может включать уведомление, ссылку, вложение или внедренный отчет. Модуль доставки по электронной почте работает с существующими технологиями почтовых серверов. Почтовый сервер должен быть либо SMTP-сервером, либо перенаправителем. Сервер отчетов соединяется с SMTP-сервером через объекты данных совместной работы (библиотека cdosys.dll), предоставляемых операционной системой.

Модуль доставки электронной почты сервера отчетов не настроен по умолчанию. Для минимальной настройки модуля следует воспользоваться диспетчером конфигурации сервера отчетов. Чтобы указать дополнительные настройки, необходимо изменить файл конфигурации RSReportServer.config. Если нельзя настроить сервер отчетов на использование этого модуля, то вместо этого можно доставлять отчеты в общую папку. Дополнительные сведения см. в статье "Доставка в общую папку в службах Reporting Services".

## <a name="configuration-requirements"></a>Требования к конфигурации

- Доставка сервером отчетов по электронной почте реализована на основе объектов данных совместной работы и требует локального или удаленного SMTP-сервера или перенаправителя. Протокол SMTP поддерживается не для всех операционных систем Windows. В частности, он не поддерживается в выпуске Windows Server 2008 для платформы Itanium. Дополнительные сведения о параметрах конфигурации, предоставляемых объектами CDO, см. в MSDN, в статье [CoClass конфигурации](https://go.microsoft.com/fwlink/?LinkId=98237) .

Настроенная учетная запись проверки подлинности должна иметь разрешение на отправку почты через SMTP-сервер.

- Модуль доставки по электронной почте использует во вложениях электронной почты кодировку UTF-8. Она не может быть изменена: модуль подготовки HTML поддерживает только UTF-8.

> [!NOTE] 
> Модуль доставки по электронной почте по умолчанию не поддерживает цифровые подписи или шифрование в исходящих сообщениях почты.

## <a name="setting-configuration-options-for-e-mail-delivery"></a>Установка параметров конфигурации для работы с электронной почтой
Прежде чем будет можно использовать рассылку сервера отчетов по электронной почте, следует установить значения конфигурации, указывающие, какой SMTP-сервер использовать.

Для настройки сервера отчетов для доставки электронной почты выполните следующие действия:

- Воспользуйтесь диспетчером конфигурации сервера отчетов, если вы задаете SMTP-сервер и учетную запись, имеющую разрешение на отправку сообщений электронной почты. Это минимальные установки, необходимые для настройки модуля доставки электронной почты сервера отчетов.

- С помощью текстового редактора укажите дополнительные параметры в файле конфигурации RSreportserver.config (необязательно). Этот файл содержит все параметры конфигурации доставки отчетов по электронной почте. Задание дополнительных установок в этих файлах необходимо, если используется локальный SMTP-сервер или если доставка сообщений электронной почты ограничивается определенными узлами. Дополнительные сведения о местоположении и изменении файлов конфигурации см. в статье [Изменение файла конфигурации служб Reporting Services (RSreportserver.config)](../../reporting-services/report-server/modify-a-reporting-services-configuration-file-rsreportserver-config.md).

> [!NOTE] 
> Параметры электронной почты сервера отчетов основаны на объектах CDO. Если необходимы дальнейшие подробности о конкретных параметрах, можно обратиться к документации по приложениям CDO.

## <a name="configure-report-server-e-mail-using-the-report-server-configuration-manager"></a><a name="rsconfigman"/>Настройка электронной почты сервера отчетов с помощью диспетчера конфигурации сервера отчетов

1. Запустите диспетчер конфигурации сервера отчетов и подключитесь к экземпляру сервера отчетов.

2. В поле **Адрес отправителя**введите адрес электронной почты для поля **От:** создаваемого сообщения. 

     Необходимо указать учетную запись, имеющую разрешение на передачу почтовых сообщений из SMTP-сервера. Значение, введенное для параметра **Адрес отправителя** , сохраняется в поле `<From>` файла rsreportserver.config.  

3.  В поле **Исходящий SMTP-сервер**укажите используемый SMTP-сервер или шлюз. 

     Это значение может быть IP-адресом, NetBIOS-именем компьютера в корпоративной сети или полным доменным именем. Значение, введенное для параметра **SMTP-сервер** , сохраняется в поле `<SMTPServer>` файла rsreportserver.config.

4. В раскрывающемся списке **Проверка подлинности** укажите метод проверки подлинности SMTP-сервера. Это 

     - **Без проверки подлинности** означает, что анонимное подключение к указанному почтовому серверу невозможно.
     
          При выборе этого параметра `<SendUsing>` в файле rsreportserver.config принимает значение **2** , а `<SMTPAuthenticate>` — значение **0** .
     
     - **Имя пользователя и пароль (базовый)** позволяет указать имя пользователя и пароль для подключения к почтовому серверу. Для того чтобы использовать зашифрованное подключение к почтовому серверу, можно применить параметр **Использовать безопасное соединение** .
     
          При выборе этого параметра `<SendUsing>` в файле rsreportserver.config принимает значение **2** , а `<SMTPAuthenticate>` — значение **1** . При выборе параметра **Использовать безопасное подключение**`SMTPUseSSL` принимает значение **True**. **Имя пользователя** в `<SendUserName>` становится шифруемым значением. **Пароль** в `<SendPassword>` становится шифруемым значением.
     
     - **Учетная запись службы сервера отчетов (NTLM)** будет использовать учетную запись службы, указанную для сервера отчетов. При использовании учетной записи службы сервера отчетов для проверки подлинности убедитесь, что учетная запись службы имеет разрешение **Send As** на SMTP-сервере.
     
          При выборе этого параметра `<SendUsing>` в файле rsreportserver.config принимает значение **2** , а `<SMTPAuthenticate>` — значение **2** .

5. Нажмите кнопку **Применить**.

6. При необходимости в файле rsreportserver.config можно настроить дополнительные поля для настройки электронной почты.

## <a name="example-report-server-e-mail-configuration"></a>Образец конфигурации электронной почты сервера отчетов
В следующем примере иллюстрируются параметры файла RSreportserver.config для удаленного SMTP-сервера. Описания параметров и их допустимых значений см. в статье [Файл конфигурации RsReportServer.config](../../reporting-services/report-server/rsreportserver-config-configuration-file.md).

```
<RSEmailDPConfiguration>
     <SMTPServer>mySMTPServer.Adventure-Works.com</SMTPServer>
     <SMTPServerPort></SMTPServerPort>
     <SMTPAccountName></SMTPAccountName>
     <SMTPConnectionTimeout></SMTPConnectionTimeout>
     <SMTPServerPickupDirectory></SMTPServerPickupDirectory>
     <SMTPUseSSL>False</SMTPUseSSL>
     <SendUsing>2</SendUsing>
     <SMTPAuthenticate>2</SMTPAuthenticate>
     <From>my-rs-email-account@Adventure-Works.com</From>
     <EmbeddedRenderFormats>
          <RenderingExtension>MHTML</RenderingExtension>
     </EmbeddedRenderFormats>
     <PrivilegedUserRenderFormats></PrivilegedUserRenderFormats>
     <ExcludedRenderFormats>
          <RenderingExtension>HTMLOWC</RenderingExtension>
          <RenderingExtension>NULL</RenderingExtension>
          <RenderingExtension>RGDI</RenderingExtension>
     </ExcludedRenderFormats>
     <SendEmailToUserAlias>True</SendEmailToUserAlias>
     <DefaultHostName></DefaultHostName>
     <PermittedHosts>
          <HostName>Adventure-Works.com</HostName>
          <HostName>hotmail.com</HostName>
     </PermittedHosts>
     <SendUserName></SendUserName>
     <SendPassword></SendPassword>
</RSEmailDPConfiguration>
```
## <a name="configuration-options-for-setting-the-to-field-in-a-message"></a>Параметры конфигурации для настройки поля "Кому" в сообщении
Определяемые пользователем подписки, которые создаются в соответствии с разрешениями, предоставленными задачей "Управление отдельными подписками", содержат предварительно заданное имя пользователя, которое основано на учетной записи пользователя домена. Когда пользователь создает подписку, имя получателя в поле **Кому:** подставляется автоматически; используется учетная запись пользователя домена, создающего подписку.

Если использовать SMTP-сервер или перенаправитель, который использует учетные записи электронной почты, отличающиеся от учетной записи пользователя домена, то во время доставки отчета произойдет ошибка, когда SMTP-сервер попытается доставить отчет этому пользователю.

Чтобы обойти эту проблему, можно изменить настройки конфигурации так, чтобы пользователь мог ввести имя в поле **Кому:**

1. Откройте файл RSReportServer.config в текстовом редакторе.

2. Присвойте `<SendEmailToUserAlias>` значение **False**.

3. Установите параметр `<DefaultHostName>` в DNS-имя или IP-адрес SMTP-сервера или перенаправителя.

4. Сохраните файл.

## <a name="configuration-options-for-remote-smtp-service"></a>Параметры конфигурации для удаленной службы SMTP
Соединение между сервером отчетов и локальным SMTP-сервером или перенаправителем определяется следующими параметрами конфигурации:

- `<SendUsing>` указывает метод отправки сообщений. Возможен выбор между сетевой службой SMTP или локальным каталогом сбора службы SMTP. Чтобы использовать удаленную SMTP-службу, этому параметру в файле конфигурации RSReportServer.config должно быть присвоено значение **2** .
- `<SMTPServer>` указывает удаленный сервер или перенаправитель SMTP. Это значение обязательное, если нужно использовать удаленный сервер или перенаправитель SMTP.
- `<From>` задает значение, которое появляется на строке **От:** сообщения электронной почты. Это значение обязательное, если нужно использовать удаленный сервер или перенаправитель SMTP.

Другие значения, которые используются для удаленной службы SMTP, включают следующее (обратите внимание, что указывать их необязательно, если не нужно заменять ими значения по умолчанию).

- `<SMTPServerPort>` по умолчанию использует порт 25.
- `<SMTPAuthenticate>` указывает, как сервер отчетов подключается к удаленному SMTP-серверу. Значение по умолчанию равно **0** (отсутствие проверки подлинности). В этом случае соединение осуществляется через анонимный доступ. Может потребоваться, чтобы сервер отчетов и SMTP-сервер были элементами одного домена (в зависимости от конфигурации домена).
- Для отправки электронной почты в списки рассылки с ограничениями (например, в списки рассылки, принимающие входящие сообщения только от учетных записей, прошедших проверку подлинности) установите значение `<SMTPAuthenticate>` равным **1** или **2**. При выборе значения **1**необходимо также задать `<SendUserName>` и `<SendPassword>`. Для этого рекомендуется использовать диспетчер конфигурации сервера отчетов, который зашифрует значения `<SendUserName>` и `<SendPassword>`.

### <a name="to-configure-a-remote-smtp-service-for-the-report-server"></a>Настройка удаленной службы SMTP для сервера отчетов

> [!NOTE] 
> Почтовый сервер рекомендуется настраивать через диспетчер конфигурации сервера отчетов.

1. Убедитесь, что у службы Windows сервера отчетов есть разрешения **Send As** на SMTP-сервере.

2. Откройте файл RSReportServer.config в текстовом редакторе.

3. Убедитесь, что параметр `<UrlRoot>` настроен на URL-адрес сервера отчетов. Это значение устанавливается при настройке сервера отчетов так, что оно должно быть уже заполнено. Если оно не установлено, введите URL-адрес сервера отчетов.

4. В разделе Delivery найдите параметр `<RSEmailDPConfiguration>`.
     
5. В поле `<SMTPServer>`введите имя SMTP-сервера. Это значение может быть IP-адресом, UNC-именем компьютера в корпоративной сети или полным доменным именем.

6. Чтобы использовать учетную запись службы для сервера отчетов, присвойте параметру `<SendUsing>` значение **2** . Чтобы использовать обычную проверку подлинности, присвойте параметру `<SendUsing>` значение **1** . При выборе значения **1**необходимо также указать значения для параметров `<SendUserName>` и `<SendPassword>`. Если эти значения необходимо шифровать, задайте способ проверки подлинности в диспетчере конфигурации сервера отчетов.

7. Присвойте параметру `<SMTPAuthenticate>` значение **1** , если `<SendUsing>` имеет значение 1 или 2.

7. Задайте `<From>`. Необходимо указать учетную запись, имеющую разрешение на передачу почтовых сообщений из SMTP-сервера.

8. Сохраните файл.

     Сервер отчетов автоматически будет использовать новые настройки; нет необходимости перезапускать службу. Можно указать дополнительные настройки SMTP для последующей конфигурации использования SMTP-сервера для доставки электронной почты на сервер отчетов.

## <a name="configuration-options-for-local-smtp-service"></a>Параметры конфигурации для локальной службы SMTP
Настройка локальной службы SMTP полезна при тестировании или диагностике работы с электронной почтой сервера отчетов. Локальная служба SMTP по умолчанию отключена.

Соединение между сервером отчетов и локальным сервером или перенаправителем SMTP определяется следующими параметрами конфигурации:

- Значение**SendUsing** равно **1**.
- В качестве значения**SMTPServerPickupDirectory** указана папка на локальном жестком диске.

  > [!NOTE] 
  > Убедитесь, что не присвоили значения параметру SMTPServer, если пользуетесь локальным SMTP-сервером.

- Поле**От** задает значение, которое появляется на строке **От:** сообщения электронной почты. Это значение обязательно.

### <a name="to-configure-a-local-smtp-service-for-the-report-server"></a>Настройка локальной службы SMTP для сервера отчетов

1. На панели управления выберите **Включение или отключение компонентов Windows** и запустите **Мастер добавления ролей и компонентов**.

2. Выберите пункт **Установка ролей или компонентов** и нажмите кнопку **Далее**.

3. Выберите сервер для установки Internet Information Server (IIS) и нажмите кнопку **Далее**.

4. Нажмите кнопку **Далее** на странице *Роли сервера*.
     
5. На странице *Компоненты* выберите **SMTP-сервер** и нажмите кнопку **Далее**.

     Если система предложит вам добавить компоненты, необходимые для SMTP-сервера, выберите **Добавить компоненты**.

6. Нажмите кнопку **Далее** на странице *Роль веб-сервера (IIS)* .

7. Нажмите кнопку **Далее** на странице *Службы ролей* .

8. Нажмите кнопку **Установка** на странице **Подтверждение** .

9. Убедитесь, что служба Windows **Simple Mail Transfer Protocol (SMTP)** запущена в консоли "Службы".

     Для настройки локального SMTP-сервера необходимо использовать диспетчер IIS 6.0 в разделе "Средства администрирования".

10. Откройте файл RSReportServer.config в текстовом редакторе.

11. Убедитесь, что параметр `<UrlRoot>` настроен на URL-адрес сервера отчетов. Это значение устанавливается при настройке сервера отчетов так, что оно должно быть уже заполнено. Если оно не указано, введите URL-адрес веб-службы для сервера отчетов.

12. В разделе Delivery найдите параметр `<RSEmailDPConfiguration>`.
     
13. Убедитесь, что параметр `<SMTPServer>` присутствует, но не задан.
     
14. Присвойте параметру `<SendUsing>` значение 1.
     
14. Присвойте параметру `<SMTPAuthenticate>` значение 0.
     
15. В качестве `<SMTPServerPickupDirectory>` задайте папку сбора SMTP-службы.
     
     По умолчанию используется расположение *C:\inetpub\mailroot\Pickup*.
     
16. Задайте `<From>`. Он определяет значение, которое будет отображаться в строке **От:** сообщения электронной почты.
     
17. Сохраните файл.
  
## <a name="see-also"></a>См. также:  
[Диспетчер конфигураций сервера отчетов (собственный режим)](../../reporting-services/install-windows/reporting-services-configuration-manager-native-mode.md)  
[Modify a Reporting Services Configuration File (rsreportserver.config)](../../reporting-services/report-server/modify-a-reporting-services-configuration-file-rsreportserver-config.md)  
[Файл конфигурации rsreportserver.config](../../reporting-services/report-server/rsreportserver-config-configuration-file.md)
  
  
