---
title: Тип соединения SQL Server | Документация Майкрософт
description: Сведения о типе подключения SQL Server и включении данных из базы данных SQL Server в отчет.
ms.date: 08/17/2018
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-data
ms.topic: conceptual
ms.assetid: 957e7091-e08f-48d2-9506-872227ae8b20
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 347ad41fb6165b3ab9364ee799aac3d3629ee78a
ms.sourcegitcommit: fe59f8dc27fd633f5dfce54519d6f5dcea577f56
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91935471"
---
# <a name="sql-server-connection-type-ssrs"></a>Тип соединения SQL Server (службы SSRS)
  Чтобы включить в отчет данные из базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], необходимо иметь набор данных, основанный на источнике данных [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Этот встроенный тип источника данных основан на модуле обработки данных [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Используйте этот тип источника данных для соединения и извлечения данных из баз данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] текущей версии и более ранних версий.  
  
 Этот модуль обработки данных поддерживает многозначные параметры, серверные агрегатные вычисления и учетные данные, управляемые отдельно с помощью строки подключения.  
  
 Используйте сведения в этом разделе для создания источника данных. Пошаговые инструкции см. в разделе [Добавление и проверка подключения к данным (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md).  
  
##  <a name="connection-string"></a><a name="Connection"></a> Строка подключения  
 При соединении с базой данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] выполняется соединение с объектом базы данных в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на сервере. В базе данных может быть несколько схем, содержащих несколько таблиц, представлений и хранимых процедур. Необходимо указать объект базы данных для использования в конструкторе запросов. Если в строке соединения не указать базу данных, будет выполнено соединение с базой данных по умолчанию, заданной администратором баз данных для данного пользователя.  
  
 Данные для строки соединения и учетные данные для подключения к источнику данных можно получить у администратора базы данных. Ниже приведен пример строки соединения для образца базы данных на локальном клиенте.  
  
```  
Data Source=<server>;Initial Catalog=AdventureWorks  
```  
  
 Дополнительные сведения о примерах строк подключения вы найдете в статье [Подключения к данным, источники данных и строки подключения (построитель отчетов и службы SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md).  
  
##  <a name="credentials"></a><a name="Credentials"></a> Учетные данные  
 Учетные данные необходимы для запуска запросов, локального предварительного просмотра отчетов, а также для предварительного просмотра отчетов на сервере отчетов.  
  
 После публикации отчета может понадобиться изменить учетные данные источника данных, чтобы разрешения, необходимые для получения данных при запуске отчета на сервере отчетов, были допустимыми.  
  
 Клиент, используемый для создания отчетов, имеет следующие параметры для указания учетных данных.  
  
-   Текущий пользователь Windows (встроенная безопасность).  
  
-   Использовать сохраненные имя пользователя и пароль.  
  
-   Выдавать приглашение пользователю на ввод учетных данных. Этот параметр поддерживает только встроенную безопасность Windows.  
  
-   Учетные данные не требуются. Чтобы использовать этот параметр, необходима учетная запись автоматического выполнения, настроенная на сервере отчетов. Дополнительные сведения см. в статье [Настройка учетной записи автоматического выполнения (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md). 
  
 См. сведения о [создании строк подключения к данным (построитель отчетов и SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md) и [определении учетных данных и сведений о подключении для источников данных отчета](specify-credential-and-connection-information-for-report-data-sources.md).  
  
  
##  <a name="queries"></a><a name="Query"></a> Запросы  
 Запрос указывает, какие данные для набора данных отчета необходимо получить. Столбцы результирующего набора запроса заполняют коллекцию полей набора данных. Отчет обрабатывает только первый результирующий набор, полученный запросом.  
  
 По умолчанию при создании нового запроса или открытии существующего запроса, который может быть представлен в графическом конструкторе запросов, предоставляется доступ к конструктору реляционных запросов. Запрос можно задавать следующими способами.  
  
-   Интерактивное построение отчета. Используйте конструктор реляционных запросов, отображающий иерархическое представление таблиц, представлений, хранимых процедур и других элементов базы данных, упорядоченных схемой базы данных. Выберите столбцы из таблиц или представлений либо укажите хранимые процедуры или возвращающие табличное значение функции. Ограничьте число получаемых строк данных при помощи условия фильтра. При запуске отчета фильтр можно настроить, указав для него параметры.  
  
-   Ввод или вставка запроса. С помощью текстового конструктора запросов можно напрямую вводить текст запроса на языке [!INCLUDE[tsql](../../includes/tsql-md.md)] , вставлять его из других источников, вводить сложные запросы, которые нельзя построить с помощью конструктора реляционных запросов, а также вводить выражения на основе запросов.  
  
-   Импорт существующего запроса из файла или отчета. Используйте кнопку **Импорт запроса** конструктора запросов, чтобы найти файл с расширением SQL или RDL и импортировать запрос из него.  
  
 Дополнительные сведения см. в разделах [Пользовательский интерфейс конструктора реляционных запросов (построитель отчетов)](../../reporting-services/report-data/relational-query-designer-user-interface-report-builder.md) и [Пользовательский интерфейс текстового конструктора запросов (построитель отчетов)](../../reporting-services/report-data/text-based-query-designer-user-interface-report-builder.md).  
  
 Поддерживаются следующие режимы запросов.  
  
-   [Текст.](#QueryText) Введите команды [!INCLUDE[tsql](../../includes/tsql-md.md)] .  
  
-   [Хранимая процедура.](#QueryStoredProcedure) Выберите из списка хранимых процедур.  
  
###  <a name="using-query-type-text"></a><a name="QueryText"></a> Использование типа запроса Text  
 В текстовом конструкторе запросов можно вводить команды на языке [!INCLUDE[tsql](../../includes/tsql-md.md)] , определяющие данные в наборе данных. Например, следующий запрос на языке [!INCLUDE[tsql](../../includes/tsql-md.md)] выбирает имена всех сотрудников отдела сбыта.  
  
```  
SELECT  
  HumanResources.Employee.BusinessEntityID  
  ,HumanResources.Employee.JobTitle  
  ,Person.Person.FirstName  
  ,Person.Person.LastName  
FROM  
  Person.Person  
  INNER JOIN HumanResources.Employee  
    ON Person.Person.BusinessEntityID = HumanResources.Employee.BusinessEntityID  
WHERE HumanResources.Employee.JobTitle = 'Marketing Assistant'   
```  
  
 Нажмите кнопку **Выполнить** ( **!** ) на панели инструментов, чтобы выполнить запрос и отобразить результирующий набор.  
  
 Для параметризации этого запроса добавьте в него параметр. Например, измените предложение WHERE следующим образом:  
  
 `WHERE HumanResources.Employee.JobTitle = (@JobTitle)`  
  
 После запуска запроса параметры отчета, соответствующие параметрам запроса, создаются автоматически. Дополнительные сведения см. в подразделе [Параметры запроса](#Parameters) далее в этом разделе.  
  
  
###  <a name="using-query-type-storedprocedure"></a><a name="QueryStoredProcedure"></a> Использование типа запроса StoredProcedure  
 Указать хранимую процедуру для набора данных запроса можно одним из следующих способов.  
  
-   В диалоговом окне **Свойства набора данных** задать параметр **Хранимая процедура** . Выбрать из раскрывающегося списка хранимых процедур и возвращающих табличное значение функций.  
  
-   В конструкторе реляционных запросов в панели представления базы данных выбрать хранимую процедуру или возвращающую табличное значение функцию.  
  
-   В текстовом конструкторе запросов выбрать элемент **Хранимая процедуру** на панели инструментов.  
  
 После выбора хранимой процедуры или возвращающей табличное значение функции можно запустить запрос. Появится подсказка ввести значения входных параметров. После запуска запроса параметры отчета, соответствующие входным параметрам, создаются автоматически. Дополнительные сведения см. в подразделе [Параметры запроса](#Parameters) далее в этом разделе.  
  
 Поддерживается только первый результирующий набор, получаемый хранимой процедурой. Если хранимая процедура возвращает несколько результирующих наборов, используется только первый из них.  
  
 Если у хранимой процедуры есть параметр со значением по умолчанию, доступ к этому значению можно получить с помощью ключевого слова DEFAULT в качестве значения параметра. Если параметр запроса связан с параметром отчета, пользователь может ввести или выбрать слово DEFAULT в поле ввода параметра отчета.  
  
 Дополнительные сведения см. в разделе [Хранимые процедуры (ядро СУБД)](../../relational-databases/stored-procedures/stored-procedures-database-engine.md).  
  
  
##  <a name="parameters"></a><a name="Parameters"></a> Параметры  
 Если в тексте запроса содержатся переменные запроса или хранимые процедуры с входными параметрами, автоматически создаются соответствующие параметры запроса для набора данных и параметры отчета. Текст запроса не должен включать инструкцию DECLARE для всех переменных запроса.  
  
 Например, следующий SQL-запрос создает параметр отчета с именем **EmpID**.  
  
```  
SELECT FirstName, LastName FROM HumanResources.Employee E INNER JOIN  
       Person.Contact C ON  E.ContactID=C.ContactID   
WHERE EmployeeID = (@EmpID)  
```  
  
 Параметры отчета создаются со значениями свойств по умолчанию, которые, возможно, потребуется изменить. Пример:  
  
-   По умолчанию все параметры отчета имеют тип данных **Текст**. Если базовые данные имеют другой тип, необходимо изменить тип данных параметра.  
  
-   При выборе настройки для многозначных параметров необходимо вручную изменить запрос для проверки того, являются ли значения частью набора, с помощью оператора **IN** , например `WHERE EmployeeID IN (@EmpID)`.  
  
 Дополнительные сведения см. в разделе [Параметры отчета (построитель отчетов и конструктор отчетов)](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md).  
  
  
##  <a name="remarks"></a><a name="Remarks"></a> Замечания  
 Также данные из базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] можно получить с помощью источника данных OLE DB или ODBC. Дополнительные сведения см. в разделе [Тип подключения к OLE DB (службы SSRS)](../../reporting-services/report-data/ole-db-connection-type-ssrs.md) или [Тип подключения к ODBC (службы SSRS)](../../reporting-services/report-data/odbc-connection-type-ssrs.md).  
  
###### <a name="platform-and-version-information"></a>Сведения о платформе и версии  
 Дополнительные сведения о поддержке платформ и версий см. в статье [Источники данных, поддерживаемые службами Reporting Services (SSRS)](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md).  
  
  
##  <a name="how-to-topics"></a><a name="HowTo"></a> Инструкции  
 В этом разделе содержатся пошаговые инструкции по работе с подключениями к данным, источниками данных и наборами данных.  
  
 [Добавление и проверка подключения к данным (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)  
  
 [Создание общего или внедренного набора данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md)  
  
 [Добавление фильтра к набору данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-a-filter-to-a-dataset-report-builder-and-ssrs.md)  
  
  
##  <a name="related-sections"></a><a name="Related"></a> См. также  
 В этих разделах документации содержатся подробные сведения о данных отчетов, а также методические сведения об определении, настройке и использовании элементов отчетов, связанных с данными.  
  
 [Наборы данных отчетов (службы SSRS)](../../reporting-services/report-data/report-datasets-ssrs.md)  
 Предоставляет общие сведения о доступе к данным отчета.  
  
 [Создание строк подключения к данным (построитель отчетов и SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)  
 Предоставляет сведения о подключениях к данным и источникам данных.  
  
 [Внедренные и общие наборы данных отчета (построитель отчетов и службы SSRS)](../../reporting-services/report-data/report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)  
 Предоставляет сведения об общих и внедренных наборах данных.  
  
 [Коллекция полей набора данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/dataset-fields-collection-report-builder-and-ssrs.md)  
 Предоставляет сведения о коллекции полей набора данных, создаваемой запросом.  
  
 [Источники данных, поддерживаемые службами Reporting Services &#40;SSRS&#41;](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md).  
 Предоставляет подробные сведения о поддержке платформ и версий для каждого модуля обработки данных.  
  
  
## <a name="see-also"></a>См. также:  
 [Параметры отчета (построитель отчетов и конструктор отчетов)](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md)   
 [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md)   
 [Выражения (построитель отчетов и службы SSRS)](../../reporting-services/report-design/expressions-report-builder-and-ssrs.md)  
  
  
