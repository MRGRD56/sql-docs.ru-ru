---
title: Тип соединения список SharePoint | Документация Майкрософт
description: В этой статье о типе соединения "Список SharePoint" вы узнаете, как создать источник данных.
ms.date: 05/10/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-data
ms.topic: conceptual
ms.assetid: 2c4adf2f-e9c4-4fae-bd3c-97fe64436caf
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 7bb6380e168c1e4bddefab539354d80bf14805c6
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100033484"
---
# <a name="sharepoint-list-connection-type-ssrs"></a>Тип соединения список SharePoint (службы SSRS)

[!INCLUDE[ssrs-appliesto-sql2016-preview](../../includes/ssrs-appliesto-sql2016-preview.md)] [!INCLUDE [ssrs-appliesto-sharepoint-2013-2016](../../includes/ssrs-appliesto-sharepoint-2013-2016.md)]

Для включения данных из списка Microsoft SharePoint в отчет следует добавить или создать набор данных, основанный на источнике данных отчета типа «Список Microsoft SharePoint». Это встроенный тип источника данных, основанный на модуле обработки данных «Список SharePoint служб Microsoft SQL Server Reporting Services». Используйте этот тип источника данных для подключения к данным в списках и их извлечения из SharePoint 2013 и более поздних версий.

Используйте сведения в этом разделе для создания источника данных. Пошаговые инструкции см. в разделе [Добавление и проверка подключения к данным (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md).  

##  <a name="connection-string"></a><a name="Connection"></a> Строка подключения  
 Строка подключения к списку SharePoint — это URL-адрес сайта или дочернего сайта SharePoint, например `https://MySharePointWeb/MySharePointSite` или `https://MySharePointWeb/MySharePointSite/Subsite`.  
  
 Конструктор запросов автоматически отображает списки SharePoint, для доступа к которым имеются достаточные разрешения.  
  
 Дополнительные примеры строк подключения см. в статье [Подключения к данным, источники данных и строки подключения (построитель отчетов и службы SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md).  
  
##  <a name="credentials"></a><a name="Credentials"></a> Учетные данные  
 Учетные данные необходимы для запуска запросов, локального предварительного просмотра отчетов, а также для предварительного просмотра отчетов на сервере отчетов. После публикации отчета может понадобиться изменить учетные данные источника данных, чтобы разрешения, необходимые для получения данных при запуске отчета на сервере отчетов, были допустимыми. Типы учетных данных, которые можно использовать с этим модулем обработки данных, зависят от конфигурации технологии SharePoint для списка SharePoint, который используется в качестве источника данных.  
  
 В следующих таблицах описано получение учетных данных для расширения списка SharePoint при подключении к локальному списку фермы SharePoint и к удаленному списку SharePoint.  
  
 **Таблица 1** предназначена для отчетов, развернутых на устаревшем сайте Windows SharePoint. Устаревший сайт Windows поддерживает только проверку подлинности Kerberos, NTLM и проверку подлинности на основе форм (FBA). **Таблица 2** предназначена для отчетов, развернутых на сайте SharePoint с проверкой подлинности на основе утверждений.  
  
 **Таблица 1**  
  
|Тип извлечения|Поддерживаемые учетные данные|Классический режим проверки подлинности Windows|*Проверка подлинности на основе утверждений|  
|-|---------------------------|-----------------------------------------|-----------------------------|  
|Локальный список фермы SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Да|  
||Хранимые, запрос, нет (с учетными данными Windows<br /><br /> Хранимые учетные данные и учетные данные по запросу не поддерживаются с учетными данными, отличными от Windows.|Да|Нет|  
|Удаленный список SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Нет<br /><br /> Проверка подлинности на основе форм и на основе утверждений не поддерживается для удаленных списков SharePoint.|  
||Хранимые, запрос, нет (с учетными данными Windows<br /><br /> Хранимые учетные данные и учетные данные по запросу не поддерживаются с учетными данными, отличными от Windows.|Да|Нет<br /><br /> Проверка подлинности на основе форм и на основе утверждений не поддерживается для удаленных списков SharePoint.|  
  
 *Проверка подлинности Windows, проверка подлинности на основе форм (FBA), маркеры SAML, другие поставщики удостоверений или сочетание нескольких из упомянутых выше поставщиков проверки подлинности.  
  
 **Таблица 2**  
  
|Тип извлечения|Поддерживаемые учетные данные|Классический режим проверки подлинности Windows|*Проверка подлинности на основе утверждений|  
|-|---------------------------|-----------------------------------------|-----------------------------|  
|Локальный список фермы SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Да|  
||Хранимые, запрос, нет (с учетными данными Windows<br /><br /> Хранимые учетные данные и учетные данные по запросу не поддерживаются с учетными данными, отличными от Windows.|нет|Нет|  
|Удаленный список SharePoint|Проверка подлинности Windows (встроенная) или токен пользователя SharePoint|Да|Нет<br /><br /> Проверка подлинности на основе форм и на основе утверждений не поддерживается для удаленных списков SharePoint.|  
||Хранимые, запрос, нет (с учетными данными Windows<br /><br /> Хранимые учетные данные и учетные данные по запросу не поддерживаются с учетными данными, отличными от Windows.|нет|Нет<br /><br /> Проверка подлинности на основе форм и на основе утверждений не поддерживается для удаленных списков SharePoint.|  
  
 *Проверка подлинности Windows, проверка подлинности на основе форм (FBA), маркеры SAML, другие поставщики удостоверений или сочетание нескольких из упомянутых выше поставщиков проверки подлинности.  
  
 **Проверка подлинности Windows.**  
 Для технологии SharePoint, настроенной для работы с сервером отчетов в режиме «Доверенная учетная запись», этот параметр не поддерживается. Относится только к выпускам до версии служб SQL Server 2012 Reporting Services.

 Для технологии SharePoint, настроенной для работы с сервером отчетов в режиме интеграции с Windows, этот параметр применяется как к текущему пользователю Windows, так и к текущему пользователю SharePoint.
 
 Для технологии SharePoint, настроенной для работы без сервера отчетов (в локальном режиме), этот параметр не поддерживается. Дополнительные сведения о локальном режиме см. в разделе [Отчеты, созданные в локальном и подключенном режиме в средстве просмотра отчетов (службы Reporting Services в режиме интеграции с SharePoint)](../../reporting-services/report-server-sharepoint/local-mode-vs-connected-mode-reports-in-the-report-viewer.md).  
  
 **Учетные данные не требуются (не использовать учетные данные).**  
 Чтобы использовать этот параметр, необходима учетная запись автоматического выполнения, настроенная на сервере отчетов. Дополнительные сведения см. в статье [Настройка учетной записи автоматического выполнения (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).  
  
 Дополнительные сведения о поддержке проверки подлинности на основе утверждений в стеке бизнес-аналитики Майкрософт см. в разделе [Использование проверки подлинности на основе утверждений в стеке бизнес-аналитики Майкрософт](https://social.technet.microsoft.com/wiki/contents/articles/15274.using-claims-authentication-across-the-microsoft-bi-stack.aspx).  
  
 См. подробнее о [создании строк подключенияв построителе отчетов и службах SSRS](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md), [указании учетных данных и сведений о подключении для источников данных отчетов](specify-credential-and-connection-information-for-report-data-sources.md) и [использовании источников данных, поддерживаемых в Reporting Services (SSRS)](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md).  
  
##  <a name="queries"></a><a name="Query"></a> Запросы  
 Чтобы построить запрос, создайте новый набор данных на основе источника данных и откройте связанный конструктор запросов. Дополнительные сведения см. в разделе [Создание общего или внедренного набора данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md).  
  
 Графический конструктор запросов списка SharePoint имеет четыре панели.  
  
 **Списки SharePoint.**  Отображает список всех списков SharePoint на сайте для данного источника данных. Выберите список и поля, которые нужно добавить в запрос. Имена полей на данной панели являются понятными именами SharePoint, которые также называются отображаемыми именами. Наведите курсор мыши на элемент. В подсказке отобразятся следующие свойства.  
  
-   **Имя.** Уникальное имя поля.  
  
-   **Идентификатор.** Уникальный идентификатор поля.  
  
-   **Тип поля.** Тип данных поля.  
  
-   **Скрыто.** Отображается ли поле в представлении списка SharePoint.  
  
 Выбор полей из нескольких списков не поддерживается. Можно создать набор данных для каждого списка и выбирать поля из каждого набора данных. Если списки имеют общее поле, можно использовать функцию уточняющего запроса в области данных табликса, которая привязана к одному набору данных, чтобы получать значение из другого набора данных, который не привязан к области данных. Дополнительные сведения см. в разделе [Функция Lookup &#40;построитель отчетов и службы SSRS&#41;](../../reporting-services/report-design/report-builder-functions-lookup-function.md).  
  
-   **Выбранные поля.**  Отображает выбранные поля. Имена полей на этой панели являются понятными именами SharePoint, которые были указаны пользователем SharePoint. При закрытии конструктора запросов эти имена можно увидеть в наборе полей набора данных в области данных отчета. Связь между уникальными именами и понятными именами см. на странице [Диалоговое окно "Свойства набора данных" — "Поля", &#40;построитель отчетов&#41;](../../reporting-services/report-data/dataset-fields-collection-report-builder-and-ssrs.md).  
  
-   **Примененные фильтры.**  Ограничивает данные, возвращаемые из списка SharePoint, прежде чем вернуть их в отчет. Выберите имя поля, оператор и значение, которые будут использованы для ограничения данных, извлекаемых из списка. Список доступных операторов зависит от выбранного типа данных значения.  
  
     В графическом конструкторе запросов изменять порядок сортировки или указывать группы нельзя. Чтобы сделать это, задайте выражения сортировки в наборе данных отчетов и сгруппируйте выражения в областях данных отчета. Параметры запросов не поддерживаются. Для фильтрации данных в отчете пользуйтесь фильтрами или параметрами отчетов. Дополнительные сведения см. в разделе [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md) и [Параметры отчета (построитель отчетов и конструктор отчетов)](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md).  
  
-   **Результаты запросов.**  Отображает примеры строк, возвращаемых при выполнении запроса. Если значения списка SharePoint часто изменяются на сайте SharePoint, то значения на панели результатов запросов могут отличаться от значений, выводимых в отчете.  
  
-   **Выбранные поля.**  Отображает выбранные поля. Имена полей на этой панели являются понятными именами SharePoint, которые были указаны пользователем SharePoint. При закрытии конструктора запросов эти имена можно увидеть в наборе полей набора данных в области данных отчета. Связь между уникальными именами и понятными именами см. на странице [Диалоговое окно "Свойства набора данных" — "Поля", &#40;построитель отчетов&#41;](../../reporting-services/report-data/dataset-fields-collection-report-builder-and-ssrs.md).  
  
-   **Примененные фильтры.**  Ограничивает данные, возвращаемые из списка SharePoint, прежде чем вернуть их в отчет. Выберите имя поля, оператор и значение, которые будут использованы для ограничения данных, извлекаемых из списка. Список доступных операторов зависит от выбранного типа данных значения.  
  
     В графическом конструкторе запросов изменять порядок сортировки или указывать группы нельзя. Чтобы сделать это, задайте выражения сортировки в наборе данных отчетов и сгруппируйте выражения в областях данных отчета. Параметры запросов не поддерживаются. Для фильтрации данных в отчете пользуйтесь фильтрами или параметрами отчетов. Дополнительные сведения см. в разделе [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md) и [Параметры отчета (построитель отчетов и конструктор отчетов)](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md).  
  
-   **Результаты запросов.**  Отображает примеры строк, возвращаемых при выполнении запроса. Если значения списка SharePoint часто изменяются на сайте SharePoint, то значения на панели результатов запросов могут отличаться от значений, выводимых в отчете.  
  
 Дополнительные сведения см. в разделе [Конструктор запросов к спискам SharePoint &#40;построитель отчетов&#41;](../../reporting-services/report-data/sharepoint-list-query-designer-report-builder.md).  
  
### <a name="query-text"></a>Текст запроса  
 Чтобы просмотреть запрос, созданный с помощью графического конструктора запросов, переключитесь в текстовый конструктор запросов. Здесь можно просмотреть XML-текст, созданный графическим конструктором запросов. XML-код включает элементы для имени списка, набора полей и фильтров.  
  
#### <a name="example-1-specified-fields-for-a-list"></a>Пример 1. Указанные поля для списка  
 В следующем примере показан правильно составленный запрос SharePoint:  
  
```  
<RSSharePointList>  
<listName>MyList</listName>  
<viewFields>  
  <FieldRef Name="Field1"/>  
  <FieldRef Name="Field4"/>  
</viewFields>  
<Query>  
  <Where>  
    <And>  
      <Gt>  
        <FieldRef Name="Field1"/>  
        <Value Type="Integer">1</Value>  
      </Gt>  
      <IsNotNull>  
        <FieldRef Name="Field2"/>  
        <Value Type="string"/>  
      </IsNotNull>   
    </And>  
  </Where>  
</Query>  
</RSSharePointList>  
```  
  
 Данное представление запроса можно изменить, если запрос представлен в виде XML-текста.  
  
#### <a name="example-2-all-fields-for-a-list"></a>Пример 2. Все поля для списка  
 Достаточно указать имя списка, и будут возвращены все поля, включая скрытые. В следующем примере из списка Tasks извлекаются все поля:  
  
```  
<RSSharePointList>  
<listName>Tasks</listName>  
</RSSharePointList>  
```  
  
 В результатах запроса возвращаются все поля для списка Tasks.  
  
##  <a name="parameters"></a><a name="Parameters"></a> Параметры  
 Параметры не поддерживаются этим модулем обработки данных.  
  
##  <a name="how-to-topics"></a><a name="HowTo"></a> Инструкции  
 В этом разделе содержатся пошаговые инструкции по работе с подключениями к данным, источниками данных и наборами данных.  
  
 [Добавление и проверка подключения к данным (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-and-verify-a-data-connection-report-builder-and-ssrs.md)  
  
 [Создание общего или внедренного набора данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/create-a-shared-dataset-or-embedded-dataset-report-builder-and-ssrs.md)  
  
 [Добавление фильтра к набору данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/add-a-filter-to-a-dataset-report-builder-and-ssrs.md)  
  
##  <a name="related-sections"></a><a name="Related"></a> См. также  
 В этих разделах документации содержатся подробные сведения о данных отчетов, а также методические сведения об определении, настройке и использовании элементов отчетов, связанных с данными.  
  
 [Наборы данных отчетов (службы SSRS)](../../reporting-services/report-data/report-datasets-ssrs.md)  
 Предоставляет общие сведения о доступе к данным отчета.  
  
 [Создание строк подключения к данным (построитель отчетов и SSRS)](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)  
 Предоставляет сведения о подключениях к данным и источникам данных.  
  
 [Внедренные и общие наборы данных отчета (построитель отчетов и службы SSRS)](../../reporting-services/report-data/report-embedded-datasets-and-shared-datasets-report-builder-and-ssrs.md)  
 Предоставляет сведения об общих и внедренных наборах данных.  
  
 [Коллекция полей набора данных (построитель отчетов и службы SSRS)](../../reporting-services/report-data/dataset-fields-collection-report-builder-and-ssrs.md)  
 Предоставляет сведения о коллекции полей набора данных, создаваемой запросом.  
  
 [Источники данных, поддерживаемые службами Reporting Services &#40;SSRS&#41;](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md).  
 Предоставляет подробные сведения о поддержке платформ и версий для каждого модуля обработки данных.  

## <a name="see-also"></a>См. также:

[Параметры отчета](../../reporting-services/report-design/report-parameters-report-builder-and-report-designer.md)   
[Фильтрация, группирование и сортировка данных](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md)   
[Выражения (построитель отчетов и службы SSRS)](../../reporting-services/report-design/expressions-report-builder-and-ssrs.md)  

Остались вопросы? [Посетите форум служб Reporting Services](https://go.microsoft.com/fwlink/?LinkId=620231).
