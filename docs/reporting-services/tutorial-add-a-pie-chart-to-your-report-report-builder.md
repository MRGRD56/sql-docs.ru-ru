---
title: Учебник. Добавление круговой диаграммы к отчету (построитель отчетов) | Документы Майкрософт
description: Узнайте, как создать круговую диаграмму в отчете Reporting Services с разбивкой на страницы, добавить процентные значения и объединить небольшие сегменты в один большой.
ms.date: 06/15/2016
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: reporting-services
ms.topic: conceptual
ms.assetid: eaadf7bf-c312-428a-b214-0a1fbf959c3f
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: a924e8e6ed7a19904ddc9c8cded38683b849edeb
ms.sourcegitcommit: 9e2c682929ee64c051dc62f8917d147861f7c635
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "93043736"
---
# <a name="tutorial-add-a-pie-chart-to-your-report-report-builder"></a>Руководство по Добавление круговой диаграммы в отчет (построитель отчетов)
В этом учебнике вы создадите круговую диаграмму в отчете Reporting Services с разбивкой на страницы. Вы добавите процентные значения и объедините несколько небольших секторов в один сектор.

Данные на круговых и кольцевых диаграммах отображаются в виде пропорциональных долей целого. Такие диаграммы не имеют осей. После добавления числового поля на круговую диаграмму в этой диаграмме вычисляется процентная доля каждого значения в общей сумме.  

На иллюстрации показана круговая диаграмма, которую предстоит создать. 
 
![Снимок экрана круговой диаграммы построителя отчетов.](../reporting-services/media/report-builder-pie-chart-final.png)
  
Если на круговой диаграмме расположено слишком много точек данных, метки точек данных могут располагаться близко друг к другу, и их будет трудно читать. В этом случае рекомендуется объединить несколько маленьких секторов в один большой. Круговые диаграммы более удобны для восприятия, если данные статистически обработаны в небольшое количество точек данных.  
 
> [!NOTE]  
> В этом учебнике шаги для мастера объединены в две процедуры. Пошаговые инструкции по переходу к серверу отчетов, добавлению источника данных и набора данных см. в первом учебнике этой серии: [Учебник. Создание простого табличного отчета (построитель отчетов)](../reporting-services/tutorial-creating-a-basic-table-report-report-builder.md).  
  
На изучение этого руководства потребуется примерно 10 минут.  
  
## <a name="requirements"></a>Требования  
Дополнительные сведения о требованиях см. в разделе [Предварительные условия для использования учебников (построитель отчетов)](../reporting-services/prerequisites-for-tutorials-report-builder.md).  
  
## <a name="1-create-a-pie-chart-from-the-chart-wizard"></a><a name="Chart"></a>1. Создание круговой диаграммы с помощью мастера диаграмм  
В этом разделе вы создадите внедренный набор данных с помощью мастера диаграмм, выберите общий источник данных и создадите круговую диаграмму.  

  
1.  [Запустите построитель отчетов](../reporting-services/report-builder/start-report-builder.md) с компьютера, веб-портала [!INCLUDE[ssRSnoversion_md](../includes/ssrsnoversion-md.md)] или сервера в режиме интеграции с SharePoint.  
  
    Откроется диалоговое окно **Создать отчет или набор данных** .  
  
    Если диалоговое окно **Новый отчет или набор данных** не появилось, в меню **Файл** выберите команду **Создать**.  
  
2.  Убедитесь, что на левой панели выбран **Новый отчет** .  
  
3.  На правой панели выберите **Мастер диаграмм**.  
  
4.  На странице **Выбор набора данных** нажмите кнопку **Создать набор данных** , а затем кнопку **Далее**.  
  
5.  На странице **Выбор соединения с источником данных** выберите существующий источник данных или перейдите к серверу отчетов и выберите источник данных, а затем нажмите кнопку **Далее**. Может потребоваться указать имя пользователя и пароль.  
  
    > [!NOTE]  
    > При наличии необходимых разрешений выбор источника данных не имеет существенного значения. Этот источник данных не будет использоваться для получения данных. Дополнительные сведения см. в разделе [Альтернативные способы создания подключения к данным &#40;построитель отчетов&#41;](../reporting-services/alternative-ways-to-get-a-data-connection-report-builder.md).  
  
6.  На странице **Проектирование запроса** нажмите кнопку **Изменить как текст**.  
  
7.  На панель запроса вставьте следующий запрос:  

    > [!NOTE]  
    > В этом учебнике запрос уже содержит значения данных, поэтому внешний источник данных не требуется. В связи с этим запрос получается длинным. В рабочей среде запрос не будет содержать данные. Этот запрос содержит данные только в учебных целях.  
  
    ```  
    SELECT 'Advanced Digital Camera' AS Product, CAST(254995.21 AS money) AS Sales  
    UNION SELECT 'Slim Digital Camera' AS Product, CAST(164499.04 AS money) AS Sales  
    UNION SELECT 'SLR Digital Camera' AS Product, CAST(782176.79 AS money) AS Sales  
    UNION SELECT 'Lens Adapter' AS Product, CAST(36333.08 AS money) AS Sales  
    UNION SELECT 'Macro Zoom Lens' AS Product, CAST(40199.3 AS money) AS Sales  
    UNION SELECT 'USB Cable' AS Product, CAST(53245.5 AS money) AS Sales  
    UNION SELECT 'Independent Filmmaker Camcorder' AS Product, CAST(452288.0 AS money) AS Sales  
    UNION SELECT 'Full Frame Digital Camera' AS Product, CAST(247250.85 AS money) AS Sales  
    ```  
  
8.  Нажмите кнопку "Выполнить" ( **!** ), чтобы просмотреть данные, на основе которых будет создана диаграмма (необязательно).  
  
9. Щелкните **Далее**.  
  
## <a name="2-choose-the-chart-type"></a><a name="ChartType"></a>2. Выбор типа диаграммы  
Можно выбрать один из различных стандартных типов диаграмм.  

  
1.  На странице **Выбор типа диаграммы** выберите **Круговая диаграмма** и нажмите кнопку **Далее**. Откроется страница **Расположение полей диаграммы** .  
  
    На странице **Расположение полей диаграммы** перетащите поле Product на панель **Категории** . Категории определяют номера срезов в круговой диаграмме. В этом примере восемь срезов — по одному для каждого продукта.  
  
2.  Перетащите поле Sales на панель **Значения** . Поле Sales представляет объем продаж по подкатегории. На панели **Значения** отображается выражение `[Sum(Sales)]` , так как на диаграмме отображается агрегат для каждого из продуктов.  
  
3.  Нажмите кнопку **Далее** для предварительного просмотра.  
  
5.  Нажмите кнопку **Готово**.  
  
    Диаграмма добавляется в область конструктора. При этом вы не видите фактические значения круговой диаграммы. Вместо этого отображаются значения "Product 1", "Product 2" и т. д., что позволяет получить представление о том, как будет выглядеть диаграмма.  
    
    ![Снимок экрана круговой диаграммы построителя отчетов в режиме конструктора.](../reporting-services/media/report-builder-pie-chart-first-design.png)
  
6.  Щелкните диаграмму, чтобы отобразить ее маркеры. Перетащите правый нижний угол диаграммы, чтобы увеличить ее. Обратите внимание, что область конструктора отчета также увеличивается в соответствии с размером диаграммы.  
  
7.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
В отчете отображается круговая диаграмма с восемью срезами, по одному для каждого продукта. Теперь вы видите фактические продукты, и размер каждого сектора представляет продажи для этого продукта. Три среза диаграммы достаточно тонкие.  

![Снимок экрана, показывающий предварительный просмотр круговой диаграммы построителя отчетов.](../reporting-services/media/report-builder-pie-chart-first-preview.png)
  
## <a name="3-display-percentages-in-each-slice"></a><a name="Percentages"></a>3. Отображение процентов в каждом срезе  
На каждом срезе круговой диаграммы можно отобразить процент для этого среза относительно полной круговой диаграммы.  

  
1.  Переключитесь в режим конструктора отчета.  
  
2.  Щелкните правой кнопкой мыши круговую диаграмму и выберите пункт **Отобразить метки данных**. На диаграмме появятся метки данных.  
  
3.  Щелкните метку правой кнопкой мыши и выберите пункт **Свойства метки ряда**.  
  
4.  В поле **Данные метки** введите **#PERCENT**.  
    
5.  Чтобы указать для метки количество десятичных разрядов, в поле **Данные метки** после **#PERCENT** введите значение **{Pn}** , где *n* — число десятичных разрядов (необязательно). Например, чтобы не отображать десятичные разряды, введите **#PERCENT{P0}** .  

6.  Чтобы значения отображались в виде процентов, свойство UseValueAsLabel должно иметь значение false. Если в диалоговом окне **Подтверждение действия** будет предложено задать это значение, нажмите кнопку **Да**.  
  
    > [!NOTE]  
    > Поле **Формат чисел** в диалоговом окне **Свойства метки ряда** не имеет значения, если выбрано форматирование в процентах. Это форматирует метки в виде процентов, но не вычисляет процент, который представляет каждый срез круговой диаграммы.  
  
6.  [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
7.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
В отчете отображается процент от целого для каждого среза круговой диаграммы.  

![Снимок экрана, показывающий предварительную версию круговой диаграммы построителя отчетов с процентами в каждом срезе.](../reporting-services/media/report-builder-pie-chart-preview-percents.png)
  
## <a name="4-combine-small-slices-into-one-slice"></a><a name="CombineSlices"></a>4. Объединение небольших срезов круговой диаграммы в один срез  
Три среза диаграммы достаточно маленькие. Можно объединить несколько небольших секторов в один большой, представляющий все эти секторы.  

1.  Переключитесь в режим конструктора отчета.  
  
2.  Если область свойств не видна, на вкладке **Вид** в группе **Показать/скрыть** выберите элемент **Свойства**.  
  
3.  В области конструктора щелкните любой сегмент круговой диаграммы. На панели «Свойства» отображаются свойства ряда.  
  
4.  В разделе **Общие** разверните узел **CustomAttributes** .  
  
5.  Присвойте свойству **CollectedStyle** значение **SingleSlice**.  

    ![Снимок экрана, показывающий, как настроить свойство отдельного среза для круговой диаграммы в построителе отчетов.](../reporting-services/media/report-builder-pie-chart-single-slice-property.png)
 
6.  Убедитесь в том, что свойство **CollectedThreshold** имеет значение 5.  
  
7.  Убедитесь в том, что свойство **CollectedThresholdUsePercent** имеет значение **True**.  
  
8.  На вкладке **Главная** нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
В условных обозначениях теперь есть категория "Прочее". Новый срез круговой диаграммы объединяет все срезы, имеющие размер менее 5%, в один срез, имеющий размер 6% от всей круговой диаграммы.  

![Снимок экрана, показывающий, как выглядит круговая диаграмма построителя отчетов начинается под углом в 90 градусов от верхней части диаграммы.](../reporting-services/media/report-builder-pie-chart-start-at-90.png)
 
## <a name="5-start-pie-chart-values-at-the-top"></a><a name="DrawingEffect"></a>5. Вывод значений круговой диаграммы в верхней части диаграммы 

По умолчанию в круговых диаграммах первое значение набора данных отсчитывается с 90-го градуса от верхней части диаграммы. Это можно видеть на круговой диаграмме в предыдущих разделах.

В этом разделе мы сделаем так, чтобы значения отсчитывались сверху.

1.  Переключитесь в режим конструктора отчета.  

2. Выберите сам круг.

3. На панели "Свойства" в области **Настраиваемые атрибуты** измените значение PieStartAngle с **0** на **270**.

4. Нажмите кнопку **Выполнить** для предварительного просмотра отчета.

Теперь секторы круговой диаграммы следуют в алфавитном порядке, начиная сверху и заканчивая сектором "Прочее".

![Снимок экрана, показывающий как выглядит круговая диаграмма построителя отчетов, начинающаяся наверху.](../reporting-services/media/report-builder-pie-chart-start-at-top.png)
  
## <a name="6-add-a-report-title"></a><a name="Title"></a>6. Добавление заголовка отчета  
  
Так как круговая диаграмма является единственной визуализацией в отчете, ей не требуется собственный заголовок. Достаточно заголовка отчета.
  
1.  На диаграмме выберите поле "Заголовок диаграммы" и нажмите клавишу DELETE.

2. В области конструктора щелкните ссылку **Щелкните, чтобы добавить заголовок**.  
  
2.  Введите **Продажи фотоаппаратов и видеокамер** , нажмите клавишу ВВОД, а затем введите **В процентах от общего объема продаж** , после чего он будет выглядеть следующим образом:  
  
    **Продажи фотоаппаратов и видеокамер**  
  
    **В процентах от общего объема продаж**  
  
3.  Выделите текст **Продажи фотоаппаратов и видеокамер** , а затем на вкладке **Главная** в разделе **Шрифт** щелкните **Полужирный**.  
  
4.  Выделите текст **В процентах от общего объема продаж** , а затем на вкладке **Главная** в разделе **Шрифт** выберите размер шрифта **10**.  
  
5.  Может потребоваться увеличить высоту текстового поля «Заголовок» для соответствия размерам двух строк текста (необязательно).  
  
    Данный заголовок появится в верхней части отчета. При отсутствии верхнего колонтитула страницы элементы в верхней части текста отчета выполняют роль заголовка отчета.  
  
6.  Нажмите кнопку **Выполнить** для предварительного просмотра отчета.  
  
## <a name="7-save-the-report"></a><a name="Save"></a>7. Сохранение отчета  
  
### <a name="to-save-the-report"></a>Сохранение отчета  
  
1.  Переключитесь в режим конструктора отчета.  
  
2.  В меню **Файл** выберите пункт **Сохранить**.  
  
3.  В поле **Имя** введите **Круговая диаграмма продаж**.  
  
4.  Выберите команду **Сохранить**.  
  
Отчет будет сохранен на сервере отчетов.  
  
## <a name="next-steps"></a>Next Steps  
Учебник «Добавление круговой диаграммы в отчет» успешно завершен. Дополнительные сведения о диаграммах см. в разделах [Диаграммы (построитель отчетов и службы SSRS)](../reporting-services/report-design/charts-report-builder-and-ssrs.md) и [Спарклайны и гистограммы (построитель отчетов и службы SSRS)](../reporting-services/report-design/sparklines-and-data-bars-report-builder-and-ssrs.md).  
  
## <a name="see-also"></a>См. также:  
[Учебники по построителю отчетов](../reporting-services/report-builder-tutorials.md)  
[Построитель отчетов в SQL Server](../reporting-services/report-builder/report-builder-in-sql-server-2016.md)  
  

