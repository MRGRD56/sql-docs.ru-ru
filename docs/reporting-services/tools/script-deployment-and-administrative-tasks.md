---
title: Написание скриптов для задач развертывания и администрирования | Документы Майкрософт
description: Сведения о средствах, технологиях и стратегиях автоматизации повседневных задач по установке, развертыванию и администрированию сервера отчетов.
ms.date: 05/30/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: tools
ms.topic: conceptual
helpviewer_keywords:
- scripts [Reporting Services]
- moving reports
- report servers [Reporting Services], duplicating settings
- deploying [Reporting Services], scripts
- copying report server settings
- administrative tasks [Reporting Services]
- duplicating report server environment
- migrating reports [Reporting Services]
- scripts [Reporting Services], deployments
- transferrng reports
- reports [Reporting Services], migrating
ms.assetid: d0416c9e-e3f9-456d-9870-2cfd2c49039b
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 883acc6af22c69b6deda8606c2361e33e55aeb1f
ms.sourcegitcommit: 917df4ffd22e4a229af7dc481dcce3ebba0aa4d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100077925"
---
# <a name="script-deployment-and-administrative-tasks"></a>Написание скриптов для задач развертывания и администрирования

  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] поддерживают использование сценариев для автоматизации стандартных задач по установке, развертыванию и администрированию. Развертывание сервера отчетов является многошаговым процессом. Чтобы настроить развертывание, необходимо использовать несколько средств и процессов. Для автоматизации всех задач не существует единой программы или единого подхода.  
  
 Не все шаги следует автоматизировать. В некоторых случаях выполнение шага вручную или с помощью графического средства является самым простым и эффективным подходом. Например, если требуется развернуть большое количество отчетов и моделей, проще скопировать базу данных сервера отчетов, чем писать программный код, который воссоздаст среду сервера отчетов.  
  
 Некоторые шаги требуют специального программного кода. Например, автоматизировать настройку URL-адресов для веб-службы и диспетчера отчетов можно только путем написания специального кода, который обращается к Инструментарию управления Windows (WMI) сервера отчетов. Избежать написания программного кода на этом шаге можно. Для этого примените средство настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .  
  
 Чтобы выполнить скрипт, настраивающий сервер отчетов, необходимо иметь права локального администратора на настраиваемом компьютере. Дополнительные сведения о подготовке сервера отчетов для удаленного администрирования см. в разделе [Настройка сервера отчетов для удаленного администрирования](../../reporting-services/report-server/configure-a-report-server-for-remote-administration.md).  
  
 Этот раздел описывает рекомендуемые подходы для автоматизации определенных шагов. Упомянуты несколько программ и программных интерфейсов; описания каждого предоставлены далее в разделе.  
  
## <a name="deployment-tasks-and-how-to-automate-them"></a>Задачи развертывания и способы их автоматизации  
 В следующей таблице обобщены задачи по установке и настройке сервера отчетов, необходимые для его развертывания. Эту таблицу можно использовать для сверки конкретной задачи с подходом, позволяющим ее автоматизировать или выполнить полностью автоматически.  
  
|Задача|Подход|  
|----------|--------------|  
|Установить службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].|Для выполнения автоматической установки программу установки можно запустить из командной строки.<br /><br /> Программу установки можно использовать как для установки, так и для настройки сервера отчетов, но только в случае, если указаны параметры конфигурации по умолчанию и система соответствует всем требованиям для этого типа установки. Если установка конфигурации по умолчанию невозможна, необходимо установить только файлы.|  
|Настройте учетную запись службы.|Начальная конфигурация этой учетной записи службы выполняется программой установки. Чтобы автоматизировать сделанные в учетной записи службы изменения как задачу, которая будет выполнена после установки, необходимо записать пользовательский код, выполняющий вызовы к поставщику WMI сервера отчетов. Для программной настройки учетной записи службы не существует специальных программ командной строки или шаблонов скриптов.<br /><br /> Если автоматизировать этот шаг путем создания программного кода невозможно, то учетную запись можно настроить вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Дополнительные сведения см. в разделе [Настройка учетной записи службы (диспетчер конфигурации сервера отчетов)](../install-windows/configure-the-report-server-service-account-ssrs-configuration-manager.md).|  
|Настройте URL-адреса веб-службы сервера отчетов и диспетчера отчетов.|Необходимо записать специальный программный код, обращающийся к поставщику WMI сервера отчетов. Для настройки URL-адресов не существует специальных программ командной строки или шаблонов скриптов.<br /><br /> Если вы хотите избежать написания кода, то URL-адреса можно настроить вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Дополнительные сведения см. в статье [Настройка URL-адреса (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/configure-a-url-ssrs-configuration-manager.md).|  
|Создание базы данных сервера отчетов.|Необходимо записать специальный программный код, обращающийся к поставщику WMI сервера отчетов. Для создания баз данных сервера отчетов и роли RSExecRole не существует специальных программ командной строки или шаблонов скриптов.<br /><br /> Если вы хотите избежать написания кода, то базу данных можно создать вручную при помощи средства настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Дополнительные сведения см. в разделе [Создание базы данных сервера отчетов, работающего в собственном режиме (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).|  
|Настройка подключения к базе данных сервера отчетов.|При изменении строки подключения, учетной записи, пароля или типа проверки подлинности следует запустить программу **rsconfig** для настройки соединения. Дополнительные сведения см. в разделах [Настройка подключения к базе данных сервера отчетов (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/configure-a-report-server-database-connection-ssrs-configuration-manager.md) и [Служебная программа rsconfig (SSRS)](../../reporting-services/tools/rsconfig-utility-ssrs.md).<br /><br /> Программу rsconfig.exe нельзя использовать для создания или обновления базы данных. База данных и роль RSExecRole должны быть созданы ранее.|  
|Настройка масштабного развертывания.|Для настройки масштабного развертывания выберите один из следующих подходов.<br /><br /> — Для соединения экземпляров сервера отчетов с существующей установкой запустите программу rskeymgmt.exe. Дополнительные сведения см. в разделе [Добавление и удаление ключей шифрования для развертывания с горизонтальным увеличением масштаба (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).<br />— Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.|  
|Резервное копирование ключей шифрования.|Для автоматизации резервного копирования ключей шифрования выберите один из следующих подходов.<br /><br /> — Для создания резервной копии ключей шифрования запустите программу rskeymgmt.exe. Дополнительные сведения см. в разделе [Резервное копирование и восстановление ключей шифрования служб Reporting Services](../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).<br />— Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.|  
|Настройка электронной почты сервера отчетов.|Напишите пользовательский программный код, обращающийся к поставщику WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] . Поставщик поддерживает подмножество установок конфигурации электронной почты.<br /><br /> Хотя файл RSReportServer.config содержит все установки, не используйте этот файл автоматически. В особенности не используйте пакетный файл для копирования файла на другой сервер отчетов. Каждый файл конфигурации содержит значения, определенные для текущего экземпляра. Эти значения не будут допустимыми на других экземплярах сервера отчетов.<br /><br /> См. сведения о [параметрах электронной почты и собственном режиме Reporting Services (Configuration Manager)](../install-windows/e-mail-settings-reporting-services-native-mode-configuration-manager.md).|  
|Настройка учетной записи автоматического выполнения.|Для автоматизации настройки учетной записи автоматического выполнения выберите один из следующих подходов.<br /><br /> — Запустите программу rsconfig.exe для настройки учетной записи. Дополнительные сведения см. в статье [Настройка учетной записи автоматического выполнения (диспетчер конфигурации сервера отчетов)](../../reporting-services/install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).<br />— Напишите специальный программный код, обращающийся к поставщику WMI сервера отчетов.|  
|Развертывание существующего содержимого на другом сервере отчетов, включая иерархию папок, назначение ролей, отчеты, подписки, расписания, источники данных и ресурсы.|Лучший способ повторно создать существующую среду сервера отчетов — скопировать базу данных сервера отчетов в новый экземпляр сервера отчетов.<br /><br /> Альтернативный подход заключается в написании специального кода, который программным путем заново создает существующее содержимое сервера отчетов. Однако учтите, что подписки, моментальные снимки отчетов и журнал отчетов невозможно создать повторно программным способом.<br /><br /> В некоторых случаях развертывание может выиграть от применения обоих методов (то есть можно восстановить базу данных сервера отчетов, а затем записать программный код, изменяющий ее для конкретного экземпляра).<br /><br /> Подробный пример см. в разделе [Образец скрипта программы rs.exe служб Reporting Services для копирования содержимого между серверами отчетов](../../reporting-services/tools/sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).<br /><br /> Дополнительные сведения о перемещении базы данных сервера отчетов см. в разделе [Перемещение баз данных сервера отчетов на другой компьютер (собственный режим служб SSRS)](../../reporting-services/report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md). Дополнительные сведения о создании среды сервера отчетов программным способом см. в подразделе «Миграция содержимого и папок сервера отчетов с помощью скрипта» этого раздела.|  
  
## <a name="tools-and-technologies-for-automating-server-deployment"></a>Инструменты и технологии для автоматизации развертывания сервера  
 В следующем списке обобщаются программы и интерфейсы, которые могут использоваться для автоматизации задач развертывания и обслуживания.  
  
-   Программа установки может запускаться в автоматическом режиме для установки и (в некоторых случаях) настройки компонентов сервера отчетов. Чтобы программа установки настроила экземпляр сервера отчетов, следует использовать параметр установки «Только файлы».  
  
-   Поставщик WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и программы командной строки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] можно использовать для локальной и удаленной настройки сервера.  
  
     Поставщик WMI служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] предоставляет классы, свойства и методы, реализующие управление всеми аспектами установки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] , — задание учетной записи службы, настройка URL-адресов, создание и настройка базы данных сервера отчетов или настройка сервера отчетов для доставки отчетов по электронной почте. Для использования поставщика WMI необходимо записать специальный программный код или скрипт. Дополнительные сведения см. в разделе [Доступ к поставщику WMI для служб Reporting Services](../../reporting-services/tools/access-the-reporting-services-wmi-provider.md).  
  
     Альтернативой написанию программного кода является использование программ командной строки (rsconfig.exe и rskeymgmt.exe). Можно записать пакетный файл, запускающий эти программы. Программы могут использоваться для автоматизации не всех задач настройки.  
  
-   Средство обработки скриптов сервера отчетов (rs.exe) может выполнять пользовательский код [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] для повторного создания или перемещения существующего содержимого с одного сервера отчетов на другой. При этом подходе скрипт записывается на языке [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], сохраняется в виде RSS-файла и с помощью программы rs.exe запускается на сервере отчетов. Написанный скрипт может обращаться к веб-службе сервера отчетов по протоколу SOAP. При создании скриптов развертывания данный подход позволяет повторно создавать пространство имен и содержимое папок сервера отчетов, а также политики безопасности на основе ролей.  
  
-   В выпуске SQL Server 2012 появились командлеты PowerShell для режима интеграции с SharePoint. PowerShell можно использовать для настройки и администрирования интеграции с SharePoint.  Дополнительные сведения см. в разделе [Командлеты PowerShell для служб Reporting Services в режиме интеграции с SharePoint](../../reporting-services/report-server-sharepoint/powershell-cmdlets-for-reporting-services-sharepoint-mode.md).  
  
## <a name="use-scripts-to-migrate-report-server-content-and-folders"></a>Миграция содержимого и папок сервера отчетов с помощью скриптов  
 Можно записать скрипт, дублирующие среду сервера отчетов на другом экземпляре сервера отчетов. Скрипты развертывания, как правило, пишутся на языке [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] , а затем выполняются с помощью сервера скриптов сервера отчетов.  
  
 Подробный пример см. в разделе [Образец скрипта программы rs.exe служб Reporting Services для копирования содержимого между серверами отчетов](../../reporting-services/tools/sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).  
  
 Скрипты позволяют копировать с одного сервера на другой папки, общие источники данных, ресурсы, отчеты, назначение ролей и настройки. Если есть необходимость воссоздания пространства имен сервера отчетов, они пишутся для одного экземпляра сервера отчетов, а затем выполняются на другом. Если развертывание служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] выполняется на нескольких серверах отчетов, то для одинаковой их настройки один и тот же скрипт выполняется на каждом из серверов.  
  
 Следующий перечень описывает шаги, необходимые для перемещения отчетов с одного сервера на другой.  
  
1.  Присвойте переменной скрипта URL-адрес исходного сервера отчетов.  
  
2.  Воспользуйтесь методами <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> и <xref:ReportService2010.ReportingService2010.GetProperties%2A> для получения определения и свойств отчета.  
  
3.  Присвойте URL-адресу значение, указывающее на целевой сервер.  
  
4.  Воспользуйтесь методом <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> , передав ему свойства, возвращенные методом <xref:ReportService2010.ReportingService2010.GetProperties%2A> , и определение отчета, возвращенное методом <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.  
  
 Пользуясь методами get и create, можно выполнить аналогичные шаги для переноса настроек, папок, общих источников данных и ресурсов. Дополнительные сведения о доступных методах см. в разделе [Технический справочник (службы SSAS)](../../reporting-services/technical-reference-ssrs.md).  
  
> [!NOTE]  
>  Если учетные данные не указаны явным образом, то скрипты выполняются от имени пользователя [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, запустившего скрипт.  
  
 Дополнительные сведения о форматировании и выполнении файлов скриптов см. в разделе [Создание скриптов с помощью программы rs.exe и веб-службы](../../reporting-services/tools/script-with-the-rs-exe-utility-and-the-web-service.md).  
  
## <a name="using-scripts-to-set-server-properties"></a>Настройка свойств сервера с помощью сценариев  
 Можно записать сценарии, которые зададут системные свойства на сервере отчетов. Следующий скрипт [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET иллюстрирует один из способов установки свойств. Этот сценарий отключает элемент управления RSClientPrint ActiveX, но можно заменить значения **EnableClientPrinting** и **False** любым допустимым именем свойства и значением. Полный список свойств сервера см. в разделе [Report Server System Properties](../../reporting-services/report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).  
  
 Чтобы использовать скрипт, сохраните его в файл с расширением RSS, а затем воспользуйтесь программой командной строки rs.exe для запуска файла на сервере отчетов. Скрипт не компилируется, поэтому необязательно иметь установку [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]. В этом примере предполагается, что пользователь имеет необходимые разрешения на локальном компьютере, на котором находится сервер отчетов. Если пользователь не вошел в систему под учетной записью, имеющей необходимые разрешения, необходимо указать сведения об учетной записи с помощью дополнительных аргументов командной строки. Дополнительные сведения см. в разделе [Программа RS.exe (SSRS)](../../reporting-services/tools/rs-exe-utility-ssrs.md).  
  
> [!TIP]  
>  Подробный пример см. в разделе [Образец скрипта программы rs.exe служб Reporting Services для копирования содержимого между серверами отчетов](../../reporting-services/tools/sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).  
  
```  
Public Sub Main()  
        Dim props(0) As [Property]  
        Dim setProp As New [Property]  
        setProp.Name = "EnableClientPrinting"  
        setProp.Value = "False"   
        props(0) = setProp  
        Try  
            rs.SetSystemProperties(props)  
        Catch ex As System.Web.Services.Protocols.SoapException  
            Console.Write(ex.Detail.InnerXml)  
        Catch e as Exception  
            Console.Write(e.Message)  
        End Try  
End Sub  
```

## <a name="next-steps"></a>Дальнейшие действия

[Метод GenerateDatabaseCreationScript (WMI MSReportServer_ConfigurationSetting)](../../reporting-services/wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md)   
[Метод GenerateDatabaseRightsScript (WMI MSReportServer_ConfigurationSetting)](../../reporting-services/wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md)   
[Метод GenerateDatabaseUpgradeScript (WMI MSReportServer_ConfigurationSetting)](../../reporting-services/wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md)   
[Установка SQL Server из командной строки](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md)   
[Установка сервера отчетов служб Reporting Services в собственном режиме](~/reporting-services/install-windows/install-reporting-services-native-mode-report-server.md)   
[Сервер отчетов служб Reporting Services (основной режим)](../../reporting-services/report-server/reporting-services-report-server-native-mode.md)   
[Программы командной строки сервера отчетов (службы SSRS)](../../reporting-services/tools/report-server-command-prompt-utilities-ssrs.md)   
[Поддержка браузера для служб Reporting Services и Power View](../../reporting-services/browser-support-for-reporting-services-and-power-view.md)   
[Инструментальные средства служб Reporting Services](../../reporting-services/tools/reporting-services-tools.md)  

Остались вопросы? [Посетите форум служб Reporting Services](https://go.microsoft.com/fwlink/?LinkId=620231).
