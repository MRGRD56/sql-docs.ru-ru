---
title: Мастер карт и мастер слоев карт (построитель отчетов) | Документация Майкрософт
description: Узнайте, как автоматизировать создание карты, добавление слоя карты или изменение параметров слоя карты с помощью мастера карт или мастера слоев карт в построителе отчетов.
ms.date: 03/14/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-design
ms.topic: reference
f1_keywords:
- sql13.rtp.rptdesigner.mapandlayerwizard.f1
- "10542"
- MICROSOFT.REPORTDESIGNER.MAPLAYER.NAME
ms.assetid: 48cbe18b-1290-4107-8a1c-ec6acd71f73b
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: b307966577cfd30197963263597aee7a9d06e018
ms.sourcegitcommit: d8cdbb719916805037a9167ac4e964abb89c3909
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/20/2021
ms.locfileid: "98597333"
---
# <a name="map-wizard-and-map-layer-wizard-report-builder-and-ssrs"></a>Мастер карт и мастер слоев карт (построитель отчетов и службы SSRS)
 В отчетах [!INCLUDE[ssRSnoversion_md](../../includes/ssrsnoversion-md.md)] с разбиением на страницы мастер карт и мастер слоев карт автоматизируют задачи создания карты, добавления слоя карты или изменения параметров слоя карты применительно к существующему слою.  
  
 Перед добавлением карты в отчет или слоя карты в карту необходимо получить следующие сведения:  
  
-   **Источник пространственных данных.** Расположение пространственных данных или соединение с источником пространственных данных, например имя экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] и базы данных, содержащей пространственные данные, либо имя файла фигуры Environmental Systems Research Institute, Inc. Файл фигуры (ESRI).  
  
-   **Spatial data.** Поле источника пространственных данных, которое содержит набор координат, указывающих местоположение.  
  
-   **Аналитические данные.** Аналитические данные, используемые для изменения параметров отображения карты (например ежегодный объем продаж).  
  
-   **Поля соответствия.** Поля соответствия, определяющие взаимосвязи между пространственными и аналитическими данными (например, название региона и города, являющееся уникальным идентификатором каждого города).  
  
 Следующие разделы содержат сведения о параметрах, задаваемых в процессе работы мастеров «Карта» и «Слой карты».  
  
-   При первом открытии построителя отчетов щелкните значок мастера **Карта** в центре области конструктора.  
  
-   На вкладке **Вставка** выберите **Карта**, затем **Мастер «Карта»** .  
  
 Чтобы открыть мастер «Слой карты», выполните следующее действие.  
  
-   Чтобы отобразить панель «Карта», щелкните карту и на панели инструментов нажмите кнопку **Мастер нового слоя** .  
  
 Щелкните заголовок страницы мастера, чтобы получить соответствующее содержимое справки. Состав отображаемых страниц зависит от выбора типа карты, источника пространственных данных и источника аналитических данных.  
  
1.  [Выбор источника пространственных данных](#SpatialDataSource). Пространственные данные могут быть получены из галереи карт, из файла фигуры ESRI или из реляционной базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , содержащей пространственные данные.  
  
    -   [Что такое пространственные данные?](#SpatialData)  
  
    -   [Что такое галерея карт?](#MapGallery)  
  
    -   [Что такое файл фигуры ESRI?](#Shapefile)  
  
    -   [Где можно получить шейп-файлы ESRI?](#GetShapefiles)  
  
    -   [Что такое пространственный запрос SQL Server?](#SqlServerSpatial)  
  
2.  [Выбор пространственных данных и параметров отображения карты](#MapView). Задайте представление и разрешение карты, укажите, внедрять ли пространственные данные в отчет и включать ли мозаичный фон [!INCLUDE[msCoName](../../includes/msconame-md.md)] Bing Map.  
  
    -   [Что такое представление карты или область просмотра?](#Viewport)  
  
    -   [Что такое разрешение карты или оптимизация?](#Resolution)  
  
    -   [Что происходит при внедрении пространственных данных?](#Embed)  
  
    -   [Что такое мозаичный фон Bing Map?](#Tiles)  
  
3.  [Выбор параметров визуализации карты](#Visualization). Выберите тип создаваемой карты.  
  
    -   [В чем разница между базовой картой, пузырьковой картой и аналитической картой?](#MapType)  
  
    -   Выбор параметров визуализации карты: многоугольники  
  
    -   Выбор параметров визуализации карты: Линии  
  
    -   Выбор параметров визуализации карты: точки  
  
4.  "Выберите соединение с источником данных", "Выбор параметров визуализации карты: Точки. Выберите соединение с источником данных или создайте таковое для внешнего источника данных, который содержит аналитические данные, предназначенные для отображения на карте.  
  
5.  Проектирование запроса. Сконструируйте запрос, который определяет аналитические данные.  
  
6.  [Выбор набора аналитических данных](#AnalyticalData). Укажите источник аналитических данных.  
  
    -   [В чем разница между пространственными и аналитическими данными?](#Diff)  
  
7.  [Определение полей соответствия для пространственных и аналитических данных](#SpecifyMatchFields). Постройте связь между пространственными и аналитическими данными, что позволит изменять внешний вид элементов карты в зависимости от данных.  
  
    -   [Что такое поле сопоставления?](#MatchFields)  
  
8.  [Выбор цветовой темы и параметров визуализации данных](#ThemeandVisualization). Чтобы определить на этой странице способ визуализации данных на фоне карты, укажите тему карты, визуализируемые поля и изменяемые параметры: цвет, размер и тип маркера.  
  
    -   [Что делает тема?](#Theme)  
  
    -   [Для чего нужны условные обозначения и шкалы в окне предварительного просмотра карты?](#Legends)  
  
    -   [Что такое правила?](#Rules)  
  
 После добавления карты или слоя карты и предварительного просмотра отчета можно изменить параметры карты и слоя карты, заданные в мастерах. Дополнительные сведения см. в разделе [Настройка данных и отображения карты или слоя карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/customize-the-data-and-display-of-a-map-or-map-layer-report-builder-and-ssrs.md).  
  
 Дополнительные сведения о картах см. в разделе [Карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/maps-report-builder-and-ssrs.md). Пошаговые инструкции по добавлению карты в отчет см. в статье [Учебник. Отчет-карта (построитель отчетов)](../../reporting-services/tutorial-map-report-report-builder.md).  
  
##  <a name="choose-a-source-of-spatial-data"></a><a name="SpatialDataSource"></a> Выбор источника пространственных данных  
 Укажите на этой странице источник пространственных данных, а также включаемые пространственные данные. Пространственные данные могут поступать из галереи карт, из файла фигуры ESRI или из запроса к набору данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , получающему пространственные данные из базы данных [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] или более поздней версии.  
  
 Для каждого слоя можно использовать один и тот же источник или различные источники. Однако при добавлении каждого слоя необходимо указать источник. Если пространственные данные получены из галереи карт или файла фигуры ESRI, то источник пространственных данных не будет отдельным элементом отчета. Он не отображается в области данных отчета.  
  
###  <a name="what-is-spatial-data"></a><a name="SpatialData"></a> Что такое пространственные данные?  
 Пространственные данные содержат координаты, определяющие географические или геометрические элементы. Пространственные данные определяют на карте *элементы карты*: многоугольники, задающие участки или фигуры, линии, задающие маршруты или пути, и точки, задающие положение маркеров или вешек. Пространственные данные хранятся в источнике данных в двоичном формате и указываются как наборы координат. Например, точка имеет координаты X и Y (X Y), линия состоит из двух наборов координат ((X1 Y1), (X2 Y2)), многоугольник состоит из четырех и более наборов координат, причем первый и последний набор совпадают ((X1 Y1), (X2 Y2), (X3 Y3), (X1 Y1)).  
  
 Дополнительные сведения см. в документации по типу используемых пространственных данных.  
  
###  <a name="what-is-the-map-gallery"></a><a name="MapGallery"></a> What is the map gallery?  
 Галерея карт содержит карты из отчетов. Они расположены в папке галереи карт среды создания отчетов. Карты из этой галереи позволяют быстро добавить карту в отчет. Стандартные карты в галерее предоставлены поставщиком карт.  
  
> [!NOTE]  
>  Службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] используют данные из файлов фигур TIGER/Line, поставляемых с разрешения Бюро переписи населения США переписи населения США ([https://www.census.gov/](https://www.census.gov/)). Файлы фигур TIGER/Line содержат выборочную географическую и картографическую информацию из базы данных Census MAF/TIGER. Файлы фигур TIGER/Line бесплатно распространяются Бюро переписи населения США. Чтобы получить дополнительную информацию о файлах фигур TIGER/Line, обратитесь к [технической документации по файлам фигур TIGER/Line и файлам TIGER/Line](https://www.census.gov/programs-surveys/geography/technical-documentation/complete-technical-documentation/tiger-geo-line.html). Информация о границах в шейп-файлах TIGER/Line может использоваться только для сбора и табулирования статистических данных. Их описание и использование в статистических целях не может повлечь изменения юридических полномочий или прав собственности. Они не являются законными описаниями земель. TIGER и TIGER/Line являются охраняемыми товарными знаками Бюро переписи населения США.  
  
 Для расширения галереи карт можно добавлять или удалять отчеты из каталога галереи карт, а также добавлять папки для структуризации карт. Дополнительные сведения см. в разделе [Карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/maps-report-builder-and-ssrs.md).  
  
###  <a name="what-is-an-esri-shapefile"></a><a name="Shapefile"></a> What is an ESRI shapefile?  
 Файл фигуры ESRI представляет собой набор файлов данных, соответствующих формату хранения файла фигуры пространственных данных Института исследования окружающей среды (Environmental Systems Research Institute, ESRI). В набор файлов, как правило, включается файл *\<filename>* .shp, который содержит пространственные данные, и файл поддержки *\<filename>* .dbf.  
  
 Если файл фигуры указан в качестве источника пространственных данных и расположен на локальном компьютере, то пространственные данные автоматически внедряются в отчет. Чтобы использовать пространственные данные файла ESRI динамически, необходимо выполнить следующие действия.  
  
 В построителе отчетов передайте SHP- и DBF-файлы в одну и ту же папку на сервере отчетов и укажите этот SHP-файл в качестве источника пространственных данных.  
  
 В конструкторе отчетов среды [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]добавьте SHP- и DBF-файлы в проект отчета и укажите имя SHP-файла в качестве источника пространственных данных.  
  
###  <a name="where-can-i-get-esri-shapefiles"></a><a name="GetShapefiles"></a> Где можно получить шейп-файлы ESRI?  
 Шейп-файлы ESRI доступны в Интернете. Дополнительные сведения см. в разделе [Поиск шейп-файлов ESRI для карты](https://go.microsoft.com/fwlink/?linkid=178814).  
  
###  <a name="what-is-a-sql-server-spatial-query"></a><a name="SqlServerSpatial"></a> Что такое пространственный запрос SQL Server?  
 Пространственный запрос [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] представляет собой запрос к набору данных, который указывает на тип данных SQLGeometry или SQLGeography из реляционной базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .  
  
> [!NOTE]  
>  При определении в мастере источника данных на странице «Конструирование запроса» отображаются различные конструкторы запросов в зависимости от типа источника данных, с которым устанавливается соединение. Дополнительные сведения см. в статье [Средства проектирования запросов (SSRS)](../report-data/query-design-tools-ssrs.md).  
  
 При выполнении запроса в конструкторе запросов результирующий набор отображает столбец, содержащий текстовое представление пространственных данных. Например, в одной строке могут содержаться пространственные данные, представляющие отдельную точку, а в другой строке — пространственные данные, определяющие набор точек. Каждая строка становится одним элементом карты. Можно изменять параметры отображения каждого элемента карты как неделимой единицы.  
  
 Дополнительные сведения см. в разделе [Пространственные типы данных](../../relational-databases/spatial/spatial-data-types-overview.md).  
  
##  <a name="choose-spatial-data-and-map-view-options"></a><a name="MapView"></a> Выбор пространственных данных и параметров отображения карты  
 На этой странице можно задать следующие параметры.  
  
-   Укажите центрирование и масштабирование представления для пространственных данных, выбранных на предыдущей странице мастера. Заданное представление применяется к всей карте.  
  
-   Укажите разрешение карты.  
  
-   Укажите, внедрять ли пространственные данные в отчет.  
  
-   Для внедренных данных укажите, включать ли все данные или только данные в текущем представлении.  
  
-   Укажите, включать ли мозаичный фон [!INCLUDE[msCoName](../../includes/msconame-md.md)] Bing Map.  
  
###  <a name="what-is-the-map-view-or-viewport"></a><a name="Viewport"></a> Что такое представление карты или область просмотра?  
 Окно просмотра карты определяет отображаемую область карты для всех слоев в отчете.  
  
 По умолчанию шкала цветов и шкала расстояний отображается внутри области просмотра, а условные обозначения карты — вне области просмотра. Эти параметры области просмотра можно изменить по завершении мастера.  
  
###  <a name="what-is-map-resolution-and-optimization"></a><a name="Resolution"></a> Что такое разрешение карты и оптимизация?  
 Изменение разрешения для пространственных данных, представляющих линии или многоугольники, определяет детальность отрисовки карты. Например, необходимо ли в виде с воздуха отображать поверхность земли с точностью до сотни метров, или достаточно одного километра?  
  
 При внедрении пространственных данных в отчет более высокое разрешение увеличивает количество элементов, которые нужно детально отрисовывать при данном разрешении. Если пространственные данные не внедрены в отчет, повышение разрешения увеличивает количество времени, требуемое обработчику отчетов для вычисления линий карты в данном разрешении при каждом просмотре отчета.  
  
 При снижении разрешения обработчик отчетов применяет алгоритм, сокращающий количество точек, необходимых для отрисовки элементов карты. Чем ниже разрешение, тем меньше данных необходимо для отрисовки элементов карты, что приводит к повышению производительности при отображении.  
  
 При изменении положения ползунка панель предварительного просмотра мастера обновляется, что позволяет оценить эффект. После добавления карты в отчет это значение можно изменить в параметрах окна просмотра карты.  
  
###  <a name="what-does-embedding-spatial-data-do"></a><a name="Embed"></a> Что происходит при внедрении пространственных данных?  
 При внедрении в отчет элементов карты или мозаичных элементов Bing Map пространственные данные сохраняются в определении отчета.  
  
 Отчет с картой может использовать пространственные данные или мозаичные элементы Bing Map, которые либо извлекаются динамически при обработке отчета, либо внедряются в определение отчета во время разработки. Внедренные элементы карты могут значительно увеличить размер определения отчета, но сокращают время, необходимое для отображения карты в отчете. Динамические элементы карты сокращают размер определения отчета, но повышают время, необходимое для обработки и отображения карты.  
  
 При проектировании отчета рекомендуется оценить издержки, связанные со статическим или динамическим доступом к данным карты и найти баланс, удовлетворительно работающий при всех обстоятельствах. В общем, чем больше данных, тем больше места потребуется для хранения определения отчета и скомпилированного отчета на сервере отчетов, и тем больше время обработки. Рекомендуется обрезать пространственные данные, а также ограничить объем других данных отчета и включать в него только необходимое.  
  
###  <a name="what-is-a-bing-map-tile-background"></a><a name="Tiles"></a> Что такое мозаичный фон Bing Map?  
 Чтобы добавить к карте фон из географических изображений, выберите параметр включения мозаичного фона Bing Map. Обработчик отчетов загружает с веб-служб Bing Maps мозаичные элементы, соответствующие размеру и разрешению карты, указанным на этой странице мастера. Можно выбрать один из следующих типов мозаичных элементов.  
  
-   **Дорожный.** Отображение в стиле дорожной карты на белом фоне.  
  
-   **Воздушный.** Отображение только гибридного вида. В этом режиме текст не отображается.  
  
-   **Гибридная среда**. Отображает сочетание представлений **Дорожный** и **Воздушный** .  
  
 Дополнительные сведения о мозаичных элементах см. в разделе [Мозаичная система Bing Maps](/bingmaps/articles/bing-maps-tile-system). Дополнительные сведения об использовании в отчете мозаичных элементов Bing Map см. в разделах [Дополнительные условия использования](https://go.microsoft.com/fwlink/?LinkId=151371).  
  
 Для просмотра мозаичного фона в режиме конструктора необходим доступ к Интернету. Чтобы отображать мозаичный фон при предварительном просмотре отчета на сервере отчетов, сервер отчета должен быть настроен для поддержки мозаичного фона Bing Map. Дополнительные сведения см. в статье [Устранение неполадок в отчетах: отчеты-карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/troubleshoot-reports-map-reports-report-builder-and-ssrs.md) и [Планирование отчета-карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/plan-a-map-report-report-builder-and-ssrs.md).  
  
 Дополнительные сведения о других способах настройки мозаичного слоя см. в разделе [Добавление, изменение или удаление карты или слоя карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/add-change-or-delete-a-map-or-map-layer-report-builder-and-ssrs.md).  
  
##  <a name="choose-map-visualization"></a><a name="Visualization"></a> Выбор параметров визуализации карты  
 Выберите на этой странице тип карты или слоя карты, добавляемых к отчету. При первом запуске мастера к отчету добавляется карта и первый слой карты. Карта может содержать несколько слоев карты. Каждый слой карты отображает пространственные данные определенного типа: многоугольники, линии или точки.  
  
 Выбор типа карты зависит от назначения карты и доступных данных.  
  
###  <a name="what-is-the-difference-among-a-basic-map-a-bubble-map-and-an-analytical-map"></a><a name="MapType"></a> В чем разница между базовой картой, пузырьковой картой и аналитической картой?  
 **Базовая карта** отображает только местоположения. Можно изменять оттенки цветов областей карты, но эти цвета не отображают значения аналитических данных.  
  
 **Пузырьковая карта** передает размером пузырька статистическую значимость отдельного параметра аналитических данных (например объема продаж). Пузырьковые карты можно создавать для многоугольников или точек. Для многоугольников задайте свойства центральных точек многоугольника, а для точек — свойства маркеров.  
  
 **Аналитическая карта** передает статистическую значимость одного или нескольких аналитических значений для каждого элемента карты. Например, объем продаж может передаваться размером маркера, диапазон прибыльности категории продуктов — цветом маркера, а наиболее продаваемые продукты — типом маркера.  
  
 Дополнительные сведения см. в разделе [Планирование отчета-карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/plan-a-map-report-report-builder-and-ssrs.md).  
  
##  <a name="choose-the-analytical-dataset"></a><a name="AnalyticalData"></a> Выбор набора аналитических данных  
 Укажите на этой странице источник аналитических данных, отображаемых на данном слое карты.  
  
 Для отображения данных отчета или любых аналитических данных на фоне карты необходимо указать, где находятся эти данные и как они связаны с пространственными данными. Данные можно получать из существующего набора данных отчета или из нового набора данных, для которого создается запрос. Имеющиеся аналитические данные могут быть включены в файл фигуры ESRI, содержащий пространственные данные.  
  
###  <a name="what-is-the-difference-between-spatial-data-and-analytical-data"></a><a name="Diff"></a> В чем разница между пространственными и аналитическими данными?  
 Пространственные данные состоят из наборов координат, определяющих точки, линии и многоугольники. Элементы карты основаны на пространственных данных.  
  
 Аналитические данные — это числовые или классификационные данные, которые используются для изменения внешнего вида карты. Аналитические данные могут быть получены из набора данных отчета или включены вместе с пространственными данными из карты, входящей в галерею карт, или из файла фигуры ESRI.  
  
##  <a name="specify-the-match-fields"></a><a name="SpecifyMatchFields"></a> Задание полей соответствия  
 Задайте на этой странице взаимосвязи между пространственными и аналитическими данными.  
  
###  <a name="what-are-match-fields"></a><a name="MatchFields"></a> Что такое поля соответствия?  
 Поля соответствия позволяют обработчику отчетов строить взаимосвязи между аналитическими и пространственными данными. Поля соответствия указывают уникальные значения среди аналитических данных. Например, название склада может оказаться неуникальным, поэтому вместо него следует указывать город и название склада.  
  
##  <a name="choose-color-theme-and-data-visualization"></a><a name="ThemeandVisualization"></a> Выбор цветовой темы и параметров визуализации данных  
 На этой странице определяется способ визуализации данных на фоне карты, тема карты, визуализируемые поля и изменяемые параметры: цвет, размер и тип маркера.  
  
###  <a name="what-does-the-theme-do"></a><a name="Theme"></a> Что делает тема?  
 Выбранная тема задает значения по умолчанию для цвета, границы и шрифта. Эти параметры можно изменить по завершении мастера.  
  
###  <a name="what-are-the-legends-and-scales-in-map-preview-for"></a><a name="Legends"></a> Для чего нужны условные обозначения и шкалы в окне предварительного просмотра карты?  
 Условные обозначения помогают пользователю интерпретировать данные, отображаемые на карте. Карта предоставляет диапазон цветов, шкалу расстояний и условные обозначения.  
  
-   **Диапазон цветов.** Диапазон цветов представляет собой цветную полосу со шкалой, которая описывает интервалы данных, определенных обработчиком отчетов на основе правил, заданных для слоя.  
  
-   **Шкала расстояний.** Шкала расстояний содержит указания относительно единиц расстояния на карте. Единицы расстояний определяются автоматически в зависимости от проекции и масштаба карты.  
  
-   **Условные обозначения.** Условные обозначения помогают интерпретировать значение цветов, размеров и типов маркеров на карте. По умолчанию все правила для всех слоев отображают интервалы в первых условных обозначениях. После добавления карты в отчет можно изменить данные условные обозначения и добавить дополнительные.  
  
###  <a name="what-are-rules"></a><a name="Rules"></a> Что такое правила?  
 Правила определяют способ вычисления обработчиком отчетов диапазонов, на которые делятся аналитические данные. Для каждого слоя можно задать различные правила. Допустимые типы правил, которые можно задать, зависят от типа пространственных данных слоя.  
  
-   **Многоугольники.** Можно указать правила цвета.  
  
-   **Центральные точки многоугольников.** Можно указать правила цвета, размера и типа маркеров.  
  
-   **Линии.** Можно указать правила цвета и толщины.  
  
-   **Точки.** Можно указать правила цвета, размера и типа маркеров.  
  
 Обработчик отчетов применяет эти правила и автоматически определяет список элементов, которые будут отображаться в условных обозначениях. По умолчанию результаты применения всех правил для всех слоев отображаются в первых условных обозначениях. Это поведение можно изменить по завершении мастера. Дополнительные сведения см. в разделе [Изменение параметров отображения многоугольников, линий и точек с помощью правил и аналитических данных (построитель отчетов и службы SSRS)](../../reporting-services/report-design/vary-polygon-line-and-point-display-by-rules-and-analytical-data.md).  
  
## <a name="see-also"></a>См. также:  
 [Устранение неполадок в отчетах: отчеты-карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/troubleshoot-reports-map-reports-report-builder-and-ssrs.md)   
 [Планирование отчета-карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/plan-a-map-report-report-builder-and-ssrs.md)   
 [Карты (построитель отчетов и службы SSRS)](../../reporting-services/report-design/maps-report-builder-and-ssrs.md)  
  
