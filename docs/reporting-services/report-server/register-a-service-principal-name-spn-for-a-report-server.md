---
title: Регистрация имени субъекта-службы для сервера отчетов | Документы Майкрософт
description: Узнайте, как создать имя субъекта-службы для службы сервера отчетов, если она выполняется от имени пользователя домена и в сети используется проверка подлинности Kerberos.
ms.date: 09/24/2020
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-server
ms.topic: conceptual
ms.assetid: dda91d4f-77cc-4898-ad03-810ece5f8e74
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 4fad93d5682a8e3cfdd6fdf5341944c4b4b58a83
ms.sourcegitcommit: 2600a414c321cfd6dc6daf5b9bcbc9a99c049dc4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2020
ms.locfileid: "91603173"
---
# <a name="register-a-service-principal-name-spn-for-a-report-server"></a>зарегистрировать имя участника-службы для сервера отчетов
  При развертывании служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] в сети, где для взаимной проверки подлинности используется протокол Kerberos, а сервер отчетов настроен для запуска от учетной записи пользователя домена, необходимо создать для службы сервера отчетов имя участника-службы (SPN).  
  
## <a name="about-spns"></a>Сведения об именах участников-служб  
 Имя участника-службы представляет собой уникальный идентификатор службы в сети, использующей проверку подлинности по протоколу Kerberos. Оно состоит из класса службы, имени узла и иногда номера порта. Для имен субъектов-служб HTTP номер порта не требуется. В сети с проверкой подлинности по протоколу Kerberos имя участника-службы для сервера должно быть зарегистрировано либо со встроенной учетной записью компьютера (например, «Сетевая служба» или «Локальная система»), либо с учетной записью пользователя. Регистрация имен участников-служб для встроенных учетных записей производится автоматически. Если же служба запускается от учетной записи пользователя домена, необходимо вручную зарегистрировать имя участника-службы для применяемого типа учетной записи.  
  
 Чтобы создать имя субъекта-службы, можно воспользоваться программой командной строки **SetSPN** . Дополнительные сведения см. в следующих разделах:  
  
-   [Setspn](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731241(v=ws.11)) (https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731241(v=ws.11)).  
  
-   [Синтаксис имен субъектов-служб (SPN) SetSPN (Setspn.exe)](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx) (https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).  
  
 Для ее запуска на контроллере домена необходимо быть администратором домена.  
  
## <a name="syntax"></a>Синтаксис  

При управлении именами субъектов-служб с помощью SetSPN имя субъекта-службы должно быть введено в правильном формате. Формат имени субъекта-службы HTTP — `http/host`. Синтаксис команд, применяющийся в программе SetSPN для создания имени участника-службы для сервера отчетов, выглядит следующим образом.  
  
```  
Setspn -s http/<computer-name>.<domain-name> <domain-user-account>  
```  
  
 **SetSPN** входит в комплект Windows Server. Аргумент **-s** добавляет имена субъектов-служб после проверки на отсутствие дубликатов. **Примечание. -s** доступен в Windows Server, начиная с Windows Server 2008.  
  
 **HTTP** — класс службы. Веб-служба сервера отчетов работает в компоненте HTTP.SYS. Создание имени участника-службы для компонента HTTP имеет один побочный эффект: всем веб-приложениям, запускаемым компонентом HTTP.SYS (включая размещенные в службе IIS), будут предоставляться билеты на основе учетной записи пользователя домена. Если эти службы запускаются от имени других учетных записей, то запросы на проверку подлинности будут завершаться ошибкой. Чтобы избежать этой проблемы, необходимо настроить все HTTP-приложения для запуска от одной и той же учетной записи либо назначить для каждого из приложений заголовок, а для каждого из узлов создать отдельное имя участника-службы. При настройке заголовков узлов изменения в DNS придется вносить вне зависимости от настройки служб [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .  
  
 Значения \<*computername*> и \<*domainname*> составляют уникальный сетевой адрес компьютера, на котором расположен сервер отчетов. Это может быть как локальное имя узла, так и полное доменное имя. Если у вас единственный домен, то \<*domainname*> можно не указывать в команде. \<*domain-user-account*> — это учетная запись пользователя, с которой будет выполняться служба сервера отчетов. Для нее должно быть зарегистрировано имя субъекта-службы.  
  
## <a name="register-an-spn-for-domain-user-account"></a>Регистрация имени участника-службы для учетной записи пользователя домена  
  
### <a name="to-register-an-spn-for-a-report-server-service-running-as-a-domain-user"></a>Регистрация имени участника-службы для службы сервера отчетов, которая запускается от имени пользователя домена  
  
1.  Установите службы [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] и настройте службу сервера отчетов для запуска от учетной записи пользователя домена. Не забывайте, что пользователи не смогут соединиться с сервером отчетов до тех пор, пока не будут выполнены все описанные ниже шаги.  
  
2.  Войдите на контроллер домена как администратор домена.  
  
3.  Откройте окно командной строки и  
  
4.  Скопируйте следующую команду, заменив заполнители значениями для конкретной сети:  
  
    ```  
    Setspn -s http/<computer-name>.<domain-name> <domain-user-account>  
    ```  
  
    Например: `Setspn -s http/MyReportServer.MyDomain.com MyDomainUser`  
  
5.  Выполните команду.  
  
6.  Откройте файл **RsReportServer.config** и найдите раздел `<AuthenticationTypes>` .  
  
7.  Добавьте `<RSWindowsNegotiate/>` в качестве первой записи этого раздела для включения Kerberos.  
  
## <a name="see-also"></a>См. также:  
 [Настройка учетной записи службы (диспетчер конфигурации служб SSRS)](../install-windows/configure-the-report-server-service-account-ssrs-configuration-manager.md)   
 [Настройка учетной записи службы сервера отчетов (диспетчер конфигурации служб SSRS)](../../reporting-services/install-windows/configure-the-report-server-service-account-ssrs-configuration-manager.md)   
 [Управление сервером отчетов Reporting Services в собственном режиме](../../reporting-services/report-server/manage-a-reporting-services-native-mode-report-server.md)  
  
  
