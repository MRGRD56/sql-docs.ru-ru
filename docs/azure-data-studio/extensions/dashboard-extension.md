---
title: Создания расширения панели мониторинга
description: В этом учебнике показано, как создать расширение панели мониторинга, чтобы добавить пользовательские функции для Azure Data Studio.
ms.prod: azure-data-studio
ms.technology: azure-data-studio
ms.topic: how-to
author: yualan
ms.author: alayu
ms.reviewer: alayu, maghan
ms.custom: ''
ms.date: 08/28/2020
ms.openlocfilehash: 835b1fd4687dc5fd86afe300d7c6ed56dc2ed6ea
ms.sourcegitcommit: cc23d8646041336d119b74bf239a6ac305ff3d31
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/23/2020
ms.locfileid: "91111639"
---
# <a name="create-an-azure-data-studio-dashboard-extension"></a>Создание расширения панели мониторинга в Azure Data Studio

В этом учебнике показано, как создать **расширение панели мониторинга в Azure Data Studio**. Это расширение связано с панелью мониторинга подключений Azure Data Studio, поэтому вы можете расширить функциональные возможности Azure Data Studio так, чтобы это было заметно пользователям.

В этом руководстве вы узнаете, как выполнять следующие задачи.
> [!div class="checklist"]
> - Установка генератора расширений
> - Создание расширения
> - Вклад в панель мониторинга в расширении
> - Тестирование расширения
> - Упаковка расширения
> - Публикация расширения в Marketplace

## <a name="prerequisites"></a>Предварительные требования

Средство Azure Data Studio основано на той же платформе, что и Visual Studio Code, поэтому расширения для Azure Data Studio создаются с помощью Visual Studio Code. Чтобы приступить к работе, вам потребуются следующие компоненты.

- Установленный [Node.js](https://nodejs.org), доступный в вашей переменной `$PATH`. Node.js включает в себя [npm](https://www.npmjs.com/), диспетчер пакетов Node.js, который будет использоваться для установки генератора расширений.
- [Visual Studio Code](https://code.visualstudio.com) для отладки расширения.
- [Расширение отладки](https://marketplace.visualstudio.com/items?itemName=ms-mssql.sqlops-debug) Azure Data Studio (необязательно). Оно позволяет протестировать расширение без необходимости упаковывать и устанавливать его в Azure Data Studio.
- Убедитесь, что `azuredatastudio` указан в вашем пути. Для Windows выберите параметр `Add to Path` в setup.exe. Для Mac или Linux выберите параметр *Установить путь к команде azuredatastudio в PATH*.

## <a name="install-the-extension-generator"></a>Установка генератора расширений

Чтобы упростить процесс создания расширений, мы создали [генератор расширений](https://code.visualstudio.com/docs/extensions/yocode) с помощью Yeoman. Для его установки выполните следующую команду в командной строке.

```console
`npm install -g yo generator-azuredatastudio`
```

## <a name="create-your-dashboard-extension"></a>Создание расширения панели мониторинга

### <a name="introduction-to-the-dashboard"></a>Общие сведения о панели мониторинга

Панель мониторинга подключений Azure Data Studio — это эффективный инструмент, который предоставляет общие и аналитические сведения о подключениях пользователя.

Существует два варианта панели мониторинга: панель мониторинга сервера, которая предоставляет общие сведения обо всем сервере, и панель мониторинга базы данных, которая предоставляет общие сведения об отдельной базе данных. Доступ можно получить, щелкнув правой кнопкой мыши сервер или базу данных в разделе "Подключения" в Azure Data Studio и выбрав **Управление**:

:::image type="content" source="media/dashboard-extension/dashboard-summary.gif" alt-text="Введение в панели мониторинга":::

Существуют три ключевые точки вклада для расширений, чтобы добавить функциональные возможности на панель мониторинга.

1. **Вкладка панели мониторинга**. Отдельная вкладка на панели мониторинга для вашего расширения. Можно добавить на панель мониторинга сервера или базы данных. Настраивается с помощью мини-приложений, панели инструментов и раздела навигации.
2. **Действия на домашней странице**. Кнопки действий в верхней части панели инструментов подключения.
3. **Мини-приложения**. Графы, которые выполняются для SQL Server.

:::image type="content" source="media/dashboard-extension/dashboard-contrib-points.png" alt-text="Точки вклада":::

### <a name="run-the-extension-generator"></a>Запуск генератора расширений

Для создания расширения сделайте следующее.

1. Запустите генератор расширений с помощью следующей команды.

   `yo azuredatastudio`

2. Выберите **Новая панель мониторинга** в списке типов расширений.

3. Заполните запросы, как показано ниже. При этом создается расширение, которое создает вкладку на панели мониторинга сервера.

:::image type="content" source="media/dashboard-extension/dashboard-generator.png" alt-text="Генератор расширений":::

Существует множество запросов, поэтому ниже приведены некоторые сведения о том, что означает каждый вопрос:

:::image type="content" source="media/dashboard-extension/dashboard-flowchart.png" alt-text="Блок-схема панелей мониторинга":::

При выполнении предыдущих шагов создается папка. Откройте ее в Visual Studio Code, после чего вы сможете создать собственное расширение панели мониторинга.

### <a name="run-the-extension"></a>Запуск расширения

Давайте посмотрим, что делает шаблон панели мониторинга, запустив расширение. Перед запуском убедитесь, что в Visual Studio Code установлено **расширение отладки Azure Data Studio**.

Нажмите клавишу **F5** в Visual Studio Code, чтобы запустить Azure Data Studio в режиме отладки с запущенным расширением. Затем посмотрите, как этот шаблон по умолчанию вносит вклад на панели мониторинга.

Далее мы рассмотрим, как изменить эту панель мониторинга по умолчанию.

### <a name="develop-the-dashboard"></a>Разработка панели мониторинга

Разработку расширения нужно начать с самого важного файла — `package.json`. Это файл манифеста, в котором зарегистрированы вклады панелей мониторинга. Обратите внимание на разделы `dashboard.tabs`, `dashboard.insights` и `dashboard.containers`.

Можно попробовать внести следующие изменения:

- Поэкспериментируйте с типами аналитических сведений, включая bar, horizontalBar, timeSeries.
- Напишите собственные запросы, которые будут выполняться через подключение к SQL Server.
- Ознакомьтесь [с этим](../tutorial-qds-sql-server.md) или [этим](../tutorial-table-space-sql-server.md) примером аналитических сведений.

## <a name="package-your-extension"></a>Упаковка расширения

Чтобы предоставить общий доступ другим пользователям, нужно упаковать расширение в один файл. Его можно опубликовать в магазине расширений Azure Data Studio или предоставить для общего доступа другим участникам команды или сообщества. Для этого нужно установить другой пакет npm из командной строки.

```console
`npm install -g vsce`
```

Измените `README.md` по желанию, перейдите к базовому каталогу расширения и выполните команду `vsce package`. При необходимости можно связать репозиторий с расширением или продолжить работу без него. Чтобы добавить его, добавьте аналогичную строку в файл `package.json`.

```json
"repository": {
    "type": "git",
    "url": "https://github.com/anjalia/my-test-extension.git"
}
```

После добавления этих строк создается файл my-test-extension-0.0.1.vsix, готовый для установки в Azure Data Studio.

:::image type="content" source="media/dashboard-extension/install-vsix.png" alt-text="Установка VSIX":::

## <a name="publish-your-extension-to-the-marketplace"></a>Публикация расширения в Marketplace

Магазин расширений Azure Data Studio пока реализован не полностью, но текущая процедура заключается в размещении VSIX расширения где-либо (например, на странице выпуска GitHub) и последующей отправке запроса на вытягивание для обновления [этого JSON-файла](https://github.com/Microsoft/azuredatastudio/blob/release/extensions/extensionsGallery.json) с использованием сведений о расширении.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:
> [!div class="checklist"]
> - Установка генератора расширений
> - Создание расширения
> - Вклад в панель мониторинга в расширении
> - Тестирование расширения
> - Упаковка расширения
> - Публикация расширения в Marketplace

Мы надеемся, что после ознакомления с этим материалом вы захотите создать собственное расширение для Azure Data Studio. Мы обеспечиваем поддержку Dashboard Insights (симпатичное графическое решение, предназначенное для SQL Server), нескольких SQL-ориентированных API, а также обширного набора точек расширений, унаследованных от Visual Studio Code.

Если у вас появилась идея, но вы не знаете, с чего начать, откройте вопрос или отправьте твит нашей команде: [azuredatastudio](https://twitter.com/azuredatastudio).

Вы всегда можете обратиться к [руководству по расширениям Visual Studio Code](https://code.visualstudio.com/docs/extensions/overview), так как оно охватывает все существующие API и шаблоны.

Чтобы узнать, как работать с T-SQL в Azure Data Studio, изучите руководство по редактору T-SQL:

> [!div class="nextstepaction"]
> [Создание объектов базы данных с помощью редактора Transact-SQL](../tutorial-sql-editor.md).
