---
description: Безопасность темпоральных таблиц
title: Защита темпоральных таблиц | Документация Майкрософт
ms.custom: ''
ms.date: 10/16/2019
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
ms.assetid: 60e5d6f6-a26d-4bba-aada-42e382bbcd38
author: markingmyname
ms.author: maghan
monikerRange: =azuresqldb-current||>=sql-server-2016||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: 244a625cb41d05f0d2f7cf61e8d6631a85dc8a4e
ms.sourcegitcommit: 1a544cf4dd2720b124c3697d1e62ae7741db757c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2020
ms.locfileid: "97462565"
---
# <a name="temporal-table-security"></a>Безопасность темпоральных таблиц


[!INCLUDE [sqlserver2016-asdb-asdbmi](../../includes/applies-to-version/sqlserver2016-asdb-asdbmi.md)]


Для понимания безопасности применительно к темпоральным таблицам важно понять принципы безопасности, касающиеся темпоральных таблиц. Изучив эти принципы безопасности, можно приступить к рассмотрению вопросов безопасности относительно инструкций **CREATE TABLE**, **ALTER TABLE** и **SELECT** .

## <a name="security-principles"></a>Принципы безопасности

 В следующей таблице описаны принципы безопасности, применимые к темпоральным таблицам.

|Принцип|Description|
|---------------|-----------------|
|Включение и отключение системного управления версиями требует наивысших прав на затронутые объекты|Для включения и отключения SYSTEM_VERSIONING необходимо разрешение CONTROL как для текущей, так и для прежней таблицы|
|Данные за прошедший период нельзя изменить напрямую|Если параметр SYSTEM_VERSIONING включен (ON), пользователи не могут изменять данные за прошедший период независимо от своих фактических разрешений для текущей или прежней таблицы. Это относится к изменениям как данных, так и схемы.|
|Для отправки запросов к данным за прошедший период требуются разрешения **SELECT** для прежней таблицы|То, что у пользователя есть разрешение **SELECT** для текущей таблицы, не означает, что у него есть разрешение **SELECT** для прежней таблицы.|
|Аудит показывает операции, затрагивающие прежнюю таблицу определенными способами:|Параметры аудита из текущей таблицы не применяются к таблице журнала автоматически. Для таблицы журнала аудит необходимо включать явно.<br /><br /> После включения аудита для таблицы журнала будут регулярно фиксироваться все попытки прямого доступа к данным (независимо от того, были ли они успешными).<br /><br /> **SELECT** с расширением темпорального запроса показывает, что прежняя таблица была затронута соответствующей операцией.<br /><br /> Темпоральная таблица **CREATE/ALTER** предоставляет информацию о том, что проверка разрешения выполняется также для прежней таблицы. Файл аудита будет содержать дополнительную запись для прежней таблицы.<br /><br /> Операции DML над текущей таблицей показывают, что прежняя таблица была затронута, но additional_info предоставляет необходимый контекст (DML — это результат system_versioning).|

## <a name="performing-schema-operations"></a>Выполнение операций со схемой

Если параметр SYSTEM_VERSIONING включен (ON), операции изменения схемы ограничены.

### <a name="disallowed-alter-schema-operations"></a>Запрещенные операции ALTER над схемой

|Операция|Текущая таблица|Прежняя таблица|
|---------------|-------------------|-------------------|
|**DROP TABLE**|Запрещено|Запрещено|
|**ALTER TABLE…SWITCH PARTITION**|Только SWITCH IN (см. раздел [Секционирование с использованием темпоральных таблиц](../../relational-databases/tables/partitioning-with-temporal-tables.md))|Только SWITCH OUT (см. раздел [Секционирование с использованием темпоральных таблиц](../../relational-databases/tables/partitioning-with-temporal-tables.md))|
|**ALTER TABLE…DROP PERIOD**|Запрещено|-|
|**ALTER TABLE…ADD PERIOD**|-|Запрещено|

## <a name="allowed-alter-table-operations"></a>Разрешенные операции ALTER TABLE

|Операция|Текущий|Журнал|
|---------------|-------------|-------------|
|**ALTER TABLE...REBUILD**|Допускается (независимо друг от друга)|Допускается (независимо друг от друга)|
|**CREATE INDEX**|Допускается (независимо друг от друга)|Допускается (независимо друг от друга)|
|**CREATE STATISTICS**|Допускается (независимо друг от друга)|Допускается (независимо друг от друга)|

## <a name="security-of-the-create-temporal-table-statement"></a>Безопасность инструкции CREATE Temporal TABLE

| Компонент | Создание новой прежней таблицы | Повторное использование существующей прежней таблицы |
| ------- | ------------------------ | ---------------------------- |
|Требуемое разрешение|Разрешение **CREATE TABLE** в базе данных<br /><br /> Разрешение **ALTER** на схемы, в которых создаются текущие таблицы и прежней таблицы|Разрешение **CREATE TABLE** в базе данных<br /><br /> Разрешение **ALTER** на схемы, в которых будет создана текущая таблица<br /><br /> Разрешение **CONTROL** для прежней таблицы, указанной как часть инструкции **CREATE TABLE** , которая создает темпоральную таблицу|
|Аудит|Аудит показывает, что пользователи пытались создать два объекта. Операция может завершиться ошибкой из-за отсутствия разрешений на создание таблицы в базе данных или из-за отсутствия разрешений на изменение схем для любой из таблиц.|Аудит показывает, что темпоральная таблица была создана. Операция может завершиться ошибкой из-за отсутствия разрешения на создание таблицы в базе данных, из-за отсутствия разрешений на изменение схемы для темпоральной таблицы или из-за отсутствия разрешений на прежнюю таблицу.|

## <a name="security-of-the-alter-temporal-table-set-system_versioning-onoff-statement"></a>Безопасность инструкции ALTER Temporal TABLE SET (SYSTEM_VERSIONING ON/OFF)

| Компонент | Создание новой прежней таблицы | Повторное использование существующей прежней таблицы |
| ------- | ------------------------ | ---------------------------- |
|Требуемое разрешение|Разрешение **CONTROL** в базе данных<br /><br /> Разрешение **CREATE TABLE** в базе данных<br /><br /> Разрешение **ALTER** на схемы, в которых создается прежняя таблица|Разрешение **CONTROL** на исходную таблицу, которая изменяется<br /><br /> Разрешение **CONTROL** на прежнюю таблицу, указанную как часть инструкции **ALTER TABLE**|
|Аудит|Аудит показывает, что темпоральная таблица была изменена и в то же время была создана прежняя таблица. Операция может завершиться ошибкой из-за отсутствия разрешений на создание таблицы в базе данных, из-за отсутствия разрешений на изменение схемы для прежней таблицы или из-за отсутствия разрешений на изменение темпоральной таблицы.|Аудит показывает, что темпоральная таблица была изменена, но для операции потребовался доступ к прежней таблице. Операция может завершиться ошибкой из-за отсутствия разрешений на прежнюю таблицу или из-за отсутствия разрешений на текущую таблицу.|

## <a name="security-of-select-statement"></a>Безопасность инструкции SELECT

Разрешение **SELECT** не изменяется для инструкций **SELECT** , которые не влияют на прежнюю таблицу. Для инструкций **SELECT** , влияющих на прежнюю таблицу, требуется разрешение **SELECT** как на текущую, так и на прежнюю таблицу.

## <a name="see-also"></a>См. также:

- [Темпоральные таблицы](../../relational-databases/tables/temporal-tables.md) 
- [Приступая к работе c темпоральными таблицами с системным управлением версиями](../../relational-databases/tables/getting-started-with-system-versioned-temporal-tables.md)
- [Проверка согласованности системной темпоральной таблицы](../../relational-databases/tables/temporal-table-system-consistency-checks.md)
- [Секционирование с помощью темпоральных таблиц](../../relational-databases/tables/partitioning-with-temporal-tables.md)
- [Рекомендации и ограничения для темпоральной таблицы](../../relational-databases/tables/temporal-table-considerations-and-limitations.md)
- [Управление хранением данных журнала в темпоральных таблицах с системным управлением версиями](../../relational-databases/tables/manage-retention-of-historical-data-in-system-versioned-temporal-tables.md)
- [Темпоральные таблицы с системным управлением версиями и таблицы, оптимизированные для памяти](../../relational-databases/tables/system-versioned-temporal-tables-with-memory-optimized-tables.md)
- [Представления и функции метаданных для временной таблицы](../../relational-databases/tables/temporal-table-metadata-views-and-functions.md)
