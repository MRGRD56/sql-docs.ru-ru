---
title: T-SQL, не поддерживаемые в выполняющейся в памяти OLTP
description: Узнайте, какие функции Transact-SQL не поддерживаются для оптимизированных для памяти таблиц, скомпилированных в собственном коде хранимых процедур и определяемых пользователем функций.
ms.custom: seo-dt-2019
ms.date: 11/21/2017
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: e3f8009c-319d-4d7b-8993-828e55ccde11
author: MightyPen
ms.author: genemi
monikerRange: =azuresqldb-current||>=sql-server-2016||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: a41ac84e7e34e0df190c725d9dbadf84f15cac47
ms.sourcegitcommit: b1cec968b919cfd6f4a438024bfdad00cf8e7080
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2021
ms.locfileid: "100353634"
---
# <a name="transact-sql-constructs-not-supported-by-in-memory-oltp"></a>Конструкции языка Transact-SQL, неподдерживаемые в In-Memory OLTP
[!INCLUDE [SQL Server Azure SQL Database](../../includes/applies-to-version/sql-asdb.md)]

  Оптимизированные для памяти таблицы, скомпилированные хранимые процедуры и определяемые пользователем функции не поддерживают полную контактную зону [!INCLUDE[tsql](../../includes/tsql-md.md)], которая поддерживается дисковыми таблицами и интерпретируемыми хранимыми процедурами [!INCLUDE[tsql](../../includes/tsql-md.md)], а также определяемыми пользователем функциями. При попытке использовать одну из неподдерживаемых функций сервер возвращает ошибку.  
  
 Текст сообщения об ошибке указывает тип инструкции [!INCLUDE[tsql](../../includes/tsql-md.md)] (функции, операции, параметра), а также имя функции или ключевое слово [!INCLUDE[tsql](../../includes/tsql-md.md)] . Большинство неподдерживаемых функций возвращают ошибку 10794, а текст сообщения об ошибке указывает на неподдерживаемую функцию. В следующей таблице перечислены функции и ключевые слова [!INCLUDE[tsql](../../includes/tsql-md.md)] , которые могут появиться в тексте сообщения об ошибке, а также действие по ее исправлению.  
  
 Дополнительные сведения о поддерживаемых функциях для оптимизированных для памяти таблиц и скомпилированных в собственном коде хранимых процедур см. на следующих ресурсах:  
  
-   [Проблемы миграции, связанные с хранимыми процедурами, скомпилированными в собственном коде](./a-guide-to-query-processing-for-memory-optimized-tables.md)  
  
-   [Поддержка Transact-SQL для выполняющейся в памяти OLTP](../../relational-databases/in-memory-oltp/transact-sql-support-for-in-memory-oltp.md)  
  
-   [Неподдерживаемые функции SQL Server для выполняющейся в памяти OLTP](../../relational-databases/in-memory-oltp/unsupported-sql-server-features-for-in-memory-oltp.md)  
  
-   [Скомпилированные в собственном коде хранимые процедуры](./a-guide-to-query-processing-for-memory-optimized-tables.md)  
  
## <a name="databases-that-use-in-memory-oltp"></a>Базы данных, использующие OLTP в памяти  
 В следующей таблице перечислены неподдерживаемые функции [!INCLUDE[tsql](../../includes/tsql-md.md)] , а также ключевые слова, которые могут присутствовать в тексте сообщения об ошибке, связанной с базой данных In-Memory OLTP. В таблице также перечислены пути устранения ошибки.  
  
|Тип|Имя|Решение|  
|----------|----------|----------------|  
|Параметр|AUTO_CLOSE|Параметр базы данных AUTO_CLOSE=ON не поддерживается для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA.|  
|Параметр|ATTACH_REBUILD_LOG|Параметр ATTACH_REBUILD_LOG инструкции CREATE базы данных не поддерживается для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA.|  
|Компонент|DATABASE SNAPSHOT|Создание моментальных снимков базы данных не поддерживается для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA.|  
|Компонент|Репликация с помощью метода синхронизации «database snapshot» или «database snapshot character»|Репликация с помощью метода синхронизации «database snapshot» или «database snapshot character» не поддерживается для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA.|  
|Компонент|DBCC CHECKDB<br /><br /> DBCC CHECKTABLE|DBCC CHECKDB пропускает оптимизированные для памяти таблицы в базе данных.<br /><br /> DBCC CHECKTABLE для таблиц, оптимизированных для памяти, завершается ошибкой.|  
  
## <a name="memory-optimized-tables"></a>Таблицы, оптимизированные для памяти  
 В следующей таблице перечислены неподдерживаемые функции [!INCLUDE[tsql](../../includes/tsql-md.md)] , а также ключевые слова, которые могут присутствовать в тексте сообщения об ошибке, связанной с оптимизированными для памяти таблицами. В таблице также перечислены пути устранения ошибки.  
  
|Тип|Имя|Решение|  
|----------|----------|----------------|  
|Компонент|ON|Оптимизированные для памяти таблицы не могут размещаться в файловой группе или схеме секционирования. Удалите предложение ON из инструкции **CREATE TABLE** .<br /><br /> Все оптимизированные для памяти таблицы сопоставляются с оптимизированной для памяти файловой группой.|  
|Тип данных|*Название типа данных*|Указанный тип данных не поддерживается. Замените этот тип одним из поддерживаемых типов данных. Дополнительные сведения см. в статье [Поддерживаемые типы данных для выполняющейся в памяти OLTP](../../relational-databases/in-memory-oltp/supported-data-types-for-in-memory-oltp.md).|  
|Компонент|Вычисляемые столбцы|**Область применения:** [!INCLUDE[ssSQL14-md](../../includes/sssql14-md.md)] и [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>Вычисляемые столбцы не поддерживаются для оптимизированных для памяти таблиц. Удалите вычисляемые столбцы из инструкции **CREATE TABLE** .<br/><br/>[!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE[sssql17-md](../../includes/sssql17-md.md)] поддерживают вычисляемые столбцы в оптимизированных для памяти таблицах и индексах.|  
|Компонент|Репликация|Репликация не поддерживается для таблиц, оптимизированных для памяти.|  
|Компонент|FILESTREAM|Хранилище FILESTREAM не поддерживает столбцы оптимизированных для памяти таблиц. Удалите ключевое слово **FILESTREAM** из определения столбца.|  
|Компонент|SPARSE|Столбцы оптимизированных для памяти таблиц не могут быть определены как SPARSE. Удалите ключевое слово **SPARSE** из определения столбца.|  
|Компонент|ROWGUIDCOL|Параметр ROWGUIDCOL не поддерживается для столбцов таблиц, оптимизированных для памяти. Удалите ключевое слово **ROWGUIDCOL** из определения столбца.|  
|Компонент|FOREIGN KEY|**Область применения:** [!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server, начиная с версии [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>Для таблиц, оптимизированных для памяти, ограничения FOREIGN KEY поддерживаются только для внешних ключей, ссылающихся на первичные ключи других таблиц, оптимизированных для памяти. Удалите ограничение из определения таблицы, если внешний ключ ссылается на уникальное ограничение.<br/><br/>В [!INCLUDE[ssSQL14-md](../../includes/sssql14-md.md)] ограничения FOREIGN KEY не поддерживаются в оптимизированных для памяти таблицах.|  
|Компонент|кластеризованный индекс|Укажите некластеризованный индекс. В случае использования индекса первичного ключа необходимо указать **PRIMARY KEY NONCLUSTERED**.|  
|Компонент|DDL в транзакциях|Оптимизированные для памяти таблицы и скомпилированные хранимые процедуры нельзя создавать или удалять в контексте пользовательской транзакции. Не начинайте транзакцию до выполнения инструкции CREATE или DROP и проверьте, чтобы параметр сеанса IMPLICIT_TRANSACTIONS имел значение OFF.|  
|Компонент|DDL, триггеры|Оптимизированные для памяти таблицы и скомпилированные хранимые процедуры нельзя создать или удалить, если есть триггер сервера или базы данных для этой DDL-операции. Удалите триггеры сервера и базы данных для операций CREATE/DROP TABLE и CREATE/DROP PROCEDURE.|  
|Компонент|EVENT NOTIFICATION|Оптимизированные для памяти таблицы и скомпилированные хранимые процедуры нельзя создать или удалить, если есть уведомление о событии сервера или базы данных для этой DDL-операции. Удалите уведомления о событиях сервера и базы данных в CREATE TABLE или DROP TABLE, а также в CREATE PROCEDURE или DROP PROCEDURE.|  
|Компонент|FileTable|Оптимизированные для памяти таблицы не могут быть созданы как файловые таблицы. Удалите аргумент **AS FileTable** из инструкции **CREATE TABLE** .|  
|Операция|Обновление столбцов первичного ключа|Столбцы первичного ключа в оптимизированных для памяти таблицах и табличных типах нельзя обновить. Если первичный ключ должен быть обновлен, удалите старую строку и вставьте новую строку с обновленным первичным ключом.|  
|Операция|CREATE INDEX|Индексы в оптимизированных для памяти таблицах нужно указывать в инструкции **CREATE TABLE** или **ALTER TABLE** .|  
|Операция|CREATE FULLTEXT INDEX|Полнотекстовые индексы не поддерживаются с оптимизированными для памяти таблицами.|  
|Операция|изменение схемы|Оптимизированные для памяти таблицы и скомпилированные в машинный код хранимые процедуры не поддерживают некоторые изменения схемы.<br/> [!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE [sssql17-md](../../includes/sssql17-md.md)]: операции ALTER TABLE, ALTER PROCEDURE и sp_rename поддерживаются. Другие изменения схемы, например добавление расширенных свойств, не поддерживаются.<br/><br/>[!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]: операции ALTER TABLE и ALTER PROCEDURE поддерживаются. Другие изменения схемы, включая sp_rename, не поддерживаются.<br/><br/>[!INCLUDE[ssSQL14-md](../../includes/sssql14-md.md)]: изменения схемы не поддерживаются. Чтобы изменить определение оптимизированной для памяти таблицы или скомпилированной в машинный код хранимой процедуры, сначала удалите объект, а затем создайте его повторно с требуемым определением.| 
|Операция|TRUNCATE TABLE|Операция TRUNCATE не поддерживается для оптимизированных для памяти таблиц. Удалить все строки из таблицы можно с помощью **DELETE FROM**_таблица_ . Или удалите таблицу и создайте ее повторно.|  
|Операция|ALTER AUTHORIZATION|Изменение владельца существующей оптимизированной для памяти таблицы или скомпилированной хранимой процедуры не поддерживается. Для изменения владельца удалите и заново создайте таблицу или процедуру.|  
|Операция|ALTER SCHEMA|Передача существующей таблицы или скомпилированной в машинный код хранимой процедуры в другую схему не поддерживается. Чтобы передать объект из одной схемы в другую, удалите его, а затем создайте повторно.|  
|Операция|DBCC CHECKTABLE|Операции DBCC CHECKTABLE не поддерживаются для таблиц, оптимизированных для памяти. Чтобы проверить целостность файлов контрольных точек на диске, выполните резервное копирование файловой группы MEMORY_OPTIMIZED_DATA.|  
|Компонент|ANSI_PADDING OFF|Параметр сеанса **ANSI_PADDING** должен быть установлен в ON при создании оптимизированной для памяти таблицы или скомпилированной хранимой процедуры. Выполните **SET ANSI_PADDING ON** перед выполнением инструкции CREATE.|  
|Параметр|DATA_COMPRESSION|Сжатие данных не поддерживается для оптимизированных для памяти таблиц. Удалите выбранный параметр из определения таблицы.|  
|Компонент|DTC|Оптимизированные для памяти таблицы и скомпилированные хранимые процедуры недоступны из распределенных транзакций. Вместо этого используйте транзакции SQL.|  
|Операция|Оптимизированные для памяти таблицы в качестве назначения MERGE|Оптимизированные для памяти таблицы не могут быть целью операции **MERGE** . Вместо этого используйте инструкции **INSERT**, **UPDATE** и **DELETE**.|  
  
## <a name="indexes-on-memory-optimized-tables"></a>Индексы для оптимизированных для памяти таблиц  
 В следующей таблице перечислены функции и ключевые слова [!INCLUDE[tsql](../../includes/tsql-md.md)] , которые могут присутствовать в тексте ошибки, связанной с индексом оптимизированной для памяти таблицы, а также действия по исправлению данной ошибки.  
  
|Тип|Имя|Решение|  
|----------|----------|----------------|  
|Компонент|Фильтруемый индекс|Отфильтрованные индексы для таблиц, оптимизированных для памяти, не поддерживаются. Пропустите предложение **WHERE** из определения индекса.|  
|Компонент|Включенные столбцы|Указывать включенные столбцы в отношении оптимизированных для памяти таблиц не требуется. Все столбцы оптимизированной для памяти таблицы неявно включаются в каждый оптимизированный для памяти индекс.|  
|Операция|DROP INDEX|Удаление индексов к таблицам, оптимизированным для памяти, не поддерживается. Вы можете удалить индексы с помощью инструкции ALTER TABLE.<br /><br /> Дополнительные сведения см. в статье [Изменение таблиц с оптимизацией для памяти](../../relational-databases/in-memory-oltp/altering-memory-optimized-tables.md).|  
|Параметр индекса|*Параметр индекса*|Поддерживается только один вариант индекса — BUCKET_COUNT для индексов HASH.|  
  
## <a name="nonclustered-hash-indexes"></a>Некластеризованные хэш-индексы  
 В следующей таблице перечислены функции и ключевые слова [!INCLUDE[tsql](../../includes/tsql-md.md)] , которые могут присутствовать в тексте ошибки, связанной с некластеризованным хэш-индексом, а также действия по исправлению данной ошибки.  
  
|Тип|Имя|Решение|  
|----------|----------|----------------|  
|Параметр|ASC/DESC|Некластеризованные хэш-индексы не упорядочиваются. Удалите ключевые слова **ASC** и **DESC** из спецификации ключа индекса.|  
  
## <a name="natively-compiled-stored-procedures-and-user-defined-functions"></a>Скомпилированные в собственном коде хранимые процедуры и определяемые пользователем функции  
 В следующей таблице перечислены функции [!INCLUDE[tsql](../../includes/tsql-md.md)] и ключевые слова, которые могут присутствовать в тексте ошибки, связанной со скомпилированными хранимыми процедурами и определяемыми пользователем функциями, а также действия по исправлению такой ошибки.  
  
|Тип|Компонент|Решение|  
|----------|-------------|----------------|  
|Компонент|Встроенные табличные переменные|Табличные типы нельзя объявлять как встроенные с объявлениями переменных. Табличные типы должны быть объявлены явно с помощью инструкции **CREATE TYPE** .|  
|Компонент|Курсоры|Курсоры не поддерживаются в пределах хранимых процедур, скомпилированных в собственном коде.<br /><br /> При выполнении процедуры из клиента используйте RPC вместо API курсора. Что касается ODBC, то избегайте инструкции [!INCLUDE[tsql](../../includes/tsql-md.md)] . **EXECUTE**.<br /><br /> При выполнении процедуры из пакета [!INCLUDE[tsql](../../includes/tsql-md.md)] или другой хранимой процедуры следует избегать использования курсора вместе со скомпилированной хранимой процедурой.<br /><br /> При создании скомпилированной хранимой процедуры не используйте курсор, а применяйте логику, основанную на наборах, или цикл **WHILE** .|  
|Компонент|Неконстантные значения по умолчанию для параметров|При использовании значений по умолчанию с параметрами для скомпилированных хранимых процедур эти значения должны быть константами. Удалите все шаблоны из определений параметров.|  
|Компонент|EXTERNAL|Хранимые процедуры CLR нельзя скомпилировать в собственном коде. Удалите предложение AS EXTERNAL или параметр NATIVE_COMPILATION в инструкции CREATE PROCEDURE.|  
|Компонент|Нумерованные хранимые процедуры|Изначально скомпилированные хранимые процедуры нельзя пронумеровать. Удаление **;** _номер_ из инструкции **CREATE PROCEDURE** .|  
|Компонент|Многостроковые инструкции INSERT ... INSERT … VALUES|Нельзя вставить несколько строк с использованием одной и той же инструкции **INSERT** в скомпилированной хранимой процедуре. Создайте инструкции **INSERT** для каждой строки.|  
|Компонент|Обобщенные табличные выражения|Обобщенные табличные выражения (CTE) не поддерживаются в скомпилированных хранимых процедурах. Заново составить запрос.|  
|Компонент|COMPUTE|Предложение **COMPUTE** не поддерживается. Удалите его из запроса.|  
|Компонент|SELECT INTO|Предложение **INTO** в инструкции **SELECT** не поддерживается. Перепишите запрос в следующей форме: **INSERT INTO** _Таблица_ **SELECT**.|  
|Компонент|неполный список вставки столбцов|В общем случае в инструкциях INSERT необходимо указывать значения для всех столбцов таблицы.<br /><br /> Тем не менее мы поддерживаем ограничения DEFAULT и столбцы IDENTITY(1,1) в оптимизированных для памяти таблицах. Эти столбцы могут присутствовать, но если должны присутствовать столбцы IDENTITY, они исключаются из списка столбцов INSERT.|  
|Компонент|*Компонент*|Некоторые встроенные функции не поддерживаются в скомпилированных в собственном коде хранимых процедурах. Удалите такую функцию из хранимой процедуры. Дополнительные сведения о поддерживаемых встроенных функциях см. в следующих источниках:<br />[Поддерживаемые функции для модулей, скомпилированных в собственном коде T-SQL](../../relational-databases/in-memory-oltp/supported-features-for-natively-compiled-t-sql-modules.md)<br />[Скомпилированные в собственном коде хранимые процедуры](./a-guide-to-query-processing-for-memory-optimized-tables.md)|  
|Компонент|CASE|**Область применения:** [!INCLUDE[ssSQL14-md](../../includes/sssql14-md.md)] и SQL Server, начиная с версии [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>Выражения **CASE** не поддерживаются в запросах внутри скомпилированных в машинном коде хранимых процедур. Создайте запросы для каждого случая. Дополнительные сведения см. в статье [Реализация выражения CASE в скомпилированной в собственном коде хранимой процедуре](../../relational-databases/in-memory-oltp/implementing-a-case-expression-in-a-natively-compiled-stored-procedure.md).<br/><br/>[!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE [sssql17-md](../../includes/sssql17-md.md)] поддерживают выражения CASE.|  
|Компонент|INSERT EXECUTE|Удаление ссылки.|  
|Компонент|EXECUTE|Поддерживается только скомпилированными в собственном коде хранимыми процедурами и определяемыми пользователем функциями.|  
|Компонент|пользовательские агрегаты|Определяемые пользователем агрегатные функции нельзя использовать в скомпилированных хранимых процедурах. Удалите ссылку на функцию из процедуры.|  
|Компонент|режим просмотра метаданных|Скомпилированные хранимые процедуры не поддерживают режима обзора метаданных. Убедитесь, что параметр сеанса **NO_BROWSETABLE** установлен в значение OFF.|  
|Компонент|Инструкции DELETE с предложением FROM|В хранимых процедурах, скомпилированных в собственном коде, предложение **FROM** в инструкциях **DELETE** с таблицей-источником не поддерживается.<br /><br /> **DELETE** с предложением **FROM** поддерживается только в том случае, если она используется для указания таблицы, из которой производится удаление.|  
|Компонент|UPDATE с предложением FROM|Предложение **FROM** не поддерживается в инструкциях **UPDATE** скомпилированных хранимых процедур.| 
|Компонент|временные процедуры|Временные хранимые процедуры нельзя скомпилировать в собственном коде. Создайте долговременную скомпилированную хранимую процедуру или временную интерпретируемую хранимую процедуру [!INCLUDE[tsql](../../includes/tsql-md.md)] .|  
|Уровень изоляции|READ UNCOMMITTED|Уровень изоляции READ UNCOMMITTED не поддерживается для скомпилированных хранимых процедур. Используйте поддерживаемый уровень изоляции, например SNAPSHOT.|  
|Уровень изоляции|READ COMMITTED|Уровень изоляции READ COMMITTED не поддерживается для скомпилированных в собственном коде хранимых процедур. Используйте поддерживаемый уровень изоляции, например SNAPSHOT.|  
|Компонент|временные таблицы|Таблицы в базе данных tempdb нельзя использовать в скомпилированных хранимых процедурах. Вместо этого используйте табличную переменную или оптимизированную для памяти таблицу с DURABILITY=SCHEMA_ONLY.|  
|Компонент|DTC|Оптимизированные для памяти таблицы и скомпилированные хранимые процедуры недоступны из распределенных транзакций. Вместо этого используйте транзакции SQL.|  
|Компонент|EXECUTE WITH RECOMPILE|Параметр **WITH RECOMPILE** не поддерживается для скомпилированных хранимых процедур.|  
|Компонент|Выполнение из выделенного административного соединения.|Скомпилированные хранимые процедуры не могут быть выполнены из выделенного административного соединения (DAC). Вместо этого используйте обычное соединение.|  
|Операция|точка сохранения|Скомпилированные хранимые процедуры не могут быть вызваны из транзакции с активной точкой сохранения. Удалите точку сохранения из транзакции.|  
|Операция|ALTER AUTHORIZATION|Изменение владельца существующей оптимизированной для памяти таблицы или скомпилированной хранимой процедуры не поддерживается. Для изменения владельца удалите и заново создайте таблицу или процедуру.|  
|Оператор|OPENROWSET|Данный оператор не поддерживается. Удалите **OPENROWSET** из скомпилированной хранимой процедуры.|  
|Оператор|OPENQUERY|Данный оператор не поддерживается. Удалите **OPENQUERY** из скомпилированной хранимой процедуры.|  
|Оператор|OPENDATASOURCE|Данный оператор не поддерживается. Удалите **OPENDATASOURCE** из скомпилированной хранимой процедуры.|  
|Оператор|OPENXML|Данный оператор не поддерживается. Удалите **OPENXML** из скомпилированной хранимой процедуры.|  
|Оператор|CONTAINSTABLE|Данный оператор не поддерживается. Удалите **CONTAINSTABLE** из скомпилированной хранимой процедуры.|  
|Оператор|FREETEXTTABLE|Данный оператор не поддерживается. Удалите **FREETEXTTABLE** из скомпилированной хранимой процедуры.|  
|Компонент|функции с табличным значением|К функциям с табличным значением не может производиться обращение из скомпилированных хранимых процедур. Одно возможное решение для этого ограничения — добавление логики для функций с табличным значением в текст процедуры.|  
|Оператор|CHANGETABLE|Данный оператор не поддерживается. Удалите **CHANGETABLE** из скомпилированной хранимой процедуры.|  
|Оператор|GOTO|Данный оператор не поддерживается. Используйте другие конструкции, такие как WHILE.|  
|Оператор|OFFSET|Данный оператор не поддерживается. Удалите **OFFSET** из скомпилированной хранимой процедуры.|  
|Оператор|INTERSECT|Данный оператор не поддерживается. Удалите **INTERSECT** из скомпилированной хранимой процедуры. В некоторых случаях можно использовать INNER JOIN, чтобы получить тот же результат.|  
|Оператор|EXCEPT|Данный оператор не поддерживается. Удалите **EXCEPT** из скомпилированной хранимой процедуры.|  
|Оператор|APPLY|**Область применения:** [!INCLUDE[ssSQL14-md](../../includes/sssql14-md.md)] и SQL Server, начиная с версии [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>Данный оператор не поддерживается. Удалите **APPLY** из скомпилированной хранимой процедуры.<br/><br/>[!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE [sssql17-md](../../includes/sssql17-md.md)] поддерживают оператор APPLY в скомпилированных в машинный код модулях.|  
|Оператор|PIVOT|Данный оператор не поддерживается. Удалите **PIVOT** из скомпилированной хранимой процедуры.|  
|Оператор|UNPIVOT|Данный оператор не поддерживается. Удалите **UNPIVOT** из скомпилированной хранимой процедуры.|  
|Оператор|CONTAINS|Данный оператор не поддерживается. Удалите **CONTAINS** из скомпилированной хранимой процедуры.|  
|Оператор|FREETEXT|Данный оператор не поддерживается. Удалите **FREETEXT** из скомпилированной хранимой процедуры.|  
|Оператор|TSEQUAL|Данный оператор не поддерживается. Удалите **TSEQUAL** из скомпилированной хранимой процедуры.|  
|Оператор|LIKE|Данный оператор не поддерживается. Удалите **LIKE** из скомпилированной хранимой процедуры.|  
|Оператор|NEXT VALUE FOR|Из скомпилированных хранимых процедур нельзя обращаться к последовательностям. Получите значение, используя интерпретируемый код [!INCLUDE[tsql](../../includes/tsql-md.md)], а затем передайте его в скомпилированную хранимую процедуру. Дополнительные сведения см. в статье [Реализация IDENTITY в таблице, оптимизированной для памяти](../../relational-databases/in-memory-oltp/implementing-identity-in-a-memory-optimized-table.md).|  
|Параметр SET|*Параметр*|Параметры SET нельзя изменить внутри скомпилированных хранимых процедур. Некоторые параметры можно задать с помощью инструкции BEGIN ATOMIC. Дополнительные сведения см. в разделе об атомарных блоках в статье [Natively Compiled Stored Procedures](./a-guide-to-query-processing-for-memory-optimized-tables.md).|  
|Операнд|TABLESAMPLE|Данный оператор не поддерживается. Удалите **TABLESAMPLE** из скомпилированной хранимой процедуры.|  
|Параметр|RECOMPILE|Компилируемые хранимые процедуры компилируются во время создания. Удалите **RECOMPILE** из определения процедуры.<br /><br /> Вы можете выполнить sp_recompile для скомпилированной в собственном коде хранимой процедуры, что приведет к повторной компиляции при следующем выполнении.|  
|Параметр|ENCRYPTION|Этот параметр не поддерживается. Удалите **ENCRYPTION** из определения процедуры.|  
|Параметр|FOR REPLICATION|Скомпилированные хранимые процедуры не могут быть созданы во время репликации. Удалите **FOR REPLICATION** из определения процедуры.|  
|Параметр|FOR XML|Этот параметр не поддерживается. Удалите **FOR XML** из скомпилированной хранимой процедуры.|  
|Параметр|FOR BROWSE|Этот параметр не поддерживается. Удалите **FOR BROWSE** из скомпилированной хранимой процедуры.|  
|Указание соединения|HASH, MERGE|Скомпилированные хранимые процедуры поддерживают только соединения во вложенных циклах. Соединения слиянием и хэша не поддерживаются. Удалите указание соединения.|  
|Указание запроса|*Указание запроса*|Данное указание запроса не находится внутри скомпилированных хранимых процедур. Поддерживаемые указания запросов см. в статье [Указания запросов (Transact-SQL)](../../t-sql/queries/hints-transact-sql-query.md).|  
|Параметр|PERCENT|Этот параметр не поддерживается с предложениями **TOP** . Удалите **PERCENT** из запроса в скомпилированной хранимой процедуре.|  
|Параметр|WITH TIES|**Область применения:** [!INCLUDE[ssSDS14_md](../../includes/sssql14-md.md)] и [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>Этот параметр не поддерживается с предложениями **TOP** . Удалите **WITH TIES** из запроса в скомпилированной хранимой процедуре.<br/><br/>[!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE [sssql17-md](../../includes/sssql17-md.md)] поддерживают **TOP WITH TIES**.|  
|Агрегатная функция|*Агрегатная функция*|Поддерживаются не все агрегатные функции. Дополнительные сведения об агрегатных функциях, поддерживаемых в скомпилированных в машинный код модулях T-SQL, см. в разделе [Поддерживаемые функции для модулей, скомпилированных в собственном коде T-SQL](../../relational-databases/in-memory-oltp/supported-features-for-natively-compiled-t-sql-modules.md).|  
|Ранжирующая функция|*Ранжирующая функция*|Ранжирующие функции не поддерживаются в скомпилированных хранимых процедурах. Удалите их из определения процедуры.|  
|Компонент|*Компонент*|Эта функция не поддерживается. Дополнительные сведения о функциях, поддерживаемых в скомпилированных в машинный код модулях T-SQL, см. в разделе [Поддерживаемые функции для модулей, скомпилированных в собственном коде T-SQL](../../relational-databases/in-memory-oltp/supported-features-for-natively-compiled-t-sql-modules.md).|  
|.|*Инструкция*|Данная инструкция не поддерживается. Дополнительные сведения о функциях, поддерживаемых в скомпилированных в машинный код модулях T-SQL, см. в разделе [Поддерживаемые функции для модулей, скомпилированных в собственном коде T-SQL](../../relational-databases/in-memory-oltp/supported-features-for-natively-compiled-t-sql-modules.md).|  
|Компонент|Значения MIN и MAX, используемые с двоичными и символьными строками|Агрегатные функции **MIN** и **MAX** нельзя использовать для символьных и двоичных строковых значений в скомпилированных хранимых процедурах.|  
|Компонент|GROUP BY ALL|ALL нельзя использовать с предложениями GROUP BY в скомпилированных в собственном коде хранимых процедурах. Удалите ALL из предложения GROUP BY.|  
|Компонент|GROUP BY ()|Группирование по пустому списку не поддерживается. Либо удалите предложение GROUP BY, либо включите столбцы в список группирования.|  
|Компонент|ROLLUP|**ROLLUP** нельзя использовать с предложениями **GROUP BY** в скомпилированных в собственном коде хранимых процедурах. Удалите **ROLLUP** из определения процедуры.|  
|Компонент|CUBE|**CUBE** нельзя использовать с предложениями **GROUP BY** в скомпилированных в собственном коде хранимых процедурах. Удалите **CUBE** из определения процедуры.|  
|Компонент|GROUPING SETS|**GROUPING SETS** нельзя использовать с предложениями **GROUP BY** в скомпилированных в собственном коде хранимых процедурах. Удалите **GROUPING SETS** из определения процедуры.|  
|Компонент|BEGIN TRANSACTION, COMMIT TRANSACTION и ROLLBACK TRANSACTION|Используйте блоки ATOMIC для управления транзакциями и обработки ошибок. Дополнительные сведения см. в статье [Atomic Blocks](../../relational-databases/in-memory-oltp/atomic-blocks-in-native-procedures.md).|  
|Компонент|Встроенные объявления табличной переменной.|Табличные переменные должны ссылаться на явно определенные табличные типы с оптимизацией для памяти. Необходимо создать тип оптимизированной для памяти таблицы и использовать этот тип для объявления переменной вместо указания встроенного типа.|  
|Компонент|Таблицы на диске|Доступ к таблицам на диске нельзя осуществлять из скомпилированных в собственном коде хранимых процедур. Удаляйте ссылки на таблицы на диске из скомпилированных в собственном коде хранимых процедур. Либо выполните миграцию таблиц на диске в таблицы, оптимизированные для памяти.|  
|Компонент|Представления|Доступ к представлениям нельзя осуществлять из скомпилированных в собственном коде хранимых процедур. Вместо представлений ссылайтесь на базовые таблицы.|  
|Компонент|Функции с табличным значением|**Область применения:** [!INCLUDE[ssSDSFull_md](../../includes/ssSDSFull-md.md)] и SQL Server начиная с версии [!INCLUDE[ssSQL15-md](../../includes/sssql16-md.md)]<br/>К функциям с несколькими инструкциями и табличными значениями нельзя обращаться из скомпилированных в машинный код модулей T-SQL. Встроенные функции с табличными значениями поддерживаются, но должны создаваться с пометкой WITH NATIVE_COMPILATION.<br/><br/>**Область применения**: [!INCLUDE[ssSQL14-md](../../includes/ssSQL14-md.md)]<br/>К функциям с табличными значениями нельзя обращаться из скомпилированных в машинный код модулей T-SQL.|  
|Параметр|PRINT|Удаление ссылки.|  
|Компонент|DDL|Код на языке описания данных DDL не поддерживается в модулях T-SQL, скомпилированных в машинный код.|  
|Параметр|STATISTICS XML|Не поддерживается. Когда вы выполняете запрос с включенным параметром STATISTICS XML, XML-содержимое возвращается без части для скомпилированной в собственном коде хранимой процедуры.|  
  
## <a name="transactions-that-access-memory-optimized-tables"></a>Транзакции, обращающиеся к оптимизированным для памяти таблицам  
 В следующей таблице перечислены функции и ключевые слова [!INCLUDE[tsql](../../includes/tsql-md.md)] , которые могут присутствовать в тексте ошибки, связанной с транзакциями, которые обращаются к оптимизированным для памяти таблицам, а также действия по исправлению данной ошибки.  
  
|Тип|Имя|Решение|  
|----------|----------|----------------|  
|Компонент|точка сохранения|Создание явных точек сохранения в транзакциях, которых обращаются к оптимизированным для памяти таблицам, не поддерживается.|  
|Компонент|привязанная транзакция|Связанные сеансы не могут участвовать в транзакциях, которые обращаются к оптимизированным для памяти таблицам. Не привязывайте сеанс до выполнения процедуры.|  
|Компонент|DTC|Транзакции, осуществляющие доступ к оптимизированным для памяти таблицам, не могут быть распределенными транзакциями.|  
  
## <a name="see-also"></a>См. также:  
 [Миграция в In-Memory OLTP](./plan-your-adoption-of-in-memory-oltp-features-in-sql-server.md)  
  
