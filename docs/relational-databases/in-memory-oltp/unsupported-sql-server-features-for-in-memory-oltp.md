---
title: Неподдерживаемые функции — выполняющаяся в памяти OLTP
description: Сведения о возможностях SQL Server, которые не поддерживаются при работе с оптимизированными для памяти объектами. Просмотрите функции для выполняющейся в памяти OLTP, которые стали поддерживаемыми.
ms.custom: ''
ms.date: 02/21/2020
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: c39f03a7-e223-4fd7-bd30-142e28f51654
author: MightyPen
ms.author: genemi
monikerRange: =azuresqldb-current||>=sql-server-2016||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: f5617201ce5cfb5dd5f341bcb1264ed250109a64
ms.sourcegitcommit: 4d370399f6f142e25075b3714e5c2ce056b1bfd0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91867736"
---
# <a name="unsupported-sql-server-features-for-in-memory-oltp"></a>Неподдерживаемые функции SQL Server для выполняющейся в памяти OLTP
[!INCLUDE [SQL Server Azure SQL Database](../../includes/applies-to-version/sql-asdb.md)]

В этом разделе описаны возможности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , которые не поддерживаются для использования с оптимизированными для памяти объектами. Кроме того, в последнем разделе перечислены функции, которые не поддерживались для выполняющейся в памяти OLTP, однако более поздние версии стали поддерживаться.
  
## <a name="ssnoversion-features-not-supported-for-in-memory-oltp"></a>[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Возможности, которые не поддерживаются для In-Memory OLTP  

Следующие возможности [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не поддерживаются для баз данных, которые содержат оптимизированные для памяти объекты, включая файловую группу данных, оптимизированную для памяти.  

  
|Неподдерживаемая функция|Описание функции|  
|-------------------------|-------------------------|  
|Сжатие данных для оптимизированных для памяти таблиц.|Функцию сжатия данных можно использовать для сжатия данных внутри базы данных, а также уменьшения размера базы данных. Дополнительные сведения см. в разделе [Data Compression](../../relational-databases/data-compression/data-compression.md).|  
|Секционирование оптимизированных для памяти таблиц и хэш-индексов, а также некластеризованных индексов.|Данные секционированных таблиц и индексов подразделяются на блоки, которые могут быть распределены по нескольким файловым группам в базе данных. Дополнительные сведения см. в разделе [Partitioned Tables and Indexes](../../relational-databases/partitions/partitioned-tables-and-indexes.md).|  
| Репликация | За исключением репликации транзакций для подписчиков в таблицы, оптимизированные для памяти, конфигурации репликации несовместимы с таблицами и представлениями, ссылающимися на оптимизированные для памяти таблицы.<br /><br />Если существует файловая группа, оптимизированная для памяти, репликация с помощью sync_mode='database snapshot' не поддерживается.<br /><br />Дополнительные сведения см. в разделе [Репликация на подписчиков оптимизированных для памяти таблиц](../../relational-databases/replication/replication-to-memory-optimized-table-subscribers.md).|
|Зеркальное отображение|Зеркальное отображение не поддерживается для баз данных с файловой группой MEMORY_OPTIMIZED_DATA. Дополнительные сведения о зеркальном отображении базы данных см. в разделе [Зеркальное отображение базы данных (SQL Server)](../../database-engine/database-mirroring/database-mirroring-sql-server.md).|  
|Повторная сборка журнала|Повторная сборка журнала с помощью прикрепления или ALTER DATABASE не поддерживается базами данных с файловой группой MEMORY_OPTIMIZED_DATA.|  
|Связанный сервер|Нельзя получить доступ к связанным серверам в том же запросе или транзакции, в которой используются оптимизированные для памяти таблицы. Дополнительные сведения см. в разделе [Связанные серверы (компонент Database Engine)](../../relational-databases/linked-servers/linked-servers-database-engine.md).|  
|С неполным протоколированием|Вне зависимости от модели восстановления базы данных все операции в устойчивых таблицах, оптимизированных для памяти, всегда полностью протоколируются.|  
|Минимальное протоколирование|Минимальное протоколирование не поддерживается для оптимизированных для памяти таблиц. Дополнительные сведения о минимальном протоколировании см. в статьях [Журнал транзакций &#40;SQL Server&#41;](../../relational-databases/logs/the-transaction-log-sql-server.md) и [Предварительные условия для минимального протоколирования массового импорта данных](../../relational-databases/import-export/prerequisites-for-minimal-logging-in-bulk-import.md).|  
|отслеживание изменений|Отслеживание изменений не поддерживается для оптимизированных для памяти таблиц. |
| DDL, триггеры | Триггеры DDL уровня базы данных и уровня сервера не поддерживаются для таблиц, выполняющихся в памяти OLTP, и для модулей, скомпилированных в собственном коде. |  
| Система отслеживания измененных данных (CDC) | SQL Server 2017 CU15 и более поздние версии поддерживают включение CDC в базах данных с таблицами, оптимизированными в памяти. Это значение применимо только к базе данных и таблицам на диске в базе данных. В более ранних версиях SQL Server систему CDC не допускается использовать с базой данных, содержащей оптимизированные в памяти таблицы, так как внутри CDC используется DDL-триггер для DROP TABLE. |  
| Режим волокон | Режим волокон не поддерживается для таблиц, оптимизированных для памяти.<br /><br />Если режим волокон активен, вы не сможете создавать базы данных с файловыми группами, оптимизированными для памяти, или добавлять такие группы в существующие базы данных.<br /><br />Режим волокон можно включить, если существуют базы данных с файловыми группами, оптимизированными для памяти. Однако включение режима волокон требует перезапуска сервера. В этом случае базы данных с файловыми группами, оптимизированными для памяти, не восстанавливаются. Вы увидите сообщение об ошибке с предложением отключить режим волокон, чтобы использование таких баз данных стало возможным.<br /><br />Если режим волокон активен, для баз данных с оптимизированной для памяти файловой группой не будут работать вложение и восстановление. Базы данных будут помечены как подозрительные.<br /><br />Дополнительные сведения см. в разделе [Параметр конфигурации сервера «использование упрощенных пулов»](../../database-engine/configure-windows/lightweight-pooling-server-configuration-option.md). |  
|Ограничения Service Broker|Нет доступа к очереди из скомпилированной в собственном коде хранимой процедуры.<br /><br /> Нет доступа к очереди в удаленной базе данных в транзакции, получающей доступ к оптимизированным для памяти таблицам.|  
|Репликация в подписчиков|Репликация транзакций для подписчиков в таблицы, оптимизированные для памяти, поддерживается, но с некоторыми ограничениями. Дополнительные сведения см. в статье [Репликация на подписчиков оптимизированных для памяти таблиц](../../relational-databases/replication/replication-to-memory-optimized-table-subscribers.md).|  
|||

#### <a name="cross-database-queries-and-transcations"></a>Запросы и транзакции между базами данных

За некоторыми исключениями, транзакции между базами данных не поддерживаются. В следующей таблице описываются варианты, которые поддерживаются, и соответствующие ограничения. (См. также [Межбазовые запросы](../../relational-databases/in-memory-oltp/cross-database-queries.md).)  


|Базы данных|Разрешено|Описание|  
|---------------|-------------|-----------------|  
| Пользовательские базы данных, **model** и **msdb**. | Нет | В большинстве случаев запросы и транзакции между базами данных *не* поддерживаются.<br /><br />Запрос не может получить доступ к другим базам данных, если он использует таблицу, оптимизированную для памяти, или хранимую процедуру, компилируемую в собственном коде. Это ограничение применяется к транзакциям и запросам.<br /><br />Исключения: системные базы данных **tempdb** и **master**. Здесь база данных **master** доступна только для чтения. |
| База данных **Resource**, **tempdb** | Да | В транзакции, которая касается объектов In-Memory OLTP, системные базы данных **Resource** и **tempdb** можно использовать без дополнительного ограничения.
||||

## <a name="scenarios-not-supported"></a>Неподдерживаемые сценарии  
  
- Доступ к таблицам, оптимизированным для памяти, с помощью контекстного подключения изнутри хранимых процедур CLR.  
  
- Набор ключей и динамические курсоры в запросах, обращающихся к оптимизированным для памяти таблицам. Функциональность этих курсоров понижена, теперь они статические и доступны только для чтения.  
  
- Не поддерживается использование **MERGE INTO** _target_, где *target* — оптимизированная для памяти таблица.
    - **MERGE USING** _source_ для таблиц, оптимизированных для памяти, поддерживается.  
  
- Тип данных ROWVERSION (TIMESTAMP) не поддерживается. Дополнительные сведения см. в разделе [FROM (Transact-SQL)](../../t-sql/queries/from-transact-sql.md).
  
- Автоматическое закрытие не поддерживается для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA.  

- Транзакционные DDL-элементы, такие как CREATE, ALTER или DROP для объектов In-Memory OLTP, не поддерживаются в пользовательских транзакциях.  
  
- Уведомление о событии.  
  
- Управление на основе политик (PBM).
    - Режимы предотвращения и только протоколирование PBM не поддерживаются. Наличие таких политик на сервере может помешать успешному выполнению DDL-библиотеки OLTP в памяти. Режимы по запросу и по расписанию поддерживаются.  

- Включение базы данных ([автономные базы данных](../../relational-databases/databases/contained-databases.md)) не поддерживается при выполнении в памяти OLTP.
    - Поддерживается проверка подлинности автономной базы данных. Но все объекты In-Memory OLTP помечаются как нарушающие вложение в динамическом административном представлении (DMV) **dm_db_uncontained_entities**.

## <a name="recently-added-supports"></a>Последние добавленные поддерживаемые возможности

Иногда в более новом выпуске SQL Server доступна поддержка функции, которая ранее не поддерживалась. В этом разделе перечислены функции, которые не поддерживались для выполняющейся в памяти OLTP, однако более поздние версии стали поддерживаться.

В следующей таблице значения _версии_, такие как `(15.x)`, представляют собой значение, возвращаемое инструкцией Transact-SQL `SELECT @@Version;`.

| Имя функции | Версия SQL Server | Комментарии |
| :----------- | :-------------------- | :------- |
| Моментальные снимки базы данных | 2019 (15.x) | Теперь моментальные снимки базы данных поддерживаются для баз данных, имеющих файловую группу MEMORY_OPTIMIZED_DATA. |
| &nbsp; | &nbsp; | &nbsp; |

## <a name="see-also"></a>См. также:

- [Поддержка SQL Server для In-Memory OLTP](./transact-sql-support-for-in-memory-oltp.md)