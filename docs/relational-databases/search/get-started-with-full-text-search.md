---
description: Приступая к работе с компонентом Full-Text Search
title: Приступая к работе с компонентом Full-Text Search | Документация Майкрософт
ms.date: 03/31/2020
ms.prod: sql
ms.prod_service: search, sql-database
ms.technology: search
ms.topic: conceptual
helpviewer_keywords:
- full-text catalogs [SQL Server], creating
- full-text indexes [SQL Server], creating
- full-text search [SQL Server], about
- full-text search [SQL Server], setting up
ms.assetid: 1fa628ba-0ee4-4d8f-b086-c4e52962ca4a
author: pmasl
ms.author: pelopes
ms.reviewer: mikeray
monikerRange: =azuresqldb-current||>=sql-server-2016||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: ffb6aefd828d9e329df6b624669f7d025d6044f7
ms.sourcegitcommit: 1a544cf4dd2720b124c3697d1e62ae7741db757c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2020
ms.locfileid: "97479525"
---
# <a name="get-started-with-full-text-search"></a>Приступая к работе с компонентом Full-Text Search
[!INCLUDE [SQL Server Azure SQL Database](../../includes/applies-to-version/sql-asdb.md)]
По умолчанию для баз данных SQL Server включен полнотекстовый поиск. Однако перед выполнением полнотекстовых запросов нужно создать полнотекстовый каталог и полнотекстовый индекс для таблиц или индексированных представлений, по которым требуется выполнить поиск.

## <a name="set-up-full-text-search-in-two-steps"></a>Настройка полнотекстового поиска в два шага
Чтобы настроить полнотекстовый поиск, обычно требуется выполнить два основных шага:  
1.  Создание полнотекстового каталога.  
2.  Создание полнотекстового индекса по таблицам или индексированному представлению, где требуется произвести поиск. 

Полнотекстовый индекс должен принадлежать к полнотекстовому каталогу. Можно либо создать отдельный текстовый каталог для каждого полнотекстового индекса, либо связать с одним каталогом несколько полнотекстовых индексов. Полнотекстовый каталог является виртуальным объектом и не входит в файловую группу. Каталог — это логическое понятие, которое ссылается на группу полнотекстовых индексов.

> [!NOTE]
> Выполнение этих действий предполагает, что при установке SQL Server были установлены дополнительные компоненты полнотекстового поиска. В противном случае, чтобы их добавить, программу установки SQL Server необходимо будет перезапустить.  

## <a name="set-up-full-text-search-with-a-wizard"></a>Настройка полнотекстового поиска с помощью мастера 
 
Чтобы настроить полнотекстовый поиск с помощью мастера, ознакомьтесь со статьей [Use the Full-Text Indexing Wizard](../../relational-databases/search/use-the-full-text-indexing-wizard.md) (Использование мастера полнотекстового индексирования).

## <a name="set-up-full-text-search-with-transact-sql"></a>Настройка полнотекстового поиска с помощью Transact-SQL 
 В следующем примере из двух частей в образце базы данных AdventureWorks создается полнотекстовый каталог с именем `AdvWksDocFTCat`, затем создается полнотекстовый индекс в таблице `Document` образца базы данных. Эта инструкция создает полнотекстовый каталог в папке по умолчанию, указанной во время установки SQL Server, то есть папка `AdvWksDocFTCat` будет вложена в каталог по умолчанию.  
  
1.  Для создания полнотекстового каталога `AdvWksDocFTCat`в примере используется инструкция [CREATE FULLTEXT CATALOG](../../t-sql/statements/create-fulltext-catalog-transact-sql.md) :  
  
    ```sql
    USE AdventureWorks;  
    GO  
    CREATE FULLTEXT CATALOG AdvWksDocFTCat;  
    ```  
    Дополнительные сведения см. в статье [Создание полнотекстовых каталогов и управление ими](../../relational-databases/search/create-and-manage-full-text-catalogs.md).
 
2.  Однако перед созданием полнотекстового индекса для таблицы Document следует убедиться, что в ней определен уникальный индекс с одним столбцом, не допускающий значений NULL. Следующая инструкция [CREATE INDEX](../../t-sql/statements/create-index-transact-sql.md) создает уникальный индекс `ui_ukDoc`для столбца DocumentID таблицы Document:  
  
    ```sql 
    CREATE UNIQUE INDEX ui_ukDoc ON Production.Document(DocumentNode);  
    ```  

3.  Удалите существующий полнотекстовый индекс в таблице `Document` с помощью следующей инструкции [DROP FULLTEXT INDEX](../../t-sql/statements/drop-fulltext-index-transact-sql.md). 

    ```sql
    DROP FULLTEXT INDEX ON Production.Document
    GO
    ```

4.  После создания уникального ключа можно создать полнотекстовый индекс для таблицы `Document` с помощью следующей инструкции [CREATE FULLTEXT INDEX](../../t-sql/statements/create-fulltext-index-transact-sql.md) .  
  
    ```sql  
    CREATE FULLTEXT INDEX ON Production.Document  
    (  
        Document                         --Full-text index column name   
            TYPE COLUMN FileExtension    --Name of column that contains file type information  
            Language 2057                 --2057 is the LCID for British English  
    )  
    KEY INDEX ui_ukDoc ON AdvWksDocFTCat --Unique index  
    WITH CHANGE_TRACKING AUTO            --Population type;  
    GO  
  
    ```  
    
  
  
     Столбец TYPE COLUMN, определенный в этом примере, задает столбец типов в таблице, которая в каждой строке столбца «Document» (имеющего двоичный тип) содержит тип документа. Столбец типа хранит заданное пользователем расширение файла документа — DOC, XLS и т. д. — в данной строке. Средство полнотекстового поиска будет использовать это расширение для вызова соответствующего фильтра, который применяется для синтаксического анализа данных в данной строке. После того как фильтр выполнит синтаксический анализ двоичных данных в строке, указанное средство разбиения по словам выполнит синтаксический анализ содержимого. (В этом примере используется средство разбиения по словам для английского языка (Соединенное Королевство)). Дополнительные сведения см. в разделе [Настройка фильтров для поиска и управление ими](../../relational-databases/search/configure-and-manage-filters-for-search.md).  

    Дополнительные сведения см. в статье [Create and Manage Full-Text Indexes](../../relational-databases/search/create-and-manage-full-text-indexes.md) (Создание полнотекстовых индексов и управление ими).

##  <a name="choose-options-for-a-full-text-index"></a><a name="options"></a> Выбор параметров для полнотекстового индекса 
  
### <a name="choose-a-language"></a>Выбор языка  
 Сведения о выборе языка столбца см. в разделе [Выбор языка при создании полнотекстового индекса](../../relational-databases/search/choose-a-language-when-creating-a-full-text-index.md).  
  
### <a name="choose-a-filegroup"></a>Выбор файловой группы  
 Процесс создания полнотекстового индекса может сильно нагружать подсистему ввода-вывода. В целом он состоит из считывания данных из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с последующим заполнением полнотекстового индекса отфильтрованными данными. Рекомендуется размещать полнотекстовый индекс в той файловой группе базы данных, которая обеспечит максимальную производительность операций ввода-вывода, либо разместить полнотекстовые индексы в другой файловой группе на другом томе.
  
### <a name="choose-a-full-text-catalog"></a>Выбор полнотекстового каталога   
 
 Таблицы с одинаковыми характеристиками обновления (например, небольшим числом изменений, в противоположность большому их количеству или частым изменением таблиц в определенное время дня) рекомендуется связывать с одним полнотекстовым каталогом. Если настроить расписание заполнения полнотекстового каталога, то полнотекстовые индексы будут синхронизироваться с таблицами, почти не влияя на использование ресурсов сервером баз данных в течение периодов высокой активности.  
  
 Ознакомьтесь со следующими рекомендациями:  
  
-   Если индексируется таблица с миллионами строк, назначьте ее отдельному полнотекстовому каталогу.  
  
-   Учитывайте количество изменений в таблице, в которой выполняется полнотекстовое индексирование, а также общее количество строк в ней. Если общее число изменяемых строк вместе с количеством строк в таблице на момент последнего полнотекстового заполнения исчисляется миллионами, назначьте эту таблицу отдельному полнотекстовому каталогу.  

### <a name="associate-a-unique-index"></a>Сопоставление уникального индекса
Для полнотекстового уникального ключа всегда следует выбирать наименьший по размеру уникальный индекс. (Оптимален четырехбайтовый индекс на основе целочисленных значений.) Это значительно снизит потребление ресурсов, необходимых службе поиска [!INCLUDE[msCoName](../../includes/msconame-md.md)] для работы с файловой системой. Если первичный ключ велик (более 100 байт), попробуйте выбрать в таблице другой уникальный индекс (или создайте другой уникальный индекс) в качестве полнотекстового уникального ключа. В противном случае, если размер полнотекстового уникального ключа превышает максимально разрешенный размер (900 байт), выполнить полнотекстовое заполнение не удастся.  
 
### <a name="associate-a-stoplist"></a>Сопоставление списка стоп-слов   
  *Список стоп-слов* — это список, в котором перечислены стоп-слова, также известные как пропускаемые слова. Список стоп-слов связывается с каждым полнотекстовым индексом. Слова в данном списке применяются к полнотекстовым запросам в данном индексе. По умолчанию с новым полнотекстовым индексом связан системный список стоп-слов. Вы можете создать и использовать собственный список стоп-слов.   
  
 Например, приведенная ниже инструкция [CREATE FULLTEXT STOPLIST](../../t-sql/statements/create-fulltext-stoplist-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] создает список полнотекстовых стоп-слов с именем myStoplist путем копирования из системного списка стоп-слов:  
  
```sql  
CREATE FULLTEXT STOPLIST myStoplist FROM SYSTEM STOPLIST;  
GO  
```  
  
 Приведенная ниже инструкция [ALTER FULLTEXT STOPLIST](../../t-sql/statements/alter-fulltext-stoplist-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] изменяет список стоп-слов myStoplist путем добавления слова en для испанского и затем французского языков:  
  
```sql  
ALTER FULLTEXT STOPLIST myStoplist ADD 'en' LANGUAGE 'Spanish';  
ALTER FULLTEXT STOPLIST myStoplist ADD 'en' LANGUAGE 'French';  
GO  
```  
Дополнительные сведения см. в разделе [Настройка стоп-слов и списков стоп-слов для полнотекстового поиска и управление ими](../../relational-databases/search/configure-and-manage-stopwords-and-stoplists-for-full-text-search.md).

## <a name="update-a-full-text-index"></a>Обновление полнотекстового индекса  
 Аналогично обычным индексам [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] полнотекстовые индексы можно обновлять автоматически по мере изменения данных в связанных с ними таблицах. Это поведение по умолчанию. Обновлять полнотекстовые индексы можно и вручную либо по заданному расписанию. Заполнение полнотекстового индекса может потребовать значительного времени и ресурсов, из-за чего обновление индекса обычно выполняется как асинхронный процесс в фоновом режиме, обновляющий полнотекстовый индекс после внесения изменений в базовую таблицу. 
 
Для немедленного обновления полнотекстового индекса после каждого изменения в базовой таблице может также потребоваться большой объем ресурсов. Следовательно, если обновление, вставка или удаление выполняются часто, то производительность запросов может снизиться. В таком случае попробуйте выполнять обновления отслеживания изменений вручную по определенному расписанию. Это позволит обрабатывать больше изменений в определенные моменты времени, а не конкурировать за ресурсы с запросами.  
  
Дополнительные сведения см. в статье [Заполнение полнотекстовых индексов](../../relational-databases/search/populate-full-text-indexes.md). 

## <a name="next-steps"></a>Дальнейшие действия
После настройки полнотекстового поиска SQL Server вы можете приступить к выполнению полнотекстовых запросов. Дополнительные сведения см. в статье [Запрос с полнотекстовым поиском](../../relational-databases/search/query-with-full-text-search.md).
