---
description: sys.dm_exec_query_stats (Transact-SQL)
title: sys.dm_exec_query_stats (Transact-SQL) | Документация Майкрософт
ms.custom: ''
ms.date: 05/30/2019
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: system-objects
ms.topic: language-reference
f1_keywords:
- dm_exec_query_stats_TSQL
- dm_exec_query_stats
- sys.dm_exec_query_stats
- sys.dm_exec_query_stats_TSQL
dev_langs:
- TSQL
helpviewer_keywords:
- sys.dm_exec_query_stats dynamic management view
ms.assetid: eb7b58b8-3508-4114-97c2-d877bcb12964
author: WilliamDAssafMSFT
ms.author: wiassaf
monikerRange: =azuresqldb-current||>=sql-server-2016||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: c9643374bd0992fb17ea216a868616c5759d2665
ms.sourcegitcommit: a9e982e30e458866fcd64374e3458516182d604c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/11/2021
ms.locfileid: "98098952"
---
# <a name="sysdm_exec_query_stats-transact-sql"></a>sys.dm_exec_query_stats (Transact-SQL)
[!INCLUDE [SQL Server SQL Database](../../includes/applies-to-version/sql-asdb.md)]

Возвращает суммарную статистику производительности для кэшированных планов запросов в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. Представление содержит по одной строке для каждой инструкции запроса в плане в кэше, а время жизни строк связано с самим планом. Когда план удаляется из кэша, соответствующие строки исключаются из представления.  
  
> [!NOTE]
> - Результаты **sys.dm_exec_query_stats**  могут различаться при каждом выполнении, так как данные отражают только завершенные запросы, а не по-прежнему в полете.
> - Чтобы вызвать эту функцию из [!INCLUDE[ssSDWfull](../../includes/sssdwfull-md.md)] или [!INCLUDE[ssPDW](../../includes/sspdw-md.md)] , используйте имя **sys.dm_pdw_nodes_exec_query_stats**.    

  
|Имя столбца|Тип данных|Описание|  
|-----------------|---------------|-----------------|  
|**sql_handle**|**varbinary (64)**  |Токен, однозначно определяющий пакет или хранимую процедуру, частью которой является запрос.<br /><br /> Столбец **sql_handle** вместе со столбцами **statement_start_offset** и **statement_end_offset** может использоваться для получения SQL-текста запроса с помощью вызова функции динамического управления **sys.dm_exec_sql_text**.|  
|**statement_start_offset**|**int**|Начальная позиция запроса, описываемого строкой, в соответствующем тексте пакета или сохраняемом объекте, в байтах, начиная с 0.|  
|**statement_end_offset**|**int**|Конечная позиция запроса, описываемого строкой, в соответствующем тексте пакета или сохраняемом объекте, в байтах, начиная с 0. Для версий, предшествующих [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] , значение-1 обозначает конец пакета. Конечные комментарии больше не включаются.|  
|**plan_generation_num**|**bigint**|Порядковый номер, который может использоваться для проведения различия между экземплярами планов после рекомпиляции.|  
|**plan_handle**|**varbinary (64)**|Токен, однозначно определяющий план выполнения запроса для пакета, который был выполнен, а его план находится в кэше планов или в данный момент выполняется. Это значение можно передать функции динамического управления [sys.dm_exec_query_plan](../../relational-databases/system-dynamic-management-views/sys-dm-exec-query-plan-transact-sql.md) для получения плана запроса.<br /><br /> Значение всегда равно 0x000, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**creation_time**|**datetime**|Время компиляции плана.|  
|**last_execution_time**|**datetime**|Время начала последнего выполнения плана.|  
|**execution_count**|**bigint**|Количество выполнений плана с момента последней компиляции.|  
|**total_worker_time**|**bigint**|Общее время ЦП, затраченное на выполнение плана с момента компиляции, в микросекундах (но с точностью до миллисекунды).<br /><br /> Для скомпилированных в собственном коде хранимых процедур функция **total_worker_time** может быть неточной, если за время меньше миллисекунды выполняется большое количество хранимых процедур.|  
|**last_worker_time**|**bigint**|Время ЦП, затраченное на последнее выполнение плана, в микросекундах (но с точностью до миллисекунды). <sup>1</sup>|  
|**min_worker_time**|**bigint**|Минимальное время ЦП, когда-либо затраченное на выполнение плана, в микросекундах (но с точностью до миллисекунды). <sup>1</sup>|  
|**max_worker_time**|**bigint**|Максимальное время ЦП, когда-либо затраченное на выполнение плана, в микросекундах (но с точностью до миллисекунды). <sup>1</sup>|  
|**total_physical_reads**|**bigint**|Общее количество операций физического считывания при выполнении плана с момента его компиляции.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**last_physical_reads**|**bigint**|Количество операций физического считывания за время последнего выполнения плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**min_physical_reads**|**bigint**|Минимальное количество операций физического считывания за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**max_physical_reads**|**bigint**|Максимальное количество операций физического считывания за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**total_logical_writes**|**bigint**|Общее количество операций логической записи при выполнении плана с момента его компиляции.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**last_logical_writes**|**bigint**|Количество страниц буферного пула, изменялся в течение последнего выполненного плана.<br /><br />После считывания страницы страница становится «грязной» только при первом ее изменении. Когда страница становится "грязной", это число увеличивается. Последующие изменения уже измененной страницы не влияют на это число.<br /><br />Это число всегда будет равно 0 при запросе к таблице, оптимизированной для памяти.|  
|**min_logical_writes**|**bigint**|Минимальное количество операций логической записи за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**max_logical_writes**|**bigint**|Максимальное количество операций логической записи за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**total_logical_reads**|**bigint**|Общее количество операций логического считывания при выполнении плана с момента его компиляции.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**last_logical_reads**|**bigint**|Количество операций логического считывания за время последнего выполнения плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**min_logical_reads**|**bigint**|Минимальное количество операций логического считывания за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**max_logical_reads**|**bigint**|Максимальное количество операций логического считывания за одно выполнение плана.<br /><br /> Значение всегда равно 0 при запросе оптимизированной для памяти таблицы.|  
|**total_clr_time**|**bigint**|Время, сообщаемое в микросекундах (но с точностью до миллисекунд), затраченное на [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] выполнение плана в объектах среды CLR с момента его компиляции. Объекты среды CLR могут быть хранимыми процедурами, функциями, триггерами, типами и статистическими выражениями.|  
|**last_clr_time**|**bigint**|Время, затраченное на последнее выполнение плана внутри объектов [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] среды CLR в микросекундах (но с точностью до миллисекунды). Объекты среды CLR могут быть хранимыми процедурами, функциями, триггерами, типами и статистическими выражениями.|  
|**min_clr_time**|**bigint**|Минимальное время, когда-либо затраченное на выполнение плана внутри объектов [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] среды CLR, в микросекундах (но с точностью до миллисекунды). Объекты среды CLR могут быть хранимыми процедурами, функциями, триггерами, типами и статистическими выражениями.|  
|**max_clr_time**|**bigint**|Максимальное время, когда-либо затраченное на выполнение плана внутри среды CLR [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)], в микросекундах (но с точностью до миллисекунды). Объекты среды CLR могут быть хранимыми процедурами, функциями, триггерами, типами и статистическими выражениями.|  
|**total_elapsed_time**|**bigint**|Общее время, затраченное на выполнение плана, в микросекундах (но с точностью до миллисекунды).|  
|**last_elapsed_time**|**bigint**|Время, затраченное на последнее выполнение плана, в микросекундах (но с точностью до миллисекунды).|  
|**min_elapsed_time**|**bigint**|Минимальное время, когда-либо затраченное на выполнение плана, в микросекундах (но с точностью до миллисекунды).|  
|**max_elapsed_time**|**bigint**|Максимальное время, когда-либо затраченное на выполнение плана, в микросекундах (но с точностью до миллисекунды).|  
|**query_hash**|**Binary (8)**|Двоичное хэш-значение рассчитывается для запроса и используется для идентификации запросов с аналогичной логикой. Можно использовать хэш запроса для определения использования статистических ресурсов для запросов, которые отличаются только своими литеральными значениями.|  
|**query_plan_hash**|**Binary (8)**|Двоичное хэш-значение рассчитывается для плана выполнения запроса и используется для идентификации аналогичных планов выполнения запросов. Можно использовать хэш плана запроса для нахождения совокупной стоимости запросов со схожими планами выполнения.<br /><br /> Значение всегда равно 0x000, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**total_rows**|**bigint**|Общее число строк, возвращаемых запросом. Не может иметь значение NULL.<br /><br /> Значение всегда равно 0, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**last_rows**|**bigint**|Число строк, возвращенных последним выполнением запроса. Не может иметь значение NULL.<br /><br /> Значение всегда равно 0, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**min_rows**|**bigint**|Минимальное количество строк, возвращенных запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Значение всегда равно 0, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**max_rows**|**bigint**|Максимальное количество строк, возвращенных запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Значение всегда равно 0, если скомпилированная в собственном коде хранимая процедура запрашивает оптимизированную для памяти таблицу.|  
|**statement_sql_handle**|**varbinary (64)**|**Область применения**: [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] и более поздних версий.<br /><br /> Заполнены значениями, отличными от NULL, только если хранилище запросов включено и сбор статистики для этого конкретного запроса.|  
|**statement_context_id**|**bigint**|**Область применения**: [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] и более поздних версий.<br /><br /> Заполнены значениями, отличными от NULL, только если хранилище запросов включено и сбор статистики для этого конкретного запроса.|  
|**total_dop**|**bigint**|Общая сумма степени параллелизма, которую этот план использовал с момента компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_dop**|**bigint**|Степень параллелизма, когда этот план выполнялся в последний раз. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_dop**|**bigint**|Минимальная степень параллелизма, которую этот план использовал во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_dop**|**bigint**|Максимальная степень параллелизма, которую этот план использовал во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_grant_kb**|**bigint**|Общий объем зарезервированной памяти в КБ, полученный этим планом с момента его компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_grant_kb**|**bigint**|Объем зарезервированной памяти, выделенной в КБ, когда этот план был выполнен в последний раз. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_grant_kb**|**bigint**|Минимальный объем зарезервированной памяти, предоставленный в КБ этот план был получен во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_grant_kb**|**bigint**|Максимальный объем зарезервированной памяти, предоставленный в КБ этот план был получен во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_used_grant_kb**|**bigint**|Общий объем зарезервированной памяти, предоставленный в КБ этот план использовался с момента компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_used_grant_kb**|**bigint**|Объем используемого выделения памяти в КБ, когда этот план был выполнен в последний раз. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_used_grant_kb**|**bigint**|Минимальный объем используемой памяти в КБ, когда этот план использовался во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_used_grant_kb**|**bigint**|Максимальный объем используемой памяти в КБ, когда этот план использовался во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_ideal_grant_kb**|**bigint**|Общий объем идеального выделения памяти в КБ, который был оценен этим планом с момента его компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_ideal_grant_kb**|**bigint**|Объем идеального выделения памяти в КБ, когда этот план был выполнен в последний раз. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_ideal_grant_kb**|**bigint**|Минимальный объем идеально выделяемой памяти в КБ, когда этот план был оценен во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_ideal_grant_kb**|**bigint**|Максимальный объем идеально выделяемой памяти в КБ, когда этот план был оценен во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_reserved_threads**|**bigint**|Общая сумма зарезервированных параллельных потоков, которые когда-либо использовались с момента компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_reserved_threads**|**bigint**|Число зарезервированных параллельных потоков, когда этот план выполнялся в последний раз. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_reserved_threads**|**bigint**|Минимальное число зарезервированных параллельных потоков, которое когда-либо использовалось в ходе одного выполнения.  Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_reserved_threads**|**bigint**|Максимальное количество зарезервированных параллельных потоков, которое когда-либо использовалось этим планом во время одного выполнения. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_used_threads**|**bigint**|Общая сумма использованных параллельных потоков, которые когда-либо использовали этот план после его компиляции. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**last_used_threads**|**bigint**|Число использованных параллельных потоков при последнем выполнении плана. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**min_used_threads**|**bigint**|Минимальное число использованных параллельных потоков, которое когда-либо использовалось при выполнении одного плана. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**max_used_threads**|**bigint**|Максимальное количество использованных параллельных потоков, которое когда-либо использовалось при выполнении одного плана. Он всегда будет равен 0 для запроса оптимизированной для памяти таблицы.<br /><br /> **Область применения**: [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] и более поздних версий.|  
|**total_columnstore_segment_reads**|**bigint**|Общая сумма сегментов columnstore, считанных запросом. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**last_columnstore_segment_reads**|**bigint**|Число сегментов columnstore, считанных при последнем выполнении запроса. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**min_columnstore_segment_reads**|**bigint**|Минимальное число сегментов columnstore, считываемых запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**max_columnstore_segment_reads**|**bigint**|Максимальное число сегментов columnstore, считываемых запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**total_columnstore_segment_skips**|**bigint**|Общая сумма сегментов columnstore, пропущенных запросом. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**last_columnstore_segment_skips**|**bigint**|Число сегментов columnstore, пропущенных при последнем выполнении запроса. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**min_columnstore_segment_skips**|**bigint**|Минимальное число сегментов columnstore, пропущенных запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|    
|**max_columnstore_segment_skips**|**bigint**|Максимальное число сегментов columnstore, пропущенных запросом во время одного выполнения. Не может иметь значение NULL.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|
|**total_spills**|**bigint**|Общее число страниц, сброшенных при выполнении этого запроса с момента его компиляции.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|  
|**last_spills**|**bigint**|Число страниц, сброшенных при последнем выполнении запроса.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|  
|**min_spills**|**bigint**|Минимальное число страниц, которые этот запрос когда-либо был сброшен во время одного выполнения.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|  
|**max_spills**|**bigint**|Максимальное количество страниц, которые этот запрос когда-либо был сброшен во время одного выполнения.<br /><br /> Область **применения**: начиная с с [!INCLUDE[ssSQL15](../../includes/sssql15-md.md)] пакетом обновления 2 (SP2) и [!INCLUDE[ssSQL17](../../includes/sssql17-md.md)] CU3|  
|**pdw_node_id**|**int**|Идентификатор узла, на котором находится данное распределение.<br /><br /> **Применимо к**: [!INCLUDE[ssSDWfull](../../includes/sssdwfull-md.md)] , [!INCLUDE[ssPDW](../../includes/sspdw-md.md)]| 
|**total_page_server_reads**|**bigint**|Общее число операций чтения с сервера удаленной страницы, выполненных при выполнении плана с момента его компиляции.<br /><br /> **Применимо к:** Масштабирование базы данных SQL Azure |  
|**last_page_server_reads**|**bigint**|Число операций чтения сервера удаленной страницы, выполненных при последнем выполнении плана.<br /><br /> **Применимо к:** Масштабирование базы данных SQL Azure |  
|**min_page_server_reads**|**bigint**|Минимальное число операций чтения сервером удаленных страниц, которое этот план выполнял во время одного выполнения.<br /><br /> **Применимо к:** Масштабирование базы данных SQL Azure |  
|**max_page_server_reads**|**bigint**|Максимальное количество операций чтения сервером удаленных страниц, которое этот план выполнял во время одного выполнения.<br /><br /> **Применимо к:** Масштабирование базы данных SQL Azure |  
> [!NOTE]
> <sup>1</sup> для хранимых процедур, скомпилированных в собственном режиме, когда сбор статистики включен, время рабочей роли собираются в миллисекундах. Если запрос выполняется менее чем за одну миллисекунду, значение будет равно 0.  
  
## <a name="permissions"></a>Разрешения  

В [!INCLUDE[ssNoVersion_md](../../includes/ssnoversion-md.md)] необходимо `VIEW SERVER STATE` разрешение.   
В базах данных SQL Basic, S0 и S1, а также для баз данных в эластичных пулах `Server admin` `Azure Active Directory admin` требуется учетная запись или. Для всех остальных целей службы базы данных SQL `VIEW DATABASE STATE` разрешение требуется в базе данных.   
   
## <a name="remarks"></a>Комментарии  
 Статистика в представлении обновляется после завершения выполнения запроса.  
  
## <a name="examples"></a>Примеры  
  
### <a name="a-finding-the-top-n-queries"></a>A. Поиск запросов TOP N  
 В следующем примере возвращаются сведения о пяти первых запросах, отсортированных по среднему времени ЦП. В этом примере объединяются запросы в соответствии с хэшем запроса таким образом, чтобы обеспечить группировку логически эквивалентных запросов по их совокупному потреблению ресурсов.  
  
```sql  
SELECT TOP 5 query_stats.query_hash AS "Query Hash",   
    SUM(query_stats.total_worker_time) / SUM(query_stats.execution_count) AS "Avg CPU Time",  
    MIN(query_stats.statement_text) AS "Statement Text"  
FROM   
    (SELECT QS.*,   
    SUBSTRING(ST.text, (QS.statement_start_offset/2) + 1,  
    ((CASE statement_end_offset   
        WHEN -1 THEN DATALENGTH(ST.text)  
        ELSE QS.statement_end_offset END   
            - QS.statement_start_offset)/2) + 1) AS statement_text  
     FROM sys.dm_exec_query_stats AS QS  
     CROSS APPLY sys.dm_exec_sql_text(QS.sql_handle) as ST) as query_stats  
GROUP BY query_stats.query_hash  
ORDER BY 2 DESC;  
```  
  
### <a name="b-returning-row-count-aggregates-for-a-query"></a>Б. Возврат статистического выражения счетчика строк для запроса  
 В следующем примере показан возврат сведений о статистическом выражении счетчика строк (общее число строк, минимальное число строк, максимальное число строк и число строк при последнем выполнении) для запросов.  
  
```sql  
SELECT qs.execution_count,  
    SUBSTRING(qt.text,qs.statement_start_offset/2 +1,   
                 (CASE WHEN qs.statement_end_offset = -1   
                       THEN LEN(CONVERT(nvarchar(max), qt.text)) * 2   
                       ELSE qs.statement_end_offset end -  
                            qs.statement_start_offset  
                 )/2  
             ) AS query_text,   
     qt.dbid, dbname= DB_NAME (qt.dbid), qt.objectid,   
     qs.total_rows, qs.last_rows, qs.min_rows, qs.max_rows  
FROM sys.dm_exec_query_stats AS qs   
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt   
WHERE qt.text like '%SELECT%'   
ORDER BY qs.execution_count DESC;  
```  
  
## <a name="see-also"></a>См. также статью  
[Динамические административные представления и функции, связанные с выполнением &#40;Transact-SQL&#41;](../../relational-databases/system-dynamic-management-views/execution-related-dynamic-management-views-and-functions-transact-sql.md)    
[sys.dm_exec_sql_text &#40;Transact-SQL&#41;](../../relational-databases/system-dynamic-management-views/sys-dm-exec-sql-text-transact-sql.md)    
[sys.dm_exec_query_plan &#40;Transact-SQL&#41;](../../relational-databases/system-dynamic-management-views/sys-dm-exec-query-plan-transact-sql.md)    
[sys.dm_exec_procedure_stats &#40;Transact-SQL&#41;](../../relational-databases/system-dynamic-management-views/sys-dm-exec-procedure-stats-transact-sql.md)     
[sys.dm_exec_trigger_stats &#40;Transact-SQL&#41;](../../relational-databases/system-dynamic-management-views/sys-dm-exec-trigger-stats-transact-sql.md)     
[sys.dm_exec_cached_plans (Transact-SQL)](../../relational-databases/system-dynamic-management-views/sys-dm-exec-cached-plans-transact-sql.md)    
  


