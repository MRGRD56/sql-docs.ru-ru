---
description: MSSQLSERVER_856
title: MSSQLSERVER_856
ms.custom: ''
ms.date: 08/20/2020
ms.prod: sql
ms.reviewer: ramakoni1, pijocoder, suresh-kandoth, Masha
ms.technology: supportability
ms.topic: language-reference
helpviewer_keywords:
- 856 (Database Engine error)
ms.assetid: ''
author: suresh-kandoth
ms.author: ramakoni
ms.openlocfilehash: f94f6f4e8f8eebee48bbb0c2a6d0faefa4218c25
ms.sourcegitcommit: ead0b8c334d487a07e41256ce5d6acafa2d23c9d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2020
ms.locfileid: "92418864"
---
# <a name="mssqlserver_856"></a>MSSQLSERVER_856
 [!INCLUDE [SQL Server](../../includes/applies-to-version/sqlserver.md)]

## <a name="details"></a>Сведения

|attribute|Значение|
|---|---|
|Название продукта|SQL Server|
|Идентификатор события|856|
|Источник события|MSSQLSERVER|
|Компонент|SQLEngine|
|Символическое имя|BAD_MEMORY_CLEAN_DATABASE_PAGE|
|Текст сообщения|SQL Server определил наличие аппаратного сбоя памяти в базе данных "'%ls", идентификатор файла: %u; идентификатор страницы %u, адрес памяти: 0x%I64x. Страница успешно восстановлена.|
||

## <a name="explanation"></a>Пояснение

Это сообщение указывает, что сервер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] обнаружил поврежденную страницу памяти в кэшированном объекте за пределами буферного пула. Это сообщение выдается в системах, которые поддерживают возможность восстановления после ошибок памяти. [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] исправляет эти ошибки, удаляя поврежденные страницы памяти, которые не были изменены, и записывает данное сообщение об ошибке в журнал. Если поврежденная страница памяти была изменена (является "грязной"), то возникает ошибка 824 ([MSSQLSERVER_824](mssqlserver-824-database-engine-error.md)).

## <a name="user-action"></a>Рекомендуемые действия

Необходимо выполнить проверку оборудования или системы, чтобы определить, есть ли проблемы с памятью или ЦП. Убедитесь в том, что в системе установлены все системные драйверы, обновления операционной системы и обновления оборудования. Также рекомендуется выполнить диагностику оборудования средствами производителя, включая тесты памяти. При появлении этой ошибки желательно выполнить команду `DBCC CHECKDB` применительно ко всем базам данных в этом экземпляре.

## <a name="more-information"></a>Дополнительные сведения

На компьютерах с более новым оборудованием и ОС Windows Server 2012 или более поздней версии оборудование может уведомлять операционную систему и приложения о том, что страницы памяти (страницы операционной системы) помечены как поврежденные. Такие приложения, как [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], могут регистрировать эти уведомления с помощью следующего набора API:

- `GetMemoryErrorHandlingCapabilities`
- `RegisterBadMemoryNotification`
- `BadMemoryCallbackRoutine`

[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] добавляет поддержку этих уведомлений в Microsoft [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] и более поздних версиях. Во время запуска [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] сервер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проверяет, поддерживает ли оборудование эту новую функцию. Кроме того, в журнале ошибок появится следующее сообщение:

> \<Datetime> Компьютер сервера поддерживает восстановление ошибок памяти. Защита памяти SQL включена и обеспечивает восстановление от сбоев памяти.

В настоящее время только буферный пул предпринимает действие, когда [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] получает эти уведомления. При получении уведомления сервер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] должен пройти по всему буферному пулу и определить адрес каждого выделенного буфера. Затем [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] использует API `QueryWorkingSetEX`, чтобы проверить, помечены ли какие-либо страницы памяти, связанные со страницей данных, как поврежденные. При наличии повреждений в выходной структуре `PSAPI_WORKING_SET_EX_BLOCK`, соответствующей странице памяти, элементу bad будет присвоено значение 1.

Если буферный пул или страница данных в настоящее время не изменены или не обрабатывают операции ввода-вывода, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может удалить страницу данных и отменить ее фиксацию. Затем [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] записывает в журнал следующее сообщение:

> SQL Server определил наличие аппаратного сбоя памяти в базе данных "'%ls", идентификатор файла: %u; идентификатор страницы %u, адрес памяти: 0x%I64x. Страница успешно восстановлена.

Когда эта страница данных снова потребуется запросам, она может быть считана с диска и возвращена в буферный пул. Версия страницы на диске также может находиться в поврежденном состоянии. В этом случае [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] может записывать в журнал дополнительные ошибки, например ошибку 824.

Если поврежденная страница используется не буферным пулом, а другим кэшированным объектом или структурой, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] записывает в журнал следующее сообщение:

> Обнаружено невосстановимое аппаратное повреждение памяти. Система может работать нестабильно. Подробности см. в журнале событий Windows.

Если сервер сообщает об ошибках памяти, обратитесь к поставщику оборудования компьютера и выполните надлежащие действия, например диагностику памяти, обновление BIOS и встроенного ПО либо замену неисправных модулей памяти.

Чтобы сервер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] не регистрировал уведомления об ошибках памяти в операционной системе, можно использовать флаг трассировки [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 849. Однако имейте в виду, что включение флага трассировки 849 не позволит [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] получать уведомления о повреждениях памяти от операционной системы. Поэтому в обычных обстоятельствах использовать его не рекомендуется.

Кроме того, имейте в виду, что по умолчанию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] получает эти уведомления на поддерживаемом оборудовании.

Следует также иметь в виду, что когда [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] регистрирует эти уведомления об ошибках памяти, системный процесс отложенной записи не выполняет проверки константных страниц. Дополнительные сведения о проверках константных страниц см. в статье [Устранение ошибки Msg 832 (изменение константной страницы) в SQL Server](https://support.microsoft.com/help/2015759).
