---
description: Преобразования SQL Server Native Client, выполненные от клиента к серверу
title: Преобразования, выполняемые при передаче от клиента к серверу
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine, sql-database, synapse-analytics, pdw
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- conversions [OLE DB], client to server
ms.assetid: 6bb24928-0f3e-4119-beda-cfd04a44a3eb
author: markingmyname
ms.author: maghan
ms.custom: seo-dt-2019
monikerRange: '>=aps-pdw-2016||=azuresqldb-current||=azure-sqldw-latest||>=sql-server-2016||>=sql-server-linux-2017||=azuresqldb-mi-current'
ms.openlocfilehash: 71dd80ab27efe11a11798f6bf6b4416df1ccb441
ms.sourcegitcommit: 0310fdb22916df013eef86fee44e660dbf39ad21
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "104748444"
---
# <a name="sql-server-native-client-conversions-performed-from-client-to-server"></a>Преобразования SQL Server Native Client, выполненные от клиента к серверу
[!INCLUDE[SQL Server Azure SQL Database Synapse Analytics PDW ](../../includes/applies-to-version/sql-asdb-asdbmi-asa-pdw.md)]

  В этом разделе описываются преобразования даты и времени, которые выполняются между клиентским приложением, написанным с использованием поставщика OLE DB для собственного клиента [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , и [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (или более поздней версией).  
  
## <a name="conversions"></a>Преобразования  
 В этом разделе описываются преобразования, выполняемые на клиенте. Если клиент задает точность в долях секунд для параметра, отличающуюся от определенной на сервере, клиентское преобразование может вызвать сбой, в то время как сервер завершит операцию успешно. А именно, клиент рассматривает любое усечение долей секунды как ошибку, в то время как [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] округляет значения времени до ближайшей целой секунды.  
  
 Если не вызывается метод ICommandWithParameters::SetParameterInfo, привязки DBTYPE_DBTIMESTAMP преобразовываются, как если бы они имели тип **datetime2**.  
  
|Полученное значение -><br /><br /> От|DBDATE (date)|DBTIME (time)|DBTIME2 (time)|DBTIMESTAMP (smalldatetime)|DBTIMESTAMP (datetime)|DBTIMESTAMP (datetime2)|DBTIMESTAMPOFFSET (datetimeoffset)|STR|WSTR|SQLVARIANT<br /><br /> (sql_variant)|  
|----------------------|---------------------|---------------------|----------------------|-----------------------------------|------------------------------|-------------------------------|------------------------------------------|---------|----------|-------------------------------------|  
|DATE|1,2|1,3,4|4,12|1,12|1,12|1,12|1,5, 12|1,12|1,12|1,12<br /><br /> datetime2(0)|  
|DBDATE|1|-|-|1,6|1,6|1,6|1,5, 6|1,10|1,10|1<br /><br /> Дата|  
|DBTIME|-|1|1|1,7|1,7|1,7|1,5, 7|1,10|1,10|1<br /><br /> Time(0)|  
|DBTIME2|-|1,3|1|1,7,10,14|1,7,10,15|1,7,10|1,5,7,10|1,10,11|1,10,11|1<br /><br /> Time(7)|  
|DBTIMESTAMP|1,2|1,3,4|1,4,10|1,10,14|1,10,15|1,10|1,5,10|1,10,11|1,10,11|1,10<br /><br /> datetime2(7)|  
|DBTIMESTAMPOFFSET|1,2,8|1,3,4,8|1,4,8,10|1,8,10,14|1,8,10,15|1,8,10|1,10|1,10,11|1,10,11|1,10<br /><br /> datetimeoffset(7)|  
|FILETIME|1,2|1,3,4|1,4,13|1,13|1,13|1,13|1,5,13|1,13|1,10|1,13<br /><br /> datetime2(3)|  
|BYTES|-|-|-|-|-|-|-|Недоступно|Н/Д|Недоступно|  
|VARIANT|1|1|1|1,10|1,10|1,10|1,10|Н/Д|Н/Д|1,10|  
|SSVARIANT|1,16|1,16|1,16|1,10,16|1,10,16|1,10,16|1,10,16|Н/Д|Н/Д|1,16|  
|BSTR|1,9|1,9|1,9,10|1,9,10|1,9,10|1,9,10|1,9,10|Н/Д|Н/Д|Недоступно|  
|STR|1,9|1,9|1,9,10|1,9,10|1,9,10|1,9,10|1,9,10|Н/Д|Н/Д|Недоступно|  
|WSTR|1,9|1,9|1,9,10|1,9,10|1,9,10|1,9,10|1,9,10|Н/Д|Н/Д|Недоступно|  
  
## <a name="key-to-symbols"></a>Расшифровка символов  
  
|Символ|Значение|  
|------------|-------------|  
|-|Преобразование не поддерживается. Если при вызове IAccessor::CreateAccessor осуществляется проверка связывания, то в параметре *rgStatus* возвращается значение DBBINDSTATUS_UPSUPPORTEDCONVERSION. Если проверка метода доступа является отложенной, то устанавливается значение DBSTATUS_E_BADACCESSOR.|  
|Недоступно|Неприменимо.|  
|1|Если поддерживаемые данные недопустимы, возвращается значение DBSTATUS_E_CANTCONVERTVALUE. Входные данные проверяются до выполнения преобразований, поэтому, даже если компонент не будет обрабатываться последующим преобразованием, он должен иметь допустимое значение, чтобы это преобразование завершилось успешно.|  
|2|Поля времени не учитываются.|  
|3|Доли секунды должны иметь нулевое значение, иначе возвращается значение DBSTATUS_E_DATAOVERFLOW.|  
|4|Компонент даты не учитывается.|  
|5|Часовой пояс устанавливается в соответствии с часовым поясом клиента.|  
|6|Время установлено в нуль.|  
|7|Дата устанавливается в текущую дату.|  
|8|Время преобразуется в формат UTC. Если во время преобразования происходит ошибка, возвращается значение DBSTATUS_E_CANTCONVERTVALUE.|  
|9|Строка анализируется как литерал ISO и преобразуется в целевой тип. Если попытка оказалась неудачной, то строка анализируется как литерал даты OLE (который также содержит компоненты времени) и преобразуется из даты OLE (DBTYPE_DATE) в целевой тип.<br /><br /> Если целевым типом является DBTIMESTAMP, **smalldatetime**, **datetime** или **datetime2**, строка должна соответствовать синтаксису литералов типа date, time или **datetime2** либо синтаксису, распознаваемому OLE. Если строка является литералом типа date, все компоненты времени принимают нулевое значение. Если строка является литералом типа time, дата устанавливается в текущую дату.<br /><br /> Для всех других типов строка должна соответствовать синтаксису литералов целевого типа.|  
|10|Если усечение долей секунды происходит с потерей данных, возвращается значение DBSTATUS_E_DATAOVERFLOW. Проверка переполнения при преобразовании строк возможна, только если строка соответствует синтаксису ISO. Если строка является литералом даты OLE, доли секунды округляются.<br /><br /> Для преобразования типа DBTIMESTAMP (datetime) в smalldatetime собственный клиент [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] усекает значение секунд, не выдавая сообщения об этом, вместо вызова ошибки DBSTATUS_E_DATAOVERFLOW.|  
|11|Количество знаков долей секунды (масштаб) определяется размером целевого столбца согласно таблице ниже. Для размеров столбцов, превышающих диапазон таблицы, подразумевается масштаб 9. Это преобразование позволяет передавать доли секунд с точностью до девяти значащих цифр — максимум, поддерживаемый OLE DB.<br /><br /> Однако, если исходным типом является DBTIMESTAMP, а доли секунды равны нулю, знаки долей секунды и десятичная запятая не формируются. Такое поведение гарантирует обратную совместимость для приложений, использующих более старые версии поставщиков OLE DB.<br /><br /> Длина столбца ~0 подразумевает неограниченный размер в OLE DB (9 знаков, если для DBTIMESTAMP не применяется правило 3 знаков).|  
|12|Поддерживается семантика преобразования версий, предшествующих [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], для типа DBTYPE_DATE. Доли секунды усекаются до нуля.|  
|13|Поддерживается семантика преобразования версий, предшествующих [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], для типа DBTYPE_FILETIME. Если используется API-интерфейс FileTimeToSystemTime Windows, точность долей секунды ограничивается 1 миллисекундой.|  
|14|Поддерживается семантика преобразования версий, предшествующих [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], для типа **smalldatetime**. Секундам присваивается нулевое значение.|  
|15|Поддерживается семантика преобразования версий, предшествующих [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], для типа **datetime**. Секунды округляются до ближайшей 300-ой секунды.|  
|16|Поведение преобразования значения (конкретного типа), внедренное в клиентскую структуру SSVARIANT, совпадает с поведением того же значения с тем же типом, не встроенного в структуру SSVARIANT.|  
  
|Тип|Длина (в символах)|Масштабирование|  
|-|-|-|  
|DBTIME2|8, 10..18|0,1..9|  
|DBTIMESTAMP|19, 21..29|0,1..9|  
|DBTIMESTAMPOFFSET|26, 28..36|0,1..9|  
  
## <a name="see-also"></a>См. также:  
 [Привязки и преобразования &#40;OLE DB&#41;](../../relational-databases/native-client-ole-db-date-time/conversions-ole-db.md)  
  
  
