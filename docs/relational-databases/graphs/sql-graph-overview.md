---
description: Обработка графов в SQL Server и Базы данных SQL Azure
title: Обработка Graph
titleSuffix: SQL Server and Azure SQL Database
ms.date: 06/26/2019
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: ''
ms.topic: language-reference
helpviewer_keywords:
- SQL graph
- SQL graph, overview
ms.assetid: ''
author: shkale-msft
ms.author: shkale
ms.custom: seo-dt-2019
monikerRange: =azuresqldb-current||>=sql-server-2017||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: 8c7dfeaa67e0ede78b0a891409be3211e1fa8d2e
ms.sourcegitcommit: 8dc7e0ececf15f3438c05ef2c9daccaac1bbff78
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/13/2021
ms.locfileid: "100351418"
---
# <a name="graph-processing-with-sql-server-and-azure-sql-database"></a>Обработка графов в SQL Server и Базы данных SQL Azure
[!INCLUDE[sqlserver2017-asdb](../../includes/applies-to-version/sqlserver2017-asdb-asdbmi.md)]

[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предоставляет возможности баз данных Graph для моделирования связей "многие ко многим". Связи графов интегрированы в [!INCLUDE[tsql-md](../../includes/tsql-md.md)] и получают преимущества использования [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в качестве базовой системы управления базами данных.


## <a name="what-is-a-graph-database"></a>Что такое графовая база данных?  
База данных графа представляет собой коллекцию узлов (или вершин) и ребер (или связей). Узел представляет сущность (например, пользователя или организацию), а ребро — связь между двумя узлами, которые оно соединяет (например, отметки "Нравится" или друзья). С этими узлами и краями могут быть связаны свойства. Ниже приведены некоторые функции, благодаря которым графовая база данных является уникальной.  
-    Ребра или связи в графовой базе данных являются сущностями первого класса, с которым могут быть связаны атрибуты или свойства. 
-    Одно ребро может гибко соединить несколько узлов в графовой базе данных.
-    Вы можете легко выразить запросы на сопоставление шаблонов и навигацию со множеством переходов.
-    Вы можно легко выразить транзитивное замыкание и полиморфные запросы.

## <a name="when-to-use-a-graph-database"></a>Когда следует использовать базу данных Graph

Реляционная база данных может обеспечить все, что может сделать база данных Graph. Однако база данных Graph упрощает выражать определенные типы запросов. Кроме того, при определенных оптимизациях некоторые запросы могут работать лучше. Решение о выборе реляционной или графовой базы данных зависит от следующих факторов:  
-    Приложение имеет иерархические данные. Тип данных HierarchyID можно использовать для реализации иерархий, но у него есть некоторые ограничения. Например, он не позволяет хранить несколько родителей для узла.
-    Приложение имеет сложные связи "многие ко многим". по мере развития приложения добавляются новые связи.
-    Вам необходимо анализировать взаимосвязанные данные и связи.

## <a name="graph-features-introduced-in-sssql17"></a>Функции Graph, появившиеся в [!INCLUDE[sssql17](../../includes/sssql17-md.md)] 
Мы начинаем добавлять расширения графа в SQL Server, чтобы упростить хранение и запрос данных графов. В первом выпуске представлены следующие функции. 


### <a name="create-graph-objects"></a>Создание объектов Graph
[!INCLUDE[tsql-md](../../includes/tsql-md.md)] расширения позволяют пользователям создавать таблицы node или ребра. С этими узлами и краями могут быть связаны свойства. Поскольку узлы и грани хранятся в виде таблиц, все операции, поддерживаемые реляционными таблицами, поддерживаются в таблице node или EDGE. Пример:  

```   
CREATE TABLE Person (ID INTEGER PRIMARY KEY, Name VARCHAR(100), Age INT) AS NODE;
CREATE TABLE friends (StartDate date) AS EDGE;
```   

![Схема, показывающая узлы и края, хранится в виде таблиц.](../../relational-databases/graphs/media/person-friends-tables.png "Пограничные таблицы узлов Person и друзей")  
Узлы и грани хранятся в виде таблиц.  

### <a name="query-language-extensions"></a>Расширения языка запросов  
`MATCH`Введено предложение New для поддержки сопоставления шаблонов и навигации с несколькими прыжками через граф. `MATCH`Функция использует синтаксис стиля ASCII для сопоставления шаблонов. Пример:  

```   
-- Find friends of John
SELECT Person2.Name 
FROM Person Person1, Friends, Person Person2
WHERE MATCH(Person1-(Friends)->Person2)
AND Person1.Name = 'John';
```   
 
### <a name="fully-integrated-in-ssnoversion-engine"></a>Полностью интегрировано в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] подсистему 
Расширения Graph полностью интегрированы в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] подсистему. Используйте ту же подсистему хранилища, метаданные, обработчик запросов и т. д. для хранения данных графа и запросов к ним. Запрос по графу и реляционным данным в одном запросе. Объединение возможностей графа с другими [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] технологиями, такими как columnstore, Ha, R Services и т. д. База данных SQL Graph также поддерживает все функции обеспечения безопасности и соответствия требованиям, доступные в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .
 
### <a name="tooling-and-ecosystem"></a>Инструментарий и экосистема

Преимущества существующих средств и экосистемы, которые [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предлагают. Такие средства, как резервное копирование и восстановление, импорт и экспорт, просто работают с программой BCP. Другие средства или службы, такие как SSIS, SSRS или Power BI, будут работать с таблицами графов так же, как они работают с реляционными таблицами.

## <a name="edge-constraints"></a>Ограничения ребер
Ограничение ребра определяется в краевой таблице графа и является парой таблиц узлов, к которым может подключаться данный тип ребра. Это позволяет пользователям лучше управлять схемой графа. С помощью ограничений границ пользователи могут ограничивать типы узлов, к которым может подключаться данная граница. 

Дополнительные сведения о создании и использовании ограничений границ см. в разделе [ограничения границ](../../relational-databases/tables/graph-edge-constraints.md) .

## <a name="merge-dml"></a>Слияние DML 
Инструкция [Merge](../../t-sql/statements/merge-transact-sql.md) выполняет операции вставки, обновления или удаления в целевой таблице на основе результатов объединения с исходной таблицей. Например, можно синхронизировать две таблицы путем вставки, обновления или удаления строк в целевой таблице на основе различий между целевой таблицей и исходной таблицей. Использование предикатов MATCH в инструкции MERGE теперь поддерживается в базе данных SQL Azure и SQL Server vNext. Это значит, что теперь можно объединить текущие данные графа (таблицы узлов или пограничных таблиц) с новыми данными, используя предикаты MATCH для указания связей графа в одной инструкции, а не отдельные инструкции INSERT, UPDATE и DELETE.

Дополнительные сведения о том, как сопоставление можно использовать при слиянии DML, см. в [инструкции MERGE](../../t-sql/statements/merge-transact-sql.md) .

## <a name="shortest-path"></a>Кратчайший путь
Функция [SHORTEST_PATH](./sql-graph-shortest-path.md) находит кратчайший путь между любыми двумя узлами в графе или начиная с заданного узла и до всех остальных узлов графа. Кратчайший путь можно также использовать для поиска транзитивное замыкания или для произвольного обхода длины в графе. 

 ## <a name="next-steps"></a>Дальнейшие действия  
Ознакомьтесь с [архитектурой базы данных SQL Graph](./sql-graph-architecture.md)
   

