---
title: Публикация данных и объектов базы данных | Документация Mайкрософт
description: В этой статье перечислены таблицы и другие объекты базы данных, которые можно опубликовать для репликации в SQL Server.
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- user-defined types [SQL Server replication]
- articles [SQL Server replication], dropping
- objects [SQL Server replication]
- publications [SQL Server replication], creating
- merge replication [SQL Server replication], publications
- schema-only articles [SQL Server replication]
- publishing [SQL Server replication], database objects
- articles [SQL Server replication], defining
- publishing [SQL Server replication], functions
- replication [SQL Server], publications
- publishing [SQL Server replication], views
- tables [SQL Server replication]
- schemas [SQL Server replication]
- publishing [SQL Server replication], data
- schemas [SQL Server replication], publishing
- articles [SQL Server replication], stored procedures and
- publishing [SQL Server replication], tables
- alias data types [SQL Server replication]
- publications [SQL Server replication], deleting
- snapshot replication [SQL Server], publications
- articles [SQL Server replication], modifying
- transactional replication, publications
- publishing [SQL Server replication], stored procedures
- publishing [SQL Server replication]
- views [SQL Server replication]
- stored procedures [SQL Server replication], publishing
- publications [SQL Server replication], schema options
- articles [SQL Server replication], adding
- publications [SQL Server replication], modifying
- user-defined functions [SQL Server replication]
ms.assetid: d986032c-3387-4de1-a435-3ec5e82185a2
author: MashaMSFT
ms.author: mathoma
monikerRange: =azuresqldb-mi-current||>=sql-server-2016
ms.openlocfilehash: 6f0302c5807a93fdac826bb67a85c8e4e3e4abb5
ms.sourcegitcommit: 1a544cf4dd2720b124c3697d1e62ae7741db757c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2020
ms.locfileid: "97468975"
---
# <a name="publish-data-and-database-objects"></a>Публикация данных и объектов базы данных
[!INCLUDE[sql-asdbmi](../../../includes/applies-to-version/sql-asdbmi.md)]
  При создании публикации можно выбрать таблицы и другие объекты базы данных, которые необходимо опубликовать. Используя репликацию, можно опубликовать следующие объекты базы данных.  
  
|Объект базы данных|Репликация моментальных снимков и репликация транзакций|Репликация слиянием|  
|---------------------|--------------------------------------------------------|-----------------------|  
|Таблицы|X|X|  
|Секционированные таблицы|X|X|  
|Хранимые процедуры — определение ([!INCLUDE[tsql](../../../includes/tsql-md.md)] и среда CLR)|X|X|  
|Хранимые процедуры — выполнение ([!INCLUDE[tsql](../../../includes/tsql-md.md)] и среда CLR)|X|нет|  
|Представления|X|X|  
|Индексированные представления|X|X|  
|Индексированные представления в виде таблиц|X|нет|  
|Определяемые пользователем типы (CLR)|X|X|  
|Определяемые пользователем функции ([!INCLUDE[tsql](../../../includes/tsql-md.md)] и среда CLR)|X|X|  
|Псевдонимы типов данных|X|X|  
|Полнотекстовые индексы|X|X|  
|Объекты схемы (ограничения, индексы, пользовательские триггеры DML, расширенные свойства и параметры сортировки)|X|X|  
  
## <a name="creating-publications"></a>Создание публикаций  
 Для создания публикации необходимо предоставить следующую информацию.  
  
-   Распространитель.    
-   Расположение файлов моментальных снимков.    
-   База данных публикации.    
-   Тип создаваемой публикации (публикация моментальных снимков, публикация транзакций, публикация транзакций с обновляемыми подписками или публикация слиянием).    
-   Данные и объекты базы данных (статьи) для включения в публикацию.   
-   Статические фильтры строк и фильтры столбцов для всех типов публикаций, параметризованные фильтры строк и фильтры соединения для публикаций слиянием.   
-   Расписание агента моментальных снимков.    
-   Учетные записи, под которыми должны быть запущены следующие агенты: агент моментальных снимков для всех публикаций; агент чтения журнала для всех публикаций транзакций; агент чтения очереди для публикаций транзакций, разрешающих использование обновляемых подписок.    
-   Имя и описание публикации.  
  
 Сведения о работе с публикациями см. в следующих разделах.    
-   [Create a Publication](../../../relational-databases/replication/publish/create-a-publication.md)    
-   [Определение статьи](../../../relational-databases/replication/publish/define-an-article.md)    
-   [Просмотр и изменение свойств публикации](../../../relational-databases/replication/publish/view-and-modify-publication-properties.md)    
-   [View and Modify Article Properties (Просмотр и изменение свойств статьи)](../../../relational-databases/replication/publish/view-and-modify-article-properties.md)    
-   [Delete a Publication (Удаление публикации)](../../../relational-databases/replication/publish/delete-a-publication.md)    
-   [Delete an Article](../../../relational-databases/replication/publish/delete-an-article.md) (Удаление статьи)  
  
> [!NOTE]  
>  Удаление статьи или публикации не приводит к удалению объектов с подписчика.  
  
## <a name="publishing-tables"></a>Публикация таблиц  
 Наиболее часто публикуемым объектом является таблица. Следующие ссылки предоставляют дополнительные сведения по темам, связанным с публикацией таблиц.  
  
-   [Фильтрация опубликованных данных](../../../relational-databases/replication/publish/filter-published-data.md)    
-   [Article Options for Transactional Replication](../../../relational-databases/replication/transactional/article-options-for-transactional-replication.md)
-   [Article Options for Merge Replication](../../../relational-databases/replication/merge/article-options-for-merge-replication.md)    
-   [Репликация столбцов идентификаторов](../../../relational-databases/replication/publish/replicate-identity-columns.md)  
  
 При публикации таблицы для репликации можно указать, какие объекты схемы должны копироваться на подписчик, например: объявленная ссылочная целостность (ограничения на первичный ключ, ссылочные ограничения, ограничения уникальности), индексы, пользовательские триггеры DML (триггеры DDL не могут быть реплицированы), расширенные свойства и параметры сортировки. Расширенные свойства реплицируются только во время начальной синхронизации между издателем и подписчиком. При добавлении или изменении расширенного свойства после начальной синхронизации эти изменения не реплицируются.  
  
 Сведения об указании параметров схемы см. в разделе [Указание параметров схемы](../../../relational-databases/replication/publish/specify-schema-options.md) или <xref:Microsoft.SqlServer.Replication.Article.SchemaOption%2A>.  
  
### <a name="partitioned-tables-and-indexes"></a>Partitioned Tables and Indexes  
 Репликация поддерживает публикацию секционированных таблиц и индексов. Уровень поддержки зависит от типа репликации, которая была использована, и параметров, заданных для публикации и статей, связанных с секционированными таблицами. Дополнительные сведения см. в статье [Replicate Partitioned Tables and Indexes](../../../relational-databases/replication/publish/replicate-partitioned-tables-and-indexes.md) (Репликация секционированных таблиц и индексов).  
  
## <a name="publishing-stored-procedures"></a>Публикация хранимых процедур  
 Все типы репликации позволяют реплицировать определения хранимых процедур: инструкция CREATE PROCEDURE копируется на каждый подписчик. В случае с хранимыми процедурами общеязыковой среды исполнения (CLR) также копируется связанная сборка. Изменения процедур реплицируются на подписчики; изменения связанных сборок не реплицируются.  
  
 Помимо репликации определения хранимой процедуры репликация транзакций позволяет реплицировать выполнение хранимых процедур. Это полезно при репликации результатов хранимых процедур, связанных с обслуживанием и работающих с большими объемами данных. Дополнительные сведения см. в статье [Publishing Stored Procedure Execution in Transactional Replication](../../../relational-databases/replication/transactional/publishing-stored-procedure-execution-in-transactional-replication.md).  
  
## <a name="publishing-views"></a>Публикация представлений  
 Все типы репликации позволяют реплицировать представления. Представление (и сопутствующий индекс, если это индексированное представление) можно скопировать в подписчик, однако базовую таблицу также необходимо реплицировать.  
  
 Для индексированных представлений репликация транзакций также позволяет реплицировать индексированное представление в виде таблицы, а не как представление, исключая необходимость реплицировать и базовую таблицу. Для этого укажите один из вариантов на основе журнала индексированного представления для параметра *\@type* хранимой процедуры [sp_addarticle &#40;Transact-SQL&#41;](../../../relational-databases/system-stored-procedures/sp-addarticle-transact-sql.md). Дополнительные сведения об использовании **sp_addarticle** см. в статье [Define an Article](../../../relational-databases/replication/publish/define-an-article.md) (Определение статьи).  
  
## <a name="publishing-user-defined-functions"></a>Публикация пользовательских функций  
 Инструкции CREATE FUNCTION для функций CLR и [!INCLUDE[tsql](../../../includes/tsql-md.md)] копируются на каждый подписчик. В случае с функциями CLR также копируется и связанная сборка. Изменения функций реплицируются на подписчики; изменения связанных сборок не реплицируются.  
  
## <a name="publishing-user-defined-types-and-alias-data-types"></a>Публикация определяемых пользовательских типов и псевдонимов типов данных  
 Столбцы, использующие определяемые пользователем типы, и псевдонимы типов данных реплицируются на подписчики подобно другим столбцам. Перед созданием таблицы на подписчике выполняется инструкция CREATE TYPE для каждого реплицированного типа. В случае с определяемыми пользователем типами в каждый подписчик также копируется и связанная сборка. Изменения определяемых пользователем типов и псевдонимов типов данных не реплицируются на подписчики.  
  
 Если тип определен в базе данных, но на него нет ссылок ни в одном столбце, то при создании публикации этот тип не копируется в подписчики. Если впоследствии в базе данных создается столбец этого типа и его необходимо реплицировать, то вначале этот тип (вместе со связанной сборкой для определяемого пользователем типа) необходимо скопировать вручную на каждый подписчик.  
  
## <a name="publishing-full-text-indexes"></a>Публикация полнотекстовых индексов  
 Инструкция CREATE FULLTEXT INDEX копируется на каждый подписчик, и на подписчике создается полнотекстовый индекс. Изменения, внесенные в полнотекстовые индексы с помощью инструкции ALTER FULLTEXT INDEX, не реплицируются.  
  
## <a name="making-schema-changes-to-published-objects"></a>Внесение изменений схемы в опубликованные объекты  
 Репликация поддерживает широкий диапазон изменений схем для опубликованных объектов. При внесении любого из следующих изменений схемы в соответствующий опубликованный объект на издателе [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] это изменение распространяется по умолчанию на все подписчики [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :  
  
-   ALTER TABLE  
  
-   ALTER VIEW  
  
-   ALTER PROCEDURE  
  
-   ALTER FUNCTION  
  
-   ALTER TRIGGER  
  
 Дополнительные сведения см. в статье [Внесение изменений в схемы баз данных публикации](../../../relational-databases/replication/publish/make-schema-changes-on-publication-databases.md).  
  
## <a name="considerations-for-publishing"></a>Некоторые аспекты процесса публикации  
 При публикации объектов базы данных необходимо принимать во внимание следующие соображения.  
  
-   Во время создания публикации и исходного моментального снимка база данных может быть доступна для пользователей, однако рекомендуется создавать публикации в периоды пониженной активности на издателе.  
  
-   Базу данных невозможно переименовать после создания в ней публикации. Чтобы базу данных переименовать, необходимо сначала удалить из нее репликацию.  
  
-   При публикации объекта базы данных, зависящего от одного или нескольких других объектов базы данных, необходимо опубликовать и все связанные с ним объекты. Например, при публикации представления, зависящего от таблицы, необходимо также опубликовать и таблицу.  
  
    > [!NOTE]  
    >  Если при добавлении статьи в публикацию слиянием, существующая статья зависит от новой статьи, необходимо задать порядок обработки для обеих статей с помощью параметра **\@processing_order** процедур [sp_addmergearticle](../../../relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql.md) и [sp_changemergearticle](../../../relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql.md). Рассмотрим следующий сценарий: необходимо опубликовать таблицу без публикации функции, на которую ссылается эта таблица. Если функция не будет опубликована, то таблица не сможет быть создана на подписчике. При добавлении функции к публикации: задайте значение **1** для параметра **\@processing_order** процедуры **sp_addmergearticle** и значение **2** для параметра **\@processing_order** процедуры **sp_changemergearticle**, указав имя таблицы в параметре **\@article**. Этот порядок обработки гарантирует создание функции на подписчике до создания таблицы, которая зависит от нее. Можно использовать различные числа для каждой статьи при условии, что число для функции меньше числа для таблицы.  
  
-   Имена публикаций не могут содержать следующие символы: % * [ ] | : " ? \ / < >.  
  
### <a name="limitations-on-publishing-objects"></a>Ограничения на публикацию объектов  
  
-   Максимальное количество публикуемых статей и столбцов зависит от типа публикации. Дополнительные сведения см. в разделе "Объекты репликации" статьи [Maximum Capacity Specifications for SQL Server](../../../sql-server/maximum-capacity-specifications-for-sql-server.md) (Спецификации максимально допустимых параметров SQL Server).  
  
-   Хранимые процедуры, представления, триггеры и определяемые пользователем функции, которые определяются как WITH ENCRYPTION, невозможно опубликовать как часть репликации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .  
  
-   Коллекции схем XML могут быть реплицированы, но изменения, внесенные после создания исходного моментального снимка, не реплицируются.  
  
-   Таблицы, опубликованные для репликации транзакций, должны содержать первичный ключ. Если таблица входит в публикацию репликации транзакций, то нельзя отключить никакие индексы, связанные с первичными ключевыми столбцами. Эти индексы необходимы для репликации. Чтобы отключить индексы, сначала необходимо удалить таблицу из публикации.  
  
-   Связанные значения по умолчанию, созданные с помощью [sp_bindefault (Transact-SQL)](../../../relational-databases/system-stored-procedures/sp-bindefault-transact-sql.md), не реплицируются (вместо связанных значений по умолчанию мы рекомендуем использовать значения по умолчанию, созданные с помощью ключевого слова DEFAULT инструкции ALTER TABLE или CREATE TABLE).  
  
-   Функции, содержащие указание **NOEXPAND** на индексированных представлениях, невозможно опубликовать в той же публикации, что и ссылочные таблицы и индексированные представления. Это обусловлено порядком их доставки агентом распространения. Чтобы обойти эту проблему, поместите создание таблицы и индексированного представления в первую публикацию, добавьте функции с указанием **NOEXPAND** в на индексированных представлениях во вторую публикацию, которую следует опубликовать после завершения первой публикации. Также вы можете создать сценарии для этих функций и передать сценарий с помощью параметра *\@post_snapshot_script* в **sp_addpublication**.  
  
### <a name="schemas-and-object-ownership"></a>Схемы и принадлежность объектов  
 Репликации свойственно следующее поведение по умолчанию в мастере создания публикаций, касающееся схем и принадлежности объектов:  
  
-   Для статей в публикациях слиянием с уровнем совместимости 90 или выше, публикациях моментальных снимков и публикациях транзакций: по умолчанию владелец объекта на подписчике идентичен владельцу соответствующего объекта на издателе. Если на подписчике не существует схем, владеющих объектами, они создаются автоматически.  
  
-   Для статей в публикациях слиянием с уровнем совместимости менее 90: по умолчанию владелец не указывается, а в процессе создания объекта на подписчике владельцем назначается **dbo** .  
  
-   Для статей в публикациях Oracle: по умолчанию владельцем назначается **dbo**.  
  
-   Для статей в публикациях, в которых используются моментальные снимки в текстовом режиме (используются для подписчиков, отличных от подписчиков[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , и подписчиков [!INCLUDE[ssEW](../../../includes/ssew-md.md)] ): по умолчанию владелец не указывается. Владельцем по умолчанию является владелец, указанный в учетной записи, используемой агентом распространителя или агентом слияния для соединения с подписчиком.  
  
 Владельца объекта можно изменить с помощью диалогового окна **Свойства статьи — \<**_Article_**>** и следующих хранимых процедур: **sp_addarticle**, **sp_addmergearticle**, **sp_changearticle** и **sp_changemergearticle**. Дополнительные сведения см. в статье [Просмотр и изменение свойств публикации](../../../relational-databases/replication/publish/view-and-modify-publication-properties.md), [Определение статьи](../../../relational-databases/replication/publish/define-an-article.md) и [Просмотр и изменение свойств статьи](../../../relational-databases/replication/publish/view-and-modify-article-properties.md).  
  
### <a name="publishing-data-to-subscribers-running-previous-versions-of-sql-server"></a>Публикация данных на подписчики, использующие предыдущие версии SQL Server  
  
-   При публикации данных на подписчик, использующий предыдущую версию [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], предлагаются только те функции, которые имеются в этой версии. Ограничения накладываются как на функции репликации, так и на функции продукта в целом.  
  
-   Публикации слиянием используют уровень совместимости, который определяет, какие функции могут использоваться в публикации, а также обеспечивает поддержку подписчиков, на которых выполняются предыдущие версии [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].  
  
### <a name="publishing-tables-in-more-than-one-publication"></a>Публикация таблиц в нескольких публикациях  
 Репликация поддерживает публикацию статей в нескольких публикациях (включая переиздание данных) со следующими ограничениями.  
  
-   Если статья опубликована в публикации транзакций и публикации слиянием, убедитесь, что свойство *\@published_in_tran_pub* имеет значение TRUE для статьи публикации слиянием. Дополнительные сведения об изменении свойств см. в статье [Просмотр и изменение свойств публикации](../../../relational-databases/replication/publish/view-and-modify-publication-properties.md) и [Просмотр и изменение свойств статьи](../../../relational-databases/replication/publish/view-and-modify-article-properties.md).  
  
     Также нужно установить свойство *\@published_in_tran_pub*, если статья является частью подписки на публикацию транзакций и включена в публикацию слиянием. В этом случае нужно иметь в виду, что по умолчанию репликация транзакций ожидает, что таблицы на подписчике будут иметь атрибут «только для чтения». Если репликация слиянием производит изменения данных в таблице подписки на публикацию транзакций, то может возникнуть потеря конвергенции данных. Чтобы избежать этой ситуации, рекомендуется, чтобы любые подобные таблицы задавались в публикации слиянием с атрибутом «только для загрузки». Это защищает подписчика на публикацию слиянием от передачи измененных данных в таблицу. Дополнительные сведения см. в статье [Оптимизация производительности репликации слиянием при работе со статьями, доступными только для загрузки](../../../relational-databases/replication/merge/optimize-merge-replication-performance-with-download-only-articles.md).  
  
-   Статья не может быть опубликована и в публикации слиянием и в публикации транзакций с подписками, обновляемыми посредством очередей.  
  
-   Статьи, включенные в публикации транзакций, которые поддерживают обновляемые подписки, не могут переиздаваться.  
  
-   Если статья опубликована в нескольких публикациях транзакций, которые поддерживают подписки, обновляемые посредством очередей, то во всех публикациях следующим свойствам этой статьи должны присваиваться одинаковые значения:  
  
    |Свойство|Параметр в sp_addarticle|  
    |--------------|---------------------------------|  
    |Управление диапазонами идентификаторов|**\@auto_identity_range** (является устаревшим) и **\@identityrangemangementoption**|  
    |Диапазон идентификаторов издателя|**\@pub_identity_range**|  
    |Диапазон идентификаторов|**\@identity_range**|  
    |Порог диапазона идентификаторов|**\@threshold**|  
  
     Дополнительные сведения о параметрах схемы см. в статье об [sp_addarticle (Transact-SQL)](../../../relational-databases/system-stored-procedures/sp-addarticle-transact-sql.md).  
  
-   Если статья опубликована в нескольких публикациях слиянием, то во всех публикациях следующим свойствам этой статьи должны присваиваться одинаковые значения.  
  
    |Свойство|Параметр в sp_addmergearticle|  
    |--------------|--------------------------------------|  
    |Отслеживание значений столбцов|**\@column_tracking**|  
    |Параметры схемы|**\@schema_option**|  
    |Фильтрация столбцов|**\@vertical_partition**|  
    |Параметры выгрузки данных подписчика|**\@subscriber_upload_options**|  
    |Условное отслеживание удалений|**\@delete_tracking**|  
    |Компенсация ошибок|**\@compensate_for_errors**|  
    |Управление диапазонами идентификаторов|**\@auto_identity_range** (является устаревшим) и **\@identityrangemangementoption**|  
    |Диапазон идентификаторов издателя|**\@pub_identity_range**|  
    |Диапазон идентификаторов|**\@identity_range**|  
    |Порог диапазона идентификаторов|**\@threshold**|  
    |Параметры секции|**\@partition_options**|  
    |Направление потока данных столбцов большого двоичного объекта|**\@stream_blob_columns**|  
    |Тип фильтра|**\@filter_type** (параметр хранимой процедуры **sp_addmergefilter**)|  
  
     Дополнительные сведения об этих параметрах см. в статье об [sp_addmergearticle (Transact-SQL)](../../../relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql.md) и [sp_addmergefilter (Transact-SQL)](../../../relational-databases/system-stored-procedures/sp-addmergefilter-transact-sql.md).  
  
-   Репликация транзакций и нефильтрованная репликация слиянием поддерживают публикацию таблицы в нескольких публикациях с последующей подпиской в пределах одной таблицы в базе данных подписки (такой сценарий, как правило, называется сценарием сведения). Сведение часто используется для объединения подмножеств данных из нескольких мест в одной таблице на центральном подписчике. Фильтрованные публикации слиянием не поддерживают сценарий центрального подписчика. Для репликации слиянием сведение обычно реализуется в одной публикации с помощью параметризованных фильтров строк. Дополнительные сведения см. в разделе [Параметризованные фильтры строк](../../../relational-databases/replication/merge/parameterized-filters-parameterized-row-filters.md).  
  
## <a name="see-also"></a>См. также:  
 [Добавление и удаление статей в существующих публикациях](../../../relational-databases/replication/publish/add-articles-to-and-drop-articles-from-existing-publications.md)   
 [Настройка распространения](../../../relational-databases/replication/configure-distribution.md)   
 [Инициализация подписки](../../../relational-databases/replication/initialize-a-subscription.md)   
 [Scripting Replication (Скрипты репликации)](../../../relational-databases/replication/scripting-replication.md)   
 [Организация безопасности издателя](../../../relational-databases/replication/security/secure-the-publisher.md)   
 [Подписка на публикации](../../../relational-databases/replication/subscribe-to-publications.md)  
  
  
