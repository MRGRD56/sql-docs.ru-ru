---
title: настроить выполнение модульного теста SQL Server
description: Сведения о настройке модульных тестов SQL Server. Узнайте, как указать строки подключения и развернуть схему базы данных.
ms.prod: sql
ms.technology: ssdt
ms.topic: conceptual
ms.assetid: e0179429-13ce-4d23-ae27-e6419de0a575
author: markingmyname
ms.author: maghan
ms.reviewer: “”
ms.custom: seo-lt-2019
ms.date: 02/09/2017
ms.openlocfilehash: b2d0b76423ab5a391351783970a6c9a057896bf7
ms.sourcegitcommit: a41e1f4199785a2b8019a419a1f3dcdc15571044
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "91987970"
---
# <a name="how-to-configure-sql-server-unit-test-execution"></a>Руководство. настроить выполнение модульного теста SQL Server

При настройке тестового проекта можно задать несколько параметров, управляющих аспектами выполнения модульных тестов SQL Server. Эти параметры конфигурации хранятся в файле app.config проекта тестов. При непосредственном изменении этого файла новые значения отображаются в диалоговом окне конфигурации проекта.  
  
Решение может содержать несколько проектов тестов. Каждый проект тестов содержит один файл app.config (то есть один набор параметров конфигурации). В результате решение может содержать различные наборы модульных тестов (по одному набору на каждый проект тестов), настроенных для выполнения различным образом.  
  
Эти параметры определяют то, как тест подключается к проверяемой базе данных, метод развертывания схемы из проекта базы данных в эту базу данных, а также будет ли база данных заполняться с помощью плана формирования данных.  
  
-   **Подключения к базе данных**. Этот параметр используется для задания строк подключения, используемых для подключения к тестируемой базе данных. Дополнительные сведения см. в разделе [Указание строк подключения](#SpecifyConnectionStrings).  
  
-   **Развертывание схемы**. Проект базы данных — это представления базы данных вне сети. Проект базы данных представляет структуру объектов базы данных, но не содержит данных. После внесения изменений в схему в проекте базы данных их можно тестировать в реальной базе данных. На этапе развертывания схемы тестируемые объекты базы данных копируются из проекта базы данных в базу данных, в которой выполняются тесты. Дополнительные сведения о развертывании схем см. в разделе [Развертывание схемы базы данных](#DeployingDBSchema).  
  
    > [!NOTE]  
    > Тесты выполняются не в папке решения, а в отдельной папке на локальном жестком диске. Хотя существует возможность настройки аспектов развертывания тестов, обычно для модульных тестов нет необходимости в их настройке. Дополнительные сведения о развертывании тестов см. в статье [Выполнение тестов](/previous-versions/visualstudio/visual-studio-2010/dd286680(v=vs.100)).  
  
## <a name="specify-connection-strings"></a><a name="SpecifyConnectionStrings"></a>Указание строк подключения  
  
#### <a name="to-specify-database-connection-strings"></a>Указание строк подключения к базе данных  
  
1.  В **обозревателе решений** щелкните проект модульных тестов правой кнопкой мыши и выберите **Конфигурация теста SQL Server**.  
  
    Откроется диалоговое окно **Конфигурация теста SQL Server — "<projectname>"** .  
  
2.  В окне **Подключения к базе данных** можно сделать следующее.  
  
    -   Выберите подключение к базе данных, для которой необходимо выполнить модульные тесты.  
  
    -   Установите флажок **Use a secondary data connection to validate unit tests** (Использовать вторичное подключение к данным для проверки модульных тестов) и выберите подключение к базе данных в списке, если необходимо проверить выполнение теста с другим подключением к базе данных.  
  
    -   Выберите **Новое подключение**, чтобы добавить подключение к любому из списков. Также можно щелкнуть **Изменить подключение**, чтобы изменить параметры существующего подключения.  
  
    На этом этапе создается строка подключения `ExecutionContext`, используемая для выполнения скрипта теста из модульного теста. Если было указано вторичное подключение, также будет создана строка подключения `PrivilegedContext`. Это соединение используется для тестирования в модульном тесте взаимодействия с базой данных вне скрипта теста. Дополнительные сведения см. в разделе [Общие сведения о строках подключения и разрешениях](../ssdt/overview-of-connection-strings-and-permissions.md).  
  
3.  Чтобы закрыть диалоговое окно **Конфигурация теста SQL Server —''<projectname>''** , нажмите кнопку **OК**.  
  
4.  Повторно постройте проект тестов, чтобы применить изменения конфигурации.  
  
## <a name="deploy-a-database-schema"></a><a name="DeployingDBSchema"></a>Развертывание схемы базы данных  
  
#### <a name="to-deploy-to-a-database-the-schema-of-a-database-project"></a>Развертывание схемы проекта базы данных в базе данных  
  
1.  В **обозревателе решений** щелкните проект базы данных правой кнопкой мыши, а затем выберите пункт **Сборка**.  
  
    В процессе сборки проекта базы данных можно создать скрипт Transact\-SQL. При выполнении этого скрипта в базе данных выполняется повторное создание структуры проекта базы данных в этой базе данных.  
  
2.  Выберите проект тестов, который следует настроить.  
  
3.  В **обозревателе решений** щелкните проект модульных тестов правой кнопкой мыши и выберите **Конфигурация теста SQL Server**.  
  
    Откроется диалоговое окно **Конфигурация теста SQL Server — "<projectname>"** .  
  
4.  В разделе **Развертывание** можно сделать следующее.  
  
    -   Установите флажок **Automatically deploy database projects before running tests** (Автоматически развертывать проекты базы данных перед выполнением тестов), чтобы все изменения схемы, внесенные в проект базы данных, были зафиксированы перед выполнением тестов.  
  
    -   В разделе **Проект базы данных** щелкните проект базы данных, который следует развернуть, либо нажмите кнопку с многоточием, чтобы перейти к другому проекту. Файлы проекта базы данных должны иметь расширение DBPROJ.  
  
    -   В разделе **Конфигурация развертывания** щелкните конфигурацию проекта, в которой необходимо выполнить развертывание. Доступны варианты **Отладка**, **По умолчанию** и **Выпуск**. Однако, если была создана конфигурация для модульного тестирования, эта конфигурация также будет отображена.  
  
5.  Чтобы закрыть диалоговое окно **Конфигурация теста SQL Server —''<projectname>''** , нажмите кнопку **OК**.  
  
    При запуске теста выполняется скрипт Transact\-SQL, который был создан на шаге 1. Это действие развертывает схему в целевой базе данных.  
  
6.  Перестройте модульный тест проекта, чтобы применить изменения конфигурации.  
  
## <a name="see-also"></a>См. также:  
[Создание и определение модульных тестов SQL Server](../ssdt/creating-and-defining-sql-server-unit-tests.md)  
[Проверка кода базы данных с помощью модульных тестов SQL Server](../ssdt/verifying-database-code-by-using-sql-server-unit-tests.md)  
